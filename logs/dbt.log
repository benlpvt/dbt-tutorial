[0m22:33:45.064151 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106310910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1069007d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e96290>]}


============================== 22:33:45.070558 | 36db5546-7b85-44e3-9c70-7c17d542b170 ==============================
[0m22:33:45.070558 [info ] [MainThread]: Running with dbt=1.7.8
[0m22:33:45.071483 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/Users/ben/.dbt', 'log_path': '/Users/ben/jaffle_shop/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt debug', 'send_anonymous_usage_stats': 'True'}
[0m22:33:45.072386 [info ] [MainThread]: dbt version: 1.7.8
[0m22:33:45.073100 [info ] [MainThread]: python version: 3.11.0
[0m22:33:45.073725 [info ] [MainThread]: python path: /Users/ben/dbt-env/bin/python
[0m22:33:45.074214 [info ] [MainThread]: os info: macOS-14.3.1-x86_64-i386-64bit
[0m22:33:45.468900 [info ] [MainThread]: Using profiles dir at /Users/ben/.dbt
[0m22:33:45.469616 [info ] [MainThread]: Using profiles.yml file at /Users/ben/.dbt/profiles.yml
[0m22:33:45.470104 [info ] [MainThread]: Using dbt_project.yml file at /Users/ben/jaffle_shop/dbt_project.yml
[0m22:33:45.470844 [info ] [MainThread]: adapter type: snowflake
[0m22:33:45.471314 [info ] [MainThread]: adapter version: 1.7.2
[0m22:33:45.679721 [info ] [MainThread]: Configuration:
[0m22:33:45.680578 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m22:33:45.681208 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m22:33:45.681967 [info ] [MainThread]: Required dependencies:
[0m22:33:45.682617 [debug] [MainThread]: Executing "git --help"
[0m22:33:45.719003 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m22:33:45.720524 [debug] [MainThread]: STDERR: "b''"
[0m22:33:45.721170 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m22:33:45.721798 [info ] [MainThread]: Connection:
[0m22:33:45.722694 [info ] [MainThread]:   account: https://eta20809.east-us-2.azure.snowflakecomputing.com
[0m22:33:45.723285 [info ] [MainThread]:   user: DBT_EXECUTOR
[0m22:33:45.723813 [info ] [MainThread]:   database: RAW
[0m22:33:45.724484 [info ] [MainThread]:   warehouse: TRANSFORMING
[0m22:33:45.725283 [info ] [MainThread]:   role: DBT_EXECUTOR
[0m22:33:45.725796 [info ] [MainThread]:   schema: JAFFLE_SHOP
[0m22:33:45.726341 [info ] [MainThread]:   authenticator: None
[0m22:33:45.727392 [info ] [MainThread]:   private_key_path: None
[0m22:33:45.728680 [info ] [MainThread]:   oauth_client_id: None
[0m22:33:45.729323 [info ] [MainThread]:   query_tag: None
[0m22:33:45.729923 [info ] [MainThread]:   client_session_keep_alive: False
[0m22:33:45.730404 [info ] [MainThread]:   host: None
[0m22:33:45.730869 [info ] [MainThread]:   port: None
[0m22:33:45.731319 [info ] [MainThread]:   proxy_host: None
[0m22:33:45.731760 [info ] [MainThread]:   proxy_port: None
[0m22:33:45.732350 [info ] [MainThread]:   protocol: None
[0m22:33:45.733072 [info ] [MainThread]:   connect_retries: 1
[0m22:33:45.733608 [info ] [MainThread]:   connect_timeout: None
[0m22:33:45.734066 [info ] [MainThread]:   retry_on_database_errors: False
[0m22:33:45.734501 [info ] [MainThread]:   retry_all: False
[0m22:33:45.734936 [info ] [MainThread]:   insecure_mode: False
[0m22:33:45.735512 [info ] [MainThread]:   reuse_connections: None
[0m22:33:45.736286 [info ] [MainThread]: Registered adapter: snowflake=1.7.2
[0m22:33:45.770673 [debug] [MainThread]: Acquiring new snowflake connection 'debug'
[0m22:33:45.773496 [debug] [MainThread]: Using snowflake connection "debug"
[0m22:33:45.774075 [debug] [MainThread]: On debug: select 1 as id
[0m22:33:45.774867 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:33:46.995838 [debug] [MainThread]: Snowflake adapter: Error running SQL: select 1 as id
[0m22:33:46.996473 [debug] [MainThread]: Snowflake adapter: Rolling back transaction.
[0m22:33:46.997013 [debug] [MainThread]: On debug: No close available on handle
[0m22:33:46.997569 [info ] [MainThread]:   Connection test: [[31mERROR[0m]

[0m22:33:46.998076 [info ] [MainThread]: [31m1 check failed:[0m
[0m22:33:46.998548 [info ] [MainThread]: dbt was unable to connect to the specified database.
The database returned the following error:

  >Database Error
  250001: Could not connect to Snowflake backend after 2 attempt(s).Aborting

Check your database credentials and try again. For more information, visit:
https://docs.getdbt.com/docs/configure-your-profile


[0m22:33:47.000520 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_wall_clock_time": 2.0295067, "process_user_time": 3.603325, "process_kernel_time": 0.411044, "process_mem_max_rss": "122671104", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m22:33:47.001758 [debug] [MainThread]: Command `dbt debug` failed at 22:33:47.001491 after 2.03 seconds
[0m22:33:47.002576 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m22:33:47.003647 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106854090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106860cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106895d50>]}
[0m22:33:47.004465 [debug] [MainThread]: Flushing usage events
[0m22:35:01.699607 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112f97b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112faaa50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112958fd0>]}


============================== 22:35:01.706209 | c7eeaee9-606c-4690-9f32-b2bd797db1ad ==============================
[0m22:35:01.706209 [info ] [MainThread]: Running with dbt=1.7.8
[0m22:35:01.707289 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/ben/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/ben/jaffle_shop/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt debug', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m22:35:01.708401 [info ] [MainThread]: dbt version: 1.7.8
[0m22:35:01.709734 [info ] [MainThread]: python version: 3.11.0
[0m22:35:01.711039 [info ] [MainThread]: python path: /Users/ben/dbt-env/bin/python
[0m22:35:01.711666 [info ] [MainThread]: os info: macOS-14.3.1-x86_64-i386-64bit
[0m22:35:02.137829 [info ] [MainThread]: Using profiles dir at /Users/ben/.dbt
[0m22:35:02.139205 [info ] [MainThread]: Using profiles.yml file at /Users/ben/.dbt/profiles.yml
[0m22:35:02.140181 [info ] [MainThread]: Using dbt_project.yml file at /Users/ben/jaffle_shop/dbt_project.yml
[0m22:35:02.141272 [info ] [MainThread]: adapter type: snowflake
[0m22:35:02.142500 [info ] [MainThread]: adapter version: 1.7.2
[0m22:35:02.366028 [info ] [MainThread]: Configuration:
[0m22:35:02.366743 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m22:35:02.367315 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m22:35:02.367987 [info ] [MainThread]: Required dependencies:
[0m22:35:02.368549 [debug] [MainThread]: Executing "git --help"
[0m22:35:02.404186 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m22:35:02.406073 [debug] [MainThread]: STDERR: "b''"
[0m22:35:02.407033 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m22:35:02.408574 [info ] [MainThread]: Connection:
[0m22:35:02.410614 [info ] [MainThread]:   account: https://eta20809.east-us-2.azure.snowflakecomputing.com
[0m22:35:02.411617 [info ] [MainThread]:   user: DBT_EXECUTOR
[0m22:35:02.412288 [info ] [MainThread]:   database: RAW
[0m22:35:02.412974 [info ] [MainThread]:   warehouse: TRANSFORMING
[0m22:35:02.413448 [info ] [MainThread]:   role: DBT_EXECUTOR_ROLE
[0m22:35:02.413894 [info ] [MainThread]:   schema: JAFFLE_SHOP
[0m22:35:02.414332 [info ] [MainThread]:   authenticator: None
[0m22:35:02.414764 [info ] [MainThread]:   private_key_path: None
[0m22:35:02.415190 [info ] [MainThread]:   oauth_client_id: None
[0m22:35:02.415621 [info ] [MainThread]:   query_tag: None
[0m22:35:02.416049 [info ] [MainThread]:   client_session_keep_alive: False
[0m22:35:02.416476 [info ] [MainThread]:   host: None
[0m22:35:02.416922 [info ] [MainThread]:   port: None
[0m22:35:02.417351 [info ] [MainThread]:   proxy_host: None
[0m22:35:02.417783 [info ] [MainThread]:   proxy_port: None
[0m22:35:02.418206 [info ] [MainThread]:   protocol: None
[0m22:35:02.418629 [info ] [MainThread]:   connect_retries: 1
[0m22:35:02.419052 [info ] [MainThread]:   connect_timeout: None
[0m22:35:02.419483 [info ] [MainThread]:   retry_on_database_errors: False
[0m22:35:02.419899 [info ] [MainThread]:   retry_all: False
[0m22:35:02.420324 [info ] [MainThread]:   insecure_mode: False
[0m22:35:02.420880 [info ] [MainThread]:   reuse_connections: None
[0m22:35:02.421744 [info ] [MainThread]: Registered adapter: snowflake=1.7.2
[0m22:35:02.433424 [debug] [MainThread]: Acquiring new snowflake connection 'debug'
[0m22:35:02.435650 [debug] [MainThread]: Using snowflake connection "debug"
[0m22:35:02.436227 [debug] [MainThread]: On debug: select 1 as id
[0m22:35:02.436902 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:35:03.579671 [debug] [MainThread]: Snowflake adapter: Error running SQL: select 1 as id
[0m22:35:03.580525 [debug] [MainThread]: Snowflake adapter: Rolling back transaction.
[0m22:35:03.581477 [debug] [MainThread]: On debug: No close available on handle
[0m22:35:03.582275 [info ] [MainThread]:   Connection test: [[31mERROR[0m]

[0m22:35:03.582946 [info ] [MainThread]: [31m1 check failed:[0m
[0m22:35:03.583618 [info ] [MainThread]: dbt was unable to connect to the specified database.
The database returned the following error:

  >Database Error
  250001: Could not connect to Snowflake backend after 2 attempt(s).Aborting

Check your database credentials and try again. For more information, visit:
https://docs.getdbt.com/docs/configure-your-profile


[0m22:35:03.585762 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_wall_clock_time": 1.9812589, "process_user_time": 3.711043, "process_kernel_time": 0.399757, "process_mem_max_rss": "123523072", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m22:35:03.586814 [debug] [MainThread]: Command `dbt debug` failed at 22:35:03.586575 after 1.98 seconds
[0m22:35:03.588062 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m22:35:03.589130 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112938850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112f80290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112bff4d0>]}
[0m22:35:03.590106 [debug] [MainThread]: Flushing usage events
[0m22:36:39.933059 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1101b7350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fb44050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10febccd0>]}


============================== 22:36:39.939212 | 23586b65-eaf3-469d-83eb-4ba11b09fa77 ==============================
[0m22:36:39.939212 [info ] [MainThread]: Running with dbt=1.7.8
[0m22:36:39.940476 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/Users/ben/.dbt', 'log_path': '/Users/ben/jaffle_shop/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt debug', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:36:39.941985 [info ] [MainThread]: dbt version: 1.7.8
[0m22:36:39.943299 [info ] [MainThread]: python version: 3.11.0
[0m22:36:39.944045 [info ] [MainThread]: python path: /Users/ben/dbt-env/bin/python
[0m22:36:39.944849 [info ] [MainThread]: os info: macOS-14.3.1-x86_64-i386-64bit
[0m22:36:40.335526 [info ] [MainThread]: Using profiles dir at /Users/ben/.dbt
[0m22:36:40.336269 [info ] [MainThread]: Using profiles.yml file at /Users/ben/.dbt/profiles.yml
[0m22:36:40.336770 [info ] [MainThread]: Using dbt_project.yml file at /Users/ben/jaffle_shop/dbt_project.yml
[0m22:36:40.337527 [info ] [MainThread]: adapter type: snowflake
[0m22:36:40.338012 [info ] [MainThread]: adapter version: 1.7.2
[0m22:36:40.554658 [info ] [MainThread]: Configuration:
[0m22:36:40.555347 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m22:36:40.555834 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m22:36:40.556312 [info ] [MainThread]: Required dependencies:
[0m22:36:40.556864 [debug] [MainThread]: Executing "git --help"
[0m22:36:40.589053 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m22:36:40.590701 [debug] [MainThread]: STDERR: "b''"
[0m22:36:40.591377 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m22:36:40.593445 [info ] [MainThread]: Connection:
[0m22:36:40.594997 [info ] [MainThread]:   account: https://eta20809.east-us-2.azure.snowflakecomputing.com
[0m22:36:40.595614 [info ] [MainThread]:   user: DBT_EXECUTOR
[0m22:36:40.596097 [info ] [MainThread]:   database: ANALYTICS
[0m22:36:40.596540 [info ] [MainThread]:   warehouse: TRANSFORMING
[0m22:36:40.596975 [info ] [MainThread]:   role: DBT_EXECUTOR_ROLE
[0m22:36:40.597409 [info ] [MainThread]:   schema: JAFFLE_SHOP
[0m22:36:40.597847 [info ] [MainThread]:   authenticator: None
[0m22:36:40.598283 [info ] [MainThread]:   private_key_path: None
[0m22:36:40.598713 [info ] [MainThread]:   oauth_client_id: None
[0m22:36:40.599143 [info ] [MainThread]:   query_tag: None
[0m22:36:40.599580 [info ] [MainThread]:   client_session_keep_alive: False
[0m22:36:40.600105 [info ] [MainThread]:   host: None
[0m22:36:40.600629 [info ] [MainThread]:   port: None
[0m22:36:40.601120 [info ] [MainThread]:   proxy_host: None
[0m22:36:40.602005 [info ] [MainThread]:   proxy_port: None
[0m22:36:40.602565 [info ] [MainThread]:   protocol: None
[0m22:36:40.603024 [info ] [MainThread]:   connect_retries: 1
[0m22:36:40.603493 [info ] [MainThread]:   connect_timeout: None
[0m22:36:40.604063 [info ] [MainThread]:   retry_on_database_errors: False
[0m22:36:40.604673 [info ] [MainThread]:   retry_all: False
[0m22:36:40.605166 [info ] [MainThread]:   insecure_mode: False
[0m22:36:40.605770 [info ] [MainThread]:   reuse_connections: None
[0m22:36:40.606858 [info ] [MainThread]: Registered adapter: snowflake=1.7.2
[0m22:36:40.616698 [debug] [MainThread]: Acquiring new snowflake connection 'debug'
[0m22:36:40.618999 [debug] [MainThread]: Using snowflake connection "debug"
[0m22:36:40.619803 [debug] [MainThread]: On debug: select 1 as id
[0m22:36:40.620359 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:36:41.749394 [debug] [MainThread]: Snowflake adapter: Error running SQL: select 1 as id
[0m22:36:41.750046 [debug] [MainThread]: Snowflake adapter: Rolling back transaction.
[0m22:36:41.750594 [debug] [MainThread]: On debug: No close available on handle
[0m22:36:41.751367 [info ] [MainThread]:   Connection test: [[31mERROR[0m]

[0m22:36:41.751911 [info ] [MainThread]: [31m1 check failed:[0m
[0m22:36:41.752389 [info ] [MainThread]: dbt was unable to connect to the specified database.
The database returned the following error:

  >Database Error
  250001: Could not connect to Snowflake backend after 2 attempt(s).Aborting

Check your database credentials and try again. For more information, visit:
https://docs.getdbt.com/docs/configure-your-profile


[0m22:36:41.754313 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_wall_clock_time": 1.9141219, "process_user_time": 3.620898, "process_kernel_time": 0.387982, "process_mem_max_rss": "122687488", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m22:36:41.755202 [debug] [MainThread]: Command `dbt debug` failed at 22:36:41.754993 after 1.92 seconds
[0m22:36:41.755885 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m22:36:41.756974 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fe1ce10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110a34590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110198150>]}
[0m22:36:41.757877 [debug] [MainThread]: Flushing usage events
[0m22:38:24.460289 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bc5ead0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bc6f150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bc6e190>]}


============================== 22:38:24.467418 | 5cc5dc23-53d1-4253-8d75-c64df1670c85 ==============================
[0m22:38:24.467418 [info ] [MainThread]: Running with dbt=1.7.8
[0m22:38:24.468663 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/ben/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/Users/ben/jaffle_shop/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt debug', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:38:24.469810 [info ] [MainThread]: dbt version: 1.7.8
[0m22:38:24.470407 [info ] [MainThread]: python version: 3.11.0
[0m22:38:24.470933 [info ] [MainThread]: python path: /Users/ben/dbt-env/bin/python
[0m22:38:24.471632 [info ] [MainThread]: os info: macOS-14.3.1-x86_64-i386-64bit
[0m22:38:24.852992 [info ] [MainThread]: Using profiles dir at /Users/ben/.dbt
[0m22:38:24.853734 [info ] [MainThread]: Using profiles.yml file at /Users/ben/.dbt/profiles.yml
[0m22:38:24.854227 [info ] [MainThread]: Using dbt_project.yml file at /Users/ben/jaffle_shop/dbt_project.yml
[0m22:38:24.855162 [info ] [MainThread]: adapter type: snowflake
[0m22:38:24.856214 [info ] [MainThread]: adapter version: 1.7.2
[0m22:38:25.051171 [info ] [MainThread]: Configuration:
[0m22:38:25.051877 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m22:38:25.052421 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m22:38:25.052896 [info ] [MainThread]: Required dependencies:
[0m22:38:25.053440 [debug] [MainThread]: Executing "git --help"
[0m22:38:25.087848 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m22:38:25.091257 [debug] [MainThread]: STDERR: "b''"
[0m22:38:25.092086 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m22:38:25.092723 [info ] [MainThread]: Connection:
[0m22:38:25.093296 [info ] [MainThread]:   account: eta20809.east-us-2.azure
[0m22:38:25.093745 [info ] [MainThread]:   user: DBT_EXECUTOR
[0m22:38:25.094198 [info ] [MainThread]:   database: ANALYTICS
[0m22:38:25.094639 [info ] [MainThread]:   warehouse: TRANSFORMING
[0m22:38:25.095070 [info ] [MainThread]:   role: DBT_EXECUTOR_ROLE
[0m22:38:25.095766 [info ] [MainThread]:   schema: JAFFLE_SHOP
[0m22:38:25.096302 [info ] [MainThread]:   authenticator: None
[0m22:38:25.096891 [info ] [MainThread]:   private_key_path: None
[0m22:38:25.097349 [info ] [MainThread]:   oauth_client_id: None
[0m22:38:25.097801 [info ] [MainThread]:   query_tag: None
[0m22:38:25.098357 [info ] [MainThread]:   client_session_keep_alive: False
[0m22:38:25.098983 [info ] [MainThread]:   host: None
[0m22:38:25.099483 [info ] [MainThread]:   port: None
[0m22:38:25.100055 [info ] [MainThread]:   proxy_host: None
[0m22:38:25.100860 [info ] [MainThread]:   proxy_port: None
[0m22:38:25.101379 [info ] [MainThread]:   protocol: None
[0m22:38:25.101831 [info ] [MainThread]:   connect_retries: 1
[0m22:38:25.102630 [info ] [MainThread]:   connect_timeout: None
[0m22:38:25.103145 [info ] [MainThread]:   retry_on_database_errors: False
[0m22:38:25.103610 [info ] [MainThread]:   retry_all: False
[0m22:38:25.104054 [info ] [MainThread]:   insecure_mode: False
[0m22:38:25.104496 [info ] [MainThread]:   reuse_connections: None
[0m22:38:25.106315 [info ] [MainThread]: Registered adapter: snowflake=1.7.2
[0m22:38:25.116452 [debug] [MainThread]: Acquiring new snowflake connection 'debug'
[0m22:38:25.119110 [debug] [MainThread]: Using snowflake connection "debug"
[0m22:38:25.119708 [debug] [MainThread]: On debug: select 1 as id
[0m22:38:25.120206 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:38:27.178585 [debug] [MainThread]: SQL status: SUCCESS 1 in 2.0 seconds
[0m22:38:27.181982 [debug] [MainThread]: On debug: Close
[0m22:38:27.308063 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m22:38:27.309339 [info ] [MainThread]: [32mAll checks passed![0m
[0m22:38:27.313244 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 2.9447412, "process_user_time": 3.876774, "process_kernel_time": 0.427804, "process_mem_max_rss": "131710976", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m22:38:27.314525 [debug] [MainThread]: Command `dbt debug` succeeded at 22:38:27.314233 after 2.95 seconds
[0m22:38:27.315261 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m22:38:27.316007 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bc5ead0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10be54910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107eb9e10>]}
[0m22:38:27.316845 [debug] [MainThread]: Flushing usage events
[0m22:39:33.987102 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105373490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105399890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10538a610>]}


============================== 22:39:33.992963 | 99e5ad7a-01af-4e43-a3e1-a51cb61b9672 ==============================
[0m22:39:33.992963 [info ] [MainThread]: Running with dbt=1.7.8
[0m22:39:33.994087 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/ben/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/Users/ben/jaffle_shop/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m22:39:34.546866 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '99e5ad7a-01af-4e43-a3e1-a51cb61b9672', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105398510>]}
[0m22:39:34.677004 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '99e5ad7a-01af-4e43-a3e1-a51cb61b9672', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063e7e50>]}
[0m22:39:34.678221 [info ] [MainThread]: Registered adapter: snowflake=1.7.2
[0m22:39:34.701831 [debug] [MainThread]: checksum: 67f0013ca5f0bd43af9a0873dd50792fde83ef69de63b71cacd0b4ac656c52e5, vars: {}, profile: , target: , version: 1.7.8
[0m22:39:34.703125 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m22:39:34.703796 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '99e5ad7a-01af-4e43-a3e1-a51cb61b9672', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10634b150>]}
[0m22:39:36.234745 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '99e5ad7a-01af-4e43-a3e1-a51cb61b9672', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106479510>]}
[0m22:39:36.249290 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '99e5ad7a-01af-4e43-a3e1-a51cb61b9672', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067e43d0>]}
[0m22:39:36.250067 [info ] [MainThread]: Found 2 models, 4 tests, 0 sources, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m22:39:36.250652 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '99e5ad7a-01af-4e43-a3e1-a51cb61b9672', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106459050>]}
[0m22:39:36.253099 [info ] [MainThread]: 
[0m22:39:36.254398 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m22:39:36.256147 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ANALYTICS'
[0m22:39:36.275771 [debug] [ThreadPool]: Using snowflake connection "list_ANALYTICS"
[0m22:39:36.276447 [debug] [ThreadPool]: On list_ANALYTICS: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_ANALYTICS"} */
show terse schemas in database ANALYTICS
    limit 10000
[0m22:39:36.276962 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:39:37.014307 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01b299bb-0000-154d-0000-000bfc03b0ed
[0m22:39:37.015273 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m22:39:37.016166 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_schemas
[0m22:39:37.016794 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m22:39:37.017599 [debug] [ThreadPool]: On list_ANALYTICS: Close
[0m22:39:37.145481 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:39:37.146395 [debug] [MainThread]: Connection 'list_ANALYTICS' was properly closed.
[0m22:39:37.147190 [info ] [MainThread]: 
[0m22:39:37.148322 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.89 seconds (0.89s).
[0m22:39:37.149659 [error] [MainThread]: Encountered an error:
Runtime Error
  Database error while listing schemas in database "ANALYTICS"
  Database Error
    002043 (02000): SQL compilation error:
    Object does not exist, or operation cannot be performed.
[0m22:39:37.152057 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 3.2444746, "process_user_time": 5.07756, "process_kernel_time": 0.36548, "process_mem_max_rss": "137179136", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m22:39:37.153184 [debug] [MainThread]: Command `dbt run` failed at 22:39:37.152910 after 3.25 seconds
[0m22:39:37.154173 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105998890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1065491d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1016bc990>]}
[0m22:39:37.155007 [debug] [MainThread]: Flushing usage events
[0m22:42:33.120444 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10590ccd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105bca5d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105eb8fd0>]}


============================== 22:42:33.127342 | b9f10611-bb5d-4e06-aea0-b0be22fb7665 ==============================
[0m22:42:33.127342 [info ] [MainThread]: Running with dbt=1.7.8
[0m22:42:33.128377 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/ben/jaffle_shop/logs', 'profiles_dir': '/Users/ben/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m22:42:33.671319 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b9f10611-bb5d-4e06-aea0-b0be22fb7665', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f1e850>]}
[0m22:42:33.802100 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b9f10611-bb5d-4e06-aea0-b0be22fb7665', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1065c1910>]}
[0m22:42:33.803340 [info ] [MainThread]: Registered adapter: snowflake=1.7.2
[0m22:42:33.826994 [debug] [MainThread]: checksum: 67f0013ca5f0bd43af9a0873dd50792fde83ef69de63b71cacd0b4ac656c52e5, vars: {}, profile: , target: , version: 1.7.8
[0m22:42:33.842964 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m22:42:33.844075 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'b9f10611-bb5d-4e06-aea0-b0be22fb7665', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105edd4d0>]}
[0m22:42:35.098312 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'experimental_parser', 'label': 'b9f10611-bb5d-4e06-aea0-b0be22fb7665', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10698b990>]}
[0m22:42:35.366654 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b9f10611-bb5d-4e06-aea0-b0be22fb7665', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b94e10>]}
[0m22:42:35.381616 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b9f10611-bb5d-4e06-aea0-b0be22fb7665', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d6aed0>]}
[0m22:42:35.382391 [info ] [MainThread]: Found 2 models, 4 tests, 0 sources, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m22:42:35.382960 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b9f10611-bb5d-4e06-aea0-b0be22fb7665', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ca3ed0>]}
[0m22:42:35.385962 [info ] [MainThread]: 
[0m22:42:35.387489 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m22:42:35.389139 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ANALYTICS'
[0m22:42:35.408486 [debug] [ThreadPool]: Using snowflake connection "list_ANALYTICS"
[0m22:42:35.409133 [debug] [ThreadPool]: On list_ANALYTICS: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_ANALYTICS"} */
show terse schemas in database ANALYTICS
    limit 10000
[0m22:42:35.409627 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:42:36.112647 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01b299be-0000-154c-0000-000bfc03c125
[0m22:42:36.113643 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m22:42:36.114745 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_schemas
[0m22:42:36.115767 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m22:42:36.116776 [debug] [ThreadPool]: On list_ANALYTICS: Close
[0m22:42:36.238562 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:42:36.239696 [debug] [MainThread]: Connection 'list_ANALYTICS' was properly closed.
[0m22:42:36.240498 [info ] [MainThread]: 
[0m22:42:36.241357 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.85 seconds (0.85s).
[0m22:42:36.242467 [error] [MainThread]: Encountered an error:
Runtime Error
  Database error while listing schemas in database "ANALYTICS"
  Database Error
    002043 (02000): SQL compilation error:
    Object does not exist, or operation cannot be performed.
[0m22:42:36.245173 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 3.208129, "process_user_time": 5.084645, "process_kernel_time": 0.357282, "process_mem_max_rss": "136536064", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m22:42:36.246422 [debug] [MainThread]: Command `dbt run` failed at 22:42:36.246147 after 3.21 seconds
[0m22:42:36.247268 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105b59150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ea1710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x101c50e90>]}
[0m22:42:36.248027 [debug] [MainThread]: Flushing usage events
[0m22:43:18.198057 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e3a6d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ae4c90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e4fa50>]}


============================== 22:43:18.203966 | f0e81add-e0d7-40d1-9534-ff3200a850b8 ==============================
[0m22:43:18.203966 [info ] [MainThread]: Running with dbt=1.7.8
[0m22:43:18.205272 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/ben/jaffle_shop/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/ben/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m22:43:18.502104 [error] [MainThread]: Encountered an error:
Runtime Error
  Credentials in profile "jaffle_shop", target "dev" invalid: None is not of type 'string'
[0m22:43:18.504411 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.38884836, "process_user_time": 3.108076, "process_kernel_time": 0.283099, "process_mem_max_rss": "119881728", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m22:43:18.505379 [debug] [MainThread]: Command `dbt run` failed at 22:43:18.505149 after 0.39 seconds
[0m22:43:18.506005 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1058a2e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e42d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066e3450>]}
[0m22:43:18.506623 [debug] [MainThread]: Flushing usage events
[0m22:43:53.929975 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1124b92d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112a7db50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112a3a7d0>]}


============================== 22:43:53.935976 | 3fa156a9-99ba-469a-ab6c-0403d90d1cc4 ==============================
[0m22:43:53.935976 [info ] [MainThread]: Running with dbt=1.7.8
[0m22:43:53.936877 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/ben/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/ben/jaffle_shop/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:43:54.618806 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3fa156a9-99ba-469a-ab6c-0403d90d1cc4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112a91610>]}
[0m22:43:54.753734 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3fa156a9-99ba-469a-ab6c-0403d90d1cc4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112c219d0>]}
[0m22:43:54.754896 [info ] [MainThread]: Registered adapter: snowflake=1.7.2
[0m22:43:54.779903 [debug] [MainThread]: checksum: 67f0013ca5f0bd43af9a0873dd50792fde83ef69de63b71cacd0b4ac656c52e5, vars: {}, profile: , target: , version: 1.7.8
[0m22:43:54.797843 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m22:43:54.798791 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '3fa156a9-99ba-469a-ab6c-0403d90d1cc4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1135ec110>]}
[0m22:43:56.358922 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3fa156a9-99ba-469a-ab6c-0403d90d1cc4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1134c8890>]}
[0m22:43:56.373630 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3fa156a9-99ba-469a-ab6c-0403d90d1cc4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1138c81d0>]}
[0m22:43:56.374375 [info ] [MainThread]: Found 2 models, 4 tests, 0 sources, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m22:43:56.374942 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3fa156a9-99ba-469a-ab6c-0403d90d1cc4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113545690>]}
[0m22:43:56.377358 [info ] [MainThread]: 
[0m22:43:56.378556 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m22:43:56.380188 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ANALYTICS'
[0m22:43:56.400053 [debug] [ThreadPool]: Using snowflake connection "list_ANALYTICS"
[0m22:43:56.400692 [debug] [ThreadPool]: On list_ANALYTICS: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_ANALYTICS"} */
show terse schemas in database ANALYTICS
    limit 10000
[0m22:43:56.401192 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:43:57.053639 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01b299bf-0000-154c-0000-000bfc03c129
[0m22:43:57.054604 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m22:43:57.055666 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_schemas
[0m22:43:57.056430 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m22:43:57.057433 [debug] [ThreadPool]: On list_ANALYTICS: Close
[0m22:43:57.183553 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:43:57.184707 [debug] [MainThread]: Connection 'list_ANALYTICS' was properly closed.
[0m22:43:57.185710 [info ] [MainThread]: 
[0m22:43:57.186651 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.81 seconds (0.81s).
[0m22:43:57.188326 [error] [MainThread]: Encountered an error:
Runtime Error
  Database error while listing schemas in database "ANALYTICS"
  Database Error
    002043 (02000): SQL compilation error:
    Object does not exist, or operation cannot be performed.
[0m22:43:57.191420 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 3.3437428, "process_user_time": 5.15804, "process_kernel_time": 0.37907, "process_mem_max_rss": "137297920", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m22:43:57.192751 [debug] [MainThread]: Command `dbt run` failed at 22:43:57.192459 after 3.35 seconds
[0m22:43:57.193562 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112768b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112a442d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1127ba610>]}
[0m22:43:57.194329 [debug] [MainThread]: Flushing usage events
[0m21:49:03.343241 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110fb3bd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110ff1ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110ff0e90>]}


============================== 21:49:03.351993 | b2322d56-1610-41b0-a4bc-5a6f0a5f77a4 ==============================
[0m21:49:03.351993 [info ] [MainThread]: Running with dbt=1.7.8
[0m21:49:03.353155 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/Users/ben/.dbt', 'log_path': '/Users/ben/jaffle_shop/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt debug', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m21:49:03.354152 [info ] [MainThread]: dbt version: 1.7.8
[0m21:49:03.354752 [info ] [MainThread]: python version: 3.11.0
[0m21:49:03.355319 [info ] [MainThread]: python path: /Users/ben/dbt-env/bin/python
[0m21:49:03.355884 [info ] [MainThread]: os info: macOS-14.3.1-x86_64-i386-64bit
[0m21:49:03.926628 [info ] [MainThread]: Using profiles dir at /Users/ben/.dbt
[0m21:49:03.927485 [info ] [MainThread]: Using profiles.yml file at /Users/ben/.dbt/profiles.yml
[0m21:49:03.928086 [info ] [MainThread]: Using dbt_project.yml file at /Users/ben/jaffle_shop/dbt_project.yml
[0m21:49:03.929705 [info ] [MainThread]: adapter type: snowflake
[0m21:49:03.930347 [info ] [MainThread]: adapter version: 1.7.2
[0m21:49:04.109414 [info ] [MainThread]: Configuration:
[0m21:49:04.110115 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m21:49:04.110641 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m21:49:04.111133 [info ] [MainThread]: Required dependencies:
[0m21:49:04.112033 [debug] [MainThread]: Executing "git --help"
[0m21:49:04.145460 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m21:49:04.146792 [debug] [MainThread]: STDERR: "b''"
[0m21:49:04.147423 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m21:49:04.147986 [info ] [MainThread]: Connection:
[0m21:49:04.148593 [info ] [MainThread]:   account: eta20809.east-us-2.azure
[0m21:49:04.149085 [info ] [MainThread]:   user: DBT_EXECUTOR
[0m21:49:04.149570 [info ] [MainThread]:   database: ANALYTICS
[0m21:49:04.150039 [info ] [MainThread]:   warehouse: TRANSFORMING
[0m21:49:04.150522 [info ] [MainThread]:   role: DBT_EXECUTOR_ROLE
[0m21:49:04.150980 [info ] [MainThread]:   schema: PUBLIC
[0m21:49:04.151679 [info ] [MainThread]:   authenticator: None
[0m21:49:04.152857 [info ] [MainThread]:   private_key_path: None
[0m21:49:04.153769 [info ] [MainThread]:   oauth_client_id: None
[0m21:49:04.154705 [info ] [MainThread]:   query_tag: None
[0m21:49:04.155428 [info ] [MainThread]:   client_session_keep_alive: False
[0m21:49:04.155970 [info ] [MainThread]:   host: None
[0m21:49:04.156520 [info ] [MainThread]:   port: None
[0m21:49:04.157156 [info ] [MainThread]:   proxy_host: None
[0m21:49:04.157695 [info ] [MainThread]:   proxy_port: None
[0m21:49:04.158396 [info ] [MainThread]:   protocol: None
[0m21:49:04.158911 [info ] [MainThread]:   connect_retries: 1
[0m21:49:04.159389 [info ] [MainThread]:   connect_timeout: None
[0m21:49:04.159873 [info ] [MainThread]:   retry_on_database_errors: False
[0m21:49:04.160444 [info ] [MainThread]:   retry_all: False
[0m21:49:04.161044 [info ] [MainThread]:   insecure_mode: False
[0m21:49:04.162036 [info ] [MainThread]:   reuse_connections: None
[0m21:49:04.163105 [info ] [MainThread]: Registered adapter: snowflake=1.7.2
[0m21:49:04.192796 [debug] [MainThread]: Acquiring new snowflake connection 'debug'
[0m21:49:04.196261 [debug] [MainThread]: Using snowflake connection "debug"
[0m21:49:04.197074 [debug] [MainThread]: On debug: select 1 as id
[0m21:49:04.197659 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:49:05.289775 [debug] [MainThread]: SQL status: SUCCESS 1 in 1.0 seconds
[0m21:49:05.293613 [debug] [MainThread]: On debug: Close
[0m21:49:05.456438 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m21:49:05.457879 [info ] [MainThread]: [32mAll checks passed![0m
[0m21:49:05.483050 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 2.222721, "process_user_time": 3.5875, "process_kernel_time": 0.579359, "process_mem_max_rss": "125968384", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m21:49:05.484102 [debug] [MainThread]: Command `dbt debug` succeeded at 21:49:05.483872 after 2.22 seconds
[0m21:49:05.484719 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m21:49:05.485360 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110cecad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cd4bd50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cd50bd0>]}
[0m21:49:05.486186 [debug] [MainThread]: Flushing usage events
[0m21:49:12.371851 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c8f510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10462bed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c50fd0>]}


============================== 21:49:12.377958 | 555b58e5-ae92-4ac0-acbc-cc20e8c951e1 ==============================
[0m21:49:12.377958 [info ] [MainThread]: Running with dbt=1.7.8
[0m21:49:12.378913 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/ben/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/Users/ben/jaffle_shop/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m21:49:12.941803 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '555b58e5-ae92-4ac0-acbc-cc20e8c951e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1046e6490>]}
[0m21:49:13.072328 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '555b58e5-ae92-4ac0-acbc-cc20e8c951e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1050db2d0>]}
[0m21:49:13.073614 [info ] [MainThread]: Registered adapter: snowflake=1.7.2
[0m21:49:13.141773 [debug] [MainThread]: checksum: 67f0013ca5f0bd43af9a0873dd50792fde83ef69de63b71cacd0b4ac656c52e5, vars: {}, profile: , target: , version: 1.7.8
[0m21:49:13.262077 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:49:13.262759 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:49:13.271903 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '555b58e5-ae92-4ac0-acbc-cc20e8c951e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1055f0350>]}
[0m21:49:13.288398 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '555b58e5-ae92-4ac0-acbc-cc20e8c951e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105672d90>]}
[0m21:49:13.289169 [info ] [MainThread]: Found 2 models, 4 tests, 0 sources, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m21:49:13.289826 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '555b58e5-ae92-4ac0-acbc-cc20e8c951e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105627f10>]}
[0m21:49:13.293139 [info ] [MainThread]: 
[0m21:49:13.294576 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m21:49:13.296661 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ANALYTICS'
[0m21:49:13.320242 [debug] [ThreadPool]: Using snowflake connection "list_ANALYTICS"
[0m21:49:13.320949 [debug] [ThreadPool]: On list_ANALYTICS: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_ANALYTICS"} */
show terse schemas in database ANALYTICS
    limit 10000
[0m21:49:13.321475 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:49:14.015590 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01b29f29-0000-15b8-0000-000bfc03d01d
[0m21:49:14.016261 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m21:49:14.016996 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_schemas
[0m21:49:14.017573 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m21:49:14.018388 [debug] [ThreadPool]: On list_ANALYTICS: Close
[0m21:49:14.144192 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:49:14.144837 [debug] [MainThread]: Connection 'list_ANALYTICS' was properly closed.
[0m21:49:14.145390 [info ] [MainThread]: 
[0m21:49:14.146198 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.85 seconds (0.85s).
[0m21:49:14.147272 [error] [MainThread]: Encountered an error:
Runtime Error
  Database error while listing schemas in database "ANALYTICS"
  Database Error
    002043 (02000): SQL compilation error:
    Object does not exist, or operation cannot be performed.
[0m21:49:14.149163 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 1.8596473, "process_user_time": 3.643542, "process_kernel_time": 0.360445, "process_mem_max_rss": "130658304", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m21:49:14.150076 [debug] [MainThread]: Command `dbt run` failed at 21:49:14.149855 after 1.86 seconds
[0m21:49:14.150728 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c8c190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c9e8d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1046b5a50>]}
[0m21:49:14.151511 [debug] [MainThread]: Flushing usage events
[0m21:55:53.736295 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109a9ced0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10945d690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10945e590>]}


============================== 21:55:53.742084 | 70bfacda-01c4-4aa6-abdc-fe743bbf5a77 ==============================
[0m21:55:53.742084 [info ] [MainThread]: Running with dbt=1.7.8
[0m21:55:53.743017 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/ben/jaffle_shop/logs', 'profiles_dir': '/Users/ben/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m21:55:54.285750 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '70bfacda-01c4-4aa6-abdc-fe743bbf5a77', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a41cc10>]}
[0m21:55:54.415104 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '70bfacda-01c4-4aa6-abdc-fe743bbf5a77', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a443c90>]}
[0m21:55:54.416603 [info ] [MainThread]: Registered adapter: snowflake=1.7.2
[0m21:55:54.442044 [debug] [MainThread]: checksum: 67f0013ca5f0bd43af9a0873dd50792fde83ef69de63b71cacd0b4ac656c52e5, vars: {}, profile: , target: , version: 1.7.8
[0m21:55:54.458343 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m21:55:54.459221 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '70bfacda-01c4-4aa6-abdc-fe743bbf5a77', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a4c5b50>]}
[0m21:55:56.106929 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '70bfacda-01c4-4aa6-abdc-fe743bbf5a77', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a4e6190>]}
[0m21:55:56.122297 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '70bfacda-01c4-4aa6-abdc-fe743bbf5a77', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a916990>]}
[0m21:55:56.123077 [info ] [MainThread]: Found 2 models, 4 tests, 0 sources, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m21:55:56.123673 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '70bfacda-01c4-4aa6-abdc-fe743bbf5a77', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a66ff50>]}
[0m21:55:56.126064 [info ] [MainThread]: 
[0m21:55:56.127363 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m21:55:56.128995 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RAW'
[0m21:55:56.152101 [debug] [ThreadPool]: Using snowflake connection "list_RAW"
[0m21:55:56.153334 [debug] [ThreadPool]: On list_RAW: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_RAW"} */
show terse schemas in database RAW
    limit 10000
[0m21:55:56.154319 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:55:56.959455 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01b29f2f-0000-15b8-0000-000bfc03d095
[0m21:55:56.960474 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m21:55:56.961668 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_schemas
[0m21:55:56.962345 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m21:55:56.963193 [debug] [ThreadPool]: On list_RAW: Close
[0m21:55:57.104524 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:55:57.105377 [debug] [MainThread]: Connection 'list_RAW' was properly closed.
[0m21:55:57.105958 [info ] [MainThread]: 
[0m21:55:57.124098 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.98 seconds (0.98s).
[0m21:55:57.125333 [error] [MainThread]: Encountered an error:
Runtime Error
  Database error while listing schemas in database "RAW"
  Database Error
    002043 (02000): SQL compilation error:
    Object does not exist, or operation cannot be performed.
[0m21:55:57.127192 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 3.4734235, "process_user_time": 5.151867, "process_kernel_time": 0.392785, "process_mem_max_rss": "134979584", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m21:55:57.128068 [debug] [MainThread]: Command `dbt run` failed at 21:55:57.127854 after 3.47 seconds
[0m21:55:57.128716 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109438ad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10973c790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109447950>]}
[0m21:55:57.129320 [debug] [MainThread]: Flushing usage events
[0m22:02:17.458137 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1062cc950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1062dfe10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10659af50>]}


============================== 22:02:17.463970 | c1715b79-caf7-4c2f-a123-ec3362f04e98 ==============================
[0m22:02:17.463970 [info ] [MainThread]: Running with dbt=1.7.8
[0m22:02:17.464914 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/ben/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/ben/jaffle_shop/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m22:02:17.982546 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c1715b79-caf7-4c2f-a123-ec3362f04e98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1072bcad0>]}
[0m22:02:18.106760 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c1715b79-caf7-4c2f-a123-ec3362f04e98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106945d10>]}
[0m22:02:18.107997 [info ] [MainThread]: Registered adapter: snowflake=1.7.2
[0m22:02:18.129567 [debug] [MainThread]: checksum: 67f0013ca5f0bd43af9a0873dd50792fde83ef69de63b71cacd0b4ac656c52e5, vars: {}, profile: , target: , version: 1.7.8
[0m22:02:18.144045 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m22:02:18.145061 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'c1715b79-caf7-4c2f-a123-ec3362f04e98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1073a9610>]}
[0m22:02:19.610320 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c1715b79-caf7-4c2f-a123-ec3362f04e98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1075e4210>]}
[0m22:02:19.624243 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c1715b79-caf7-4c2f-a123-ec3362f04e98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1076eb010>]}
[0m22:02:19.625018 [info ] [MainThread]: Found 2 models, 4 tests, 0 sources, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m22:02:19.625616 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c1715b79-caf7-4c2f-a123-ec3362f04e98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107684e90>]}
[0m22:02:19.628031 [info ] [MainThread]: 
[0m22:02:19.629294 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m22:02:19.630896 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RAW'
[0m22:02:19.653611 [debug] [ThreadPool]: Using snowflake connection "list_RAW"
[0m22:02:19.654781 [debug] [ThreadPool]: On list_RAW: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_RAW"} */
show terse schemas in database RAW
    limit 10000
[0m22:02:19.655508 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:02:20.438193 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01b29f36-0000-15b8-0000-000bfc03d0c5
[0m22:02:20.438909 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m22:02:20.439867 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_schemas
[0m22:02:20.440610 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m22:02:20.441542 [debug] [ThreadPool]: On list_RAW: Close
[0m22:02:20.565811 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:02:20.566985 [debug] [MainThread]: Connection 'list_RAW' was properly closed.
[0m22:02:20.567740 [info ] [MainThread]: 
[0m22:02:20.568522 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.94 seconds (0.94s).
[0m22:02:20.569508 [error] [MainThread]: Encountered an error:
Runtime Error
  Database error while listing schemas in database "RAW"
  Database Error
    002043 (02000): SQL compilation error:
    Object does not exist, or operation cannot be performed.
[0m22:02:20.572075 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 3.189392, "process_user_time": 4.890177, "process_kernel_time": 0.316704, "process_mem_max_rss": "135041024", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m22:02:20.573358 [debug] [MainThread]: Command `dbt run` failed at 22:02:20.573076 after 3.19 seconds
[0m22:02:20.574349 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106922fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1068f5d50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1025bfd90>]}
[0m22:02:20.575421 [debug] [MainThread]: Flushing usage events
[0m22:06:09.557035 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d620990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10de54c90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10de3a6d0>]}


============================== 22:06:09.562832 | 9d45fc88-eb40-46ee-a248-952305d9710c ==============================
[0m22:06:09.562832 [info ] [MainThread]: Running with dbt=1.7.8
[0m22:06:09.564063 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/ben/jaffle_shop/logs', 'debug': 'False', 'profiles_dir': '/Users/ben/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m22:06:10.085940 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9d45fc88-eb40-46ee-a248-952305d9710c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10de381d0>]}
[0m22:06:10.210378 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9d45fc88-eb40-46ee-a248-952305d9710c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dc114d0>]}
[0m22:06:10.211622 [info ] [MainThread]: Registered adapter: snowflake=1.7.2
[0m22:06:10.236523 [debug] [MainThread]: checksum: 67f0013ca5f0bd43af9a0873dd50792fde83ef69de63b71cacd0b4ac656c52e5, vars: {}, profile: , target: , version: 1.7.8
[0m22:06:10.253928 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m22:06:10.254760 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '9d45fc88-eb40-46ee-a248-952305d9710c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ebf0bd0>]}
[0m22:06:11.737434 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9d45fc88-eb40-46ee-a248-952305d9710c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ecc4050>]}
[0m22:06:11.752251 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9d45fc88-eb40-46ee-a248-952305d9710c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10efdab50>]}
[0m22:06:11.753041 [info ] [MainThread]: Found 2 models, 4 tests, 0 sources, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m22:06:11.753654 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9d45fc88-eb40-46ee-a248-952305d9710c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10eca3910>]}
[0m22:06:11.756085 [info ] [MainThread]: 
[0m22:06:11.757407 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m22:06:11.759149 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RAW'
[0m22:06:11.779874 [debug] [ThreadPool]: Using snowflake connection "list_RAW"
[0m22:06:11.780704 [debug] [ThreadPool]: On list_RAW: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_RAW"} */
show terse schemas in database RAW
    limit 10000
[0m22:06:11.781516 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:06:12.939710 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01b29f3a-0000-15b8-0000-000bfc03d0e5
[0m22:06:12.940711 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m22:06:12.941856 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_schemas
[0m22:06:12.942686 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m22:06:12.943953 [debug] [ThreadPool]: On list_RAW: Close
[0m22:06:13.073349 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:06:13.074361 [debug] [MainThread]: Connection 'list_RAW' was properly closed.
[0m22:06:13.075214 [info ] [MainThread]: 
[0m22:06:13.076157 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 1.32 seconds (1.32s).
[0m22:06:13.077340 [error] [MainThread]: Encountered an error:
Runtime Error
  Database error while listing schemas in database "RAW"
  Database Error
    002043 (02000): SQL compilation error:
    Object does not exist, or operation cannot be performed.
[0m22:06:13.080043 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 3.6021152, "process_user_time": 4.979157, "process_kernel_time": 0.334561, "process_mem_max_rss": "136814592", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m22:06:13.081394 [debug] [MainThread]: Command `dbt run` failed at 22:06:13.080985 after 3.60 seconds
[0m22:06:13.082649 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10db78050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10df1e310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ef916d0>]}
[0m22:06:13.083622 [debug] [MainThread]: Flushing usage events
[0m22:24:46.537761 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10470b8d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104471f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104a82950>]}


============================== 22:24:46.543705 | 6b0d59e9-e398-456f-95ab-386bf6e13ad2 ==============================
[0m22:24:46.543705 [info ] [MainThread]: Running with dbt=1.7.8
[0m22:24:46.544636 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/ben/jaffle_shop/logs', 'debug': 'False', 'profiles_dir': '/Users/ben/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt debug', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m22:24:46.545537 [info ] [MainThread]: dbt version: 1.7.8
[0m22:24:46.546116 [info ] [MainThread]: python version: 3.11.0
[0m22:24:46.546674 [info ] [MainThread]: python path: /Users/ben/dbt-env/bin/python
[0m22:24:46.547180 [info ] [MainThread]: os info: macOS-14.3.1-x86_64-i386-64bit
[0m22:24:46.882378 [info ] [MainThread]: Using profiles dir at /Users/ben/.dbt
[0m22:24:46.883185 [info ] [MainThread]: Using profiles.yml file at /Users/ben/.dbt/profiles.yml
[0m22:24:46.883735 [info ] [MainThread]: Using dbt_project.yml file at /Users/ben/jaffle_shop/dbt_project.yml
[0m22:24:46.884537 [info ] [MainThread]: adapter type: snowflake
[0m22:24:46.885035 [info ] [MainThread]: adapter version: 1.7.2
[0m22:24:47.058592 [info ] [MainThread]: Configuration:
[0m22:24:47.059451 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m22:24:47.060058 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m22:24:47.060572 [info ] [MainThread]: Required dependencies:
[0m22:24:47.061141 [debug] [MainThread]: Executing "git --help"
[0m22:24:47.092077 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m22:24:47.093858 [debug] [MainThread]: STDERR: "b''"
[0m22:24:47.094631 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m22:24:47.095208 [info ] [MainThread]: Connection:
[0m22:24:47.095811 [info ] [MainThread]:   account: eta20809.east-us-2.azure
[0m22:24:47.096310 [info ] [MainThread]:   user: DBT_EXECUTOR
[0m22:24:47.096788 [info ] [MainThread]:   database: RAW
[0m22:24:47.097258 [info ] [MainThread]:   warehouse: TRANSFORMING
[0m22:24:47.097722 [info ] [MainThread]:   role: DBT_EXECUTOR_ROLE
[0m22:24:47.098183 [info ] [MainThread]:   schema: JAFFLE_SHOP
[0m22:24:47.098648 [info ] [MainThread]:   authenticator: None
[0m22:24:47.099114 [info ] [MainThread]:   private_key_path: None
[0m22:24:47.099572 [info ] [MainThread]:   oauth_client_id: None
[0m22:24:47.100036 [info ] [MainThread]:   query_tag: None
[0m22:24:47.100574 [info ] [MainThread]:   client_session_keep_alive: False
[0m22:24:47.101048 [info ] [MainThread]:   host: None
[0m22:24:47.101521 [info ] [MainThread]:   port: None
[0m22:24:47.101981 [info ] [MainThread]:   proxy_host: None
[0m22:24:47.102448 [info ] [MainThread]:   proxy_port: None
[0m22:24:47.102910 [info ] [MainThread]:   protocol: None
[0m22:24:47.103365 [info ] [MainThread]:   connect_retries: 1
[0m22:24:47.103822 [info ] [MainThread]:   connect_timeout: None
[0m22:24:47.104281 [info ] [MainThread]:   retry_on_database_errors: False
[0m22:24:47.104734 [info ] [MainThread]:   retry_all: False
[0m22:24:47.105193 [info ] [MainThread]:   insecure_mode: False
[0m22:24:47.105698 [info ] [MainThread]:   reuse_connections: None
[0m22:24:47.106477 [info ] [MainThread]: Registered adapter: snowflake=1.7.2
[0m22:24:47.116685 [debug] [MainThread]: Acquiring new snowflake connection 'debug'
[0m22:24:47.119035 [debug] [MainThread]: Using snowflake connection "debug"
[0m22:24:47.119609 [debug] [MainThread]: On debug: select 1 as id
[0m22:24:47.120195 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:24:47.880436 [debug] [MainThread]: Snowflake adapter: Error running SQL: select 1 as id
[0m22:24:47.881595 [debug] [MainThread]: Snowflake adapter: Rolling back transaction.
[0m22:24:47.882493 [debug] [MainThread]: On debug: No close available on handle
[0m22:24:47.883410 [info ] [MainThread]:   Connection test: [[31mERROR[0m]

[0m22:24:47.884289 [info ] [MainThread]: [31m1 check failed:[0m
[0m22:24:47.885163 [info ] [MainThread]: dbt was unable to connect to the specified database.
The database returned the following error:

  >Database Error
  250001 (08001): Failed to connect to DB: eta20809.east-us-2.azure.snowflakecomputing.com:443. Incorrect username or password was specified.

Check your database credentials and try again. For more information, visit:
https://docs.getdbt.com/docs/configure-your-profile


[0m22:24:47.887933 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_wall_clock_time": 1.4281068, "process_user_time": 3.315565, "process_kernel_time": 0.306811, "process_mem_max_rss": "126730240", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m22:24:47.889130 [debug] [MainThread]: Command `dbt debug` failed at 22:24:47.888837 after 1.43 seconds
[0m22:24:47.890084 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m22:24:47.891309 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104aa0910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1047b53d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1053a3310>]}
[0m22:24:47.892369 [debug] [MainThread]: Flushing usage events
[0m22:26:49.301203 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fe51490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fe5f150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fe5e310>]}


============================== 22:26:49.307053 | f23f452b-a622-414d-bc07-962416cce55a ==============================
[0m22:26:49.307053 [info ] [MainThread]: Running with dbt=1.7.8
[0m22:26:49.308147 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/ben/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/Users/ben/jaffle_shop/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m22:26:49.827663 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f23f452b-a622-414d-bc07-962416cce55a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110e1e0d0>]}
[0m22:26:49.949982 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f23f452b-a622-414d-bc07-962416cce55a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1105a2d50>]}
[0m22:26:49.951237 [info ] [MainThread]: Registered adapter: snowflake=1.7.2
[0m22:26:49.974981 [debug] [MainThread]: checksum: 67f0013ca5f0bd43af9a0873dd50792fde83ef69de63b71cacd0b4ac656c52e5, vars: {}, profile: , target: , version: 1.7.8
[0m22:26:49.991150 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m22:26:49.992388 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'f23f452b-a622-414d-bc07-962416cce55a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110d95110>]}
[0m22:26:51.478557 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f23f452b-a622-414d-bc07-962416cce55a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110f0dad0>]}
[0m22:26:51.493274 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f23f452b-a622-414d-bc07-962416cce55a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111150110>]}
[0m22:26:51.494068 [info ] [MainThread]: Found 2 models, 4 tests, 0 sources, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m22:26:51.494683 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f23f452b-a622-414d-bc07-962416cce55a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111323810>]}
[0m22:26:51.497163 [info ] [MainThread]: 
[0m22:26:51.498427 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m22:26:51.500093 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RAW'
[0m22:26:51.521895 [debug] [ThreadPool]: Using snowflake connection "list_RAW"
[0m22:26:51.522639 [debug] [ThreadPool]: On list_RAW: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_RAW"} */
show terse schemas in database RAW
    limit 10000
[0m22:26:51.523238 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:26:52.568718 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01b29f4e-0000-15b8-0000-000bfc03d235
[0m22:26:52.569744 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m22:26:52.570923 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_schemas
[0m22:26:52.571778 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m22:26:52.572823 [debug] [ThreadPool]: On list_RAW: Close
[0m22:26:52.737527 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:26:52.738684 [debug] [MainThread]: Connection 'list_RAW' was properly closed.
[0m22:26:52.739557 [info ] [MainThread]: 
[0m22:26:52.740564 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 1.24 seconds (1.24s).
[0m22:26:52.741943 [error] [MainThread]: Encountered an error:
Runtime Error
  Database error while listing schemas in database "RAW"
  Database Error
    002043 (02000): SQL compilation error:
    Object does not exist, or operation cannot be performed.
[0m22:26:52.744723 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 3.5200431, "process_user_time": 4.941399, "process_kernel_time": 0.318157, "process_mem_max_rss": "135159808", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m22:26:52.745910 [debug] [MainThread]: Command `dbt run` failed at 22:26:52.745619 after 3.52 seconds
[0m22:26:52.746773 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ff14b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1104a0410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fe5f8d0>]}
[0m22:26:52.747905 [debug] [MainThread]: Flushing usage events
[0m22:38:05.667475 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cbe2210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cbf39d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108f53690>]}


============================== 22:38:05.673797 | 96097220-8a04-4e89-8853-7195ad450083 ==============================
[0m22:38:05.673797 [info ] [MainThread]: Running with dbt=1.7.8
[0m22:38:05.674839 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/ben/jaffle_shop/logs', 'version_check': 'True', 'profiles_dir': '/Users/ben/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m22:38:06.229472 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '96097220-8a04-4e89-8853-7195ad450083', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dbd3010>]}
[0m22:38:06.361845 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '96097220-8a04-4e89-8853-7195ad450083', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d263010>]}
[0m22:38:06.363105 [info ] [MainThread]: Registered adapter: snowflake=1.7.2
[0m22:38:06.389633 [debug] [MainThread]: checksum: 67f0013ca5f0bd43af9a0873dd50792fde83ef69de63b71cacd0b4ac656c52e5, vars: {}, profile: , target: , version: 1.7.8
[0m22:38:06.440994 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:38:06.441720 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:38:06.451011 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '96097220-8a04-4e89-8853-7195ad450083', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ddb3f90>]}
[0m22:38:06.468356 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '96097220-8a04-4e89-8853-7195ad450083', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dce5410>]}
[0m22:38:06.469380 [info ] [MainThread]: Found 2 models, 4 tests, 0 sources, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m22:38:06.470539 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '96097220-8a04-4e89-8853-7195ad450083', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dc9cc10>]}
[0m22:38:06.473706 [info ] [MainThread]: 
[0m22:38:06.475207 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m22:38:06.477372 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RAW'
[0m22:38:06.499027 [debug] [ThreadPool]: Using snowflake connection "list_RAW"
[0m22:38:06.499728 [debug] [ThreadPool]: On list_RAW: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_RAW"} */
show terse schemas in database RAW
    limit 10000
[0m22:38:06.500546 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:38:07.149926 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 1.0 seconds
[0m22:38:07.157914 [debug] [ThreadPool]: On list_RAW: Close
[0m22:38:07.291111 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RAW, now create_RAW_JAFFLE_SHOP)
[0m22:38:07.294411 [debug] [ThreadPool]: Creating schema "database: "RAW"
schema: "JAFFLE_SHOP"
"
[0m22:38:07.303283 [debug] [ThreadPool]: Using snowflake connection "create_RAW_JAFFLE_SHOP"
[0m22:38:07.312520 [debug] [ThreadPool]: On create_RAW_JAFFLE_SHOP: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "create_RAW_JAFFLE_SHOP"} */
create schema if not exists RAW.JAFFLE_SHOP
[0m22:38:07.313219 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:38:07.744194 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.0 seconds
[0m22:38:07.747661 [debug] [ThreadPool]: On create_RAW_JAFFLE_SHOP: Close
[0m22:38:07.889220 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_RAW_JAFFLE_SHOP, now list_RAW_JAFFLE_SHOP)
[0m22:38:07.902195 [debug] [ThreadPool]: Using snowflake connection "list_RAW_JAFFLE_SHOP"
[0m22:38:07.902874 [debug] [ThreadPool]: On list_RAW_JAFFLE_SHOP: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_RAW_JAFFLE_SHOP"} */
show terse objects in RAW.JAFFLE_SHOP limit 10000
[0m22:38:07.903398 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:38:08.489023 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 1.0 seconds
[0m22:38:08.493732 [debug] [ThreadPool]: On list_RAW_JAFFLE_SHOP: Close
[0m22:38:08.622300 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '96097220-8a04-4e89-8853-7195ad450083', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d94ca50>]}
[0m22:38:08.624481 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:38:08.625629 [info ] [MainThread]: 
[0m22:38:08.632906 [debug] [Thread-1 (]: Began running node model.jaffle_shop.my_first_dbt_model
[0m22:38:08.634424 [info ] [Thread-1 (]: 1 of 2 START sql table model JAFFLE_SHOP.my_first_dbt_model .................... [RUN]
[0m22:38:08.636057 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_RAW_JAFFLE_SHOP, now model.jaffle_shop.my_first_dbt_model)
[0m22:38:08.636929 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.my_first_dbt_model
[0m22:38:08.650671 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.my_first_dbt_model"
[0m22:38:08.652581 [debug] [Thread-1 (]: Timing info for model.jaffle_shop.my_first_dbt_model (compile): 22:38:08.637427 => 22:38:08.652032
[0m22:38:08.653320 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.my_first_dbt_model
[0m22:38:08.704255 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.my_first_dbt_model"
[0m22:38:08.706511 [debug] [Thread-1 (]: Using snowflake connection "model.jaffle_shop.my_first_dbt_model"
[0m22:38:08.707326 [debug] [Thread-1 (]: On model.jaffle_shop.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.my_first_dbt_model"} */
create or replace transient table RAW.JAFFLE_SHOP.my_first_dbt_model
         as
        (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
        );
[0m22:38:08.708023 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:38:09.133054 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b29f5a-0000-15b8-0000-000bfc03d2f5
[0m22:38:09.134344 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000606 (57P03): No active warehouse selected in the current session.  Select an active warehouse with the 'use warehouse' command.

[0m22:38:09.136014 [debug] [Thread-1 (]: Timing info for model.jaffle_shop.my_first_dbt_model (execute): 22:38:08.653727 => 22:38:09.135380
[0m22:38:09.137041 [debug] [Thread-1 (]: On model.jaffle_shop.my_first_dbt_model: Close
[0m22:38:09.276923 [debug] [Thread-1 (]: Database Error in model my_first_dbt_model (models/example/my_first_dbt_model.sql)
  000606 (57P03): No active warehouse selected in the current session.  Select an active warehouse with the 'use warehouse' command.
  
  compiled Code at target/run/jaffle_shop/models/example/my_first_dbt_model.sql
[0m22:38:09.278105 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '96097220-8a04-4e89-8853-7195ad450083', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dfe2610>]}
[0m22:38:09.279384 [error] [Thread-1 (]: 1 of 2 ERROR creating sql table model JAFFLE_SHOP.my_first_dbt_model ........... [[31mERROR[0m in 0.64s]
[0m22:38:09.281017 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.my_first_dbt_model
[0m22:38:09.282707 [debug] [Thread-3 (]: Began running node model.jaffle_shop.my_second_dbt_model
[0m22:38:09.283707 [info ] [Thread-3 (]: 2 of 2 SKIP relation JAFFLE_SHOP.my_second_dbt_model ........................... [[33mSKIP[0m]
[0m22:38:09.284566 [debug] [Thread-3 (]: Finished running node model.jaffle_shop.my_second_dbt_model
[0m22:38:09.287535 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:38:09.288270 [debug] [MainThread]: Connection 'model.jaffle_shop.my_first_dbt_model' was properly closed.
[0m22:38:09.289427 [info ] [MainThread]: 
[0m22:38:09.290389 [info ] [MainThread]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 2.81 seconds (2.81s).
[0m22:38:09.292496 [debug] [MainThread]: Command end result
[0m22:38:09.306927 [info ] [MainThread]: 
[0m22:38:09.307640 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m22:38:09.308266 [info ] [MainThread]: 
[0m22:38:09.309018 [error] [MainThread]:   Database Error in model my_first_dbt_model (models/example/my_first_dbt_model.sql)
  000606 (57P03): No active warehouse selected in the current session.  Select an active warehouse with the 'use warehouse' command.
  
  compiled Code at target/run/jaffle_shop/models/example/my_first_dbt_model.sql
[0m22:38:09.309921 [info ] [MainThread]: 
[0m22:38:09.310921 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=1 TOTAL=2
[0m22:38:09.314300 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 3.728751, "process_user_time": 4.044056, "process_kernel_time": 0.408701, "process_mem_max_rss": "135249920", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m22:38:09.315758 [debug] [MainThread]: Command `dbt run` failed at 22:38:09.315392 after 3.73 seconds
[0m22:38:09.317092 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cbd1e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d1f9750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ec47d0>]}
[0m22:38:09.317777 [debug] [MainThread]: Flushing usage events
[0m22:43:05.337030 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111cd2610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1116be410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1116be490>]}


============================== 22:43:05.344230 | 350f3051-e04d-4c82-973c-e95bdc6b32f0 ==============================
[0m22:43:05.344230 [info ] [MainThread]: Running with dbt=1.7.8
[0m22:43:05.345680 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/ben/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/ben/jaffle_shop/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m22:43:05.892227 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '350f3051-e04d-4c82-973c-e95bdc6b32f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1125a2990>]}
[0m22:43:06.019498 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '350f3051-e04d-4c82-973c-e95bdc6b32f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111d06350>]}
[0m22:43:06.020836 [info ] [MainThread]: Registered adapter: snowflake=1.7.2
[0m22:43:06.047130 [debug] [MainThread]: checksum: 67f0013ca5f0bd43af9a0873dd50792fde83ef69de63b71cacd0b4ac656c52e5, vars: {}, profile: , target: , version: 1.7.8
[0m22:43:06.103326 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:43:06.104072 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:43:06.113346 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '350f3051-e04d-4c82-973c-e95bdc6b32f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111d29910>]}
[0m22:43:06.128875 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '350f3051-e04d-4c82-973c-e95bdc6b32f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1126f7590>]}
[0m22:43:06.129712 [info ] [MainThread]: Found 2 models, 4 tests, 0 sources, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m22:43:06.130334 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '350f3051-e04d-4c82-973c-e95bdc6b32f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112415b90>]}
[0m22:43:06.132915 [info ] [MainThread]: 
[0m22:43:06.134325 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m22:43:06.136192 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RAW'
[0m22:43:06.158029 [debug] [ThreadPool]: Using snowflake connection "list_RAW"
[0m22:43:06.158703 [debug] [ThreadPool]: On list_RAW: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_RAW"} */
show terse schemas in database RAW
    limit 10000
[0m22:43:06.159258 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:43:07.422584 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.0 seconds
[0m22:43:07.425611 [debug] [ThreadPool]: On list_RAW: Close
[0m22:43:07.556638 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RAW, now list_RAW_JAFFLE_SHOP)
[0m22:43:07.572618 [debug] [ThreadPool]: Using snowflake connection "list_RAW_JAFFLE_SHOP"
[0m22:43:07.573394 [debug] [ThreadPool]: On list_RAW_JAFFLE_SHOP: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_RAW_JAFFLE_SHOP"} */
show terse objects in RAW.JAFFLE_SHOP limit 10000
[0m22:43:07.573912 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:43:08.040349 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.0 seconds
[0m22:43:08.044746 [debug] [ThreadPool]: On list_RAW_JAFFLE_SHOP: Close
[0m22:43:08.185164 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '350f3051-e04d-4c82-973c-e95bdc6b32f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11271be90>]}
[0m22:43:08.187623 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:43:08.188558 [info ] [MainThread]: 
[0m22:43:08.193676 [debug] [Thread-1 (]: Began running node model.jaffle_shop.my_first_dbt_model
[0m22:43:08.195683 [info ] [Thread-1 (]: 1 of 2 START sql table model JAFFLE_SHOP.my_first_dbt_model .................... [RUN]
[0m22:43:08.197170 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_RAW_JAFFLE_SHOP, now model.jaffle_shop.my_first_dbt_model)
[0m22:43:08.197999 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.my_first_dbt_model
[0m22:43:08.211379 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.my_first_dbt_model"
[0m22:43:08.212679 [debug] [Thread-1 (]: Timing info for model.jaffle_shop.my_first_dbt_model (compile): 22:43:08.198530 => 22:43:08.212290
[0m22:43:08.213305 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.my_first_dbt_model
[0m22:43:08.263471 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.my_first_dbt_model"
[0m22:43:08.265442 [debug] [Thread-1 (]: Using snowflake connection "model.jaffle_shop.my_first_dbt_model"
[0m22:43:08.266371 [debug] [Thread-1 (]: On model.jaffle_shop.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.my_first_dbt_model"} */
create or replace transient table RAW.JAFFLE_SHOP.my_first_dbt_model
         as
        (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
        );
[0m22:43:08.267047 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:43:09.376949 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m22:43:09.411205 [debug] [Thread-1 (]: Timing info for model.jaffle_shop.my_first_dbt_model (execute): 22:43:08.213685 => 22:43:09.410838
[0m22:43:09.411913 [debug] [Thread-1 (]: On model.jaffle_shop.my_first_dbt_model: Close
[0m22:43:09.522029 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '350f3051-e04d-4c82-973c-e95bdc6b32f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1127c7e50>]}
[0m22:43:09.523709 [info ] [Thread-1 (]: 1 of 2 OK created sql table model JAFFLE_SHOP.my_first_dbt_model ............... [[32mSUCCESS 1[0m in 1.33s]
[0m22:43:09.525144 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.my_first_dbt_model
[0m22:43:09.526562 [debug] [Thread-3 (]: Began running node model.jaffle_shop.my_second_dbt_model
[0m22:43:09.527413 [info ] [Thread-3 (]: 2 of 2 START sql view model JAFFLE_SHOP.my_second_dbt_model .................... [RUN]
[0m22:43:09.528608 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.jaffle_shop.my_second_dbt_model'
[0m22:43:09.529205 [debug] [Thread-3 (]: Began compiling node model.jaffle_shop.my_second_dbt_model
[0m22:43:09.536652 [debug] [Thread-3 (]: Writing injected SQL for node "model.jaffle_shop.my_second_dbt_model"
[0m22:43:09.538642 [debug] [Thread-3 (]: Timing info for model.jaffle_shop.my_second_dbt_model (compile): 22:43:09.529608 => 22:43:09.537990
[0m22:43:09.539615 [debug] [Thread-3 (]: Began executing node model.jaffle_shop.my_second_dbt_model
[0m22:43:09.586467 [debug] [Thread-3 (]: Writing runtime sql for node "model.jaffle_shop.my_second_dbt_model"
[0m22:43:09.587954 [debug] [Thread-3 (]: Using snowflake connection "model.jaffle_shop.my_second_dbt_model"
[0m22:43:09.588583 [debug] [Thread-3 (]: On model.jaffle_shop.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.my_second_dbt_model"} */
create or replace   view RAW.JAFFLE_SHOP.my_second_dbt_model
  
   as (
    -- Use the `ref` function to select from other models

select *
from RAW.JAFFLE_SHOP.my_first_dbt_model
where id = 1
  );
[0m22:43:09.589169 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m22:43:10.023711 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m22:43:10.031163 [debug] [Thread-3 (]: Timing info for model.jaffle_shop.my_second_dbt_model (execute): 22:43:09.540215 => 22:43:10.030620
[0m22:43:10.032202 [debug] [Thread-3 (]: On model.jaffle_shop.my_second_dbt_model: Close
[0m22:43:10.166937 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '350f3051-e04d-4c82-973c-e95bdc6b32f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112859550>]}
[0m22:43:10.168752 [info ] [Thread-3 (]: 2 of 2 OK created sql view model JAFFLE_SHOP.my_second_dbt_model ............... [[32mSUCCESS 1[0m in 0.64s]
[0m22:43:10.170280 [debug] [Thread-3 (]: Finished running node model.jaffle_shop.my_second_dbt_model
[0m22:43:10.174408 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:43:10.175158 [debug] [MainThread]: Connection 'model.jaffle_shop.my_first_dbt_model' was properly closed.
[0m22:43:10.175811 [debug] [MainThread]: Connection 'model.jaffle_shop.my_second_dbt_model' was properly closed.
[0m22:43:10.176611 [info ] [MainThread]: 
[0m22:43:10.177519 [info ] [MainThread]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 4.04 seconds (4.04s).
[0m22:43:10.179170 [debug] [MainThread]: Command end result
[0m22:43:10.195252 [info ] [MainThread]: 
[0m22:43:10.196101 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:43:10.196793 [info ] [MainThread]: 
[0m22:43:10.197438 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m22:43:10.199719 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 4.947293, "process_user_time": 4.203761, "process_kernel_time": 0.433669, "process_mem_max_rss": "136990720", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m22:43:10.200727 [debug] [MainThread]: Command `dbt run` succeeded at 22:43:10.200496 after 4.95 seconds
[0m22:43:10.201795 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d92c110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d9b3e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111750610>]}
[0m22:43:10.202928 [debug] [MainThread]: Flushing usage events
[0m20:40:18.848624 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108dca510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108e0e510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b48f50>]}


============================== 20:40:18.854696 | a5bf9ac7-6858-48fa-a5d6-deb24d088c88 ==============================
[0m20:40:18.854696 [info ] [MainThread]: Running with dbt=1.7.8
[0m20:40:18.855899 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/ben/jaffle_shop/logs', 'profiles_dir': '/Users/ben/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt debug', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m20:40:18.856858 [info ] [MainThread]: dbt version: 1.7.8
[0m20:40:18.857463 [info ] [MainThread]: python version: 3.11.0
[0m20:40:18.858026 [info ] [MainThread]: python path: /Users/ben/dbt-env/bin/python
[0m20:40:18.858540 [info ] [MainThread]: os info: macOS-14.3.1-x86_64-i386-64bit
[0m20:40:19.229670 [info ] [MainThread]: Using profiles dir at /Users/ben/.dbt
[0m20:40:19.230433 [info ] [MainThread]: Using profiles.yml file at /Users/ben/.dbt/profiles.yml
[0m20:40:19.230988 [info ] [MainThread]: Using dbt_project.yml file at /Users/ben/jaffle_shop/dbt_project.yml
[0m20:40:19.231792 [info ] [MainThread]: adapter type: snowflake
[0m20:40:19.232327 [info ] [MainThread]: adapter version: 1.7.2
[0m20:40:19.409651 [info ] [MainThread]: Configuration:
[0m20:40:19.410394 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m20:40:19.410943 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m20:40:19.411444 [info ] [MainThread]: Required dependencies:
[0m20:40:19.412016 [debug] [MainThread]: Executing "git --help"
[0m20:40:19.443879 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m20:40:19.445193 [debug] [MainThread]: STDERR: "b''"
[0m20:40:19.445866 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m20:40:19.446482 [info ] [MainThread]: Connection:
[0m20:40:19.447269 [info ] [MainThread]:   account: eta20809.east-us-2.azure
[0m20:40:19.448188 [info ] [MainThread]:   user: DBT_EXECUTOR
[0m20:40:19.449016 [info ] [MainThread]:   database: RAW
[0m20:40:19.449699 [info ] [MainThread]:   warehouse: TRANSFORMING
[0m20:40:19.450238 [info ] [MainThread]:   role: DBT_EXECUTOR_ROLE
[0m20:40:19.450763 [info ] [MainThread]:   schema: JAFFLE_SHOP
[0m20:40:19.451629 [info ] [MainThread]:   authenticator: None
[0m20:40:19.452303 [info ] [MainThread]:   private_key_path: None
[0m20:40:19.452820 [info ] [MainThread]:   oauth_client_id: None
[0m20:40:19.453469 [info ] [MainThread]:   query_tag: None
[0m20:40:19.454307 [info ] [MainThread]:   client_session_keep_alive: False
[0m20:40:19.455321 [info ] [MainThread]:   host: None
[0m20:40:19.455932 [info ] [MainThread]:   port: None
[0m20:40:19.456450 [info ] [MainThread]:   proxy_host: None
[0m20:40:19.457133 [info ] [MainThread]:   proxy_port: None
[0m20:40:19.457686 [info ] [MainThread]:   protocol: None
[0m20:40:19.458361 [info ] [MainThread]:   connect_retries: 1
[0m20:40:19.459169 [info ] [MainThread]:   connect_timeout: None
[0m20:40:19.459721 [info ] [MainThread]:   retry_on_database_errors: False
[0m20:40:19.460228 [info ] [MainThread]:   retry_all: False
[0m20:40:19.460723 [info ] [MainThread]:   insecure_mode: False
[0m20:40:19.461205 [info ] [MainThread]:   reuse_connections: None
[0m20:40:19.462032 [info ] [MainThread]: Registered adapter: snowflake=1.7.2
[0m20:40:19.473845 [debug] [MainThread]: Acquiring new snowflake connection 'debug'
[0m20:40:19.477119 [debug] [MainThread]: Using snowflake connection "debug"
[0m20:40:19.477856 [debug] [MainThread]: On debug: select 1 as id
[0m20:40:19.478953 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:40:20.692095 [debug] [MainThread]: SQL status: SUCCESS 1 in 1.0 seconds
[0m20:40:20.695517 [debug] [MainThread]: On debug: Close
[0m20:40:20.822008 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m20:40:20.823444 [info ] [MainThread]: [32mAll checks passed![0m
[0m20:40:20.826415 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 2.0584776, "process_user_time": 3.433685, "process_kernel_time": 0.36466, "process_mem_max_rss": "125165568", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m20:40:20.827882 [debug] [MainThread]: Command `dbt debug` succeeded at 20:40:20.827524 after 2.06 seconds
[0m20:40:20.828852 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m20:40:20.829826 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108afd6d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108afe1d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104abbd90>]}
[0m20:40:20.830795 [debug] [MainThread]: Flushing usage events
[0m20:49:08.456766 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1145c1190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1142649d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114264910>]}


============================== 20:49:08.463321 | 09b2a212-99d9-45f2-acf2-4a6a35471db9 ==============================
[0m20:49:08.463321 [info ] [MainThread]: Running with dbt=1.7.8
[0m20:49:08.464358 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/ben/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/ben/jaffle_shop/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m20:49:09.035895 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '09b2a212-99d9-45f2-acf2-4a6a35471db9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115050c50>]}
[0m20:49:09.175506 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '09b2a212-99d9-45f2-acf2-4a6a35471db9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115070190>]}
[0m20:49:09.176744 [info ] [MainThread]: Registered adapter: snowflake=1.7.2
[0m20:49:09.205841 [debug] [MainThread]: checksum: 67f0013ca5f0bd43af9a0873dd50792fde83ef69de63b71cacd0b4ac656c52e5, vars: {}, profile: , target: , version: 1.7.8
[0m20:49:09.310199 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m20:49:09.311512 [debug] [MainThread]: Partial parsing: added file: jaffle_shop://models/customers.sql
[0m20:49:09.519171 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '09b2a212-99d9-45f2-acf2-4a6a35471db9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1152e7090>]}
[0m20:49:09.536372 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '09b2a212-99d9-45f2-acf2-4a6a35471db9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1154ca510>]}
[0m20:49:09.537221 [info ] [MainThread]: Found 3 models, 4 tests, 0 sources, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m20:49:09.537855 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '09b2a212-99d9-45f2-acf2-4a6a35471db9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115304ed0>]}
[0m20:49:09.540575 [info ] [MainThread]: 
[0m20:49:09.541926 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m20:49:09.545170 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RAW'
[0m20:49:09.574633 [debug] [ThreadPool]: Using snowflake connection "list_RAW"
[0m20:49:09.575418 [debug] [ThreadPool]: On list_RAW: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_RAW"} */
show terse schemas in database RAW
    limit 10000
[0m20:49:09.576210 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:49:10.623904 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.0 seconds
[0m20:49:10.628658 [debug] [ThreadPool]: On list_RAW: Close
[0m20:49:10.756065 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RAW, now list_RAW_JAFFLE_SHOP)
[0m20:49:10.772580 [debug] [ThreadPool]: Using snowflake connection "list_RAW_JAFFLE_SHOP"
[0m20:49:10.773739 [debug] [ThreadPool]: On list_RAW_JAFFLE_SHOP: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_RAW_JAFFLE_SHOP"} */
show terse objects in RAW.JAFFLE_SHOP limit 10000
[0m20:49:10.774399 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:49:11.347224 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 1.0 seconds
[0m20:49:11.352071 [debug] [ThreadPool]: On list_RAW_JAFFLE_SHOP: Close
[0m20:49:11.551856 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '09b2a212-99d9-45f2-acf2-4a6a35471db9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1154cbe90>]}
[0m20:49:11.553851 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:49:11.554797 [info ] [MainThread]: 
[0m20:49:11.562786 [debug] [Thread-1 (]: Began running node model.jaffle_shop.customers
[0m20:49:11.565095 [debug] [Thread-2 (]: Began running node model.jaffle_shop.my_first_dbt_model
[0m20:49:11.566990 [info ] [Thread-1 (]: 1 of 3 START sql view model JAFFLE_SHOP.customers .............................. [RUN]
[0m20:49:11.568577 [info ] [Thread-2 (]: 2 of 3 START sql table model JAFFLE_SHOP.my_first_dbt_model .................... [RUN]
[0m20:49:11.571957 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_RAW_JAFFLE_SHOP, now model.jaffle_shop.customers)
[0m20:49:11.574573 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.jaffle_shop.my_first_dbt_model'
[0m20:49:11.576248 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.customers
[0m20:49:11.577466 [debug] [Thread-2 (]: Began compiling node model.jaffle_shop.my_first_dbt_model
[0m20:49:11.587217 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.customers"
[0m20:49:11.592201 [debug] [Thread-2 (]: Writing injected SQL for node "model.jaffle_shop.my_first_dbt_model"
[0m20:49:11.593728 [debug] [Thread-1 (]: Timing info for model.jaffle_shop.customers (compile): 20:49:11.577944 => 20:49:11.593267
[0m20:49:11.594392 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.customers
[0m20:49:11.595150 [debug] [Thread-2 (]: Timing info for model.jaffle_shop.my_first_dbt_model (compile): 20:49:11.587974 => 20:49:11.594768
[0m20:49:11.602879 [debug] [Thread-2 (]: Began executing node model.jaffle_shop.my_first_dbt_model
[0m20:49:11.689234 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.customers"
[0m20:49:11.692768 [debug] [Thread-2 (]: Writing runtime sql for node "model.jaffle_shop.my_first_dbt_model"
[0m20:49:11.696299 [debug] [Thread-1 (]: Using snowflake connection "model.jaffle_shop.customers"
[0m20:49:11.697103 [debug] [Thread-1 (]: On model.jaffle_shop.customers: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.customers"} */
create or replace   view RAW.JAFFLE_SHOP.customers
  
   as (
    with customers as (

    select
        id as customer_id,
        first_name,
        last_name

    from raw.jaffle_shop.customers

),

orders as (

    select
        id as order_id,
        user_id as customer_id,
        order_date,
        status

    from raw.jaffle_shop.orders

),

customer_orders as (

    select
        customer_id,

        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders

    from orders

    group by 1

),

final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce(customer_orders.number_of_orders, 0) as number_of_orders

    from customers

    left join customer_orders using (customer_id)

)

select * from final
  );
[0m20:49:11.698526 [debug] [Thread-2 (]: Using snowflake connection "model.jaffle_shop.my_first_dbt_model"
[0m20:49:11.699282 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:49:11.700093 [debug] [Thread-2 (]: On model.jaffle_shop.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.my_first_dbt_model"} */
create or replace transient table RAW.JAFFLE_SHOP.my_first_dbt_model
         as
        (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
        );
[0m20:49:11.702907 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m20:49:12.220650 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b2a48d-0000-15ba-000b-fc03000100da
[0m20:49:12.221814 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 002003 (42S02): SQL compilation error:
Object 'RAW.JAFFLE_SHOP.CUSTOMERS' does not exist or not authorized.
[0m20:49:12.223065 [debug] [Thread-1 (]: Timing info for model.jaffle_shop.customers (execute): 20:49:11.595501 => 20:49:12.222598
[0m20:49:12.223889 [debug] [Thread-1 (]: On model.jaffle_shop.customers: Close
[0m20:49:12.368749 [debug] [Thread-1 (]: Database Error in model customers (models/customers.sql)
  002003 (42S02): SQL compilation error:
  Object 'RAW.JAFFLE_SHOP.CUSTOMERS' does not exist or not authorized.
  compiled Code at target/run/jaffle_shop/models/customers.sql
[0m20:49:12.370162 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '09b2a212-99d9-45f2-acf2-4a6a35471db9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1152c5bd0>]}
[0m20:49:12.371626 [error] [Thread-1 (]: 1 of 3 ERROR creating sql view model JAFFLE_SHOP.customers ..................... [[31mERROR[0m in 0.80s]
[0m20:49:12.373115 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.customers
[0m20:49:12.717046 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m20:49:12.756572 [debug] [Thread-2 (]: Timing info for model.jaffle_shop.my_first_dbt_model (execute): 20:49:11.610492 => 20:49:12.756211
[0m20:49:12.757296 [debug] [Thread-2 (]: On model.jaffle_shop.my_first_dbt_model: Close
[0m20:49:12.884911 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '09b2a212-99d9-45f2-acf2-4a6a35471db9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1156479d0>]}
[0m20:49:12.887151 [info ] [Thread-2 (]: 2 of 3 OK created sql table model JAFFLE_SHOP.my_first_dbt_model ............... [[32mSUCCESS 1[0m in 1.31s]
[0m20:49:12.888913 [debug] [Thread-2 (]: Finished running node model.jaffle_shop.my_first_dbt_model
[0m20:49:12.890803 [debug] [Thread-4 (]: Began running node model.jaffle_shop.my_second_dbt_model
[0m20:49:12.892242 [info ] [Thread-4 (]: 3 of 3 START sql view model JAFFLE_SHOP.my_second_dbt_model .................... [RUN]
[0m20:49:12.894179 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.jaffle_shop.my_second_dbt_model'
[0m20:49:12.895079 [debug] [Thread-4 (]: Began compiling node model.jaffle_shop.my_second_dbt_model
[0m20:49:12.902410 [debug] [Thread-4 (]: Writing injected SQL for node "model.jaffle_shop.my_second_dbt_model"
[0m20:49:12.904572 [debug] [Thread-4 (]: Timing info for model.jaffle_shop.my_second_dbt_model (compile): 20:49:12.895585 => 20:49:12.904074
[0m20:49:12.905303 [debug] [Thread-4 (]: Began executing node model.jaffle_shop.my_second_dbt_model
[0m20:49:12.910890 [debug] [Thread-4 (]: Writing runtime sql for node "model.jaffle_shop.my_second_dbt_model"
[0m20:49:12.913678 [debug] [Thread-4 (]: Using snowflake connection "model.jaffle_shop.my_second_dbt_model"
[0m20:49:12.915131 [debug] [Thread-4 (]: On model.jaffle_shop.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.my_second_dbt_model"} */
create or replace   view RAW.JAFFLE_SHOP.my_second_dbt_model
  
   as (
    -- Use the `ref` function to select from other models

select *
from RAW.JAFFLE_SHOP.my_first_dbt_model
where id = 1
  );
[0m20:49:12.916124 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m20:49:13.399048 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m20:49:13.406200 [debug] [Thread-4 (]: Timing info for model.jaffle_shop.my_second_dbt_model (execute): 20:49:12.905677 => 20:49:13.405840
[0m20:49:13.406975 [debug] [Thread-4 (]: On model.jaffle_shop.my_second_dbt_model: Close
[0m20:49:13.530280 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '09b2a212-99d9-45f2-acf2-4a6a35471db9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115731710>]}
[0m20:49:13.531450 [info ] [Thread-4 (]: 3 of 3 OK created sql view model JAFFLE_SHOP.my_second_dbt_model ............... [[32mSUCCESS 1[0m in 0.64s]
[0m20:49:13.532435 [debug] [Thread-4 (]: Finished running node model.jaffle_shop.my_second_dbt_model
[0m20:49:13.535061 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:49:13.535599 [debug] [MainThread]: Connection 'model.jaffle_shop.customers' was properly closed.
[0m20:49:13.536341 [debug] [MainThread]: Connection 'model.jaffle_shop.my_first_dbt_model' was properly closed.
[0m20:49:13.537028 [debug] [MainThread]: Connection 'model.jaffle_shop.my_second_dbt_model' was properly closed.
[0m20:49:13.537754 [info ] [MainThread]: 
[0m20:49:13.538747 [info ] [MainThread]: Finished running 2 view models, 1 table model in 0 hours 0 minutes and 4.00 seconds (4.00s).
[0m20:49:13.540742 [debug] [MainThread]: Command end result
[0m20:49:13.554149 [info ] [MainThread]: 
[0m20:49:13.554944 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m20:49:13.555828 [info ] [MainThread]: 
[0m20:49:13.556497 [error] [MainThread]:   Database Error in model customers (models/customers.sql)
  002003 (42S02): SQL compilation error:
  Object 'RAW.JAFFLE_SHOP.CUSTOMERS' does not exist or not authorized.
  compiled Code at target/run/jaffle_shop/models/customers.sql
[0m20:49:13.557582 [info ] [MainThread]: 
[0m20:49:13.558294 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m20:49:13.560456 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 5.1882415, "process_user_time": 4.449322, "process_kernel_time": 0.456226, "process_mem_max_rss": "139403264", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m20:49:13.562190 [debug] [MainThread]: Command `dbt run` failed at 20:49:13.561849 after 5.19 seconds
[0m20:49:13.563012 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114552ad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114551fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11429b910>]}
[0m20:49:13.563965 [debug] [MainThread]: Flushing usage events
[0m21:00:31.090564 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ba4ad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108bbdc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f8c890>]}


============================== 21:00:31.096934 | f7922071-e835-40a8-8e1d-81109e9ec2da ==============================
[0m21:00:31.096934 [info ] [MainThread]: Running with dbt=1.7.8
[0m21:00:31.098001 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/ben/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/ben/jaffle_shop/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --select customers', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:00:31.678176 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f7922071-e835-40a8-8e1d-81109e9ec2da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109b31f90>]}
[0m21:00:31.951231 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f7922071-e835-40a8-8e1d-81109e9ec2da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1099c1f10>]}
[0m21:00:31.952508 [info ] [MainThread]: Registered adapter: snowflake=1.7.2
[0m21:00:31.987243 [debug] [MainThread]: checksum: 67f0013ca5f0bd43af9a0873dd50792fde83ef69de63b71cacd0b4ac656c52e5, vars: {}, profile: , target: , version: 1.7.8
[0m21:00:32.089229 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:00:32.089906 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:00:32.100980 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f7922071-e835-40a8-8e1d-81109e9ec2da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108bbf6d0>]}
[0m21:00:32.118402 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f7922071-e835-40a8-8e1d-81109e9ec2da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1091e3790>]}
[0m21:00:32.119235 [info ] [MainThread]: Found 3 models, 4 tests, 0 sources, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m21:00:32.119847 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f7922071-e835-40a8-8e1d-81109e9ec2da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1091f7950>]}
[0m21:00:32.122357 [info ] [MainThread]: 
[0m21:00:32.123582 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m21:00:32.125174 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RAW'
[0m21:00:32.151302 [debug] [ThreadPool]: Using snowflake connection "list_RAW"
[0m21:00:32.152045 [debug] [ThreadPool]: On list_RAW: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_RAW"} */
show terse schemas in database RAW
    limit 10000
[0m21:00:32.152614 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:00:33.106291 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.0 seconds
[0m21:00:33.109557 [debug] [ThreadPool]: On list_RAW: Close
[0m21:00:33.319701 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RAW, now list_RAW_JAFFLE_SHOP)
[0m21:00:33.334615 [debug] [ThreadPool]: Using snowflake connection "list_RAW_JAFFLE_SHOP"
[0m21:00:33.335305 [debug] [ThreadPool]: On list_RAW_JAFFLE_SHOP: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_RAW_JAFFLE_SHOP"} */
show terse objects in RAW.JAFFLE_SHOP limit 10000
[0m21:00:33.335832 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:00:33.886363 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 1.0 seconds
[0m21:00:33.890228 [debug] [ThreadPool]: On list_RAW_JAFFLE_SHOP: Close
[0m21:00:34.016832 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f7922071-e835-40a8-8e1d-81109e9ec2da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1091d5a10>]}
[0m21:00:34.019023 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:00:34.020225 [info ] [MainThread]: 
[0m21:00:34.027445 [debug] [Thread-1 (]: Began running node model.jaffle_shop.customers
[0m21:00:34.028612 [info ] [Thread-1 (]: 1 of 1 START sql view model JAFFLE_SHOP.customers .............................. [RUN]
[0m21:00:34.029928 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_RAW_JAFFLE_SHOP, now model.jaffle_shop.customers)
[0m21:00:34.030597 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.customers
[0m21:00:34.041555 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.customers"
[0m21:00:34.042955 [debug] [Thread-1 (]: Timing info for model.jaffle_shop.customers (compile): 21:00:34.030991 => 21:00:34.042511
[0m21:00:34.043616 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.customers
[0m21:00:34.098699 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.customers"
[0m21:00:34.102208 [debug] [Thread-1 (]: Using snowflake connection "model.jaffle_shop.customers"
[0m21:00:34.102993 [debug] [Thread-1 (]: On model.jaffle_shop.customers: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.customers"} */
create or replace   view RAW.JAFFLE_SHOP.customers
  
   as (
    with customers as (

    select
        id as customer_id,
        first_name,
        last_name

    from raw.jaffle_shop.customers

),

orders as (

    select
        id as order_id,
        user_id as customer_id,
        order_date,
        status

    from raw.jaffle_shop.orders

),

customer_orders as (

    select
        customer_id,

        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders

    from orders

    group by 1

),

final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce(customer_orders.number_of_orders, 0) as number_of_orders

    from customers

    left join customer_orders using (customer_id)

)

select * from final
  );
[0m21:00:34.103627 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:00:34.629672 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b2a498-0000-15c3-0000-000bfc03f13d
[0m21:00:34.630477 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 002003 (42S02): SQL compilation error:
Object 'RAW.JAFFLE_SHOP.CUSTOMERS' does not exist or not authorized.
[0m21:00:34.631475 [debug] [Thread-1 (]: Timing info for model.jaffle_shop.customers (execute): 21:00:34.044015 => 21:00:34.631094
[0m21:00:34.632162 [debug] [Thread-1 (]: On model.jaffle_shop.customers: Close
[0m21:00:34.823392 [debug] [Thread-1 (]: Database Error in model customers (models/customers.sql)
  002003 (42S02): SQL compilation error:
  Object 'RAW.JAFFLE_SHOP.CUSTOMERS' does not exist or not authorized.
  compiled Code at target/run/jaffle_shop/models/customers.sql
[0m21:00:34.824916 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f7922071-e835-40a8-8e1d-81109e9ec2da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108e67e10>]}
[0m21:00:34.826204 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model JAFFLE_SHOP.customers ..................... [[31mERROR[0m in 0.80s]
[0m21:00:34.828633 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.customers
[0m21:00:34.832886 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:00:34.833855 [debug] [MainThread]: Connection 'model.jaffle_shop.customers' was properly closed.
[0m21:00:34.834895 [info ] [MainThread]: 
[0m21:00:34.835822 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.71 seconds (2.71s).
[0m21:00:34.837341 [debug] [MainThread]: Command end result
[0m21:00:34.852797 [info ] [MainThread]: 
[0m21:00:34.854278 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m21:00:34.855112 [info ] [MainThread]: 
[0m21:00:34.855673 [error] [MainThread]:   Database Error in model customers (models/customers.sql)
  002003 (42S02): SQL compilation error:
  Object 'RAW.JAFFLE_SHOP.CUSTOMERS' does not exist or not authorized.
  compiled Code at target/run/jaffle_shop/models/customers.sql
[0m21:00:34.856198 [info ] [MainThread]: 
[0m21:00:34.856742 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m21:00:34.859704 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 3.871988, "process_user_time": 4.219594, "process_kernel_time": 0.547769, "process_mem_max_rss": "134803456", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m21:00:34.861579 [debug] [MainThread]: Command `dbt run` failed at 21:00:34.861120 after 3.87 seconds
[0m21:00:34.863094 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105039090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ba4ad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108e56bd0>]}
[0m21:00:34.864313 [debug] [MainThread]: Flushing usage events
[0m21:16:59.202168 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1100ff410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110112950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110111c90>]}


============================== 21:16:59.208101 | cb712a97-5de5-492a-8723-407df6018e16 ==============================
[0m21:16:59.208101 [info ] [MainThread]: Running with dbt=1.7.8
[0m21:16:59.209092 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/ben/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/Users/ben/jaffle_shop/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt seed', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:16:59.812392 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cb712a97-5de5-492a-8723-407df6018e16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110126310>]}
[0m21:16:59.967982 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cb712a97-5de5-492a-8723-407df6018e16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110fcb850>]}
[0m21:16:59.969229 [info ] [MainThread]: Registered adapter: snowflake=1.7.2
[0m21:16:59.997016 [debug] [MainThread]: checksum: 67f0013ca5f0bd43af9a0873dd50792fde83ef69de63b71cacd0b4ac656c52e5, vars: {}, profile: , target: , version: 1.7.8
[0m21:17:00.049684 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 3 files added, 0 files changed.
[0m21:17:00.050653 [debug] [MainThread]: Partial parsing: added file: jaffle_shop://seeds/raw_orders.csv
[0m21:17:00.051257 [debug] [MainThread]: Partial parsing: added file: jaffle_shop://seeds/raw_payments.csv
[0m21:17:00.051829 [debug] [MainThread]: Partial parsing: added file: jaffle_shop://seeds/raw_customers.csv
[0m21:17:00.253318 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cb712a97-5de5-492a-8723-407df6018e16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11115a6d0>]}
[0m21:17:00.272330 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cb712a97-5de5-492a-8723-407df6018e16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1112e4fd0>]}
[0m21:17:00.273126 [info ] [MainThread]: Found 3 models, 4 tests, 3 seeds, 0 sources, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m21:17:00.273754 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cb712a97-5de5-492a-8723-407df6018e16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11104a3d0>]}
[0m21:17:00.277261 [info ] [MainThread]: 
[0m21:17:00.278595 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m21:17:00.280293 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RAW'
[0m21:17:00.304785 [debug] [ThreadPool]: Using snowflake connection "list_RAW"
[0m21:17:00.305533 [debug] [ThreadPool]: On list_RAW: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_RAW"} */
show terse schemas in database RAW
    limit 10000
[0m21:17:00.306631 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:17:01.651934 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.0 seconds
[0m21:17:01.656441 [debug] [ThreadPool]: On list_RAW: Close
[0m21:17:01.804614 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RAW, now list_RAW_JAFFLE_SHOP)
[0m21:17:01.820318 [debug] [ThreadPool]: Using snowflake connection "list_RAW_JAFFLE_SHOP"
[0m21:17:01.821024 [debug] [ThreadPool]: On list_RAW_JAFFLE_SHOP: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_RAW_JAFFLE_SHOP"} */
show terse objects in RAW.JAFFLE_SHOP limit 10000
[0m21:17:01.821552 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:17:02.705863 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 1.0 seconds
[0m21:17:02.709703 [debug] [ThreadPool]: On list_RAW_JAFFLE_SHOP: Close
[0m21:17:02.847323 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cb712a97-5de5-492a-8723-407df6018e16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1103df0d0>]}
[0m21:17:02.850156 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:17:02.851603 [info ] [MainThread]: 
[0m21:17:02.856177 [debug] [Thread-1 (]: Began running node seed.jaffle_shop.raw_customers
[0m21:17:02.857283 [debug] [Thread-2 (]: Began running node seed.jaffle_shop.raw_orders
[0m21:17:02.858351 [info ] [Thread-1 (]: 1 of 3 START seed file JAFFLE_SHOP.raw_customers ............................... [RUN]
[0m21:17:02.859224 [debug] [Thread-3 (]: Began running node seed.jaffle_shop.raw_payments
[0m21:17:02.860073 [info ] [Thread-2 (]: 2 of 3 START seed file JAFFLE_SHOP.raw_orders .................................. [RUN]
[0m21:17:02.861413 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_RAW_JAFFLE_SHOP, now seed.jaffle_shop.raw_customers)
[0m21:17:02.863605 [info ] [Thread-3 (]: 3 of 3 START seed file JAFFLE_SHOP.raw_payments ................................ [RUN]
[0m21:17:02.867620 [debug] [Thread-2 (]: Acquiring new snowflake connection 'seed.jaffle_shop.raw_orders'
[0m21:17:02.868626 [debug] [Thread-1 (]: Began compiling node seed.jaffle_shop.raw_customers
[0m21:17:02.869985 [debug] [Thread-3 (]: Acquiring new snowflake connection 'seed.jaffle_shop.raw_payments'
[0m21:17:02.871079 [debug] [Thread-2 (]: Began compiling node seed.jaffle_shop.raw_orders
[0m21:17:02.872152 [debug] [Thread-1 (]: Timing info for seed.jaffle_shop.raw_customers (compile): 21:17:02.871741 => 21:17:02.871750
[0m21:17:02.872869 [debug] [Thread-3 (]: Began compiling node seed.jaffle_shop.raw_payments
[0m21:17:02.873681 [debug] [Thread-2 (]: Timing info for seed.jaffle_shop.raw_orders (compile): 21:17:02.873305 => 21:17:02.873310
[0m21:17:02.874441 [debug] [Thread-1 (]: Began executing node seed.jaffle_shop.raw_customers
[0m21:17:02.875470 [debug] [Thread-3 (]: Timing info for seed.jaffle_shop.raw_payments (compile): 21:17:02.875126 => 21:17:02.875131
[0m21:17:02.876077 [debug] [Thread-2 (]: Began executing node seed.jaffle_shop.raw_orders
[0m21:17:02.888375 [debug] [Thread-3 (]: Began executing node seed.jaffle_shop.raw_payments
[0m21:17:02.953663 [debug] [Thread-2 (]: Using snowflake connection "seed.jaffle_shop.raw_orders"
[0m21:17:02.960213 [debug] [Thread-3 (]: Using snowflake connection "seed.jaffle_shop.raw_payments"
[0m21:17:02.965235 [debug] [Thread-1 (]: Using snowflake connection "seed.jaffle_shop.raw_customers"
[0m21:17:02.965861 [debug] [Thread-2 (]: On seed.jaffle_shop.raw_orders: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_orders"} */
create table RAW.JAFFLE_SHOP.raw_orders (id integer,user_id integer,order_date date,status text)
[0m21:17:02.966531 [debug] [Thread-3 (]: On seed.jaffle_shop.raw_payments: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_payments"} */
create table RAW.JAFFLE_SHOP.raw_payments (id integer,order_id integer,payment_method text,amount integer)
[0m21:17:02.967138 [debug] [Thread-1 (]: On seed.jaffle_shop.raw_customers: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_customers"} */
create table RAW.JAFFLE_SHOP.raw_customers (id integer,first_name text,last_name text)
[0m21:17:02.967725 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m21:17:02.968531 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m21:17:02.969152 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:17:03.655527 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m21:17:03.659757 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m21:17:03.699318 [debug] [Thread-1 (]: Using snowflake connection "seed.jaffle_shop.raw_customers"
[0m21:17:03.694669 [debug] [Thread-3 (]: Using snowflake connection "seed.jaffle_shop.raw_payments"
[0m21:17:03.700626 [debug] [Thread-1 (]: On seed.jaffle_shop.raw_customers: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_customers"} */
BEGIN
[0m21:17:03.702269 [debug] [Thread-3 (]: On seed.jaffle_shop.raw_payments: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_payments"} */
BEGIN
[0m21:17:03.799757 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m21:17:03.807132 [debug] [Thread-3 (]: Using snowflake connection "seed.jaffle_shop.raw_payments"
[0m21:17:03.808138 [debug] [Thread-3 (]: On seed.jaffle_shop.raw_payments: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_payments"} */
insert into RAW.JAFFLE_SHOP.raw_payments (id, order_id, payment_method, amount) values
            (%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%...
[0m21:17:03.816119 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m21:17:03.819736 [debug] [Thread-1 (]: Using snowflake connection "seed.jaffle_shop.raw_customers"
[0m21:17:03.820719 [debug] [Thread-1 (]: On seed.jaffle_shop.raw_customers: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_customers"} */
insert into RAW.JAFFLE_SHOP.raw_customers (id, first_name, last_name) values
            (%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%...
[0m21:17:03.826388 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m21:17:03.831680 [debug] [Thread-2 (]: Using snowflake connection "seed.jaffle_shop.raw_orders"
[0m21:17:03.833614 [debug] [Thread-2 (]: On seed.jaffle_shop.raw_orders: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_orders"} */
BEGIN
[0m21:17:03.915336 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m21:17:03.919286 [debug] [Thread-2 (]: Using snowflake connection "seed.jaffle_shop.raw_orders"
[0m21:17:03.919913 [debug] [Thread-2 (]: On seed.jaffle_shop.raw_orders: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_orders"} */
insert into RAW.JAFFLE_SHOP.raw_orders (id, user_id, order_date, status) values
            (%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),...
[0m21:17:04.445902 [debug] [Thread-1 (]: SQL status: SUCCESS 100 in 1.0 seconds
[0m21:17:04.447597 [debug] [Thread-1 (]: Using snowflake connection "seed.jaffle_shop.raw_customers"
[0m21:17:04.448798 [debug] [Thread-1 (]: On seed.jaffle_shop.raw_customers: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_customers"} */
COMMIT
[0m21:17:04.685580 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m21:17:04.699230 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.jaffle_shop.raw_customers"
[0m21:17:04.701634 [debug] [Thread-3 (]: SQL status: SUCCESS 113 in 1.0 seconds
[0m21:17:04.703213 [debug] [Thread-3 (]: Using snowflake connection "seed.jaffle_shop.raw_payments"
[0m21:17:04.704029 [debug] [Thread-3 (]: On seed.jaffle_shop.raw_payments: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_payments"} */
COMMIT
[0m21:17:04.747407 [debug] [Thread-1 (]: Timing info for seed.jaffle_shop.raw_customers (execute): 21:17:02.876565 => 21:17:04.746988
[0m21:17:04.748164 [debug] [Thread-1 (]: On seed.jaffle_shop.raw_customers: Close
[0m21:17:04.848613 [debug] [Thread-2 (]: SQL status: SUCCESS 99 in 1.0 seconds
[0m21:17:04.849543 [debug] [Thread-2 (]: Using snowflake connection "seed.jaffle_shop.raw_orders"
[0m21:17:04.850584 [debug] [Thread-2 (]: On seed.jaffle_shop.raw_orders: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_orders"} */
COMMIT
[0m21:17:04.872695 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cb712a97-5de5-492a-8723-407df6018e16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11161a110>]}
[0m21:17:04.873676 [info ] [Thread-1 (]: 1 of 3 OK loaded seed file JAFFLE_SHOP.raw_customers ........................... [[32mINSERT 100[0m in 2.01s]
[0m21:17:04.874624 [debug] [Thread-1 (]: Finished running node seed.jaffle_shop.raw_customers
[0m21:17:04.880504 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m21:17:04.883466 [debug] [Thread-3 (]: Writing runtime SQL for node "seed.jaffle_shop.raw_payments"
[0m21:17:04.888483 [debug] [Thread-3 (]: Timing info for seed.jaffle_shop.raw_payments (execute): 21:17:02.944911 => 21:17:04.888123
[0m21:17:04.889752 [debug] [Thread-3 (]: On seed.jaffle_shop.raw_payments: Close
[0m21:17:05.083397 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m21:17:05.087963 [debug] [Thread-2 (]: Writing runtime SQL for node "seed.jaffle_shop.raw_orders"
[0m21:17:05.090586 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cb712a97-5de5-492a-8723-407df6018e16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111418750>]}
[0m21:17:05.092671 [info ] [Thread-3 (]: 3 of 3 OK loaded seed file JAFFLE_SHOP.raw_payments ............................ [[32mINSERT 113[0m in 2.22s]
[0m21:17:05.094994 [debug] [Thread-3 (]: Finished running node seed.jaffle_shop.raw_payments
[0m21:17:05.100600 [debug] [Thread-2 (]: Timing info for seed.jaffle_shop.raw_orders (execute): 21:17:02.917047 => 21:17:05.100003
[0m21:17:05.101703 [debug] [Thread-2 (]: On seed.jaffle_shop.raw_orders: Close
[0m21:17:05.275988 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cb712a97-5de5-492a-8723-407df6018e16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1114600d0>]}
[0m21:17:05.277457 [info ] [Thread-2 (]: 2 of 3 OK loaded seed file JAFFLE_SHOP.raw_orders .............................. [[32mINSERT 99[0m in 2.41s]
[0m21:17:05.279760 [debug] [Thread-2 (]: Finished running node seed.jaffle_shop.raw_orders
[0m21:17:05.283506 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:17:05.284279 [debug] [MainThread]: Connection 'seed.jaffle_shop.raw_customers' was properly closed.
[0m21:17:05.284926 [debug] [MainThread]: Connection 'seed.jaffle_shop.raw_orders' was properly closed.
[0m21:17:05.285562 [debug] [MainThread]: Connection 'seed.jaffle_shop.raw_payments' was properly closed.
[0m21:17:05.286388 [info ] [MainThread]: 
[0m21:17:05.287383 [info ] [MainThread]: Finished running 3 seeds in 0 hours 0 minutes and 5.01 seconds (5.01s).
[0m21:17:05.289104 [debug] [MainThread]: Command end result
[0m21:17:05.304841 [info ] [MainThread]: 
[0m21:17:05.305540 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:17:05.306105 [info ] [MainThread]: 
[0m21:17:05.306681 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m21:17:05.308602 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": true, "command_wall_clock_time": 6.1948833, "process_user_time": 4.685903, "process_kernel_time": 0.483817, "process_mem_max_rss": "139055104", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m21:17:05.309875 [debug] [MainThread]: Command `dbt seed` succeeded at 21:17:05.309629 after 6.20 seconds
[0m21:17:05.310645 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1107368d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fccc510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1104cf890>]}
[0m21:17:05.311631 [debug] [MainThread]: Flushing usage events
[0m21:20:14.224056 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111a34a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111b1fd50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111783890>]}


============================== 21:20:14.231387 | 11696132-9b67-49c1-8be6-83532ee72907 ==============================
[0m21:20:14.231387 [info ] [MainThread]: Running with dbt=1.7.8
[0m21:20:14.233013 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/Users/ben/.dbt', 'log_path': '/Users/ben/jaffle_shop/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m21:20:14.985756 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '11696132-9b67-49c1-8be6-83532ee72907', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11175cb90>]}
[0m21:20:15.229978 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '11696132-9b67-49c1-8be6-83532ee72907', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11267f0d0>]}
[0m21:20:15.231193 [info ] [MainThread]: Registered adapter: snowflake=1.7.2
[0m21:20:15.263945 [debug] [MainThread]: checksum: 67f0013ca5f0bd43af9a0873dd50792fde83ef69de63b71cacd0b4ac656c52e5, vars: {}, profile: , target: , version: 1.7.8
[0m21:20:15.327944 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:20:15.329273 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:20:15.340932 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '11696132-9b67-49c1-8be6-83532ee72907', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112902010>]}
[0m21:20:15.360320 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '11696132-9b67-49c1-8be6-83532ee72907', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112760910>]}
[0m21:20:15.361151 [info ] [MainThread]: Found 3 models, 4 tests, 3 seeds, 0 sources, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m21:20:15.361919 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '11696132-9b67-49c1-8be6-83532ee72907', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1126a6f50>]}
[0m21:20:15.364753 [info ] [MainThread]: 
[0m21:20:15.366082 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m21:20:15.368438 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RAW'
[0m21:20:15.397784 [debug] [ThreadPool]: Using snowflake connection "list_RAW"
[0m21:20:15.398549 [debug] [ThreadPool]: On list_RAW: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_RAW"} */
show terse schemas in database RAW
    limit 10000
[0m21:20:15.399315 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:20:16.390032 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.0 seconds
[0m21:20:16.394297 [debug] [ThreadPool]: On list_RAW: Close
[0m21:20:16.780034 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RAW, now list_RAW_JAFFLE_SHOP)
[0m21:20:16.809695 [debug] [ThreadPool]: Using snowflake connection "list_RAW_JAFFLE_SHOP"
[0m21:20:16.810355 [debug] [ThreadPool]: On list_RAW_JAFFLE_SHOP: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_RAW_JAFFLE_SHOP"} */
show terse objects in RAW.JAFFLE_SHOP limit 10000
[0m21:20:16.810867 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:20:17.433019 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m21:20:17.443311 [debug] [ThreadPool]: On list_RAW_JAFFLE_SHOP: Close
[0m21:20:17.731447 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '11696132-9b67-49c1-8be6-83532ee72907', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1124abad0>]}
[0m21:20:17.733995 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:20:17.735427 [info ] [MainThread]: 
[0m21:20:17.741402 [debug] [Thread-1 (]: Began running node model.jaffle_shop.customers
[0m21:20:17.742230 [debug] [Thread-2 (]: Began running node model.jaffle_shop.my_first_dbt_model
[0m21:20:17.743982 [info ] [Thread-1 (]: 1 of 3 START sql view model JAFFLE_SHOP.customers .............................. [RUN]
[0m21:20:17.744916 [info ] [Thread-2 (]: 2 of 3 START sql table model JAFFLE_SHOP.my_first_dbt_model .................... [RUN]
[0m21:20:17.746581 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_RAW_JAFFLE_SHOP, now model.jaffle_shop.customers)
[0m21:20:17.749137 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.jaffle_shop.my_first_dbt_model'
[0m21:20:17.750645 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.customers
[0m21:20:17.751665 [debug] [Thread-2 (]: Began compiling node model.jaffle_shop.my_first_dbt_model
[0m21:20:17.762564 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.customers"
[0m21:20:17.769281 [debug] [Thread-2 (]: Writing injected SQL for node "model.jaffle_shop.my_first_dbt_model"
[0m21:20:17.770705 [debug] [Thread-1 (]: Timing info for model.jaffle_shop.customers (compile): 21:20:17.752099 => 21:20:17.770210
[0m21:20:17.771504 [debug] [Thread-2 (]: Timing info for model.jaffle_shop.my_first_dbt_model (compile): 21:20:17.763117 => 21:20:17.771121
[0m21:20:17.772137 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.customers
[0m21:20:17.773244 [debug] [Thread-2 (]: Began executing node model.jaffle_shop.my_first_dbt_model
[0m21:20:17.855811 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.customers"
[0m21:20:17.862474 [debug] [Thread-2 (]: Writing runtime sql for node "model.jaffle_shop.my_first_dbt_model"
[0m21:20:17.866594 [debug] [Thread-1 (]: Using snowflake connection "model.jaffle_shop.customers"
[0m21:20:17.867465 [debug] [Thread-1 (]: On model.jaffle_shop.customers: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.customers"} */
create or replace   view RAW.JAFFLE_SHOP.customers
  
   as (
    with customers as (

    select
        id as customer_id,
        first_name,
        last_name

    from raw.jaffle_shop.customers

),

orders as (

    select
        id as order_id,
        user_id as customer_id,
        order_date,
        status

    from raw.jaffle_shop.orders

),

customer_orders as (

    select
        customer_id,

        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders

    from orders

    group by 1

),

final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce(customer_orders.number_of_orders, 0) as number_of_orders

    from customers

    left join customer_orders using (customer_id)

)

select * from final
  );
[0m21:20:17.868131 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:20:17.870834 [debug] [Thread-2 (]: Using snowflake connection "model.jaffle_shop.my_first_dbt_model"
[0m21:20:17.871712 [debug] [Thread-2 (]: On model.jaffle_shop.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.my_first_dbt_model"} */
create or replace transient table RAW.JAFFLE_SHOP.my_first_dbt_model
         as
        (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
        );
[0m21:20:17.872969 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m21:20:18.406304 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b2a4ac-0000-15c3-0000-000bfc03f1fd
[0m21:20:18.408244 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 002003 (42S02): SQL compilation error:
Object 'RAW.JAFFLE_SHOP.CUSTOMERS' does not exist or not authorized.
[0m21:20:18.409865 [debug] [Thread-1 (]: Timing info for model.jaffle_shop.customers (execute): 21:20:17.773918 => 21:20:18.409394
[0m21:20:18.410616 [debug] [Thread-1 (]: On model.jaffle_shop.customers: Close
[0m21:20:18.535833 [debug] [Thread-1 (]: Database Error in model customers (models/customers.sql)
  002003 (42S02): SQL compilation error:
  Object 'RAW.JAFFLE_SHOP.CUSTOMERS' does not exist or not authorized.
  compiled Code at target/run/jaffle_shop/models/customers.sql
[0m21:20:18.536991 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '11696132-9b67-49c1-8be6-83532ee72907', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112855390>]}
[0m21:20:18.538069 [error] [Thread-1 (]: 1 of 3 ERROR creating sql view model JAFFLE_SHOP.customers ..................... [[31mERROR[0m in 0.79s]
[0m21:20:18.539164 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.customers
[0m21:20:18.866434 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m21:20:18.907004 [debug] [Thread-2 (]: Timing info for model.jaffle_shop.my_first_dbt_model (execute): 21:20:17.800415 => 21:20:18.906649
[0m21:20:18.907712 [debug] [Thread-2 (]: On model.jaffle_shop.my_first_dbt_model: Close
[0m21:20:19.024219 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '11696132-9b67-49c1-8be6-83532ee72907', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1126eee90>]}
[0m21:20:19.025515 [info ] [Thread-2 (]: 2 of 3 OK created sql table model JAFFLE_SHOP.my_first_dbt_model ............... [[32mSUCCESS 1[0m in 1.28s]
[0m21:20:19.026816 [debug] [Thread-2 (]: Finished running node model.jaffle_shop.my_first_dbt_model
[0m21:20:19.028239 [debug] [Thread-4 (]: Began running node model.jaffle_shop.my_second_dbt_model
[0m21:20:19.029186 [info ] [Thread-4 (]: 3 of 3 START sql view model JAFFLE_SHOP.my_second_dbt_model .................... [RUN]
[0m21:20:19.030686 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.jaffle_shop.my_second_dbt_model'
[0m21:20:19.031394 [debug] [Thread-4 (]: Began compiling node model.jaffle_shop.my_second_dbt_model
[0m21:20:19.038315 [debug] [Thread-4 (]: Writing injected SQL for node "model.jaffle_shop.my_second_dbt_model"
[0m21:20:19.040221 [debug] [Thread-4 (]: Timing info for model.jaffle_shop.my_second_dbt_model (compile): 21:20:19.032343 => 21:20:19.039657
[0m21:20:19.041165 [debug] [Thread-4 (]: Began executing node model.jaffle_shop.my_second_dbt_model
[0m21:20:19.049747 [debug] [Thread-4 (]: Writing runtime sql for node "model.jaffle_shop.my_second_dbt_model"
[0m21:20:19.051651 [debug] [Thread-4 (]: Using snowflake connection "model.jaffle_shop.my_second_dbt_model"
[0m21:20:19.052522 [debug] [Thread-4 (]: On model.jaffle_shop.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.my_second_dbt_model"} */
create or replace   view RAW.JAFFLE_SHOP.my_second_dbt_model
  
   as (
    -- Use the `ref` function to select from other models

select *
from RAW.JAFFLE_SHOP.my_first_dbt_model
where id = 1
  );
[0m21:20:19.053173 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m21:20:19.789824 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m21:20:19.795491 [debug] [Thread-4 (]: Timing info for model.jaffle_shop.my_second_dbt_model (execute): 21:20:19.041562 => 21:20:19.795030
[0m21:20:19.796388 [debug] [Thread-4 (]: On model.jaffle_shop.my_second_dbt_model: Close
[0m21:20:19.923838 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '11696132-9b67-49c1-8be6-83532ee72907', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112b58450>]}
[0m21:20:19.925335 [info ] [Thread-4 (]: 3 of 3 OK created sql view model JAFFLE_SHOP.my_second_dbt_model ............... [[32mSUCCESS 1[0m in 0.89s]
[0m21:20:19.927027 [debug] [Thread-4 (]: Finished running node model.jaffle_shop.my_second_dbt_model
[0m21:20:19.930532 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:20:19.932149 [debug] [MainThread]: Connection 'model.jaffle_shop.customers' was properly closed.
[0m21:20:19.933335 [debug] [MainThread]: Connection 'model.jaffle_shop.my_first_dbt_model' was properly closed.
[0m21:20:19.934401 [debug] [MainThread]: Connection 'model.jaffle_shop.my_second_dbt_model' was properly closed.
[0m21:20:19.935207 [info ] [MainThread]: 
[0m21:20:19.935907 [info ] [MainThread]: Finished running 2 view models, 1 table model in 0 hours 0 minutes and 4.57 seconds (4.57s).
[0m21:20:19.937985 [debug] [MainThread]: Command end result
[0m21:20:19.952767 [info ] [MainThread]: 
[0m21:20:19.953723 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m21:20:19.954410 [info ] [MainThread]: 
[0m21:20:19.955121 [error] [MainThread]:   Database Error in model customers (models/customers.sql)
  002003 (42S02): SQL compilation error:
  Object 'RAW.JAFFLE_SHOP.CUSTOMERS' does not exist or not authorized.
  compiled Code at target/run/jaffle_shop/models/customers.sql
[0m21:20:19.956283 [info ] [MainThread]: 
[0m21:20:19.956933 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m21:20:19.959046 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 5.8259773, "process_user_time": 4.657328, "process_kernel_time": 0.53203, "process_mem_max_rss": "136564736", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m21:20:19.960162 [debug] [MainThread]: Command `dbt run` failed at 21:20:19.959914 after 5.83 seconds
[0m21:20:19.961188 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111b3b950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111a60d50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111ad2450>]}
[0m21:20:19.961898 [debug] [MainThread]: Flushing usage events
[0m21:23:28.132852 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112645910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1122dfdd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112652c90>]}


============================== 21:23:28.138896 | 03ea2dce-2dba-4aa7-a31e-4f0b4d798dc5 ==============================
[0m21:23:28.138896 [info ] [MainThread]: Running with dbt=1.7.8
[0m21:23:28.141004 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/ben/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/ben/jaffle_shop/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m21:23:28.728732 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '03ea2dce-2dba-4aa7-a31e-4f0b4d798dc5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112f55390>]}
[0m21:23:28.905014 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '03ea2dce-2dba-4aa7-a31e-4f0b4d798dc5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112d78cd0>]}
[0m21:23:28.907558 [info ] [MainThread]: Registered adapter: snowflake=1.7.2
[0m21:23:28.935581 [debug] [MainThread]: checksum: 67f0013ca5f0bd43af9a0873dd50792fde83ef69de63b71cacd0b4ac656c52e5, vars: {}, profile: , target: , version: 1.7.8
[0m21:23:28.997537 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m21:23:28.998760 [debug] [MainThread]: Partial parsing: updated file: jaffle_shop://models/customers.sql
[0m21:23:29.259461 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '03ea2dce-2dba-4aa7-a31e-4f0b4d798dc5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1126a3dd0>]}
[0m21:23:29.277084 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '03ea2dce-2dba-4aa7-a31e-4f0b4d798dc5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1131aa650>]}
[0m21:23:29.278758 [info ] [MainThread]: Found 3 models, 4 tests, 3 seeds, 0 sources, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m21:23:29.279687 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '03ea2dce-2dba-4aa7-a31e-4f0b4d798dc5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1130d7690>]}
[0m21:23:29.283079 [info ] [MainThread]: 
[0m21:23:29.285253 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m21:23:29.287188 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RAW'
[0m21:23:29.311631 [debug] [ThreadPool]: Using snowflake connection "list_RAW"
[0m21:23:29.312444 [debug] [ThreadPool]: On list_RAW: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_RAW"} */
show terse schemas in database RAW
    limit 10000
[0m21:23:29.313397 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:23:30.295023 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.0 seconds
[0m21:23:30.299849 [debug] [ThreadPool]: On list_RAW: Close
[0m21:23:30.430717 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RAW, now list_RAW_JAFFLE_SHOP)
[0m21:23:30.443478 [debug] [ThreadPool]: Using snowflake connection "list_RAW_JAFFLE_SHOP"
[0m21:23:30.444277 [debug] [ThreadPool]: On list_RAW_JAFFLE_SHOP: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_RAW_JAFFLE_SHOP"} */
show terse objects in RAW.JAFFLE_SHOP limit 10000
[0m21:23:30.444878 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:23:30.869984 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.0 seconds
[0m21:23:30.873935 [debug] [ThreadPool]: On list_RAW_JAFFLE_SHOP: Close
[0m21:23:31.015468 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '03ea2dce-2dba-4aa7-a31e-4f0b4d798dc5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11309e450>]}
[0m21:23:31.017222 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:23:31.017923 [info ] [MainThread]: 
[0m21:23:31.022528 [debug] [Thread-1 (]: Began running node model.jaffle_shop.customers
[0m21:23:31.023437 [debug] [Thread-2 (]: Began running node model.jaffle_shop.my_first_dbt_model
[0m21:23:31.024790 [info ] [Thread-1 (]: 1 of 3 START sql view model JAFFLE_SHOP.customers .............................. [RUN]
[0m21:23:31.026290 [info ] [Thread-2 (]: 2 of 3 START sql table model JAFFLE_SHOP.my_first_dbt_model .................... [RUN]
[0m21:23:31.027916 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_RAW_JAFFLE_SHOP, now model.jaffle_shop.customers)
[0m21:23:31.029376 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.jaffle_shop.my_first_dbt_model'
[0m21:23:31.030096 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.customers
[0m21:23:31.031194 [debug] [Thread-2 (]: Began compiling node model.jaffle_shop.my_first_dbt_model
[0m21:23:31.044130 [debug] [Thread-2 (]: Writing injected SQL for node "model.jaffle_shop.my_first_dbt_model"
[0m21:23:31.048554 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.customers"
[0m21:23:31.051286 [debug] [Thread-2 (]: Timing info for model.jaffle_shop.my_first_dbt_model (compile): 21:23:31.039453 => 21:23:31.050470
[0m21:23:31.052325 [debug] [Thread-2 (]: Began executing node model.jaffle_shop.my_first_dbt_model
[0m21:23:31.053651 [debug] [Thread-1 (]: Timing info for model.jaffle_shop.customers (compile): 21:23:31.032858 => 21:23:31.052946
[0m21:23:31.076774 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.customers
[0m21:23:31.122582 [debug] [Thread-2 (]: Writing runtime sql for node "model.jaffle_shop.my_first_dbt_model"
[0m21:23:31.141467 [debug] [Thread-2 (]: Using snowflake connection "model.jaffle_shop.my_first_dbt_model"
[0m21:23:31.146091 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.customers"
[0m21:23:31.146898 [debug] [Thread-2 (]: On model.jaffle_shop.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.my_first_dbt_model"} */
create or replace transient table RAW.JAFFLE_SHOP.my_first_dbt_model
         as
        (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
        );
[0m21:23:31.147887 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m21:23:31.151567 [debug] [Thread-1 (]: Using snowflake connection "model.jaffle_shop.customers"
[0m21:23:31.152400 [debug] [Thread-1 (]: On model.jaffle_shop.customers: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.customers"} */
create or replace   view RAW.JAFFLE_SHOP.customers
  
   as (
    with customers as (

    select
        id as customer_id,
        first_name,
        last_name

    from raw.jaffle_shop.raw_customers

),

orders as (

    select
        id as order_id,
        user_id as customer_id,
        order_date,
        status

    from raw.jaffle_shop.raw_orders

),

customer_orders as (

    select
        customer_id,

        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders

    from orders

    group by 1

),

final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce(customer_orders.number_of_orders, 0) as number_of_orders

    from customers

    left join customer_orders using (customer_id)

)

select * from final
  );
[0m21:23:31.153097 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:23:31.632403 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m21:23:31.675544 [debug] [Thread-1 (]: Timing info for model.jaffle_shop.customers (execute): 21:23:31.090443 => 21:23:31.675038
[0m21:23:31.676340 [debug] [Thread-1 (]: On model.jaffle_shop.customers: Close
[0m21:23:31.793508 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '03ea2dce-2dba-4aa7-a31e-4f0b4d798dc5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113282f50>]}
[0m21:23:31.794646 [info ] [Thread-1 (]: 1 of 3 OK created sql view model JAFFLE_SHOP.customers ......................... [[32mSUCCESS 1[0m in 0.77s]
[0m21:23:31.795653 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.customers
[0m21:23:31.852198 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m21:23:31.863780 [debug] [Thread-2 (]: Timing info for model.jaffle_shop.my_first_dbt_model (execute): 21:23:31.054311 => 21:23:31.863137
[0m21:23:31.864929 [debug] [Thread-2 (]: On model.jaffle_shop.my_first_dbt_model: Close
[0m21:23:32.000500 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '03ea2dce-2dba-4aa7-a31e-4f0b4d798dc5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112749390>]}
[0m21:23:32.001578 [info ] [Thread-2 (]: 2 of 3 OK created sql table model JAFFLE_SHOP.my_first_dbt_model ............... [[32mSUCCESS 1[0m in 0.97s]
[0m21:23:32.002864 [debug] [Thread-2 (]: Finished running node model.jaffle_shop.my_first_dbt_model
[0m21:23:32.003967 [debug] [Thread-4 (]: Began running node model.jaffle_shop.my_second_dbt_model
[0m21:23:32.004802 [info ] [Thread-4 (]: 3 of 3 START sql view model JAFFLE_SHOP.my_second_dbt_model .................... [RUN]
[0m21:23:32.006037 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.jaffle_shop.my_second_dbt_model'
[0m21:23:32.006633 [debug] [Thread-4 (]: Began compiling node model.jaffle_shop.my_second_dbt_model
[0m21:23:32.011172 [debug] [Thread-4 (]: Writing injected SQL for node "model.jaffle_shop.my_second_dbt_model"
[0m21:23:32.014019 [debug] [Thread-4 (]: Timing info for model.jaffle_shop.my_second_dbt_model (compile): 21:23:32.007211 => 21:23:32.013042
[0m21:23:32.014888 [debug] [Thread-4 (]: Began executing node model.jaffle_shop.my_second_dbt_model
[0m21:23:32.023163 [debug] [Thread-4 (]: Writing runtime sql for node "model.jaffle_shop.my_second_dbt_model"
[0m21:23:32.024876 [debug] [Thread-4 (]: Using snowflake connection "model.jaffle_shop.my_second_dbt_model"
[0m21:23:32.025671 [debug] [Thread-4 (]: On model.jaffle_shop.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.my_second_dbt_model"} */
create or replace   view RAW.JAFFLE_SHOP.my_second_dbt_model
  
   as (
    -- Use the `ref` function to select from other models

select *
from RAW.JAFFLE_SHOP.my_first_dbt_model
where id = 1
  );
[0m21:23:32.026343 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m21:23:32.437287 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m21:23:32.442058 [debug] [Thread-4 (]: Timing info for model.jaffle_shop.my_second_dbt_model (execute): 21:23:32.015438 => 21:23:32.441673
[0m21:23:32.442803 [debug] [Thread-4 (]: On model.jaffle_shop.my_second_dbt_model: Close
[0m21:23:32.561632 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '03ea2dce-2dba-4aa7-a31e-4f0b4d798dc5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112f69ad0>]}
[0m21:23:32.562967 [info ] [Thread-4 (]: 3 of 3 OK created sql view model JAFFLE_SHOP.my_second_dbt_model ............... [[32mSUCCESS 1[0m in 0.56s]
[0m21:23:32.564272 [debug] [Thread-4 (]: Finished running node model.jaffle_shop.my_second_dbt_model
[0m21:23:32.568068 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:23:32.568866 [debug] [MainThread]: Connection 'model.jaffle_shop.customers' was properly closed.
[0m21:23:32.569657 [debug] [MainThread]: Connection 'model.jaffle_shop.my_first_dbt_model' was properly closed.
[0m21:23:32.571203 [debug] [MainThread]: Connection 'model.jaffle_shop.my_second_dbt_model' was properly closed.
[0m21:23:32.572015 [info ] [MainThread]: 
[0m21:23:32.572783 [info ] [MainThread]: Finished running 2 view models, 1 table model in 0 hours 0 minutes and 3.29 seconds (3.29s).
[0m21:23:32.574458 [debug] [MainThread]: Command end result
[0m21:23:32.588708 [info ] [MainThread]: 
[0m21:23:32.589418 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:23:32.590006 [info ] [MainThread]: 
[0m21:23:32.590589 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m21:23:32.593206 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 4.5568004, "process_user_time": 4.792903, "process_kernel_time": 0.495387, "process_mem_max_rss": "137662464", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m21:23:32.594629 [debug] [MainThread]: Command `dbt run` succeeded at 21:23:32.594351 after 4.56 seconds
[0m21:23:32.595452 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112378f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112037150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e32fd10>]}
[0m21:23:32.596669 [debug] [MainThread]: Flushing usage events
[0m21:33:23.908659 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110897a50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110274d50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1102a9350>]}


============================== 21:33:23.914956 | 1312fc2d-2a3a-4b3b-8549-9dcf427e3f05 ==============================
[0m21:33:23.914956 [info ] [MainThread]: Running with dbt=1.7.8
[0m21:33:23.916235 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/Users/ben/.dbt', 'log_path': '/Users/ben/jaffle_shop/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m21:33:24.577531 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1312fc2d-2a3a-4b3b-8549-9dcf427e3f05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1108ef5d0>]}
[0m21:33:24.713420 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1312fc2d-2a3a-4b3b-8549-9dcf427e3f05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111078f10>]}
[0m21:33:24.714680 [info ] [MainThread]: Registered adapter: snowflake=1.7.2
[0m21:33:24.742432 [debug] [MainThread]: checksum: 67f0013ca5f0bd43af9a0873dd50792fde83ef69de63b71cacd0b4ac656c52e5, vars: {}, profile: , target: , version: 1.7.8
[0m21:33:24.762565 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m21:33:24.763439 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '1312fc2d-2a3a-4b3b-8549-9dcf427e3f05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111298a10>]}
[0m21:33:26.680582 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.example
[0m21:33:26.688844 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1312fc2d-2a3a-4b3b-8549-9dcf427e3f05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111404450>]}
[0m21:33:26.707510 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1312fc2d-2a3a-4b3b-8549-9dcf427e3f05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1117fad50>]}
[0m21:33:26.708293 [info ] [MainThread]: Found 3 models, 3 seeds, 4 tests, 0 sources, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m21:33:26.708890 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1312fc2d-2a3a-4b3b-8549-9dcf427e3f05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1116cf4d0>]}
[0m21:33:26.711676 [info ] [MainThread]: 
[0m21:33:26.713928 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m21:33:26.716541 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RAW'
[0m21:33:26.739609 [debug] [ThreadPool]: Using snowflake connection "list_RAW"
[0m21:33:26.740773 [debug] [ThreadPool]: On list_RAW: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_RAW"} */
show terse schemas in database RAW
    limit 10000
[0m21:33:26.741420 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:33:27.894332 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.0 seconds
[0m21:33:27.897467 [debug] [ThreadPool]: On list_RAW: Close
[0m21:33:28.018587 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RAW, now list_RAW_JAFFLE_SHOP)
[0m21:33:28.032861 [debug] [ThreadPool]: Using snowflake connection "list_RAW_JAFFLE_SHOP"
[0m21:33:28.033669 [debug] [ThreadPool]: On list_RAW_JAFFLE_SHOP: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_RAW_JAFFLE_SHOP"} */
show terse objects in RAW.JAFFLE_SHOP limit 10000
[0m21:33:28.034343 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:33:28.491027 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.0 seconds
[0m21:33:28.494284 [debug] [ThreadPool]: On list_RAW_JAFFLE_SHOP: Close
[0m21:33:28.634840 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1312fc2d-2a3a-4b3b-8549-9dcf427e3f05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111727950>]}
[0m21:33:28.636319 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:33:28.636976 [info ] [MainThread]: 
[0m21:33:28.640518 [debug] [Thread-1 (]: Began running node model.jaffle_shop.customers
[0m21:33:28.641361 [debug] [Thread-2 (]: Began running node model.jaffle_shop.my_first_dbt_model
[0m21:33:28.642200 [info ] [Thread-1 (]: 1 of 3 START sql table model JAFFLE_SHOP.customers ............................. [RUN]
[0m21:33:28.643701 [info ] [Thread-2 (]: 2 of 3 START sql table model JAFFLE_SHOP.my_first_dbt_model .................... [RUN]
[0m21:33:28.645872 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_RAW_JAFFLE_SHOP, now model.jaffle_shop.customers)
[0m21:33:28.647742 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.jaffle_shop.my_first_dbt_model'
[0m21:33:28.648690 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.customers
[0m21:33:28.650159 [debug] [Thread-2 (]: Began compiling node model.jaffle_shop.my_first_dbt_model
[0m21:33:28.662413 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.customers"
[0m21:33:28.666420 [debug] [Thread-2 (]: Writing injected SQL for node "model.jaffle_shop.my_first_dbt_model"
[0m21:33:28.668890 [debug] [Thread-1 (]: Timing info for model.jaffle_shop.customers (compile): 21:33:28.651150 => 21:33:28.667950
[0m21:33:28.670227 [debug] [Thread-2 (]: Timing info for model.jaffle_shop.my_first_dbt_model (compile): 21:33:28.662835 => 21:33:28.669474
[0m21:33:28.670989 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.customers
[0m21:33:28.671602 [debug] [Thread-2 (]: Began executing node model.jaffle_shop.my_first_dbt_model
[0m21:33:28.716523 [debug] [Thread-1 (]: Dropping relation "RAW"."JAFFLE_SHOP"."CUSTOMERS" because it is of type view
[0m21:33:28.733693 [debug] [Thread-2 (]: Writing runtime sql for node "model.jaffle_shop.my_first_dbt_model"
[0m21:33:28.747745 [debug] [Thread-1 (]: Applying DROP to: "RAW"."JAFFLE_SHOP"."CUSTOMERS"
[0m21:33:28.760119 [debug] [Thread-1 (]: Using snowflake connection "model.jaffle_shop.customers"
[0m21:33:28.761874 [debug] [Thread-2 (]: Using snowflake connection "model.jaffle_shop.my_first_dbt_model"
[0m21:33:28.762597 [debug] [Thread-1 (]: On model.jaffle_shop.customers: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.customers"} */
drop view if exists "RAW"."JAFFLE_SHOP"."CUSTOMERS" cascade
[0m21:33:28.763358 [debug] [Thread-2 (]: On model.jaffle_shop.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.my_first_dbt_model"} */
create or replace transient table RAW.JAFFLE_SHOP.my_first_dbt_model
         as
        (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
        );
[0m21:33:28.764084 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:33:28.764661 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m21:33:29.165196 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m21:33:29.168807 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.customers"
[0m21:33:29.172478 [debug] [Thread-1 (]: Using snowflake connection "model.jaffle_shop.customers"
[0m21:33:29.173351 [debug] [Thread-1 (]: On model.jaffle_shop.customers: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.customers"} */
create or replace transient table RAW.JAFFLE_SHOP.customers
         as
        (with customers as (

    select
        id as customer_id,
        first_name,
        last_name

    from raw.jaffle_shop.raw_customers

),

orders as (

    select
        id as order_id,
        user_id as customer_id,
        order_date,
        status

    from raw.jaffle_shop.raw_orders

),

customer_orders as (

    select
        customer_id,

        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders

    from orders

    group by 1

),

final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce(customer_orders.number_of_orders, 0) as number_of_orders

    from customers

    left join customer_orders using (customer_id)

)

select * from final
        );
[0m21:33:29.405549 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m21:33:29.454885 [debug] [Thread-2 (]: Timing info for model.jaffle_shop.my_first_dbt_model (execute): 21:33:28.695003 => 21:33:29.454282
[0m21:33:29.456115 [debug] [Thread-2 (]: On model.jaffle_shop.my_first_dbt_model: Close
[0m21:33:29.576520 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1312fc2d-2a3a-4b3b-8549-9dcf427e3f05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1118e4390>]}
[0m21:33:29.577847 [info ] [Thread-2 (]: 2 of 3 OK created sql table model JAFFLE_SHOP.my_first_dbt_model ............... [[32mSUCCESS 1[0m in 0.93s]
[0m21:33:29.579067 [debug] [Thread-2 (]: Finished running node model.jaffle_shop.my_first_dbt_model
[0m21:33:29.580408 [debug] [Thread-4 (]: Began running node model.jaffle_shop.my_second_dbt_model
[0m21:33:29.582170 [info ] [Thread-4 (]: 3 of 3 START sql table model JAFFLE_SHOP.my_second_dbt_model ................... [RUN]
[0m21:33:29.583965 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.jaffle_shop.my_second_dbt_model'
[0m21:33:29.585187 [debug] [Thread-4 (]: Began compiling node model.jaffle_shop.my_second_dbt_model
[0m21:33:29.590500 [debug] [Thread-4 (]: Writing injected SQL for node "model.jaffle_shop.my_second_dbt_model"
[0m21:33:29.592179 [debug] [Thread-4 (]: Timing info for model.jaffle_shop.my_second_dbt_model (compile): 21:33:29.585916 => 21:33:29.591715
[0m21:33:29.592911 [debug] [Thread-4 (]: Began executing node model.jaffle_shop.my_second_dbt_model
[0m21:33:29.686681 [debug] [Thread-4 (]: Dropping relation "RAW"."JAFFLE_SHOP"."MY_SECOND_DBT_MODEL" because it is of type view
[0m21:33:29.691709 [debug] [Thread-4 (]: Applying DROP to: "RAW"."JAFFLE_SHOP"."MY_SECOND_DBT_MODEL"
[0m21:33:29.693537 [debug] [Thread-4 (]: Using snowflake connection "model.jaffle_shop.my_second_dbt_model"
[0m21:33:29.694754 [debug] [Thread-4 (]: On model.jaffle_shop.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.my_second_dbt_model"} */
drop view if exists "RAW"."JAFFLE_SHOP"."MY_SECOND_DBT_MODEL" cascade
[0m21:33:29.696031 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m21:33:29.716555 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m21:33:29.721765 [debug] [Thread-1 (]: Timing info for model.jaffle_shop.customers (execute): 21:33:28.671977 => 21:33:29.721132
[0m21:33:29.722498 [debug] [Thread-1 (]: On model.jaffle_shop.customers: Close
[0m21:33:29.831483 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1312fc2d-2a3a-4b3b-8549-9dcf427e3f05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1117bc810>]}
[0m21:33:29.832649 [info ] [Thread-1 (]: 1 of 3 OK created sql table model JAFFLE_SHOP.customers ........................ [[32mSUCCESS 1[0m in 1.19s]
[0m21:33:29.833654 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.customers
[0m21:33:30.107347 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m21:33:30.110975 [debug] [Thread-4 (]: Writing runtime sql for node "model.jaffle_shop.my_second_dbt_model"
[0m21:33:30.112483 [debug] [Thread-4 (]: Using snowflake connection "model.jaffle_shop.my_second_dbt_model"
[0m21:33:30.113156 [debug] [Thread-4 (]: On model.jaffle_shop.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.my_second_dbt_model"} */
create or replace transient table RAW.JAFFLE_SHOP.my_second_dbt_model
         as
        (-- Use the `ref` function to select from other models

select *
from RAW.JAFFLE_SHOP.my_first_dbt_model
where id = 1
        );
[0m21:33:30.665288 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m21:33:30.673749 [debug] [Thread-4 (]: Timing info for model.jaffle_shop.my_second_dbt_model (execute): 21:33:29.593379 => 21:33:30.673196
[0m21:33:30.674815 [debug] [Thread-4 (]: On model.jaffle_shop.my_second_dbt_model: Close
[0m21:33:30.816561 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1312fc2d-2a3a-4b3b-8549-9dcf427e3f05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1118f3d10>]}
[0m21:33:30.817680 [info ] [Thread-4 (]: 3 of 3 OK created sql table model JAFFLE_SHOP.my_second_dbt_model .............. [[32mSUCCESS 1[0m in 1.23s]
[0m21:33:30.818610 [debug] [Thread-4 (]: Finished running node model.jaffle_shop.my_second_dbt_model
[0m21:33:30.821312 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:33:30.821871 [debug] [MainThread]: Connection 'model.jaffle_shop.customers' was properly closed.
[0m21:33:30.822351 [debug] [MainThread]: Connection 'model.jaffle_shop.my_first_dbt_model' was properly closed.
[0m21:33:30.822812 [debug] [MainThread]: Connection 'model.jaffle_shop.my_second_dbt_model' was properly closed.
[0m21:33:30.823380 [info ] [MainThread]: 
[0m21:33:30.824022 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 4.11 seconds (4.11s).
[0m21:33:30.825668 [debug] [MainThread]: Command end result
[0m21:33:30.842429 [info ] [MainThread]: 
[0m21:33:30.843235 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:33:30.843815 [info ] [MainThread]: 
[0m21:33:30.844370 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m21:33:30.846115 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 7.025928, "process_user_time": 6.343103, "process_kernel_time": 0.527754, "process_mem_max_rss": "141049856", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m21:33:30.846933 [debug] [MainThread]: Command `dbt run` succeeded at 21:33:30.846732 after 7.03 seconds
[0m21:33:30.847661 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ef0fa90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c62fdd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1102a82d0>]}
[0m21:33:30.848294 [debug] [MainThread]: Flushing usage events
[0m21:35:27.077628 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bb3c950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bb0c2d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bb0f350>]}


============================== 21:35:27.089776 | 6b23603a-e14e-42de-9e1a-c7c6e77eeffb ==============================
[0m21:35:27.089776 [info ] [MainThread]: Running with dbt=1.7.8
[0m21:35:27.092134 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/ben/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/ben/jaffle_shop/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt run', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:35:27.727433 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6b23603a-e14e-42de-9e1a-c7c6e77eeffb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10be87850>]}
[0m21:35:27.893206 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6b23603a-e14e-42de-9e1a-c7c6e77eeffb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bbad9d0>]}
[0m21:35:27.894586 [info ] [MainThread]: Registered adapter: snowflake=1.7.2
[0m21:35:27.923067 [debug] [MainThread]: checksum: 67f0013ca5f0bd43af9a0873dd50792fde83ef69de63b71cacd0b4ac656c52e5, vars: {}, profile: , target: , version: 1.7.8
[0m21:35:27.979461 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m21:35:27.981075 [debug] [MainThread]: Partial parsing: updated file: jaffle_shop://models/customers.sql
[0m21:35:28.195942 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.example
[0m21:35:28.204373 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6b23603a-e14e-42de-9e1a-c7c6e77eeffb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c860910>]}
[0m21:35:28.224127 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6b23603a-e14e-42de-9e1a-c7c6e77eeffb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ca10f90>]}
[0m21:35:28.225171 [info ] [MainThread]: Found 3 models, 3 seeds, 4 tests, 0 sources, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m21:35:28.226194 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6b23603a-e14e-42de-9e1a-c7c6e77eeffb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c920b90>]}
[0m21:35:28.229550 [info ] [MainThread]: 
[0m21:35:28.231024 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m21:35:28.233581 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RAW'
[0m21:35:28.258649 [debug] [ThreadPool]: Using snowflake connection "list_RAW"
[0m21:35:28.259338 [debug] [ThreadPool]: On list_RAW: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_RAW"} */
show terse schemas in database RAW
    limit 10000
[0m21:35:28.259877 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:35:29.030982 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.0 seconds
[0m21:35:29.034622 [debug] [ThreadPool]: On list_RAW: Close
[0m21:35:29.163811 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RAW, now list_RAW_JAFFLE_SHOP)
[0m21:35:29.179094 [debug] [ThreadPool]: Using snowflake connection "list_RAW_JAFFLE_SHOP"
[0m21:35:29.179837 [debug] [ThreadPool]: On list_RAW_JAFFLE_SHOP: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_RAW_JAFFLE_SHOP"} */
show terse objects in RAW.JAFFLE_SHOP limit 10000
[0m21:35:29.180374 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:35:29.941665 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.0 seconds
[0m21:35:29.945256 [debug] [ThreadPool]: On list_RAW_JAFFLE_SHOP: Close
[0m21:35:30.066418 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6b23603a-e14e-42de-9e1a-c7c6e77eeffb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bf8b050>]}
[0m21:35:30.068494 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:35:30.069237 [info ] [MainThread]: 
[0m21:35:30.073331 [debug] [Thread-1 (]: Began running node model.jaffle_shop.customers
[0m21:35:30.074235 [info ] [Thread-1 (]: 1 of 3 START sql view model JAFFLE_SHOP.customers .............................. [RUN]
[0m21:35:30.075096 [debug] [Thread-2 (]: Began running node model.jaffle_shop.my_first_dbt_model
[0m21:35:30.076454 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_RAW_JAFFLE_SHOP, now model.jaffle_shop.customers)
[0m21:35:30.077262 [info ] [Thread-2 (]: 2 of 3 START sql table model JAFFLE_SHOP.my_first_dbt_model .................... [RUN]
[0m21:35:30.078452 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.customers
[0m21:35:30.079806 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.jaffle_shop.my_first_dbt_model'
[0m21:35:30.092393 [debug] [Thread-2 (]: Began compiling node model.jaffle_shop.my_first_dbt_model
[0m21:35:30.097717 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.customers"
[0m21:35:30.103962 [debug] [Thread-2 (]: Writing injected SQL for node "model.jaffle_shop.my_first_dbt_model"
[0m21:35:30.106136 [debug] [Thread-1 (]: Timing info for model.jaffle_shop.customers (compile): 21:35:30.080395 => 21:35:30.105638
[0m21:35:30.106949 [debug] [Thread-2 (]: Timing info for model.jaffle_shop.my_first_dbt_model (compile): 21:35:30.098413 => 21:35:30.106566
[0m21:35:30.107520 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.customers
[0m21:35:30.108106 [debug] [Thread-2 (]: Began executing node model.jaffle_shop.my_first_dbt_model
[0m21:35:30.173710 [debug] [Thread-1 (]: Dropping relation "RAW"."JAFFLE_SHOP"."CUSTOMERS" because it is of type table
[0m21:35:30.190954 [debug] [Thread-1 (]: Applying DROP to: "RAW"."JAFFLE_SHOP"."CUSTOMERS"
[0m21:35:30.216683 [debug] [Thread-1 (]: Using snowflake connection "model.jaffle_shop.customers"
[0m21:35:30.218358 [debug] [Thread-2 (]: Writing runtime sql for node "model.jaffle_shop.my_first_dbt_model"
[0m21:35:30.219115 [debug] [Thread-1 (]: On model.jaffle_shop.customers: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.customers"} */
drop table if exists "RAW"."JAFFLE_SHOP"."CUSTOMERS" cascade
[0m21:35:30.220060 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:35:30.223491 [debug] [Thread-2 (]: Using snowflake connection "model.jaffle_shop.my_first_dbt_model"
[0m21:35:30.224330 [debug] [Thread-2 (]: On model.jaffle_shop.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.my_first_dbt_model"} */
create or replace transient table RAW.JAFFLE_SHOP.my_first_dbt_model
         as
        (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
        );
[0m21:35:30.225478 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m21:35:30.628949 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m21:35:30.655232 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.customers"
[0m21:35:30.657984 [debug] [Thread-1 (]: Using snowflake connection "model.jaffle_shop.customers"
[0m21:35:30.658630 [debug] [Thread-1 (]: On model.jaffle_shop.customers: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.customers"} */
create or replace   view RAW.JAFFLE_SHOP.customers
  
   as (
    


with customers as (

    select
        id as customer_id,
        first_name,
        last_name

    from raw.jaffle_shop.raw_customers

),

orders as (

    select
        id as order_id,
        user_id as customer_id,
        order_date,
        status

    from raw.jaffle_shop.raw_orders

),

customer_orders as (

    select
        customer_id,

        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders

    from orders

    group by 1

),

final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce(customer_orders.number_of_orders, 0) as number_of_orders

    from customers

    left join customer_orders using (customer_id)

)

select * from final
  );
[0m21:35:30.796568 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m21:35:30.833587 [debug] [Thread-1 (]: Timing info for model.jaffle_shop.customers (execute): 21:35:30.108556 => 21:35:30.833222
[0m21:35:30.834301 [debug] [Thread-1 (]: On model.jaffle_shop.customers: Close
[0m21:35:30.875697 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m21:35:30.883686 [debug] [Thread-2 (]: Timing info for model.jaffle_shop.my_first_dbt_model (execute): 21:35:30.130585 => 21:35:30.883003
[0m21:35:30.884984 [debug] [Thread-2 (]: On model.jaffle_shop.my_first_dbt_model: Close
[0m21:35:30.965556 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6b23603a-e14e-42de-9e1a-c7c6e77eeffb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cc63c50>]}
[0m21:35:30.967191 [info ] [Thread-1 (]: 1 of 3 OK created sql view model JAFFLE_SHOP.customers ......................... [[32mSUCCESS 1[0m in 0.89s]
[0m21:35:30.968699 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.customers
[0m21:35:31.016774 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6b23603a-e14e-42de-9e1a-c7c6e77eeffb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ca05510>]}
[0m21:35:31.017890 [info ] [Thread-2 (]: 2 of 3 OK created sql table model JAFFLE_SHOP.my_first_dbt_model ............... [[32mSUCCESS 1[0m in 0.94s]
[0m21:35:31.018922 [debug] [Thread-2 (]: Finished running node model.jaffle_shop.my_first_dbt_model
[0m21:35:31.020155 [debug] [Thread-4 (]: Began running node model.jaffle_shop.my_second_dbt_model
[0m21:35:31.021010 [info ] [Thread-4 (]: 3 of 3 START sql table model JAFFLE_SHOP.my_second_dbt_model ................... [RUN]
[0m21:35:31.022348 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.jaffle_shop.my_second_dbt_model'
[0m21:35:31.022973 [debug] [Thread-4 (]: Began compiling node model.jaffle_shop.my_second_dbt_model
[0m21:35:31.027543 [debug] [Thread-4 (]: Writing injected SQL for node "model.jaffle_shop.my_second_dbt_model"
[0m21:35:31.028873 [debug] [Thread-4 (]: Timing info for model.jaffle_shop.my_second_dbt_model (compile): 21:35:31.023347 => 21:35:31.028466
[0m21:35:31.029576 [debug] [Thread-4 (]: Began executing node model.jaffle_shop.my_second_dbt_model
[0m21:35:31.037304 [debug] [Thread-4 (]: Writing runtime sql for node "model.jaffle_shop.my_second_dbt_model"
[0m21:35:31.039030 [debug] [Thread-4 (]: Using snowflake connection "model.jaffle_shop.my_second_dbt_model"
[0m21:35:31.039691 [debug] [Thread-4 (]: On model.jaffle_shop.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.my_second_dbt_model"} */
create or replace transient table RAW.JAFFLE_SHOP.my_second_dbt_model
         as
        (-- Use the `ref` function to select from other models

select *
from RAW.JAFFLE_SHOP.my_first_dbt_model
where id = 1
        );
[0m21:35:31.040283 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m21:35:31.684743 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m21:35:31.689418 [debug] [Thread-4 (]: Timing info for model.jaffle_shop.my_second_dbt_model (execute): 21:35:31.030226 => 21:35:31.689036
[0m21:35:31.690169 [debug] [Thread-4 (]: On model.jaffle_shop.my_second_dbt_model: Close
[0m21:35:31.837786 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6b23603a-e14e-42de-9e1a-c7c6e77eeffb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cc62690>]}
[0m21:35:31.839365 [info ] [Thread-4 (]: 3 of 3 OK created sql table model JAFFLE_SHOP.my_second_dbt_model .............. [[32mSUCCESS 1[0m in 0.82s]
[0m21:35:31.841125 [debug] [Thread-4 (]: Finished running node model.jaffle_shop.my_second_dbt_model
[0m21:35:31.845025 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:35:31.846076 [debug] [MainThread]: Connection 'model.jaffle_shop.customers' was properly closed.
[0m21:35:31.847196 [debug] [MainThread]: Connection 'model.jaffle_shop.my_first_dbt_model' was properly closed.
[0m21:35:31.848134 [debug] [MainThread]: Connection 'model.jaffle_shop.my_second_dbt_model' was properly closed.
[0m21:35:31.849327 [info ] [MainThread]: 
[0m21:35:31.850497 [info ] [MainThread]: Finished running 1 view model, 2 table models in 0 hours 0 minutes and 3.62 seconds (3.62s).
[0m21:35:31.853970 [debug] [MainThread]: Command end result
[0m21:35:31.872552 [info ] [MainThread]: 
[0m21:35:31.873713 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:35:31.874622 [info ] [MainThread]: 
[0m21:35:31.875819 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m21:35:31.879295 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 4.906561, "process_user_time": 4.752687, "process_kernel_time": 0.50398, "process_mem_max_rss": "139157504", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m21:35:31.880952 [debug] [MainThread]: Command `dbt run` succeeded at 21:35:31.880658 after 4.91 seconds
[0m21:35:31.881766 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10be90a10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b7fd50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c10ed0>]}
[0m21:35:31.882398 [debug] [MainThread]: Flushing usage events
[0m21:39:03.475772 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11335f8d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1135462d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1135464d0>]}


============================== 21:39:03.482490 | 1c3ad6d2-01ff-4a90-bca6-cfe0dcdeeaf6 ==============================
[0m21:39:03.482490 [info ] [MainThread]: Running with dbt=1.7.8
[0m21:39:03.483489 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/ben/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/ben/jaffle_shop/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m21:39:04.093274 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1c3ad6d2-01ff-4a90-bca6-cfe0dcdeeaf6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113942590>]}
[0m21:39:04.230547 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1c3ad6d2-01ff-4a90-bca6-cfe0dcdeeaf6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11396c1d0>]}
[0m21:39:04.231786 [info ] [MainThread]: Registered adapter: snowflake=1.7.2
[0m21:39:04.260578 [debug] [MainThread]: checksum: 67f0013ca5f0bd43af9a0873dd50792fde83ef69de63b71cacd0b4ac656c52e5, vars: {}, profile: , target: , version: 1.7.8
[0m21:39:04.281427 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m21:39:04.282537 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '1c3ad6d2-01ff-4a90-bca6-cfe0dcdeeaf6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11426ccd0>]}
[0m21:39:05.875888 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1c3ad6d2-01ff-4a90-bca6-cfe0dcdeeaf6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1146967d0>]}
[0m21:39:05.891568 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1c3ad6d2-01ff-4a90-bca6-cfe0dcdeeaf6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11474e750>]}
[0m21:39:05.892340 [info ] [MainThread]: Found 1 model, 3 seeds, 0 sources, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m21:39:05.892942 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1c3ad6d2-01ff-4a90-bca6-cfe0dcdeeaf6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11433de50>]}
[0m21:39:05.895264 [info ] [MainThread]: 
[0m21:39:05.896591 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m21:39:05.898278 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RAW'
[0m21:39:05.921909 [debug] [ThreadPool]: Using snowflake connection "list_RAW"
[0m21:39:05.922626 [debug] [ThreadPool]: On list_RAW: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_RAW"} */
show terse schemas in database RAW
    limit 10000
[0m21:39:05.923223 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:39:06.559232 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.0 seconds
[0m21:39:06.564030 [debug] [ThreadPool]: On list_RAW: Close
[0m21:39:06.688994 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RAW, now list_RAW_JAFFLE_SHOP)
[0m21:39:06.706053 [debug] [ThreadPool]: Using snowflake connection "list_RAW_JAFFLE_SHOP"
[0m21:39:06.706715 [debug] [ThreadPool]: On list_RAW_JAFFLE_SHOP: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_RAW_JAFFLE_SHOP"} */
show terse objects in RAW.JAFFLE_SHOP limit 10000
[0m21:39:06.707230 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:39:07.092956 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.0 seconds
[0m21:39:07.096605 [debug] [ThreadPool]: On list_RAW_JAFFLE_SHOP: Close
[0m21:39:07.220123 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1c3ad6d2-01ff-4a90-bca6-cfe0dcdeeaf6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114396890>]}
[0m21:39:07.221820 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:39:07.222545 [info ] [MainThread]: 
[0m21:39:07.226468 [debug] [Thread-1 (]: Began running node model.jaffle_shop.customers
[0m21:39:07.227457 [info ] [Thread-1 (]: 1 of 1 START sql view model JAFFLE_SHOP.customers .............................. [RUN]
[0m21:39:07.228991 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_RAW_JAFFLE_SHOP, now model.jaffle_shop.customers)
[0m21:39:07.229692 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.customers
[0m21:39:07.246318 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.customers"
[0m21:39:07.249015 [debug] [Thread-1 (]: Timing info for model.jaffle_shop.customers (compile): 21:39:07.230087 => 21:39:07.248418
[0m21:39:07.249803 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.customers
[0m21:39:07.310092 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.customers"
[0m21:39:07.313081 [debug] [Thread-1 (]: Using snowflake connection "model.jaffle_shop.customers"
[0m21:39:07.313814 [debug] [Thread-1 (]: On model.jaffle_shop.customers: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.customers"} */
create or replace   view RAW.JAFFLE_SHOP.customers
  
   as (
    


with customers as (

    select
        id as customer_id,
        first_name,
        last_name

    from raw.jaffle_shop.raw_customers

),

orders as (

    select
        id as order_id,
        user_id as customer_id,
        order_date,
        status

    from raw.jaffle_shop.raw_orders

),

customer_orders as (

    select
        customer_id,

        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders

    from orders

    group by 1

),

final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce(customer_orders.number_of_orders, 0) as number_of_orders

    from customers

    left join customer_orders using (customer_id)

)

select * from final
  );
[0m21:39:07.314446 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:39:08.118407 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m21:39:08.159660 [debug] [Thread-1 (]: Timing info for model.jaffle_shop.customers (execute): 21:39:07.250279 => 21:39:08.159297
[0m21:39:08.160395 [debug] [Thread-1 (]: On model.jaffle_shop.customers: Close
[0m21:39:08.280631 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1c3ad6d2-01ff-4a90-bca6-cfe0dcdeeaf6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1143d05d0>]}
[0m21:39:08.281976 [info ] [Thread-1 (]: 1 of 1 OK created sql view model JAFFLE_SHOP.customers ......................... [[32mSUCCESS 1[0m in 1.05s]
[0m21:39:08.283256 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.customers
[0m21:39:08.286324 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:39:08.286954 [debug] [MainThread]: Connection 'model.jaffle_shop.customers' was properly closed.
[0m21:39:08.287566 [info ] [MainThread]: 
[0m21:39:08.288503 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.39 seconds (2.39s).
[0m21:39:08.289805 [debug] [MainThread]: Command end result
[0m21:39:08.306186 [info ] [MainThread]: 
[0m21:39:08.306967 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:39:08.307510 [info ] [MainThread]: 
[0m21:39:08.308079 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m21:39:08.309865 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 4.919806, "process_user_time": 5.732798, "process_kernel_time": 0.475519, "process_mem_max_rss": "138924032", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m21:39:08.310738 [debug] [MainThread]: Command `dbt run` succeeded at 21:39:08.310532 after 4.92 seconds
[0m21:39:08.311578 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113619e90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113909d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f50e8d0>]}
[0m21:39:08.312226 [debug] [MainThread]: Flushing usage events
[0m22:11:11.234980 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fd38dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fa6a990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fa6a350>]}


============================== 22:11:11.243782 | 23317645-78c2-44fb-a565-d44662d80756 ==============================
[0m22:11:11.243782 [info ] [MainThread]: Running with dbt=1.7.8
[0m22:11:11.245284 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/ben/jaffle_shop/logs', 'profiles_dir': '/Users/ben/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m22:11:12.010008 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '23317645-78c2-44fb-a565-d44662d80756', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110922790>]}
[0m22:11:12.141416 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '23317645-78c2-44fb-a565-d44662d80756', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110911910>]}
[0m22:11:12.144248 [info ] [MainThread]: Registered adapter: snowflake=1.7.2
[0m22:11:12.174287 [debug] [MainThread]: checksum: 67f0013ca5f0bd43af9a0873dd50792fde83ef69de63b71cacd0b4ac656c52e5, vars: {}, profile: , target: , version: 1.7.8
[0m22:11:12.277670 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 2 files added, 1 files changed.
[0m22:11:12.278587 [debug] [MainThread]: Partial parsing: added file: jaffle_shop://models/stg_orders.sql
[0m22:11:12.279280 [debug] [MainThread]: Partial parsing: added file: jaffle_shop://models/stg_customers.sql
[0m22:11:12.279974 [debug] [MainThread]: Partial parsing: updated file: jaffle_shop://models/customers.sql
[0m22:11:12.500264 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '23317645-78c2-44fb-a565-d44662d80756', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110d13f90>]}
[0m22:11:12.517040 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '23317645-78c2-44fb-a565-d44662d80756', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110bdea10>]}
[0m22:11:12.517843 [info ] [MainThread]: Found 3 seeds, 3 models, 0 sources, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m22:11:12.518480 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '23317645-78c2-44fb-a565-d44662d80756', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110a891d0>]}
[0m22:11:12.521604 [info ] [MainThread]: 
[0m22:11:12.523222 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m22:11:12.525802 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RAW'
[0m22:11:12.565342 [debug] [ThreadPool]: Using snowflake connection "list_RAW"
[0m22:11:12.566070 [debug] [ThreadPool]: On list_RAW: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_RAW"} */
show terse schemas in database RAW
    limit 10000
[0m22:11:12.566643 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:11:13.231239 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.0 seconds
[0m22:11:13.236392 [debug] [ThreadPool]: On list_RAW: Close
[0m22:11:13.392925 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RAW, now list_RAW_JAFFLE_SHOP)
[0m22:11:13.410450 [debug] [ThreadPool]: Using snowflake connection "list_RAW_JAFFLE_SHOP"
[0m22:11:13.411192 [debug] [ThreadPool]: On list_RAW_JAFFLE_SHOP: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_RAW_JAFFLE_SHOP"} */
show terse objects in RAW.JAFFLE_SHOP limit 10000
[0m22:11:13.411791 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:11:13.943920 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.0 seconds
[0m22:11:13.946524 [debug] [ThreadPool]: On list_RAW_JAFFLE_SHOP: Close
[0m22:11:14.074387 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '23317645-78c2-44fb-a565-d44662d80756', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110a3b050>]}
[0m22:11:14.076880 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:11:14.078237 [info ] [MainThread]: 
[0m22:11:14.084458 [debug] [Thread-1 (]: Began running node model.jaffle_shop.stg_customers
[0m22:11:14.085575 [debug] [Thread-2 (]: Began running node model.jaffle_shop.stg_orders
[0m22:11:14.086470 [info ] [Thread-1 (]: 1 of 3 START sql table model JAFFLE_SHOP.stg_customers ......................... [RUN]
[0m22:11:14.087440 [info ] [Thread-2 (]: 2 of 3 START sql table model JAFFLE_SHOP.stg_orders ............................ [RUN]
[0m22:11:14.088766 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_RAW_JAFFLE_SHOP, now model.jaffle_shop.stg_customers)
[0m22:11:14.090002 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.jaffle_shop.stg_orders'
[0m22:11:14.091245 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.stg_customers
[0m22:11:14.093195 [debug] [Thread-2 (]: Began compiling node model.jaffle_shop.stg_orders
[0m22:11:14.113825 [debug] [Thread-2 (]: Writing injected SQL for node "model.jaffle_shop.stg_orders"
[0m22:11:14.116814 [debug] [Thread-2 (]: Timing info for model.jaffle_shop.stg_orders (compile): 22:11:14.109208 => 22:11:14.114972
[0m22:11:14.118090 [debug] [Thread-2 (]: Began executing node model.jaffle_shop.stg_orders
[0m22:11:14.143208 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.stg_customers"
[0m22:11:14.149124 [debug] [Thread-1 (]: Timing info for model.jaffle_shop.stg_customers (compile): 22:11:14.094395 => 22:11:14.148187
[0m22:11:14.156716 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.stg_customers
[0m22:11:14.235289 [debug] [Thread-2 (]: Writing runtime sql for node "model.jaffle_shop.stg_orders"
[0m22:11:14.236630 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.stg_customers"
[0m22:11:14.238698 [debug] [Thread-2 (]: Using snowflake connection "model.jaffle_shop.stg_orders"
[0m22:11:14.239581 [debug] [Thread-2 (]: On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */
create or replace transient table RAW.JAFFLE_SHOP.stg_orders
         as
        (select
        id as order_id,
        user_id as customer_id,
        order_date,
        status

    from raw.jaffle_shop.raw_orders
        );
[0m22:11:14.240814 [debug] [Thread-1 (]: Using snowflake connection "model.jaffle_shop.stg_customers"
[0m22:11:14.241489 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m22:11:14.242257 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */
create or replace transient table RAW.JAFFLE_SHOP.stg_customers
         as
        (select
        id as customer_id,
        first_name,
        last_name

    from raw.jaffle_shop.raw_customers
        );
[0m22:11:14.243842 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:11:15.348402 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m22:11:15.386886 [debug] [Thread-2 (]: Timing info for model.jaffle_shop.stg_orders (execute): 22:11:14.118919 => 22:11:15.386489
[0m22:11:15.387586 [debug] [Thread-2 (]: On model.jaffle_shop.stg_orders: Close
[0m22:11:15.499174 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '23317645-78c2-44fb-a565-d44662d80756', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110e5b990>]}
[0m22:11:15.500262 [info ] [Thread-2 (]: 2 of 3 OK created sql table model JAFFLE_SHOP.stg_orders ....................... [[32mSUCCESS 1[0m in 1.41s]
[0m22:11:15.501234 [debug] [Thread-2 (]: Finished running node model.jaffle_shop.stg_orders
[0m22:11:15.545206 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m22:11:15.549239 [debug] [Thread-1 (]: Timing info for model.jaffle_shop.stg_customers (execute): 22:11:14.169637 => 22:11:15.548899
[0m22:11:15.549888 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: Close
[0m22:11:15.669981 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '23317645-78c2-44fb-a565-d44662d80756', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110e2f3d0>]}
[0m22:11:15.671502 [info ] [Thread-1 (]: 1 of 3 OK created sql table model JAFFLE_SHOP.stg_customers .................... [[32mSUCCESS 1[0m in 1.58s]
[0m22:11:15.672996 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.stg_customers
[0m22:11:15.674868 [debug] [Thread-4 (]: Began running node model.jaffle_shop.customers
[0m22:11:15.676088 [info ] [Thread-4 (]: 3 of 3 START sql view model JAFFLE_SHOP.customers .............................. [RUN]
[0m22:11:15.678266 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.jaffle_shop.customers'
[0m22:11:15.679210 [debug] [Thread-4 (]: Began compiling node model.jaffle_shop.customers
[0m22:11:15.685511 [debug] [Thread-4 (]: Writing injected SQL for node "model.jaffle_shop.customers"
[0m22:11:15.686879 [debug] [Thread-4 (]: Timing info for model.jaffle_shop.customers (compile): 22:11:15.679721 => 22:11:15.686464
[0m22:11:15.687542 [debug] [Thread-4 (]: Began executing node model.jaffle_shop.customers
[0m22:11:15.724940 [debug] [Thread-4 (]: Writing runtime sql for node "model.jaffle_shop.customers"
[0m22:11:15.727850 [debug] [Thread-4 (]: Using snowflake connection "model.jaffle_shop.customers"
[0m22:11:15.728667 [debug] [Thread-4 (]: On model.jaffle_shop.customers: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.customers"} */
create or replace   view RAW.JAFFLE_SHOP.customers
  
   as (
    


with customers as (

    select * from RAW.JAFFLE_SHOP.stg_customers

),

orders as (

    select * from RAW.JAFFLE_SHOP.stg_orders

),

customer_orders as (

    select
        customer_id,

        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders

    from orders

    group by 1

),

final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce(customer_orders.number_of_orders, 0) as number_of_orders

    from customers

    left join customer_orders using (customer_id)

)

select * from final
  );
[0m22:11:15.729290 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m22:11:16.190657 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m22:11:16.204660 [debug] [Thread-4 (]: Timing info for model.jaffle_shop.customers (execute): 22:11:15.687925 => 22:11:16.204188
[0m22:11:16.205792 [debug] [Thread-4 (]: On model.jaffle_shop.customers: Close
[0m22:11:16.328507 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '23317645-78c2-44fb-a565-d44662d80756', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110b97a90>]}
[0m22:11:16.330052 [info ] [Thread-4 (]: 3 of 3 OK created sql view model JAFFLE_SHOP.customers ......................... [[32mSUCCESS 1[0m in 0.65s]
[0m22:11:16.331796 [debug] [Thread-4 (]: Finished running node model.jaffle_shop.customers
[0m22:11:16.335515 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:11:16.336242 [debug] [MainThread]: Connection 'model.jaffle_shop.stg_customers' was properly closed.
[0m22:11:16.337027 [debug] [MainThread]: Connection 'model.jaffle_shop.stg_orders' was properly closed.
[0m22:11:16.337956 [debug] [MainThread]: Connection 'model.jaffle_shop.customers' was properly closed.
[0m22:11:16.339246 [info ] [MainThread]: 
[0m22:11:16.340012 [info ] [MainThread]: Finished running 2 table models, 1 view model in 0 hours 0 minutes and 3.82 seconds (3.82s).
[0m22:11:16.341616 [debug] [MainThread]: Command end result
[0m22:11:16.353956 [info ] [MainThread]: 
[0m22:11:16.355337 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:11:16.356100 [info ] [MainThread]: 
[0m22:11:16.356771 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m22:11:16.360183 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 5.214398, "process_user_time": 4.667575, "process_kernel_time": 0.631508, "process_mem_max_rss": "137994240", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m22:11:16.361511 [debug] [MainThread]: Command `dbt run` succeeded at 22:11:16.361210 after 5.22 seconds
[0m22:11:16.362819 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fb1d2d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fcfc810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bd5bd90>]}
[0m22:11:16.363633 [debug] [MainThread]: Flushing usage events
[0m22:14:17.184789 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1090cdf10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d69890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d81490>]}


============================== 22:14:17.193214 | 928896c1-58cb-4f20-b5b0-97318c4c1137 ==============================
[0m22:14:17.193214 [info ] [MainThread]: Running with dbt=1.7.8
[0m22:14:17.194252 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/Users/ben/.dbt', 'log_path': '/Users/ben/jaffle_shop/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m22:14:17.923482 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '928896c1-58cb-4f20-b5b0-97318c4c1137', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10985b210>]}
[0m22:14:18.057156 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '928896c1-58cb-4f20-b5b0-97318c4c1137', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1097dce90>]}
[0m22:14:18.058709 [info ] [MainThread]: Registered adapter: snowflake=1.7.2
[0m22:14:18.087953 [debug] [MainThread]: checksum: 67f0013ca5f0bd43af9a0873dd50792fde83ef69de63b71cacd0b4ac656c52e5, vars: {}, profile: , target: , version: 1.7.8
[0m22:14:18.106653 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m22:14:18.107518 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '928896c1-58cb-4f20-b5b0-97318c4c1137', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109c4b650>]}
[0m22:14:19.778527 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.staging
[0m22:14:19.786256 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '928896c1-58cb-4f20-b5b0-97318c4c1137', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109bc9f10>]}
[0m22:14:19.804594 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '928896c1-58cb-4f20-b5b0-97318c4c1137', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109d2b490>]}
[0m22:14:19.805370 [info ] [MainThread]: Found 3 models, 3 seeds, 0 sources, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m22:14:19.806253 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '928896c1-58cb-4f20-b5b0-97318c4c1137', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109de6950>]}
[0m22:14:19.809289 [info ] [MainThread]: 
[0m22:14:19.810600 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m22:14:19.812789 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RAW'
[0m22:14:19.837055 [debug] [ThreadPool]: Using snowflake connection "list_RAW"
[0m22:14:19.838021 [debug] [ThreadPool]: On list_RAW: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_RAW"} */
show terse schemas in database RAW
    limit 10000
[0m22:14:19.838631 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:14:21.104470 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.0 seconds
[0m22:14:21.107986 [debug] [ThreadPool]: On list_RAW: Close
[0m22:14:21.234003 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RAW, now list_RAW_JAFFLE_SHOP)
[0m22:14:21.250359 [debug] [ThreadPool]: Using snowflake connection "list_RAW_JAFFLE_SHOP"
[0m22:14:21.251027 [debug] [ThreadPool]: On list_RAW_JAFFLE_SHOP: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_RAW_JAFFLE_SHOP"} */
show terse objects in RAW.JAFFLE_SHOP limit 10000
[0m22:14:21.251699 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:14:21.635959 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 0.0 seconds
[0m22:14:21.640383 [debug] [ThreadPool]: On list_RAW_JAFFLE_SHOP: Close
[0m22:14:21.783039 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '928896c1-58cb-4f20-b5b0-97318c4c1137', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109e5dd50>]}
[0m22:14:21.785100 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:14:21.786237 [info ] [MainThread]: 
[0m22:14:21.792908 [debug] [Thread-1 (]: Began running node model.jaffle_shop.stg_customers
[0m22:14:21.794096 [info ] [Thread-1 (]: 1 of 3 START sql table model JAFFLE_SHOP.stg_customers ......................... [RUN]
[0m22:14:21.795229 [debug] [Thread-2 (]: Began running node model.jaffle_shop.stg_orders
[0m22:14:21.796789 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_RAW_JAFFLE_SHOP, now model.jaffle_shop.stg_customers)
[0m22:14:21.797700 [info ] [Thread-2 (]: 2 of 3 START sql table model JAFFLE_SHOP.stg_orders ............................ [RUN]
[0m22:14:21.798725 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.stg_customers
[0m22:14:21.800741 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.jaffle_shop.stg_orders'
[0m22:14:21.810290 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.stg_customers"
[0m22:14:21.811251 [debug] [Thread-2 (]: Began compiling node model.jaffle_shop.stg_orders
[0m22:14:21.815299 [debug] [Thread-2 (]: Writing injected SQL for node "model.jaffle_shop.stg_orders"
[0m22:14:21.820648 [debug] [Thread-1 (]: Timing info for model.jaffle_shop.stg_customers (compile): 22:14:21.801458 => 22:14:21.819395
[0m22:14:21.821598 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.stg_customers
[0m22:14:21.822391 [debug] [Thread-2 (]: Timing info for model.jaffle_shop.stg_orders (compile): 22:14:21.812533 => 22:14:21.822002
[0m22:14:21.845140 [debug] [Thread-2 (]: Began executing node model.jaffle_shop.stg_orders
[0m22:14:21.895454 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.stg_customers"
[0m22:14:21.899205 [debug] [Thread-2 (]: Writing runtime sql for node "model.jaffle_shop.stg_orders"
[0m22:14:21.901056 [debug] [Thread-2 (]: Using snowflake connection "model.jaffle_shop.stg_orders"
[0m22:14:21.902140 [debug] [Thread-1 (]: Using snowflake connection "model.jaffle_shop.stg_customers"
[0m22:14:21.902813 [debug] [Thread-2 (]: On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */
create or replace transient table RAW.JAFFLE_SHOP.stg_orders
         as
        (select
        id as order_id,
        user_id as customer_id,
        order_date,
        status

    from raw.jaffle_shop.raw_orders
        );
[0m22:14:21.903646 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */
create or replace transient table RAW.JAFFLE_SHOP.stg_customers
         as
        (select
        id as customer_id,
        first_name,
        last_name

    from raw.jaffle_shop.raw_customers
        );
[0m22:14:21.904396 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m22:14:21.905287 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:14:22.741499 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m22:14:22.742739 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m22:14:22.786988 [debug] [Thread-2 (]: Timing info for model.jaffle_shop.stg_orders (execute): 22:14:21.852057 => 22:14:22.786576
[0m22:14:22.789275 [debug] [Thread-1 (]: Timing info for model.jaffle_shop.stg_customers (execute): 22:14:21.822732 => 22:14:22.788954
[0m22:14:22.789958 [debug] [Thread-2 (]: On model.jaffle_shop.stg_orders: Close
[0m22:14:22.790575 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: Close
[0m22:14:22.930956 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '928896c1-58cb-4f20-b5b0-97318c4c1137', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109f9d750>]}
[0m22:14:22.932977 [info ] [Thread-2 (]: 2 of 3 OK created sql table model JAFFLE_SHOP.stg_orders ....................... [[32mSUCCESS 1[0m in 1.13s]
[0m22:14:22.934713 [debug] [Thread-2 (]: Finished running node model.jaffle_shop.stg_orders
[0m22:14:22.988324 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '928896c1-58cb-4f20-b5b0-97318c4c1137', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109c4ee50>]}
[0m22:14:22.989436 [info ] [Thread-1 (]: 1 of 3 OK created sql table model JAFFLE_SHOP.stg_customers .................... [[32mSUCCESS 1[0m in 1.19s]
[0m22:14:22.990521 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.stg_customers
[0m22:14:22.991718 [debug] [Thread-4 (]: Began running node model.jaffle_shop.customers
[0m22:14:22.993142 [info ] [Thread-4 (]: 3 of 3 START sql view model JAFFLE_SHOP.customers .............................. [RUN]
[0m22:14:22.995027 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.jaffle_shop.customers'
[0m22:14:23.012896 [debug] [Thread-4 (]: Began compiling node model.jaffle_shop.customers
[0m22:14:23.018024 [debug] [Thread-4 (]: Writing injected SQL for node "model.jaffle_shop.customers"
[0m22:14:23.019342 [debug] [Thread-4 (]: Timing info for model.jaffle_shop.customers (compile): 22:14:23.013414 => 22:14:23.018967
[0m22:14:23.019967 [debug] [Thread-4 (]: Began executing node model.jaffle_shop.customers
[0m22:14:23.059772 [debug] [Thread-4 (]: Writing runtime sql for node "model.jaffle_shop.customers"
[0m22:14:23.063652 [debug] [Thread-4 (]: Using snowflake connection "model.jaffle_shop.customers"
[0m22:14:23.064935 [debug] [Thread-4 (]: On model.jaffle_shop.customers: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.customers"} */
create or replace   view RAW.JAFFLE_SHOP.customers
  
   as (
    


with customers as (

    select * from RAW.JAFFLE_SHOP.stg_customers

),

orders as (

    select * from RAW.JAFFLE_SHOP.stg_orders

),

customer_orders as (

    select
        customer_id,

        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders

    from orders

    group by 1

),

final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce(customer_orders.number_of_orders, 0) as number_of_orders

    from customers

    left join customer_orders using (customer_id)

)

select * from final
  );
[0m22:14:23.065868 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m22:14:23.944716 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m22:14:23.953446 [debug] [Thread-4 (]: Timing info for model.jaffle_shop.customers (execute): 22:14:23.020662 => 22:14:23.952889
[0m22:14:23.954477 [debug] [Thread-4 (]: On model.jaffle_shop.customers: Close
[0m22:14:24.084301 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '928896c1-58cb-4f20-b5b0-97318c4c1137', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109faf290>]}
[0m22:14:24.085838 [info ] [Thread-4 (]: 3 of 3 OK created sql view model JAFFLE_SHOP.customers ......................... [[32mSUCCESS 1[0m in 1.09s]
[0m22:14:24.087142 [debug] [Thread-4 (]: Finished running node model.jaffle_shop.customers
[0m22:14:24.090081 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:14:24.090691 [debug] [MainThread]: Connection 'model.jaffle_shop.stg_customers' was properly closed.
[0m22:14:24.091243 [debug] [MainThread]: Connection 'model.jaffle_shop.stg_orders' was properly closed.
[0m22:14:24.091774 [debug] [MainThread]: Connection 'model.jaffle_shop.customers' was properly closed.
[0m22:14:24.092658 [info ] [MainThread]: 
[0m22:14:24.093555 [info ] [MainThread]: Finished running 2 table models, 1 view model in 0 hours 0 minutes and 4.28 seconds (4.28s).
[0m22:14:24.094993 [debug] [MainThread]: Command end result
[0m22:14:24.107295 [info ] [MainThread]: 
[0m22:14:24.108136 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:14:24.108711 [info ] [MainThread]: 
[0m22:14:24.109284 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m22:14:24.112879 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 7.0138745, "process_user_time": 5.87618, "process_kernel_time": 0.62858, "process_mem_max_rss": "139296768", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m22:14:24.114506 [debug] [MainThread]: Command `dbt run` succeeded at 22:14:24.114116 after 7.02 seconds
[0m22:14:24.115806 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109123950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109d30810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f21090>]}
[0m22:14:24.116928 [debug] [MainThread]: Flushing usage events
[0m22:15:35.253188 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105be4710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105be48d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106487890>]}


============================== 22:15:35.259046 | 4b684fbd-85cc-4bfc-a08e-0407581c5339 ==============================
[0m22:15:35.259046 [info ] [MainThread]: Running with dbt=1.7.8
[0m22:15:35.260097 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/ben/jaffle_shop/logs', 'profiles_dir': '/Users/ben/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt run', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:15:35.803790 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4b684fbd-85cc-4bfc-a08e-0407581c5339', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10664a5d0>]}
[0m22:15:35.934736 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4b684fbd-85cc-4bfc-a08e-0407581c5339', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10667c550>]}
[0m22:15:35.935974 [info ] [MainThread]: Registered adapter: snowflake=1.7.2
[0m22:15:35.963577 [debug] [MainThread]: checksum: 67f0013ca5f0bd43af9a0873dd50792fde83ef69de63b71cacd0b4ac656c52e5, vars: {}, profile: , target: , version: 1.7.8
[0m22:15:35.980086 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m22:15:35.981158 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '4b684fbd-85cc-4bfc-a08e-0407581c5339', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10708a2d0>]}
[0m22:15:37.461858 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4b684fbd-85cc-4bfc-a08e-0407581c5339', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107202390>]}
[0m22:15:37.477002 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4b684fbd-85cc-4bfc-a08e-0407581c5339', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107486bd0>]}
[0m22:15:37.477819 [info ] [MainThread]: Found 3 models, 3 seeds, 0 sources, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m22:15:37.478425 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4b684fbd-85cc-4bfc-a08e-0407581c5339', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107088950>]}
[0m22:15:37.481269 [info ] [MainThread]: 
[0m22:15:37.482540 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m22:15:37.484664 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RAW'
[0m22:15:37.507158 [debug] [ThreadPool]: Using snowflake connection "list_RAW"
[0m22:15:37.507837 [debug] [ThreadPool]: On list_RAW: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_RAW"} */
show terse schemas in database RAW
    limit 10000
[0m22:15:37.508375 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:15:38.270368 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.0 seconds
[0m22:15:38.274451 [debug] [ThreadPool]: On list_RAW: Close
[0m22:15:38.399550 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RAW, now list_RAW_JAFFLE_SHOP)
[0m22:15:38.414663 [debug] [ThreadPool]: Using snowflake connection "list_RAW_JAFFLE_SHOP"
[0m22:15:38.415350 [debug] [ThreadPool]: On list_RAW_JAFFLE_SHOP: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_RAW_JAFFLE_SHOP"} */
show terse objects in RAW.JAFFLE_SHOP limit 10000
[0m22:15:38.415866 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:15:38.955644 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 1.0 seconds
[0m22:15:38.961213 [debug] [ThreadPool]: On list_RAW_JAFFLE_SHOP: Close
[0m22:15:39.089561 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4b684fbd-85cc-4bfc-a08e-0407581c5339', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10706f9d0>]}
[0m22:15:39.091624 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:15:39.092544 [info ] [MainThread]: 
[0m22:15:39.097545 [debug] [Thread-1 (]: Began running node model.jaffle_shop.stg_customers
[0m22:15:39.098617 [debug] [Thread-2 (]: Began running node model.jaffle_shop.stg_orders
[0m22:15:39.100315 [info ] [Thread-1 (]: 1 of 3 START sql view model JAFFLE_SHOP.stg_customers .......................... [RUN]
[0m22:15:39.101513 [info ] [Thread-2 (]: 2 of 3 START sql view model JAFFLE_SHOP.stg_orders ............................. [RUN]
[0m22:15:39.102872 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_RAW_JAFFLE_SHOP, now model.jaffle_shop.stg_customers)
[0m22:15:39.104103 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.jaffle_shop.stg_orders'
[0m22:15:39.104976 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.stg_customers
[0m22:15:39.106559 [debug] [Thread-2 (]: Began compiling node model.jaffle_shop.stg_orders
[0m22:15:39.117270 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.stg_customers"
[0m22:15:39.122171 [debug] [Thread-2 (]: Writing injected SQL for node "model.jaffle_shop.stg_orders"
[0m22:15:39.123962 [debug] [Thread-1 (]: Timing info for model.jaffle_shop.stg_customers (compile): 22:15:39.107944 => 22:15:39.123448
[0m22:15:39.124806 [debug] [Thread-2 (]: Timing info for model.jaffle_shop.stg_orders (compile): 22:15:39.117907 => 22:15:39.124385
[0m22:15:39.125550 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.stg_customers
[0m22:15:39.126174 [debug] [Thread-2 (]: Began executing node model.jaffle_shop.stg_orders
[0m22:15:39.188442 [debug] [Thread-1 (]: Dropping relation "RAW"."JAFFLE_SHOP"."STG_CUSTOMERS" because it is of type table
[0m22:15:39.191305 [debug] [Thread-2 (]: Dropping relation "RAW"."JAFFLE_SHOP"."STG_ORDERS" because it is of type table
[0m22:15:39.201666 [debug] [Thread-1 (]: Applying DROP to: "RAW"."JAFFLE_SHOP"."STG_CUSTOMERS"
[0m22:15:39.205770 [debug] [Thread-2 (]: Applying DROP to: "RAW"."JAFFLE_SHOP"."STG_ORDERS"
[0m22:15:39.216347 [debug] [Thread-1 (]: Using snowflake connection "model.jaffle_shop.stg_customers"
[0m22:15:39.218275 [debug] [Thread-2 (]: Using snowflake connection "model.jaffle_shop.stg_orders"
[0m22:15:39.219072 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */
drop table if exists "RAW"."JAFFLE_SHOP"."STG_CUSTOMERS" cascade
[0m22:15:39.219687 [debug] [Thread-2 (]: On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */
drop table if exists "RAW"."JAFFLE_SHOP"."STG_ORDERS" cascade
[0m22:15:39.220269 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:15:39.220816 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m22:15:39.646619 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m22:15:39.673091 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m22:15:39.674212 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.stg_customers"
[0m22:15:39.677019 [debug] [Thread-2 (]: Writing runtime sql for node "model.jaffle_shop.stg_orders"
[0m22:15:39.678679 [debug] [Thread-2 (]: Using snowflake connection "model.jaffle_shop.stg_orders"
[0m22:15:39.679683 [debug] [Thread-1 (]: Using snowflake connection "model.jaffle_shop.stg_customers"
[0m22:15:39.680326 [debug] [Thread-2 (]: On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */
create or replace   view RAW.JAFFLE_SHOP.stg_orders
  
   as (
    select
        id as order_id,
        user_id as customer_id,
        order_date,
        status

    from raw.jaffle_shop.raw_orders
  );
[0m22:15:39.680987 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */
create or replace   view RAW.JAFFLE_SHOP.stg_customers
  
   as (
    select
        id as customer_id,
        first_name,
        last_name

    from raw.jaffle_shop.raw_customers
  );
[0m22:15:39.811411 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m22:15:39.849363 [debug] [Thread-2 (]: Timing info for model.jaffle_shop.stg_orders (execute): 22:15:39.143669 => 22:15:39.848890
[0m22:15:39.850896 [debug] [Thread-2 (]: On model.jaffle_shop.stg_orders: Close
[0m22:15:39.875319 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m22:15:39.878928 [debug] [Thread-1 (]: Timing info for model.jaffle_shop.stg_customers (execute): 22:15:39.126558 => 22:15:39.878598
[0m22:15:39.879561 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: Close
[0m22:15:39.976391 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4b684fbd-85cc-4bfc-a08e-0407581c5339', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10742ac90>]}
[0m22:15:39.978019 [info ] [Thread-2 (]: 2 of 3 OK created sql view model JAFFLE_SHOP.stg_orders ........................ [[32mSUCCESS 1[0m in 0.87s]
[0m22:15:39.979551 [debug] [Thread-2 (]: Finished running node model.jaffle_shop.stg_orders
[0m22:15:39.994430 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4b684fbd-85cc-4bfc-a08e-0407581c5339', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10732af10>]}
[0m22:15:39.996635 [info ] [Thread-1 (]: 1 of 3 OK created sql view model JAFFLE_SHOP.stg_customers ..................... [[32mSUCCESS 1[0m in 0.89s]
[0m22:15:39.998708 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.stg_customers
[0m22:15:40.000006 [debug] [Thread-4 (]: Began running node model.jaffle_shop.customers
[0m22:15:40.001413 [info ] [Thread-4 (]: 3 of 3 START sql view model JAFFLE_SHOP.customers .............................. [RUN]
[0m22:15:40.003256 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.jaffle_shop.customers'
[0m22:15:40.004453 [debug] [Thread-4 (]: Began compiling node model.jaffle_shop.customers
[0m22:15:40.011281 [debug] [Thread-4 (]: Writing injected SQL for node "model.jaffle_shop.customers"
[0m22:15:40.012990 [debug] [Thread-4 (]: Timing info for model.jaffle_shop.customers (compile): 22:15:40.004896 => 22:15:40.012445
[0m22:15:40.014210 [debug] [Thread-4 (]: Began executing node model.jaffle_shop.customers
[0m22:15:40.019600 [debug] [Thread-4 (]: Writing runtime sql for node "model.jaffle_shop.customers"
[0m22:15:40.021984 [debug] [Thread-4 (]: Using snowflake connection "model.jaffle_shop.customers"
[0m22:15:40.022672 [debug] [Thread-4 (]: On model.jaffle_shop.customers: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.customers"} */
create or replace   view RAW.JAFFLE_SHOP.customers
  
   as (
    


with customers as (

    select * from RAW.JAFFLE_SHOP.stg_customers

),

orders as (

    select * from RAW.JAFFLE_SHOP.stg_orders

),

customer_orders as (

    select
        customer_id,

        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders

    from orders

    group by 1

),

final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce(customer_orders.number_of_orders, 0) as number_of_orders

    from customers

    left join customer_orders using (customer_id)

)

select * from final
  );
[0m22:15:40.023287 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m22:15:40.481644 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m22:15:40.490861 [debug] [Thread-4 (]: Timing info for model.jaffle_shop.customers (execute): 22:15:40.014784 => 22:15:40.490467
[0m22:15:40.491773 [debug] [Thread-4 (]: On model.jaffle_shop.customers: Close
[0m22:15:40.742203 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4b684fbd-85cc-4bfc-a08e-0407581c5339', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1075636d0>]}
[0m22:15:40.743880 [info ] [Thread-4 (]: 3 of 3 OK created sql view model JAFFLE_SHOP.customers ......................... [[32mSUCCESS 1[0m in 0.74s]
[0m22:15:40.745700 [debug] [Thread-4 (]: Finished running node model.jaffle_shop.customers
[0m22:15:40.749405 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:15:40.750136 [debug] [MainThread]: Connection 'model.jaffle_shop.stg_customers' was properly closed.
[0m22:15:40.750806 [debug] [MainThread]: Connection 'model.jaffle_shop.stg_orders' was properly closed.
[0m22:15:40.751462 [debug] [MainThread]: Connection 'model.jaffle_shop.customers' was properly closed.
[0m22:15:40.752208 [info ] [MainThread]: 
[0m22:15:40.752949 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 3.27 seconds (3.27s).
[0m22:15:40.754538 [debug] [MainThread]: Command end result
[0m22:15:40.771901 [info ] [MainThread]: 
[0m22:15:40.772613 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:15:40.773153 [info ] [MainThread]: 
[0m22:15:40.773717 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m22:15:40.775611 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 5.60529, "process_user_time": 5.639551, "process_kernel_time": 0.451393, "process_mem_max_rss": "139210752", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m22:15:40.777155 [debug] [MainThread]: Command `dbt run` succeeded at 22:15:40.776738 after 5.61 seconds
[0m22:15:40.778065 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063e3750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1022e4150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10236bc50>]}
[0m22:15:40.779130 [debug] [MainThread]: Flushing usage events
[0m22:17:38.822665 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112016590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111fdb490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111fda390>]}


============================== 22:17:38.829789 | 5a30c26f-1ba4-4078-a5d9-c202da1a507d ==============================
[0m22:17:38.829789 [info ] [MainThread]: Running with dbt=1.7.8
[0m22:17:38.830737 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/ben/jaffle_shop/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/ben/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m22:17:39.412439 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5a30c26f-1ba4-4078-a5d9-c202da1a507d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112763a90>]}
[0m22:17:39.542000 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5a30c26f-1ba4-4078-a5d9-c202da1a507d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1128e4910>]}
[0m22:17:39.543394 [info ] [MainThread]: Registered adapter: snowflake=1.7.2
[0m22:17:39.569392 [debug] [MainThread]: checksum: 67f0013ca5f0bd43af9a0873dd50792fde83ef69de63b71cacd0b4ac656c52e5, vars: {}, profile: , target: , version: 1.7.8
[0m22:17:39.619936 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m22:17:39.620983 [debug] [MainThread]: Partial parsing: updated file: jaffle_shop://models/staging/stg_orders.sql
[0m22:17:39.621678 [debug] [MainThread]: Partial parsing: updated file: jaffle_shop://models/staging/stg_customers.sql
[0m22:17:39.834518 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5a30c26f-1ba4-4078-a5d9-c202da1a507d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112b0bb90>]}
[0m22:17:39.851000 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5a30c26f-1ba4-4078-a5d9-c202da1a507d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112a58190>]}
[0m22:17:39.851874 [info ] [MainThread]: Found 3 models, 3 seeds, 0 sources, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m22:17:39.852516 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5a30c26f-1ba4-4078-a5d9-c202da1a507d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112957310>]}
[0m22:17:39.855158 [info ] [MainThread]: 
[0m22:17:39.856601 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m22:17:39.858385 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RAW'
[0m22:17:39.880837 [debug] [ThreadPool]: Using snowflake connection "list_RAW"
[0m22:17:39.881695 [debug] [ThreadPool]: On list_RAW: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_RAW"} */
show terse schemas in database RAW
    limit 10000
[0m22:17:39.882255 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:17:40.998705 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.0 seconds
[0m22:17:41.001748 [debug] [ThreadPool]: On list_RAW: Close
[0m22:17:41.132909 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RAW, now list_RAW_JAFFLE_SHOP)
[0m22:17:41.148996 [debug] [ThreadPool]: Using snowflake connection "list_RAW_JAFFLE_SHOP"
[0m22:17:41.149747 [debug] [ThreadPool]: On list_RAW_JAFFLE_SHOP: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_RAW_JAFFLE_SHOP"} */
show terse objects in RAW.JAFFLE_SHOP limit 10000
[0m22:17:41.150336 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:17:42.009322 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 1.0 seconds
[0m22:17:42.014246 [debug] [ThreadPool]: On list_RAW_JAFFLE_SHOP: Close
[0m22:17:42.150709 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5a30c26f-1ba4-4078-a5d9-c202da1a507d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112cbed50>]}
[0m22:17:42.152132 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:17:42.152773 [info ] [MainThread]: 
[0m22:17:42.156319 [debug] [Thread-1 (]: Began running node model.jaffle_shop.stg_customers
[0m22:17:42.157102 [debug] [Thread-2 (]: Began running node model.jaffle_shop.stg_orders
[0m22:17:42.157853 [info ] [Thread-1 (]: 1 of 3 START sql view model JAFFLE_SHOP.stg_customers .......................... [RUN]
[0m22:17:42.159184 [info ] [Thread-2 (]: 2 of 3 START sql view model JAFFLE_SHOP.stg_orders ............................. [RUN]
[0m22:17:42.161156 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_RAW_JAFFLE_SHOP, now model.jaffle_shop.stg_customers)
[0m22:17:42.162862 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.jaffle_shop.stg_orders'
[0m22:17:42.163620 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.stg_customers
[0m22:17:42.164642 [debug] [Thread-2 (]: Began compiling node model.jaffle_shop.stg_orders
[0m22:17:42.181953 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.stg_customers"
[0m22:17:42.186401 [debug] [Thread-2 (]: Writing injected SQL for node "model.jaffle_shop.stg_orders"
[0m22:17:42.188111 [debug] [Thread-2 (]: Timing info for model.jaffle_shop.stg_orders (compile): 22:17:42.182515 => 22:17:42.187682
[0m22:17:42.188885 [debug] [Thread-1 (]: Timing info for model.jaffle_shop.stg_customers (compile): 22:17:42.165834 => 22:17:42.188507
[0m22:17:42.189464 [debug] [Thread-2 (]: Began executing node model.jaffle_shop.stg_orders
[0m22:17:42.190046 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.stg_customers
[0m22:17:42.261395 [debug] [Thread-2 (]: Writing runtime sql for node "model.jaffle_shop.stg_orders"
[0m22:17:42.264997 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.stg_customers"
[0m22:17:42.266722 [debug] [Thread-1 (]: Using snowflake connection "model.jaffle_shop.stg_customers"
[0m22:17:42.267752 [debug] [Thread-2 (]: Using snowflake connection "model.jaffle_shop.stg_orders"
[0m22:17:42.268319 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */
create or replace   view RAW.JAFFLE_SHOP.stg_customers
  
   as (
    

select
    id as customer_id,
    first_name,
    last_name

from raw.jaffle_shop.raw_customers
  );
[0m22:17:42.268938 [debug] [Thread-2 (]: On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */
create or replace   view RAW.JAFFLE_SHOP.stg_orders
  
   as (
    

select
    id as order_id,
    user_id as customer_id,
    order_date,
    status

from raw.jaffle_shop.raw_orders
  );
[0m22:17:42.269601 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:17:42.270218 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m22:17:43.083734 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m22:17:43.106046 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m22:17:43.145513 [debug] [Thread-1 (]: Timing info for model.jaffle_shop.stg_customers (execute): 22:17:42.214996 => 22:17:43.144817
[0m22:17:43.146996 [debug] [Thread-2 (]: Timing info for model.jaffle_shop.stg_orders (execute): 22:17:42.190428 => 22:17:43.146626
[0m22:17:43.147646 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: Close
[0m22:17:43.148382 [debug] [Thread-2 (]: On model.jaffle_shop.stg_orders: Close
[0m22:17:43.340193 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5a30c26f-1ba4-4078-a5d9-c202da1a507d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112b31cd0>]}
[0m22:17:43.342100 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5a30c26f-1ba4-4078-a5d9-c202da1a507d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112ca38d0>]}
[0m22:17:43.343467 [info ] [Thread-2 (]: 2 of 3 OK created sql view model JAFFLE_SHOP.stg_orders ........................ [[32mSUCCESS 1[0m in 1.18s]
[0m22:17:43.344658 [info ] [Thread-1 (]: 1 of 3 OK created sql view model JAFFLE_SHOP.stg_customers ..................... [[32mSUCCESS 1[0m in 1.18s]
[0m22:17:43.345746 [debug] [Thread-2 (]: Finished running node model.jaffle_shop.stg_orders
[0m22:17:43.346666 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.stg_customers
[0m22:17:43.348219 [debug] [Thread-4 (]: Began running node model.jaffle_shop.customers
[0m22:17:43.349162 [info ] [Thread-4 (]: 3 of 3 START sql view model JAFFLE_SHOP.customers .............................. [RUN]
[0m22:17:43.350623 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.jaffle_shop.customers'
[0m22:17:43.351412 [debug] [Thread-4 (]: Began compiling node model.jaffle_shop.customers
[0m22:17:43.357851 [debug] [Thread-4 (]: Writing injected SQL for node "model.jaffle_shop.customers"
[0m22:17:43.360167 [debug] [Thread-4 (]: Timing info for model.jaffle_shop.customers (compile): 22:17:43.351829 => 22:17:43.359639
[0m22:17:43.360863 [debug] [Thread-4 (]: Began executing node model.jaffle_shop.customers
[0m22:17:43.366311 [debug] [Thread-4 (]: Writing runtime sql for node "model.jaffle_shop.customers"
[0m22:17:43.368700 [debug] [Thread-4 (]: Using snowflake connection "model.jaffle_shop.customers"
[0m22:17:43.369346 [debug] [Thread-4 (]: On model.jaffle_shop.customers: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.customers"} */
create or replace   view RAW.JAFFLE_SHOP.customers
  
   as (
    


with customers as (

    select * from RAW.JAFFLE_SHOP.stg_customers

),

orders as (

    select * from RAW.JAFFLE_SHOP.stg_orders

),

customer_orders as (

    select
        customer_id,

        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders

    from orders

    group by 1

),

final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce(customer_orders.number_of_orders, 0) as number_of_orders

    from customers

    left join customer_orders using (customer_id)

)

select * from final
  );
[0m22:17:43.369935 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m22:17:44.076343 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m22:17:44.083900 [debug] [Thread-4 (]: Timing info for model.jaffle_shop.customers (execute): 22:17:43.361246 => 22:17:44.083367
[0m22:17:44.084891 [debug] [Thread-4 (]: On model.jaffle_shop.customers: Close
[0m22:17:44.285363 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5a30c26f-1ba4-4078-a5d9-c202da1a507d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112c369d0>]}
[0m22:17:44.286456 [info ] [Thread-4 (]: 3 of 3 OK created sql view model JAFFLE_SHOP.customers ......................... [[32mSUCCESS 1[0m in 0.94s]
[0m22:17:44.287425 [debug] [Thread-4 (]: Finished running node model.jaffle_shop.customers
[0m22:17:44.290089 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:17:44.290628 [debug] [MainThread]: Connection 'model.jaffle_shop.stg_customers' was properly closed.
[0m22:17:44.291109 [debug] [MainThread]: Connection 'model.jaffle_shop.stg_orders' was properly closed.
[0m22:17:44.291571 [debug] [MainThread]: Connection 'model.jaffle_shop.customers' was properly closed.
[0m22:17:44.292277 [info ] [MainThread]: 
[0m22:17:44.293329 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 4.44 seconds (4.44s).
[0m22:17:44.295128 [debug] [MainThread]: Command end result
[0m22:17:44.308608 [info ] [MainThread]: 
[0m22:17:44.309717 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:17:44.310400 [info ] [MainThread]: 
[0m22:17:44.311688 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m22:17:44.313909 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 5.582401, "process_user_time": 4.710201, "process_kernel_time": 0.483853, "process_mem_max_rss": "138313728", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m22:17:44.314868 [debug] [MainThread]: Command `dbt run` succeeded at 22:17:44.314641 after 5.58 seconds
[0m22:17:44.316304 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112027b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112025090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112c84450>]}
[0m22:17:44.317541 [debug] [MainThread]: Flushing usage events
[0m22:18:31.355068 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1091a4290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109250dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1091ca110>]}


============================== 22:18:31.362458 | 0ccc3ed3-d6d9-4e4b-bacc-daa4d8a2ecba ==============================
[0m22:18:31.362458 [info ] [MainThread]: Running with dbt=1.7.8
[0m22:18:31.363531 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/ben/jaffle_shop/logs', 'profiles_dir': '/Users/ben/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --select staging', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m22:18:31.978829 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0ccc3ed3-d6d9-4e4b-bacc-daa4d8a2ecba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a104410>]}
[0m22:18:32.118632 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0ccc3ed3-d6d9-4e4b-bacc-daa4d8a2ecba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a0e9b90>]}
[0m22:18:32.119872 [info ] [MainThread]: Registered adapter: snowflake=1.7.2
[0m22:18:32.148843 [debug] [MainThread]: checksum: 67f0013ca5f0bd43af9a0873dd50792fde83ef69de63b71cacd0b4ac656c52e5, vars: {}, profile: , target: , version: 1.7.8
[0m22:18:32.201747 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:18:32.202421 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:18:32.212309 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0ccc3ed3-d6d9-4e4b-bacc-daa4d8a2ecba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a258390>]}
[0m22:18:32.228546 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0ccc3ed3-d6d9-4e4b-bacc-daa4d8a2ecba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109842dd0>]}
[0m22:18:32.229400 [info ] [MainThread]: Found 3 models, 3 seeds, 0 sources, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m22:18:32.230492 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0ccc3ed3-d6d9-4e4b-bacc-daa4d8a2ecba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10986c210>]}
[0m22:18:32.234187 [info ] [MainThread]: 
[0m22:18:32.236300 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m22:18:32.239054 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RAW'
[0m22:18:32.267105 [debug] [ThreadPool]: Using snowflake connection "list_RAW"
[0m22:18:32.267827 [debug] [ThreadPool]: On list_RAW: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_RAW"} */
show terse schemas in database RAW
    limit 10000
[0m22:18:32.268377 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:18:33.019484 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.0 seconds
[0m22:18:33.025733 [debug] [ThreadPool]: On list_RAW: Close
[0m22:18:33.150832 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RAW, now list_RAW_JAFFLE_SHOP)
[0m22:18:33.163918 [debug] [ThreadPool]: Using snowflake connection "list_RAW_JAFFLE_SHOP"
[0m22:18:33.164640 [debug] [ThreadPool]: On list_RAW_JAFFLE_SHOP: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_RAW_JAFFLE_SHOP"} */
show terse objects in RAW.JAFFLE_SHOP limit 10000
[0m22:18:33.165180 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:18:33.539792 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 0.0 seconds
[0m22:18:33.545279 [debug] [ThreadPool]: On list_RAW_JAFFLE_SHOP: Close
[0m22:18:33.671680 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0ccc3ed3-d6d9-4e4b-bacc-daa4d8a2ecba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10947a190>]}
[0m22:18:33.673705 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:18:33.674574 [info ] [MainThread]: 
[0m22:18:33.679633 [debug] [Thread-1 (]: Began running node model.jaffle_shop.stg_customers
[0m22:18:33.680648 [debug] [Thread-2 (]: Began running node model.jaffle_shop.stg_orders
[0m22:18:33.681526 [info ] [Thread-1 (]: 1 of 2 START sql view model JAFFLE_SHOP.stg_customers .......................... [RUN]
[0m22:18:33.682542 [info ] [Thread-2 (]: 2 of 2 START sql view model JAFFLE_SHOP.stg_orders ............................. [RUN]
[0m22:18:33.683936 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_RAW_JAFFLE_SHOP, now model.jaffle_shop.stg_customers)
[0m22:18:33.685323 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.jaffle_shop.stg_orders'
[0m22:18:33.686055 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.stg_customers
[0m22:18:33.686721 [debug] [Thread-2 (]: Began compiling node model.jaffle_shop.stg_orders
[0m22:18:33.699409 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.stg_customers"
[0m22:18:33.704067 [debug] [Thread-2 (]: Writing injected SQL for node "model.jaffle_shop.stg_orders"
[0m22:18:33.705553 [debug] [Thread-1 (]: Timing info for model.jaffle_shop.stg_customers (compile): 22:18:33.687344 => 22:18:33.705029
[0m22:18:33.706401 [debug] [Thread-2 (]: Timing info for model.jaffle_shop.stg_orders (compile): 22:18:33.700064 => 22:18:33.705997
[0m22:18:33.707544 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.stg_customers
[0m22:18:33.708291 [debug] [Thread-2 (]: Began executing node model.jaffle_shop.stg_orders
[0m22:18:33.785723 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.stg_customers"
[0m22:18:33.790019 [debug] [Thread-2 (]: Writing runtime sql for node "model.jaffle_shop.stg_orders"
[0m22:18:33.791784 [debug] [Thread-1 (]: Using snowflake connection "model.jaffle_shop.stg_customers"
[0m22:18:33.792472 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */
create or replace   view RAW.JAFFLE_SHOP.stg_customers
  
   as (
    

select
    id as customer_id,
    first_name,
    last_name

from raw.jaffle_shop.raw_customers
  );
[0m22:18:33.793503 [debug] [Thread-2 (]: Using snowflake connection "model.jaffle_shop.stg_orders"
[0m22:18:33.794068 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:18:33.794801 [debug] [Thread-2 (]: On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */
create or replace   view RAW.JAFFLE_SHOP.stg_orders
  
   as (
    

select
    id as order_id,
    user_id as customer_id,
    order_date,
    status

from raw.jaffle_shop.raw_orders
  );
[0m22:18:33.797412 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m22:18:34.256468 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m22:18:34.259700 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m22:18:34.313185 [debug] [Thread-2 (]: Timing info for model.jaffle_shop.stg_orders (execute): 22:18:33.722274 => 22:18:34.312824
[0m22:18:34.315435 [debug] [Thread-1 (]: Timing info for model.jaffle_shop.stg_customers (execute): 22:18:33.708737 => 22:18:34.314699
[0m22:18:34.316072 [debug] [Thread-2 (]: On model.jaffle_shop.stg_orders: Close
[0m22:18:34.316748 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: Close
[0m22:18:34.457374 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0ccc3ed3-d6d9-4e4b-bacc-daa4d8a2ecba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a325b90>]}
[0m22:18:34.460752 [info ] [Thread-2 (]: 2 of 2 OK created sql view model JAFFLE_SHOP.stg_orders ........................ [[32mSUCCESS 1[0m in 0.77s]
[0m22:18:34.464616 [debug] [Thread-2 (]: Finished running node model.jaffle_shop.stg_orders
[0m22:18:34.506719 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0ccc3ed3-d6d9-4e4b-bacc-daa4d8a2ecba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a3526d0>]}
[0m22:18:34.508691 [info ] [Thread-1 (]: 1 of 2 OK created sql view model JAFFLE_SHOP.stg_customers ..................... [[32mSUCCESS 1[0m in 0.82s]
[0m22:18:34.510939 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.stg_customers
[0m22:18:34.514178 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:18:34.514865 [debug] [MainThread]: Connection 'model.jaffle_shop.stg_customers' was properly closed.
[0m22:18:34.515662 [debug] [MainThread]: Connection 'model.jaffle_shop.stg_orders' was properly closed.
[0m22:18:34.516455 [info ] [MainThread]: 
[0m22:18:34.517227 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 2.28 seconds (2.28s).
[0m22:18:34.518990 [debug] [MainThread]: Command end result
[0m22:18:34.533701 [info ] [MainThread]: 
[0m22:18:34.534407 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:18:34.534957 [info ] [MainThread]: 
[0m22:18:34.535736 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m22:18:34.538108 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 3.288478, "process_user_time": 4.268011, "process_kernel_time": 0.445554, "process_mem_max_rss": "134578176", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m22:18:34.539210 [debug] [MainThread]: Command `dbt run` succeeded at 22:18:34.538959 after 3.29 seconds
[0m22:18:34.539892 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109485e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109496090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1092869d0>]}
[0m22:18:34.540554 [debug] [MainThread]: Flushing usage events
[0m22:20:03.915815 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a162550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a788950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a364950>]}


============================== 22:20:03.922147 | 713cc71d-8080-4c68-8ef3-c65ae651c4c2 ==============================
[0m22:20:03.922147 [info ] [MainThread]: Running with dbt=1.7.8
[0m22:20:03.923144 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/ben/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/ben/jaffle_shop/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt test', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:20:04.500273 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '713cc71d-8080-4c68-8ef3-c65ae651c4c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b0c5110>]}
[0m22:20:04.638919 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '713cc71d-8080-4c68-8ef3-c65ae651c4c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ab58750>]}
[0m22:20:04.640131 [info ] [MainThread]: Registered adapter: snowflake=1.7.2
[0m22:20:04.668565 [debug] [MainThread]: checksum: 67f0013ca5f0bd43af9a0873dd50792fde83ef69de63b71cacd0b4ac656c52e5, vars: {}, profile: , target: , version: 1.7.8
[0m22:20:04.723504 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m22:20:04.724722 [debug] [MainThread]: Partial parsing: added file: jaffle_shop://models/schema.yml
[0m22:20:05.034268 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '713cc71d-8080-4c68-8ef3-c65ae651c4c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b439b50>]}
[0m22:20:05.052258 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '713cc71d-8080-4c68-8ef3-c65ae651c4c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b3c8050>]}
[0m22:20:05.053085 [info ] [MainThread]: Found 3 models, 3 seeds, 9 tests, 0 sources, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m22:20:05.053712 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '713cc71d-8080-4c68-8ef3-c65ae651c4c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b121f90>]}
[0m22:20:05.057332 [info ] [MainThread]: 
[0m22:20:05.058800 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m22:20:05.061092 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RAW_JAFFLE_SHOP'
[0m22:20:05.088829 [debug] [ThreadPool]: Using snowflake connection "list_RAW_JAFFLE_SHOP"
[0m22:20:05.089541 [debug] [ThreadPool]: On list_RAW_JAFFLE_SHOP: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_RAW_JAFFLE_SHOP"} */
show terse objects in RAW.JAFFLE_SHOP limit 10000
[0m22:20:05.090253 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:20:06.005739 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 1.0 seconds
[0m22:20:06.011278 [debug] [ThreadPool]: On list_RAW_JAFFLE_SHOP: Close
[0m22:20:06.157966 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '713cc71d-8080-4c68-8ef3-c65ae651c4c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b462f90>]}
[0m22:20:06.159319 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:20:06.159971 [info ] [MainThread]: 
[0m22:20:06.166181 [debug] [Thread-1 (]: Began running node test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad
[0m22:20:06.167504 [debug] [Thread-2 (]: Began running node test.jaffle_shop.not_null_customers_customer_id.5c9bf9911d
[0m22:20:06.168674 [debug] [Thread-3 (]: Began running node test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m22:20:06.170761 [debug] [Thread-4 (]: Began running node test.jaffle_shop.not_null_stg_orders_customer_id.af79d5e4b5
[0m22:20:06.170009 [info ] [Thread-1 (]: 1 of 9 START test accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned  [RUN]
[0m22:20:06.172034 [info ] [Thread-2 (]: 2 of 9 START test not_null_customers_customer_id ............................... [RUN]
[0m22:20:06.173002 [info ] [Thread-3 (]: 3 of 9 START test not_null_stg_customers_customer_id ........................... [RUN]
[0m22:20:06.174601 [info ] [Thread-4 (]: 4 of 9 START test not_null_stg_orders_customer_id .............................. [RUN]
[0m22:20:06.176554 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_RAW_JAFFLE_SHOP, now test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad)
[0m22:20:06.177924 [debug] [Thread-2 (]: Acquiring new snowflake connection 'test.jaffle_shop.not_null_customers_customer_id.5c9bf9911d'
[0m22:20:06.179114 [debug] [Thread-3 (]: Acquiring new snowflake connection 'test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa'
[0m22:20:06.180545 [debug] [Thread-4 (]: Acquiring new snowflake connection 'test.jaffle_shop.not_null_stg_orders_customer_id.af79d5e4b5'
[0m22:20:06.181429 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad
[0m22:20:06.182173 [debug] [Thread-2 (]: Began compiling node test.jaffle_shop.not_null_customers_customer_id.5c9bf9911d
[0m22:20:06.182965 [debug] [Thread-3 (]: Began compiling node test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m22:20:06.183779 [debug] [Thread-4 (]: Began compiling node test.jaffle_shop.not_null_stg_orders_customer_id.af79d5e4b5
[0m22:20:06.199230 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad"
[0m22:20:06.214861 [debug] [Thread-2 (]: Writing injected SQL for node "test.jaffle_shop.not_null_customers_customer_id.5c9bf9911d"
[0m22:20:06.222211 [debug] [Thread-3 (]: Writing injected SQL for node "test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m22:20:06.229044 [debug] [Thread-4 (]: Writing injected SQL for node "test.jaffle_shop.not_null_stg_orders_customer_id.af79d5e4b5"
[0m22:20:06.230914 [debug] [Thread-2 (]: Timing info for test.jaffle_shop.not_null_customers_customer_id.5c9bf9911d (compile): 22:20:06.199672 => 22:20:06.230482
[0m22:20:06.231717 [debug] [Thread-1 (]: Timing info for test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad (compile): 22:20:06.184256 => 22:20:06.231306
[0m22:20:06.232818 [debug] [Thread-3 (]: Timing info for test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa (compile): 22:20:06.215393 => 22:20:06.232314
[0m22:20:06.233696 [debug] [Thread-2 (]: Began executing node test.jaffle_shop.not_null_customers_customer_id.5c9bf9911d
[0m22:20:06.234645 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad
[0m22:20:06.235514 [debug] [Thread-4 (]: Timing info for test.jaffle_shop.not_null_stg_orders_customer_id.af79d5e4b5 (compile): 22:20:06.222744 => 22:20:06.235114
[0m22:20:06.236064 [debug] [Thread-3 (]: Began executing node test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m22:20:06.278033 [debug] [Thread-4 (]: Began executing node test.jaffle_shop.not_null_stg_orders_customer_id.af79d5e4b5
[0m22:20:06.295495 [debug] [Thread-2 (]: Writing runtime sql for node "test.jaffle_shop.not_null_customers_customer_id.5c9bf9911d"
[0m22:20:06.294470 [debug] [Thread-1 (]: Writing runtime sql for node "test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad"
[0m22:20:06.300469 [debug] [Thread-3 (]: Writing runtime sql for node "test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m22:20:06.305130 [debug] [Thread-4 (]: Writing runtime sql for node "test.jaffle_shop.not_null_stg_orders_customer_id.af79d5e4b5"
[0m22:20:06.307485 [debug] [Thread-1 (]: Using snowflake connection "test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad"
[0m22:20:06.308825 [debug] [Thread-2 (]: Using snowflake connection "test.jaffle_shop.not_null_customers_customer_id.5c9bf9911d"
[0m22:20:06.310126 [debug] [Thread-1 (]: On test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        status as value_field,
        count(*) as n_records

    from RAW.JAFFLE_SHOP.stg_orders
    group by status

)

select *
from all_values
where value_field not in (
    'placed','shipped','completed','return_pending','returned'
)



      
    ) dbt_internal_test
[0m22:20:06.310943 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_customers_customer_id.5c9bf9911d: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_customers_customer_id.5c9bf9911d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from RAW.JAFFLE_SHOP.customers
where customer_id is null



      
    ) dbt_internal_test
[0m22:20:06.312085 [debug] [Thread-3 (]: Using snowflake connection "test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m22:20:06.313060 [debug] [Thread-4 (]: Using snowflake connection "test.jaffle_shop.not_null_stg_orders_customer_id.af79d5e4b5"
[0m22:20:06.313651 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:20:06.314306 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m22:20:06.314996 [debug] [Thread-3 (]: On test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from RAW.JAFFLE_SHOP.stg_customers
where customer_id is null



      
    ) dbt_internal_test
[0m22:20:06.315750 [debug] [Thread-4 (]: On test.jaffle_shop.not_null_stg_orders_customer_id.af79d5e4b5: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_stg_orders_customer_id.af79d5e4b5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from RAW.JAFFLE_SHOP.stg_orders
where customer_id is null



      
    ) dbt_internal_test
[0m22:20:06.321036 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m22:20:06.321816 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m22:20:06.802210 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m22:20:06.818105 [debug] [Thread-3 (]: Timing info for test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa (execute): 22:20:06.296161 => 22:20:06.817507
[0m22:20:06.819096 [debug] [Thread-3 (]: On test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa: Close
[0m22:20:06.954980 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m22:20:06.960850 [debug] [Thread-2 (]: Timing info for test.jaffle_shop.not_null_customers_customer_id.5c9bf9911d (execute): 22:20:06.236467 => 22:20:06.960214
[0m22:20:06.963114 [info ] [Thread-3 (]: 3 of 9 PASS not_null_stg_customers_customer_id ................................. [[32mPASS[0m in 0.78s]
[0m22:20:06.964291 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_customers_customer_id.5c9bf9911d: Close
[0m22:20:06.965777 [debug] [Thread-3 (]: Finished running node test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m22:20:06.968704 [debug] [Thread-3 (]: Began running node test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64
[0m22:20:06.970506 [info ] [Thread-3 (]: 5 of 9 START test not_null_stg_orders_order_id ................................. [RUN]
[0m22:20:06.972342 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa, now test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64)
[0m22:20:06.973702 [debug] [Thread-3 (]: Began compiling node test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64
[0m22:20:06.985053 [debug] [Thread-3 (]: Writing injected SQL for node "test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64"
[0m22:20:06.987147 [debug] [Thread-3 (]: Timing info for test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64 (compile): 22:20:06.974818 => 22:20:06.986644
[0m22:20:06.987859 [debug] [Thread-3 (]: Began executing node test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64
[0m22:20:06.994986 [debug] [Thread-3 (]: Writing runtime sql for node "test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64"
[0m22:20:06.997156 [debug] [Thread-3 (]: Using snowflake connection "test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64"
[0m22:20:06.998304 [debug] [Thread-3 (]: On test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select order_id
from RAW.JAFFLE_SHOP.stg_orders
where order_id is null



      
    ) dbt_internal_test
[0m22:20:06.999506 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m22:20:07.104827 [info ] [Thread-2 (]: 2 of 9 PASS not_null_customers_customer_id ..................................... [[32mPASS[0m in 0.93s]
[0m22:20:07.106540 [debug] [Thread-2 (]: Finished running node test.jaffle_shop.not_null_customers_customer_id.5c9bf9911d
[0m22:20:07.107702 [debug] [Thread-2 (]: Began running node test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m22:20:07.108835 [info ] [Thread-2 (]: 6 of 9 START test relationships_stg_orders_customer_id__customer_id__ref_stg_customers_  [RUN]
[0m22:20:07.111051 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.jaffle_shop.not_null_customers_customer_id.5c9bf9911d, now test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500)
[0m22:20:07.112331 [debug] [Thread-2 (]: Began compiling node test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m22:20:07.128512 [debug] [Thread-2 (]: Writing injected SQL for node "test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"
[0m22:20:07.130482 [debug] [Thread-2 (]: Timing info for test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500 (compile): 22:20:07.113210 => 22:20:07.129814
[0m22:20:07.131745 [debug] [Thread-2 (]: Began executing node test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m22:20:07.140963 [debug] [Thread-2 (]: Writing runtime sql for node "test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"
[0m22:20:07.144415 [debug] [Thread-2 (]: Using snowflake connection "test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"
[0m22:20:07.145933 [debug] [Thread-2 (]: On test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select customer_id as from_field
    from RAW.JAFFLE_SHOP.stg_orders
    where customer_id is not null
),

parent as (
    select customer_id as to_field
    from RAW.JAFFLE_SHOP.stg_customers
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m22:20:07.147142 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:20:07.291273 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m22:20:07.296796 [debug] [Thread-4 (]: Timing info for test.jaffle_shop.not_null_stg_orders_customer_id.af79d5e4b5 (execute): 22:20:06.301053 => 22:20:07.296130
[0m22:20:07.297888 [debug] [Thread-4 (]: On test.jaffle_shop.not_null_stg_orders_customer_id.af79d5e4b5: Close
[0m22:20:07.437019 [info ] [Thread-4 (]: 4 of 9 PASS not_null_stg_orders_customer_id .................................... [[32mPASS[0m in 1.26s]
[0m22:20:07.438682 [debug] [Thread-4 (]: Finished running node test.jaffle_shop.not_null_stg_orders_customer_id.af79d5e4b5
[0m22:20:07.439761 [debug] [Thread-4 (]: Began running node test.jaffle_shop.unique_customers_customer_id.c5af1ff4b1
[0m22:20:07.440653 [info ] [Thread-4 (]: 7 of 9 START test unique_customers_customer_id ................................. [RUN]
[0m22:20:07.442204 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.jaffle_shop.not_null_stg_orders_customer_id.af79d5e4b5, now test.jaffle_shop.unique_customers_customer_id.c5af1ff4b1)
[0m22:20:07.443041 [debug] [Thread-4 (]: Began compiling node test.jaffle_shop.unique_customers_customer_id.c5af1ff4b1
[0m22:20:07.457109 [debug] [Thread-4 (]: Writing injected SQL for node "test.jaffle_shop.unique_customers_customer_id.c5af1ff4b1"
[0m22:20:07.458500 [debug] [Thread-4 (]: Timing info for test.jaffle_shop.unique_customers_customer_id.c5af1ff4b1 (compile): 22:20:07.443542 => 22:20:07.458077
[0m22:20:07.459138 [debug] [Thread-4 (]: Began executing node test.jaffle_shop.unique_customers_customer_id.c5af1ff4b1
[0m22:20:07.464006 [debug] [Thread-4 (]: Writing runtime sql for node "test.jaffle_shop.unique_customers_customer_id.c5af1ff4b1"
[0m22:20:07.469514 [debug] [Thread-4 (]: Using snowflake connection "test.jaffle_shop.unique_customers_customer_id.c5af1ff4b1"
[0m22:20:07.471096 [debug] [Thread-4 (]: On test.jaffle_shop.unique_customers_customer_id.c5af1ff4b1: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.unique_customers_customer_id.c5af1ff4b1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    customer_id as unique_field,
    count(*) as n_records

from RAW.JAFFLE_SHOP.customers
where customer_id is not null
group by customer_id
having count(*) > 1



      
    ) dbt_internal_test
[0m22:20:07.471876 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m22:20:07.534368 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m22:20:07.537523 [debug] [Thread-1 (]: Timing info for test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad (execute): 22:20:06.242397 => 22:20:07.537124
[0m22:20:07.538797 [debug] [Thread-1 (]: On test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad: Close
[0m22:20:07.539992 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m22:20:07.544121 [debug] [Thread-3 (]: Timing info for test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64 (execute): 22:20:06.988270 => 22:20:07.543738
[0m22:20:07.545018 [debug] [Thread-3 (]: On test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64: Close
[0m22:20:07.676368 [info ] [Thread-1 (]: 1 of 9 PASS accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned  [[32mPASS[0m in 1.50s]
[0m22:20:07.677753 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad
[0m22:20:07.678567 [debug] [Thread-1 (]: Began running node test.jaffle_shop.unique_stg_customers_customer_id.c7614daada
[0m22:20:07.679742 [info ] [Thread-1 (]: 8 of 9 START test unique_stg_customers_customer_id ............................. [RUN]
[0m22:20:07.681120 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad, now test.jaffle_shop.unique_stg_customers_customer_id.c7614daada)
[0m22:20:07.681837 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.unique_stg_customers_customer_id.c7614daada
[0m22:20:07.689601 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.unique_stg_customers_customer_id.c7614daada"
[0m22:20:07.692506 [debug] [Thread-1 (]: Timing info for test.jaffle_shop.unique_stg_customers_customer_id.c7614daada (compile): 22:20:07.682401 => 22:20:07.692033
[0m22:20:07.693181 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.unique_stg_customers_customer_id.c7614daada
[0m22:20:07.697698 [debug] [Thread-1 (]: Writing runtime sql for node "test.jaffle_shop.unique_stg_customers_customer_id.c7614daada"
[0m22:20:07.699252 [info ] [Thread-3 (]: 5 of 9 PASS not_null_stg_orders_order_id ....................................... [[32mPASS[0m in 0.73s]
[0m22:20:07.700665 [debug] [Thread-3 (]: Finished running node test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64
[0m22:20:07.702339 [debug] [Thread-1 (]: Using snowflake connection "test.jaffle_shop.unique_stg_customers_customer_id.c7614daada"
[0m22:20:07.703514 [debug] [Thread-3 (]: Began running node test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a
[0m22:20:07.704666 [debug] [Thread-1 (]: On test.jaffle_shop.unique_stg_customers_customer_id.c7614daada: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.unique_stg_customers_customer_id.c7614daada"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    customer_id as unique_field,
    count(*) as n_records

from RAW.JAFFLE_SHOP.stg_customers
where customer_id is not null
group by customer_id
having count(*) > 1



      
    ) dbt_internal_test
[0m22:20:07.705674 [info ] [Thread-3 (]: 9 of 9 START test unique_stg_orders_order_id ................................... [RUN]
[0m22:20:07.706382 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:20:07.707409 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64, now test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a)
[0m22:20:07.709375 [debug] [Thread-3 (]: Began compiling node test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a
[0m22:20:07.716052 [debug] [Thread-3 (]: Writing injected SQL for node "test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a"
[0m22:20:07.718434 [debug] [Thread-3 (]: Timing info for test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a (compile): 22:20:07.709919 => 22:20:07.717935
[0m22:20:07.719226 [debug] [Thread-3 (]: Began executing node test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a
[0m22:20:07.724542 [debug] [Thread-3 (]: Writing runtime sql for node "test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a"
[0m22:20:07.727549 [debug] [Thread-3 (]: Using snowflake connection "test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a"
[0m22:20:07.728576 [debug] [Thread-3 (]: On test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    order_id as unique_field,
    count(*) as n_records

from RAW.JAFFLE_SHOP.stg_orders
where order_id is not null
group by order_id
having count(*) > 1



      
    ) dbt_internal_test
[0m22:20:07.729454 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m22:20:08.246709 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m22:20:08.252877 [debug] [Thread-2 (]: Timing info for test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500 (execute): 22:20:07.132633 => 22:20:08.252060
[0m22:20:08.253928 [debug] [Thread-2 (]: On test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500: Close
[0m22:20:08.341147 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m22:20:08.343386 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m22:20:08.348327 [debug] [Thread-1 (]: Timing info for test.jaffle_shop.unique_stg_customers_customer_id.c7614daada (execute): 22:20:07.693559 => 22:20:08.347741
[0m22:20:08.352901 [debug] [Thread-4 (]: Timing info for test.jaffle_shop.unique_customers_customer_id.c5af1ff4b1 (execute): 22:20:07.459509 => 22:20:08.352202
[0m22:20:08.353929 [debug] [Thread-1 (]: On test.jaffle_shop.unique_stg_customers_customer_id.c7614daada: Close
[0m22:20:08.354747 [debug] [Thread-4 (]: On test.jaffle_shop.unique_customers_customer_id.c5af1ff4b1: Close
[0m22:20:08.360023 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m22:20:08.364808 [debug] [Thread-3 (]: Timing info for test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a (execute): 22:20:07.719915 => 22:20:08.364317
[0m22:20:08.366144 [debug] [Thread-3 (]: On test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a: Close
[0m22:20:08.374020 [info ] [Thread-2 (]: 6 of 9 PASS relationships_stg_orders_customer_id__customer_id__ref_stg_customers_  [[32mPASS[0m in 1.26s]
[0m22:20:08.375084 [debug] [Thread-2 (]: Finished running node test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m22:20:08.501250 [info ] [Thread-1 (]: 8 of 9 PASS unique_stg_customers_customer_id ................................... [[32mPASS[0m in 0.82s]
[0m22:20:08.503437 [info ] [Thread-4 (]: 7 of 9 PASS unique_customers_customer_id ....................................... [[32mPASS[0m in 1.06s]
[0m22:20:08.505105 [info ] [Thread-3 (]: 9 of 9 PASS unique_stg_orders_order_id ......................................... [[32mPASS[0m in 0.80s]
[0m22:20:08.506597 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.unique_stg_customers_customer_id.c7614daada
[0m22:20:08.507655 [debug] [Thread-4 (]: Finished running node test.jaffle_shop.unique_customers_customer_id.c5af1ff4b1
[0m22:20:08.508659 [debug] [Thread-3 (]: Finished running node test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a
[0m22:20:08.512480 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:20:08.513161 [debug] [MainThread]: Connection 'test.jaffle_shop.unique_stg_customers_customer_id.c7614daada' was properly closed.
[0m22:20:08.513809 [debug] [MainThread]: Connection 'test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500' was properly closed.
[0m22:20:08.514720 [debug] [MainThread]: Connection 'test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a' was properly closed.
[0m22:20:08.516369 [debug] [MainThread]: Connection 'test.jaffle_shop.unique_customers_customer_id.c5af1ff4b1' was properly closed.
[0m22:20:08.517116 [info ] [MainThread]: 
[0m22:20:08.518052 [info ] [MainThread]: Finished running 9 tests in 0 hours 0 minutes and 3.46 seconds (3.46s).
[0m22:20:08.521085 [debug] [MainThread]: Command end result
[0m22:20:08.534929 [info ] [MainThread]: 
[0m22:20:08.535732 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:20:08.536340 [info ] [MainThread]: 
[0m22:20:08.536929 [info ] [MainThread]: Done. PASS=9 WARN=0 ERROR=0 SKIP=0 TOTAL=9
[0m22:20:08.539065 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 4.7072005, "process_user_time": 5.164863, "process_kernel_time": 0.518576, "process_mem_max_rss": "141516800", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m22:20:08.540429 [debug] [MainThread]: Command `dbt test` succeeded at 22:20:08.540085 after 4.71 seconds
[0m22:20:08.541818 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109bf8950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a7a1810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10648bd10>]}
[0m22:20:08.542745 [debug] [MainThread]: Flushing usage events
[0m18:18:04.194598 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b296210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10af43b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10af41b10>]}


============================== 18:18:04.204016 | 8b1729bd-0be9-454f-9800-6cf9db51c255 ==============================
[0m18:18:04.204016 [info ] [MainThread]: Running with dbt=1.7.8
[0m18:18:04.205281 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/Users/ben/.dbt', 'log_path': '/Users/ben/jaffle_shop/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt debug', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:18:04.206333 [info ] [MainThread]: dbt version: 1.7.8
[0m18:18:04.207189 [info ] [MainThread]: python version: 3.11.0
[0m18:18:04.207805 [info ] [MainThread]: python path: /Users/ben/dbt-env/bin/python
[0m18:18:04.208332 [info ] [MainThread]: os info: macOS-14.4.1-x86_64-i386-64bit
[0m18:18:04.212649 [info ] [MainThread]: target not specified in profile 'jaffle_shop', using 'default'
[0m18:18:04.213361 [info ] [MainThread]: Using profiles dir at /Users/ben/.dbt
[0m18:18:04.213728 [info ] [MainThread]: Using profiles.yml file at /Users/ben/.dbt/profiles.yml
[0m18:18:04.214136 [info ] [MainThread]: Using dbt_project.yml file at /Users/ben/jaffle_shop/dbt_project.yml
[0m18:18:04.297235 [info ] [MainThread]: Configuration:
[0m18:18:04.297975 [info ] [MainThread]:   profiles.yml file [[31mERROR invalid[0m]
[0m18:18:04.298373 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m18:18:04.298732 [info ] [MainThread]: Required dependencies:
[0m18:18:04.299137 [debug] [MainThread]: Executing "git --help"
[0m18:18:04.321725 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m18:18:04.322776 [debug] [MainThread]: STDERR: "b''"
[0m18:18:04.323360 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m18:18:04.323982 [info ] [MainThread]: Connection test skipped since no profile was found
[0m18:18:04.324530 [info ] [MainThread]: [31m1 check failed:[0m
[0m18:18:04.324917 [info ] [MainThread]: Profile loading failed for the following reason:
Runtime Error
  The profile 'jaffle_shop' does not have a target named 'default'. The valid target names for this profile are:
   - dev
   - target


[0m18:18:04.327977 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_wall_clock_time": 0.1950578, "process_user_time": 2.066583, "process_kernel_time": 0.368206, "process_mem_max_rss": "105406464", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m18:18:04.328763 [debug] [MainThread]: Command `dbt debug` failed at 18:18:04.328578 after 0.20 seconds
[0m18:18:04.329341 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10af55990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f9fc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ac502d0>]}
[0m18:18:04.330089 [debug] [MainThread]: Flushing usage events
[0m18:29:06.338307 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104db5e90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b13cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b122d0>]}


============================== 18:29:06.346165 | 6164382a-a800-40b8-9b89-04a8fbf0fab1 ==============================
[0m18:29:06.346165 [info ] [MainThread]: Running with dbt=1.7.8
[0m18:29:06.347196 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/ben/jaffle_shop/logs', 'version_check': 'True', 'profiles_dir': '/Users/ben/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt debug', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:29:06.348073 [info ] [MainThread]: dbt version: 1.7.8
[0m18:29:06.348845 [info ] [MainThread]: python version: 3.11.0
[0m18:29:06.349350 [info ] [MainThread]: python path: /Users/ben/dbt-env/bin/python
[0m18:29:06.349784 [info ] [MainThread]: os info: macOS-14.4.1-x86_64-i386-64bit
[0m18:29:06.353418 [info ] [MainThread]: target not specified in profile 'jaffle_shop', using 'default'
[0m18:29:06.354179 [info ] [MainThread]: Using profiles dir at /Users/ben/.dbt
[0m18:29:06.354818 [info ] [MainThread]: Using profiles.yml file at /Users/ben/.dbt/profiles.yml
[0m18:29:06.355439 [info ] [MainThread]: Using dbt_project.yml file at /Users/ben/jaffle_shop/dbt_project.yml
[0m18:29:06.435828 [info ] [MainThread]: Configuration:
[0m18:29:06.436423 [info ] [MainThread]:   profiles.yml file [[31mERROR invalid[0m]
[0m18:29:06.437081 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m18:29:06.437494 [info ] [MainThread]: Required dependencies:
[0m18:29:06.438309 [debug] [MainThread]: Executing "git --help"
[0m18:29:06.459432 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m18:29:06.460348 [debug] [MainThread]: STDERR: "b''"
[0m18:29:06.460825 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m18:29:06.461294 [info ] [MainThread]: Connection test skipped since no profile was found
[0m18:29:06.461797 [info ] [MainThread]: [31m1 check failed:[0m
[0m18:29:06.462153 [info ] [MainThread]: Profile loading failed for the following reason:
Runtime Error
  The profile 'jaffle_shop' does not have a target named 'default'. The valid target names for this profile are:
   - dev
   - target


[0m18:29:06.465818 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_wall_clock_time": 0.18716818, "process_user_time": 2.103107, "process_kernel_time": 0.330942, "process_mem_max_rss": "106414080", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m18:29:06.467064 [debug] [MainThread]: Command `dbt debug` failed at 18:29:06.466799 after 0.19 seconds
[0m18:29:06.467926 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104de4890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104de4d50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104dab810>]}
[0m18:29:06.468758 [debug] [MainThread]: Flushing usage events
[0m18:33:15.100619 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1061ce310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e53dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e53c90>]}


============================== 18:33:15.108548 | faa2871d-5886-446d-b1b0-10c948eefc0f ==============================
[0m18:33:15.108548 [info ] [MainThread]: Running with dbt=1.7.8
[0m18:33:15.109511 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/Users/ben/.dbt', 'log_path': '/Users/ben/jaffle_shop/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt debug', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m18:33:15.110169 [info ] [MainThread]: dbt version: 1.7.8
[0m18:33:15.110603 [info ] [MainThread]: python version: 3.11.0
[0m18:33:15.111005 [info ] [MainThread]: python path: /Users/ben/dbt-env/bin/python
[0m18:33:15.111394 [info ] [MainThread]: os info: macOS-14.4.1-x86_64-i386-64bit
[0m18:33:15.115383 [info ] [MainThread]: target not specified in profile 'jaffle_shop', using 'default'
[0m18:33:15.115998 [info ] [MainThread]: Using profiles dir at /Users/ben/.dbt
[0m18:33:15.116343 [info ] [MainThread]: Using profiles.yml file at /Users/ben/.dbt/profiles.yml
[0m18:33:15.116805 [info ] [MainThread]: Using dbt_project.yml file at /Users/ben/jaffle_shop/dbt_project.yml
[0m18:33:15.199543 [info ] [MainThread]: Configuration:
[0m18:33:15.200037 [info ] [MainThread]:   profiles.yml file [[31mERROR invalid[0m]
[0m18:33:15.200385 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m18:33:15.200711 [info ] [MainThread]: Required dependencies:
[0m18:33:15.201102 [debug] [MainThread]: Executing "git --help"
[0m18:33:15.221993 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m18:33:15.222998 [debug] [MainThread]: STDERR: "b''"
[0m18:33:15.223704 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m18:33:15.224213 [info ] [MainThread]: Connection test skipped since no profile was found
[0m18:33:15.224611 [info ] [MainThread]: [31m1 check failed:[0m
[0m18:33:15.224933 [info ] [MainThread]: Profile loading failed for the following reason:
Runtime Error
  The profile 'jaffle_shop' does not have a target named 'default'. The valid target names for this profile are:
   - dev
   - target


[0m18:33:15.228083 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_wall_clock_time": 0.19188273, "process_user_time": 2.111473, "process_kernel_time": 0.31717, "process_mem_max_rss": "105521152", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m18:33:15.228873 [debug] [MainThread]: Command `dbt debug` failed at 18:33:15.228641 after 0.19 seconds
[0m18:33:15.229403 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1058ccf90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10621d850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x101ec4610>]}
[0m18:33:15.229904 [debug] [MainThread]: Flushing usage events
[0m18:33:45.163226 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114295210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113f60690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113f60c90>]}


============================== 18:33:45.167684 | 3b1ebf03-a011-41c9-90c7-626cb1c41f15 ==============================
[0m18:33:45.167684 [info ] [MainThread]: Running with dbt=1.7.8
[0m18:33:45.168339 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/Users/ben/.dbt', 'log_path': '/Users/ben/jaffle_shop/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt debug', 'send_anonymous_usage_stats': 'True'}
[0m18:33:45.168978 [info ] [MainThread]: dbt version: 1.7.8
[0m18:33:45.169444 [info ] [MainThread]: python version: 3.11.0
[0m18:33:45.169821 [info ] [MainThread]: python path: /Users/ben/dbt-env/bin/python
[0m18:33:45.170275 [info ] [MainThread]: os info: macOS-14.4.1-x86_64-i386-64bit
[0m18:33:45.605554 [info ] [MainThread]: Using profiles dir at /Users/ben/.dbt
[0m18:33:45.606063 [info ] [MainThread]: Using profiles.yml file at /Users/ben/.dbt/profiles.yml
[0m18:33:45.606481 [info ] [MainThread]: Using dbt_project.yml file at /Users/ben/jaffle_shop/dbt_project.yml
[0m18:33:45.607616 [info ] [MainThread]: adapter type: snowflake
[0m18:33:45.607964 [info ] [MainThread]: adapter version: 1.7.2
[0m18:33:45.748069 [info ] [MainThread]: Configuration:
[0m18:33:45.748657 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m18:33:45.749034 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m18:33:45.749395 [info ] [MainThread]: Required dependencies:
[0m18:33:45.749863 [debug] [MainThread]: Executing "git --help"
[0m18:33:45.774963 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m18:33:45.775798 [debug] [MainThread]: STDERR: "b''"
[0m18:33:45.776204 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m18:33:45.776558 [info ] [MainThread]: Connection:
[0m18:33:45.777025 [info ] [MainThread]:   account: admwhpm-kn63693
[0m18:33:45.777458 [info ] [MainThread]:   user: dbt
[0m18:33:45.778162 [info ] [MainThread]:   database: RAW
[0m18:33:45.778617 [info ] [MainThread]:   warehouse: COMPUTE_WH
[0m18:33:45.779064 [info ] [MainThread]:   role: transform
[0m18:33:45.779465 [info ] [MainThread]:   schema: JAFFLE_SHOP
[0m18:33:45.779849 [info ] [MainThread]:   authenticator: None
[0m18:33:45.780161 [info ] [MainThread]:   private_key_path: None
[0m18:33:45.780461 [info ] [MainThread]:   oauth_client_id: None
[0m18:33:45.780768 [info ] [MainThread]:   query_tag: None
[0m18:33:45.781093 [info ] [MainThread]:   client_session_keep_alive: False
[0m18:33:45.781404 [info ] [MainThread]:   host: None
[0m18:33:45.781798 [info ] [MainThread]:   port: None
[0m18:33:45.782312 [info ] [MainThread]:   proxy_host: None
[0m18:33:45.782687 [info ] [MainThread]:   proxy_port: None
[0m18:33:45.783005 [info ] [MainThread]:   protocol: None
[0m18:33:45.783350 [info ] [MainThread]:   connect_retries: 1
[0m18:33:45.783655 [info ] [MainThread]:   connect_timeout: None
[0m18:33:45.783972 [info ] [MainThread]:   retry_on_database_errors: False
[0m18:33:45.784313 [info ] [MainThread]:   retry_all: False
[0m18:33:45.784619 [info ] [MainThread]:   insecure_mode: False
[0m18:33:45.784985 [info ] [MainThread]:   reuse_connections: None
[0m18:33:45.785569 [info ] [MainThread]: Registered adapter: snowflake=1.7.2
[0m18:33:45.797060 [debug] [MainThread]: Acquiring new snowflake connection 'debug'
[0m18:33:45.798896 [debug] [MainThread]: Using snowflake connection "debug"
[0m18:33:45.799334 [debug] [MainThread]: On debug: select 1 as id
[0m18:33:45.799677 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:33:47.052501 [debug] [MainThread]: SQL status: SUCCESS 1 in 1.0 seconds
[0m18:33:47.055763 [debug] [MainThread]: On debug: Close
[0m18:33:47.206836 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m18:33:47.208307 [info ] [MainThread]: [32mAll checks passed![0m
[0m18:33:47.211708 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 2.1093545, "process_user_time": 2.573031, "process_kernel_time": 0.320785, "process_mem_max_rss": "129560576", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m18:33:47.213085 [debug] [MainThread]: Command `dbt debug` succeeded at 18:33:47.212746 after 2.11 seconds
[0m18:33:47.213955 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m18:33:47.214849 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1142a6510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1142e6c90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113c94290>]}
[0m18:33:47.215818 [debug] [MainThread]: Flushing usage events
[0m18:33:54.539703 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11212e050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1121408d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111af5f50>]}


============================== 18:33:54.544091 | 49a748c5-62bd-4a80-87ee-10a34f65c6e7 ==============================
[0m18:33:54.544091 [info ] [MainThread]: Running with dbt=1.7.8
[0m18:33:54.544708 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/ben/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/ben/jaffle_shop/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m18:33:54.928613 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '49a748c5-62bd-4a80-87ee-10a34f65c6e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111db8cd0>]}
[0m18:33:55.017472 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '49a748c5-62bd-4a80-87ee-10a34f65c6e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11281f990>]}
[0m18:33:55.018568 [info ] [MainThread]: Registered adapter: snowflake=1.7.2
[0m18:33:55.039223 [debug] [MainThread]: checksum: 67f0013ca5f0bd43af9a0873dd50792fde83ef69de63b71cacd0b4ac656c52e5, vars: {}, profile: , target: , version: 1.7.8
[0m18:33:55.054131 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m18:33:55.054754 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '49a748c5-62bd-4a80-87ee-10a34f65c6e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1129b11d0>]}
[0m18:33:56.242998 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '49a748c5-62bd-4a80-87ee-10a34f65c6e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112bdce10>]}
[0m18:33:56.256299 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '49a748c5-62bd-4a80-87ee-10a34f65c6e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112fac7d0>]}
[0m18:33:56.256953 [info ] [MainThread]: Found 3 models, 3 seeds, 9 tests, 0 sources, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m18:33:56.257408 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '49a748c5-62bd-4a80-87ee-10a34f65c6e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112bd62d0>]}
[0m18:33:56.259367 [info ] [MainThread]: 
[0m18:33:56.260437 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m18:33:56.261961 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RAW'
[0m18:33:56.275801 [debug] [ThreadPool]: Using snowflake connection "list_RAW"
[0m18:33:56.276401 [debug] [ThreadPool]: On list_RAW: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_RAW"} */
show terse schemas in database RAW
    limit 10000
[0m18:33:56.276788 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:33:56.837809 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.0 seconds
[0m18:33:56.841709 [debug] [ThreadPool]: On list_RAW: Close
[0m18:33:57.007585 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RAW, now list_RAW_JAFFLE_SHOP)
[0m18:33:57.026291 [debug] [ThreadPool]: Using snowflake connection "list_RAW_JAFFLE_SHOP"
[0m18:33:57.046216 [debug] [ThreadPool]: On list_RAW_JAFFLE_SHOP: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_RAW_JAFFLE_SHOP"} */
show terse objects in RAW.JAFFLE_SHOP limit 10000
[0m18:33:57.047590 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:33:57.599636 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 1.0 seconds
[0m18:33:57.603791 [debug] [ThreadPool]: On list_RAW_JAFFLE_SHOP: Close
[0m18:33:57.753687 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '49a748c5-62bd-4a80-87ee-10a34f65c6e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112ec8fd0>]}
[0m18:33:57.756233 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:33:57.757344 [info ] [MainThread]: 
[0m18:33:57.763087 [debug] [Thread-1 (]: Began running node model.jaffle_shop.stg_customers
[0m18:33:57.764235 [debug] [Thread-2 (]: Began running node model.jaffle_shop.stg_orders
[0m18:33:57.765252 [info ] [Thread-1 (]: 1 of 3 START sql view model JAFFLE_SHOP.stg_customers .......................... [RUN]
[0m18:33:57.766372 [info ] [Thread-2 (]: 2 of 3 START sql view model JAFFLE_SHOP.stg_orders ............................. [RUN]
[0m18:33:57.768049 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_RAW_JAFFLE_SHOP, now model.jaffle_shop.stg_customers)
[0m18:33:57.769622 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.jaffle_shop.stg_orders'
[0m18:33:57.770415 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.stg_customers
[0m18:33:57.771127 [debug] [Thread-2 (]: Began compiling node model.jaffle_shop.stg_orders
[0m18:33:57.782653 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.stg_customers"
[0m18:33:57.786232 [debug] [Thread-2 (]: Writing injected SQL for node "model.jaffle_shop.stg_orders"
[0m18:33:57.787360 [debug] [Thread-1 (]: Timing info for model.jaffle_shop.stg_customers (compile): 18:33:57.771540 => 18:33:57.787051
[0m18:33:57.787972 [debug] [Thread-2 (]: Timing info for model.jaffle_shop.stg_orders (compile): 18:33:57.783157 => 18:33:57.787662
[0m18:33:57.788425 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.stg_customers
[0m18:33:57.788892 [debug] [Thread-2 (]: Began executing node model.jaffle_shop.stg_orders
[0m18:33:57.897511 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.stg_customers"
[0m18:33:57.901775 [debug] [Thread-2 (]: Writing runtime sql for node "model.jaffle_shop.stg_orders"
[0m18:33:57.902831 [debug] [Thread-2 (]: Using snowflake connection "model.jaffle_shop.stg_orders"
[0m18:33:57.903252 [debug] [Thread-2 (]: On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */
create or replace   view RAW.JAFFLE_SHOP.stg_orders
  
   as (
    

select
    id as order_id,
    user_id as customer_id,
    order_date,
    status

from raw.jaffle_shop.raw_orders
  );
[0m18:33:57.903676 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m18:33:57.905026 [debug] [Thread-1 (]: Using snowflake connection "model.jaffle_shop.stg_customers"
[0m18:33:57.905437 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */
create or replace   view RAW.JAFFLE_SHOP.stg_customers
  
   as (
    

select
    id as customer_id,
    first_name,
    last_name

from raw.jaffle_shop.raw_customers
  );
[0m18:33:57.905806 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:33:58.439194 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b3a689-0001-c86a-0005-81260003d04a
[0m18:33:58.440002 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 002003 (42S02): SQL compilation error:
Object 'RAW.JAFFLE_SHOP.RAW_CUSTOMERS' does not exist or not authorized.
[0m18:33:58.440991 [debug] [Thread-1 (]: Timing info for model.jaffle_shop.stg_customers (execute): 18:33:57.789192 => 18:33:58.440604
[0m18:33:58.441663 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: Close
[0m18:33:58.546024 [debug] [Thread-2 (]: Snowflake adapter: Snowflake query id: 01b3a689-0001-c890-0005-81260003b052
[0m18:33:58.547372 [debug] [Thread-2 (]: Snowflake adapter: Snowflake error: 002003 (42S02): SQL compilation error:
Object 'RAW.JAFFLE_SHOP.RAW_ORDERS' does not exist or not authorized.
[0m18:33:58.549013 [debug] [Thread-2 (]: Timing info for model.jaffle_shop.stg_orders (execute): 18:33:57.812473 => 18:33:58.548365
[0m18:33:58.550137 [debug] [Thread-2 (]: On model.jaffle_shop.stg_orders: Close
[0m18:33:58.597246 [debug] [Thread-1 (]: Database Error in model stg_customers (models/staging/stg_customers.sql)
  002003 (42S02): SQL compilation error:
  Object 'RAW.JAFFLE_SHOP.RAW_CUSTOMERS' does not exist or not authorized.
  compiled Code at target/run/jaffle_shop/models/staging/stg_customers.sql
[0m18:33:58.598675 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '49a748c5-62bd-4a80-87ee-10a34f65c6e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112f604d0>]}
[0m18:33:58.600079 [error] [Thread-1 (]: 1 of 3 ERROR creating sql view model JAFFLE_SHOP.stg_customers ................. [[31mERROR[0m in 0.83s]
[0m18:33:58.601282 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.stg_customers
[0m18:33:58.704758 [debug] [Thread-2 (]: Database Error in model stg_orders (models/staging/stg_orders.sql)
  002003 (42S02): SQL compilation error:
  Object 'RAW.JAFFLE_SHOP.RAW_ORDERS' does not exist or not authorized.
  compiled Code at target/run/jaffle_shop/models/staging/stg_orders.sql
[0m18:33:58.706128 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '49a748c5-62bd-4a80-87ee-10a34f65c6e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1129c3a10>]}
[0m18:33:58.707462 [error] [Thread-2 (]: 2 of 3 ERROR creating sql view model JAFFLE_SHOP.stg_orders .................... [[31mERROR[0m in 0.94s]
[0m18:33:58.708845 [debug] [Thread-2 (]: Finished running node model.jaffle_shop.stg_orders
[0m18:33:58.710244 [debug] [Thread-4 (]: Began running node model.jaffle_shop.customers
[0m18:33:58.711872 [info ] [Thread-4 (]: 3 of 3 SKIP relation JAFFLE_SHOP.customers ..................................... [[33mSKIP[0m]
[0m18:33:58.713063 [debug] [Thread-4 (]: Finished running node model.jaffle_shop.customers
[0m18:33:58.716728 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:33:58.717540 [debug] [MainThread]: Connection 'model.jaffle_shop.stg_customers' was properly closed.
[0m18:33:58.718094 [debug] [MainThread]: Connection 'model.jaffle_shop.stg_orders' was properly closed.
[0m18:33:58.718699 [info ] [MainThread]: 
[0m18:33:58.719311 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 2.46 seconds (2.46s).
[0m18:33:58.720655 [debug] [MainThread]: Command end result
[0m18:33:58.734401 [info ] [MainThread]: 
[0m18:33:58.735222 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m18:33:58.736539 [info ] [MainThread]: 
[0m18:33:58.737325 [error] [MainThread]:   Database Error in model stg_customers (models/staging/stg_customers.sql)
  002003 (42S02): SQL compilation error:
  Object 'RAW.JAFFLE_SHOP.RAW_CUSTOMERS' does not exist or not authorized.
  compiled Code at target/run/jaffle_shop/models/staging/stg_customers.sql
[0m18:33:58.737840 [info ] [MainThread]: 
[0m18:33:58.738274 [error] [MainThread]:   Database Error in model stg_orders (models/staging/stg_orders.sql)
  002003 (42S02): SQL compilation error:
  Object 'RAW.JAFFLE_SHOP.RAW_ORDERS' does not exist or not authorized.
  compiled Code at target/run/jaffle_shop/models/staging/stg_orders.sql
[0m18:33:58.738714 [info ] [MainThread]: 
[0m18:33:58.739154 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=2 SKIP=1 TOTAL=3
[0m18:33:58.741366 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 4.264904, "process_user_time": 4.054611, "process_kernel_time": 0.341287, "process_mem_max_rss": "141553664", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m18:33:58.742352 [debug] [MainThread]: Command `dbt run` failed at 18:33:58.742148 after 4.27 seconds
[0m18:33:58.742919 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111af5f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111d0cb90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11212d890>]}
[0m18:33:58.743419 [debug] [MainThread]: Flushing usage events
[0m18:36:03.205430 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c591490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c8e7bd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c8dd190>]}


============================== 18:36:03.210762 | 5745ec60-59c2-4305-893e-23505e4391e2 ==============================
[0m18:36:03.210762 [info ] [MainThread]: Running with dbt=1.7.8
[0m18:36:03.211383 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/ben/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/Users/ben/jaffle_shop/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt seed', 'send_anonymous_usage_stats': 'True'}
[0m18:36:03.584336 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5745ec60-59c2-4305-893e-23505e4391e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d0e3c90>]}
[0m18:36:03.669623 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5745ec60-59c2-4305-893e-23505e4391e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c2d9110>]}
[0m18:36:03.670475 [info ] [MainThread]: Registered adapter: snowflake=1.7.2
[0m18:36:03.689858 [debug] [MainThread]: checksum: 67f0013ca5f0bd43af9a0873dd50792fde83ef69de63b71cacd0b4ac656c52e5, vars: {}, profile: , target: , version: 1.7.8
[0m18:36:03.742286 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:36:03.742748 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:36:03.750261 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5745ec60-59c2-4305-893e-23505e4391e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d398d90>]}
[0m18:36:03.762972 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5745ec60-59c2-4305-893e-23505e4391e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d391850>]}
[0m18:36:03.763517 [info ] [MainThread]: Found 3 models, 3 seeds, 9 tests, 0 sources, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m18:36:03.763909 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5745ec60-59c2-4305-893e-23505e4391e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d1022d0>]}
[0m18:36:03.765917 [info ] [MainThread]: 
[0m18:36:03.766802 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m18:36:03.768250 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RAW'
[0m18:36:03.784073 [debug] [ThreadPool]: Using snowflake connection "list_RAW"
[0m18:36:03.784635 [debug] [ThreadPool]: On list_RAW: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_RAW"} */
show terse schemas in database RAW
    limit 10000
[0m18:36:03.785072 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:36:04.523097 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.0 seconds
[0m18:36:04.529154 [debug] [ThreadPool]: On list_RAW: Close
[0m18:36:04.676981 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RAW, now list_RAW_JAFFLE_SHOP)
[0m18:36:04.693542 [debug] [ThreadPool]: Using snowflake connection "list_RAW_JAFFLE_SHOP"
[0m18:36:04.694243 [debug] [ThreadPool]: On list_RAW_JAFFLE_SHOP: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_RAW_JAFFLE_SHOP"} */
show terse objects in RAW.JAFFLE_SHOP limit 10000
[0m18:36:04.694784 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:36:05.217684 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 1.0 seconds
[0m18:36:05.222267 [debug] [ThreadPool]: On list_RAW_JAFFLE_SHOP: Close
[0m18:36:05.378787 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5745ec60-59c2-4305-893e-23505e4391e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b74fd90>]}
[0m18:36:05.381247 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:36:05.382240 [info ] [MainThread]: 
[0m18:36:05.387788 [debug] [Thread-1 (]: Began running node seed.jaffle_shop.raw_customers
[0m18:36:05.389014 [info ] [Thread-1 (]: 1 of 3 START seed file JAFFLE_SHOP.raw_customers ............................... [RUN]
[0m18:36:05.390058 [debug] [Thread-2 (]: Began running node seed.jaffle_shop.raw_orders
[0m18:36:05.391375 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_RAW_JAFFLE_SHOP, now seed.jaffle_shop.raw_customers)
[0m18:36:05.392230 [debug] [Thread-3 (]: Began running node seed.jaffle_shop.raw_payments
[0m18:36:05.393536 [info ] [Thread-2 (]: 2 of 3 START seed file JAFFLE_SHOP.raw_orders .................................. [RUN]
[0m18:36:05.394617 [debug] [Thread-1 (]: Began compiling node seed.jaffle_shop.raw_customers
[0m18:36:05.395603 [info ] [Thread-3 (]: 3 of 3 START seed file JAFFLE_SHOP.raw_payments ................................ [RUN]
[0m18:36:05.397247 [debug] [Thread-2 (]: Acquiring new snowflake connection 'seed.jaffle_shop.raw_orders'
[0m18:36:05.398348 [debug] [Thread-1 (]: Timing info for seed.jaffle_shop.raw_customers (compile): 18:36:05.397925 => 18:36:05.397934
[0m18:36:05.399605 [debug] [Thread-3 (]: Acquiring new snowflake connection 'seed.jaffle_shop.raw_payments'
[0m18:36:05.400322 [debug] [Thread-2 (]: Began compiling node seed.jaffle_shop.raw_orders
[0m18:36:05.401016 [debug] [Thread-1 (]: Began executing node seed.jaffle_shop.raw_customers
[0m18:36:05.401654 [debug] [Thread-3 (]: Began compiling node seed.jaffle_shop.raw_payments
[0m18:36:05.402314 [debug] [Thread-2 (]: Timing info for seed.jaffle_shop.raw_orders (compile): 18:36:05.402007 => 18:36:05.402010
[0m18:36:05.420404 [debug] [Thread-3 (]: Timing info for seed.jaffle_shop.raw_payments (compile): 18:36:05.420060 => 18:36:05.420066
[0m18:36:05.445889 [debug] [Thread-2 (]: Began executing node seed.jaffle_shop.raw_orders
[0m18:36:05.448068 [debug] [Thread-1 (]: Using snowflake connection "seed.jaffle_shop.raw_customers"
[0m18:36:05.448532 [debug] [Thread-3 (]: Began executing node seed.jaffle_shop.raw_payments
[0m18:36:05.452079 [debug] [Thread-1 (]: On seed.jaffle_shop.raw_customers: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_customers"} */
create table RAW.JAFFLE_SHOP.raw_customers (id integer,first_name text,last_name text)
[0m18:36:05.456556 [debug] [Thread-2 (]: Using snowflake connection "seed.jaffle_shop.raw_orders"
[0m18:36:05.463119 [debug] [Thread-3 (]: Using snowflake connection "seed.jaffle_shop.raw_payments"
[0m18:36:05.463527 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:36:05.463909 [debug] [Thread-2 (]: On seed.jaffle_shop.raw_orders: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_orders"} */
create table RAW.JAFFLE_SHOP.raw_orders (id integer,user_id integer,order_date date,status text)
[0m18:36:05.464280 [debug] [Thread-3 (]: On seed.jaffle_shop.raw_payments: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_payments"} */
create table RAW.JAFFLE_SHOP.raw_payments (id integer,order_id integer,payment_method text,amount integer)
[0m18:36:05.466138 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m18:36:05.466633 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m18:36:06.125900 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m18:36:06.152970 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m18:36:06.157522 [debug] [Thread-1 (]: Using snowflake connection "seed.jaffle_shop.raw_customers"
[0m18:36:06.161673 [debug] [Thread-3 (]: Using snowflake connection "seed.jaffle_shop.raw_payments"
[0m18:36:06.162229 [debug] [Thread-1 (]: On seed.jaffle_shop.raw_customers: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_customers"} */
BEGIN
[0m18:36:06.162706 [debug] [Thread-3 (]: On seed.jaffle_shop.raw_payments: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_payments"} */
BEGIN
[0m18:36:06.190902 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m18:36:06.196200 [debug] [Thread-2 (]: Using snowflake connection "seed.jaffle_shop.raw_orders"
[0m18:36:06.196802 [debug] [Thread-2 (]: On seed.jaffle_shop.raw_orders: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_orders"} */
BEGIN
[0m18:36:06.292699 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m18:36:06.299568 [debug] [Thread-1 (]: Using snowflake connection "seed.jaffle_shop.raw_customers"
[0m18:36:06.300663 [debug] [Thread-1 (]: On seed.jaffle_shop.raw_customers: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_customers"} */
insert into RAW.JAFFLE_SHOP.raw_customers (id, first_name, last_name) values
            (%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%...
[0m18:36:06.302829 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m18:36:06.310827 [debug] [Thread-3 (]: Using snowflake connection "seed.jaffle_shop.raw_payments"
[0m18:36:06.312426 [debug] [Thread-3 (]: On seed.jaffle_shop.raw_payments: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_payments"} */
insert into RAW.JAFFLE_SHOP.raw_payments (id, order_id, payment_method, amount) values
            (%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%...
[0m18:36:06.325223 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m18:36:06.329952 [debug] [Thread-2 (]: Using snowflake connection "seed.jaffle_shop.raw_orders"
[0m18:36:06.330681 [debug] [Thread-2 (]: On seed.jaffle_shop.raw_orders: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_orders"} */
insert into RAW.JAFFLE_SHOP.raw_orders (id, user_id, order_date, status) values
            (%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),...
[0m18:36:07.236797 [debug] [Thread-3 (]: SQL status: SUCCESS 113 in 1.0 seconds
[0m18:36:07.238392 [debug] [Thread-3 (]: Using snowflake connection "seed.jaffle_shop.raw_payments"
[0m18:36:07.239483 [debug] [Thread-3 (]: On seed.jaffle_shop.raw_payments: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_payments"} */
COMMIT
[0m18:36:07.259630 [debug] [Thread-2 (]: SQL status: SUCCESS 99 in 1.0 seconds
[0m18:36:07.260949 [debug] [Thread-2 (]: Using snowflake connection "seed.jaffle_shop.raw_orders"
[0m18:36:07.261832 [debug] [Thread-2 (]: On seed.jaffle_shop.raw_orders: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_orders"} */
COMMIT
[0m18:36:07.277100 [debug] [Thread-1 (]: SQL status: SUCCESS 100 in 1.0 seconds
[0m18:36:07.278681 [debug] [Thread-1 (]: Using snowflake connection "seed.jaffle_shop.raw_customers"
[0m18:36:07.279810 [debug] [Thread-1 (]: On seed.jaffle_shop.raw_customers: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_customers"} */
COMMIT
[0m18:36:07.509415 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m18:36:07.524878 [debug] [Thread-3 (]: Writing runtime SQL for node "seed.jaffle_shop.raw_payments"
[0m18:36:07.534008 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m18:36:07.547973 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.jaffle_shop.raw_customers"
[0m18:36:07.554440 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m18:36:07.561198 [debug] [Thread-3 (]: Timing info for seed.jaffle_shop.raw_payments (execute): 18:36:05.456917 => 18:36:07.560959
[0m18:36:07.562711 [debug] [Thread-2 (]: Writing runtime SQL for node "seed.jaffle_shop.raw_orders"
[0m18:36:07.563306 [debug] [Thread-3 (]: On seed.jaffle_shop.raw_payments: Close
[0m18:36:07.567145 [debug] [Thread-1 (]: Timing info for seed.jaffle_shop.raw_customers (execute): 18:36:05.402655 => 18:36:07.566897
[0m18:36:07.569677 [debug] [Thread-1 (]: On seed.jaffle_shop.raw_customers: Close
[0m18:36:07.573653 [debug] [Thread-2 (]: Timing info for seed.jaffle_shop.raw_orders (execute): 18:36:05.448784 => 18:36:07.573413
[0m18:36:07.576263 [debug] [Thread-2 (]: On seed.jaffle_shop.raw_orders: Close
[0m18:36:07.721790 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5745ec60-59c2-4305-893e-23505e4391e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d5952d0>]}
[0m18:36:07.723532 [info ] [Thread-1 (]: 1 of 3 OK loaded seed file JAFFLE_SHOP.raw_customers ........................... [[32mINSERT 100[0m in 2.33s]
[0m18:36:07.725399 [debug] [Thread-1 (]: Finished running node seed.jaffle_shop.raw_customers
[0m18:36:07.737158 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5745ec60-59c2-4305-893e-23505e4391e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d411990>]}
[0m18:36:07.738354 [info ] [Thread-3 (]: 3 of 3 OK loaded seed file JAFFLE_SHOP.raw_payments ............................ [[32mINSERT 113[0m in 2.34s]
[0m18:36:07.740200 [debug] [Thread-3 (]: Finished running node seed.jaffle_shop.raw_payments
[0m18:36:07.746426 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5745ec60-59c2-4305-893e-23505e4391e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d67d6d0>]}
[0m18:36:07.747501 [info ] [Thread-2 (]: 2 of 3 OK loaded seed file JAFFLE_SHOP.raw_orders .............................. [[32mINSERT 99[0m in 2.35s]
[0m18:36:07.748548 [debug] [Thread-2 (]: Finished running node seed.jaffle_shop.raw_orders
[0m18:36:07.751668 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:36:07.752249 [debug] [MainThread]: Connection 'seed.jaffle_shop.raw_customers' was properly closed.
[0m18:36:07.752869 [debug] [MainThread]: Connection 'seed.jaffle_shop.raw_orders' was properly closed.
[0m18:36:07.753369 [debug] [MainThread]: Connection 'seed.jaffle_shop.raw_payments' was properly closed.
[0m18:36:07.754207 [info ] [MainThread]: 
[0m18:36:07.754976 [info ] [MainThread]: Finished running 3 seeds in 0 hours 0 minutes and 3.99 seconds (3.99s).
[0m18:36:07.756494 [debug] [MainThread]: Command end result
[0m18:36:07.767623 [info ] [MainThread]: 
[0m18:36:07.768146 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:36:07.768706 [info ] [MainThread]: 
[0m18:36:07.769490 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m18:36:07.773414 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": true, "command_wall_clock_time": 4.633335, "process_user_time": 3.126695, "process_kernel_time": 0.352954, "process_mem_max_rss": "137961472", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m18:36:07.774433 [debug] [MainThread]: Command `dbt seed` succeeded at 18:36:07.774220 after 4.63 seconds
[0m18:36:07.774947 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c2737d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c34ad10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108697d10>]}
[0m18:36:07.775437 [debug] [MainThread]: Flushing usage events
[0m18:36:14.410061 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fb47390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fb6b910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11017fd50>]}


============================== 18:36:14.414895 | eda3d1e5-0bcc-445c-8a39-1d0b5bb64bf3 ==============================
[0m18:36:14.414895 [info ] [MainThread]: Running with dbt=1.7.8
[0m18:36:14.415521 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/ben/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/ben/jaffle_shop/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:36:14.786427 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'eda3d1e5-0bcc-445c-8a39-1d0b5bb64bf3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110b1c550>]}
[0m18:36:14.871182 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'eda3d1e5-0bcc-445c-8a39-1d0b5bb64bf3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110a693d0>]}
[0m18:36:14.871999 [info ] [MainThread]: Registered adapter: snowflake=1.7.2
[0m18:36:14.889963 [debug] [MainThread]: checksum: 67f0013ca5f0bd43af9a0873dd50792fde83ef69de63b71cacd0b4ac656c52e5, vars: {}, profile: , target: , version: 1.7.8
[0m18:36:14.924644 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:36:14.925306 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:36:14.932552 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'eda3d1e5-0bcc-445c-8a39-1d0b5bb64bf3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11017e1d0>]}
[0m18:36:14.945420 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'eda3d1e5-0bcc-445c-8a39-1d0b5bb64bf3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110ad15d0>]}
[0m18:36:14.945942 [info ] [MainThread]: Found 3 models, 3 seeds, 9 tests, 0 sources, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m18:36:14.946389 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'eda3d1e5-0bcc-445c-8a39-1d0b5bb64bf3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110bf4310>]}
[0m18:36:14.948528 [info ] [MainThread]: 
[0m18:36:14.949403 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m18:36:14.950999 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RAW'
[0m18:36:14.965909 [debug] [ThreadPool]: Using snowflake connection "list_RAW"
[0m18:36:14.966381 [debug] [ThreadPool]: On list_RAW: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_RAW"} */
show terse schemas in database RAW
    limit 10000
[0m18:36:14.966728 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:36:15.445067 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.0 seconds
[0m18:36:15.450113 [debug] [ThreadPool]: On list_RAW: Close
[0m18:36:15.611600 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RAW, now list_RAW_JAFFLE_SHOP)
[0m18:36:15.628463 [debug] [ThreadPool]: Using snowflake connection "list_RAW_JAFFLE_SHOP"
[0m18:36:15.629147 [debug] [ThreadPool]: On list_RAW_JAFFLE_SHOP: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_RAW_JAFFLE_SHOP"} */
show terse objects in RAW.JAFFLE_SHOP limit 10000
[0m18:36:15.629709 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:36:16.116270 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.0 seconds
[0m18:36:16.120863 [debug] [ThreadPool]: On list_RAW_JAFFLE_SHOP: Close
[0m18:36:16.266692 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'eda3d1e5-0bcc-445c-8a39-1d0b5bb64bf3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110b5d410>]}
[0m18:36:16.268894 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:36:16.269938 [info ] [MainThread]: 
[0m18:36:16.274827 [debug] [Thread-1 (]: Began running node model.jaffle_shop.stg_customers
[0m18:36:16.275915 [info ] [Thread-1 (]: 1 of 3 START sql view model JAFFLE_SHOP.stg_customers .......................... [RUN]
[0m18:36:16.276881 [debug] [Thread-2 (]: Began running node model.jaffle_shop.stg_orders
[0m18:36:16.278253 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_RAW_JAFFLE_SHOP, now model.jaffle_shop.stg_customers)
[0m18:36:16.279257 [info ] [Thread-2 (]: 2 of 3 START sql view model JAFFLE_SHOP.stg_orders ............................. [RUN]
[0m18:36:16.280434 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.stg_customers
[0m18:36:16.281668 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.jaffle_shop.stg_orders'
[0m18:36:16.292838 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.stg_customers"
[0m18:36:16.293493 [debug] [Thread-2 (]: Began compiling node model.jaffle_shop.stg_orders
[0m18:36:16.297635 [debug] [Thread-2 (]: Writing injected SQL for node "model.jaffle_shop.stg_orders"
[0m18:36:16.298647 [debug] [Thread-1 (]: Timing info for model.jaffle_shop.stg_customers (compile): 18:36:16.282112 => 18:36:16.298299
[0m18:36:16.299200 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.stg_customers
[0m18:36:16.305478 [debug] [Thread-2 (]: Timing info for model.jaffle_shop.stg_orders (compile): 18:36:16.293987 => 18:36:16.305153
[0m18:36:16.305965 [debug] [Thread-2 (]: Began executing node model.jaffle_shop.stg_orders
[0m18:36:16.351914 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.stg_customers"
[0m18:36:16.352406 [debug] [Thread-2 (]: Writing runtime sql for node "model.jaffle_shop.stg_orders"
[0m18:36:16.353474 [debug] [Thread-2 (]: Using snowflake connection "model.jaffle_shop.stg_orders"
[0m18:36:16.353885 [debug] [Thread-2 (]: On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */
create or replace   view RAW.JAFFLE_SHOP.stg_orders
  
   as (
    

select
    id as order_id,
    user_id as customer_id,
    order_date,
    status

from raw.jaffle_shop.raw_orders
  );
[0m18:36:16.354246 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m18:36:16.355508 [debug] [Thread-1 (]: Using snowflake connection "model.jaffle_shop.stg_customers"
[0m18:36:16.356577 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */
create or replace   view RAW.JAFFLE_SHOP.stg_customers
  
   as (
    

select
    id as customer_id,
    first_name,
    last_name

from raw.jaffle_shop.raw_customers
  );
[0m18:36:16.357092 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:36:16.949569 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m18:36:16.980225 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m18:36:16.988387 [debug] [Thread-1 (]: Timing info for model.jaffle_shop.stg_customers (execute): 18:36:16.299529 => 18:36:16.988135
[0m18:36:16.990157 [debug] [Thread-2 (]: Timing info for model.jaffle_shop.stg_orders (execute): 18:36:16.312340 => 18:36:16.989844
[0m18:36:16.990680 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: Close
[0m18:36:16.991137 [debug] [Thread-2 (]: On model.jaffle_shop.stg_orders: Close
[0m18:36:17.143712 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eda3d1e5-0bcc-445c-8a39-1d0b5bb64bf3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110ca8490>]}
[0m18:36:17.145969 [info ] [Thread-1 (]: 1 of 3 OK created sql view model JAFFLE_SHOP.stg_customers ..................... [[32mSUCCESS 1[0m in 0.87s]
[0m18:36:17.147814 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.stg_customers
[0m18:36:17.169172 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eda3d1e5-0bcc-445c-8a39-1d0b5bb64bf3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110ea7f90>]}
[0m18:36:17.170623 [info ] [Thread-2 (]: 2 of 3 OK created sql view model JAFFLE_SHOP.stg_orders ........................ [[32mSUCCESS 1[0m in 0.89s]
[0m18:36:17.172068 [debug] [Thread-2 (]: Finished running node model.jaffle_shop.stg_orders
[0m18:36:17.173498 [debug] [Thread-4 (]: Began running node model.jaffle_shop.customers
[0m18:36:17.174647 [info ] [Thread-4 (]: 3 of 3 START sql view model JAFFLE_SHOP.customers .............................. [RUN]
[0m18:36:17.176461 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.jaffle_shop.customers'
[0m18:36:17.177276 [debug] [Thread-4 (]: Began compiling node model.jaffle_shop.customers
[0m18:36:17.182755 [debug] [Thread-4 (]: Writing injected SQL for node "model.jaffle_shop.customers"
[0m18:36:17.185043 [debug] [Thread-4 (]: Timing info for model.jaffle_shop.customers (compile): 18:36:17.177753 => 18:36:17.184305
[0m18:36:17.185812 [debug] [Thread-4 (]: Began executing node model.jaffle_shop.customers
[0m18:36:17.191507 [debug] [Thread-4 (]: Writing runtime sql for node "model.jaffle_shop.customers"
[0m18:36:17.193925 [debug] [Thread-4 (]: Using snowflake connection "model.jaffle_shop.customers"
[0m18:36:17.194567 [debug] [Thread-4 (]: On model.jaffle_shop.customers: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.customers"} */
create or replace   view RAW.JAFFLE_SHOP.customers
  
   as (
    


with customers as (

    select * from RAW.JAFFLE_SHOP.stg_customers

),

orders as (

    select * from RAW.JAFFLE_SHOP.stg_orders

),

customer_orders as (

    select
        customer_id,

        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders

    from orders

    group by 1

),

final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce(customer_orders.number_of_orders, 0) as number_of_orders

    from customers

    left join customer_orders using (customer_id)

)

select * from final
  );
[0m18:36:17.195138 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m18:36:17.852685 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m18:36:17.859349 [debug] [Thread-4 (]: Timing info for model.jaffle_shop.customers (execute): 18:36:17.186181 => 18:36:17.858665
[0m18:36:17.860397 [debug] [Thread-4 (]: On model.jaffle_shop.customers: Close
[0m18:36:18.026717 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eda3d1e5-0bcc-445c-8a39-1d0b5bb64bf3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110ce2e90>]}
[0m18:36:18.028357 [info ] [Thread-4 (]: 3 of 3 OK created sql view model JAFFLE_SHOP.customers ......................... [[32mSUCCESS 1[0m in 0.85s]
[0m18:36:18.030068 [debug] [Thread-4 (]: Finished running node model.jaffle_shop.customers
[0m18:36:18.033757 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:36:18.034439 [debug] [MainThread]: Connection 'model.jaffle_shop.stg_customers' was properly closed.
[0m18:36:18.035023 [debug] [MainThread]: Connection 'model.jaffle_shop.stg_orders' was properly closed.
[0m18:36:18.035588 [debug] [MainThread]: Connection 'model.jaffle_shop.customers' was properly closed.
[0m18:36:18.036243 [info ] [MainThread]: 
[0m18:36:18.036923 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 3.09 seconds (3.09s).
[0m18:36:18.039248 [debug] [MainThread]: Command end result
[0m18:36:18.053814 [info ] [MainThread]: 
[0m18:36:18.054449 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:36:18.054916 [info ] [MainThread]: 
[0m18:36:18.055400 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m18:36:18.056969 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 3.7068114, "process_user_time": 3.012941, "process_kernel_time": 0.304429, "process_mem_max_rss": "137097216", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m18:36:18.057670 [debug] [MainThread]: Command `dbt run` succeeded at 18:36:18.057483 after 3.71 seconds
[0m18:36:18.058189 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fd60ad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bf3c050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fb46cd0>]}
[0m18:36:18.058676 [debug] [MainThread]: Flushing usage events
[0m18:37:04.452261 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1061d0e90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a06f0d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a06f010>]}


============================== 18:37:04.460131 | be4b133a-7cb0-447a-a7fc-0232925815c3 ==============================
[0m18:37:04.460131 [info ] [MainThread]: Running with dbt=1.7.8
[0m18:37:04.461044 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/ben/jaffle_shop/logs', 'profiles_dir': '/Users/ben/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m18:37:04.998586 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'be4b133a-7cb0-447a-a7fc-0232925815c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ad315d0>]}
[0m18:37:05.092299 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'be4b133a-7cb0-447a-a7fc-0232925815c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109e03b90>]}
[0m18:37:05.093836 [info ] [MainThread]: Registered adapter: snowflake=1.7.2
[0m18:37:05.114546 [debug] [MainThread]: checksum: 67f0013ca5f0bd43af9a0873dd50792fde83ef69de63b71cacd0b4ac656c52e5, vars: {}, profile: , target: , version: 1.7.8
[0m18:37:05.194680 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:37:05.195188 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:37:05.202461 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'be4b133a-7cb0-447a-a7fc-0232925815c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10af88950>]}
[0m18:37:05.214423 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'be4b133a-7cb0-447a-a7fc-0232925815c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10acfea10>]}
[0m18:37:05.215087 [info ] [MainThread]: Found 3 models, 3 seeds, 9 tests, 0 sources, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m18:37:05.215591 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'be4b133a-7cb0-447a-a7fc-0232925815c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a4aec50>]}
[0m18:37:05.217510 [info ] [MainThread]: 
[0m18:37:05.218365 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m18:37:05.219678 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RAW'
[0m18:37:05.234642 [debug] [ThreadPool]: Using snowflake connection "list_RAW"
[0m18:37:05.235180 [debug] [ThreadPool]: On list_RAW: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_RAW"} */
show terse schemas in database RAW
    limit 10000
[0m18:37:05.235537 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:37:06.010898 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.0 seconds
[0m18:37:06.016398 [debug] [ThreadPool]: On list_RAW: Close
[0m18:37:06.381234 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RAW, now list_RAW_JAFFLE_SHOP)
[0m18:37:06.398441 [debug] [ThreadPool]: Using snowflake connection "list_RAW_JAFFLE_SHOP"
[0m18:37:06.399170 [debug] [ThreadPool]: On list_RAW_JAFFLE_SHOP: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_RAW_JAFFLE_SHOP"} */
show terse objects in RAW.JAFFLE_SHOP limit 10000
[0m18:37:06.399764 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:37:07.063165 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.0 seconds
[0m18:37:07.068499 [debug] [ThreadPool]: On list_RAW_JAFFLE_SHOP: Close
[0m18:37:07.212649 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'be4b133a-7cb0-447a-a7fc-0232925815c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10abb8590>]}
[0m18:37:07.214667 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:37:07.215601 [info ] [MainThread]: 
[0m18:37:07.221629 [debug] [Thread-1 (]: Began running node model.jaffle_shop.stg_customers
[0m18:37:07.222640 [debug] [Thread-2 (]: Began running node model.jaffle_shop.stg_orders
[0m18:37:07.223724 [info ] [Thread-1 (]: 1 of 3 START sql view model JAFFLE_SHOP.stg_customers .......................... [RUN]
[0m18:37:07.224772 [info ] [Thread-2 (]: 2 of 3 START sql view model JAFFLE_SHOP.stg_orders ............................. [RUN]
[0m18:37:07.225992 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_RAW_JAFFLE_SHOP, now model.jaffle_shop.stg_customers)
[0m18:37:07.227236 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.jaffle_shop.stg_orders'
[0m18:37:07.227922 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.stg_customers
[0m18:37:07.228561 [debug] [Thread-2 (]: Began compiling node model.jaffle_shop.stg_orders
[0m18:37:07.240552 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.stg_customers"
[0m18:37:07.244372 [debug] [Thread-2 (]: Writing injected SQL for node "model.jaffle_shop.stg_orders"
[0m18:37:07.245529 [debug] [Thread-1 (]: Timing info for model.jaffle_shop.stg_customers (compile): 18:37:07.228994 => 18:37:07.245206
[0m18:37:07.246036 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.stg_customers
[0m18:37:07.252057 [debug] [Thread-2 (]: Timing info for model.jaffle_shop.stg_orders (compile): 18:37:07.241102 => 18:37:07.251764
[0m18:37:07.252583 [debug] [Thread-2 (]: Began executing node model.jaffle_shop.stg_orders
[0m18:37:07.301348 [debug] [Thread-2 (]: Writing runtime sql for node "model.jaffle_shop.stg_orders"
[0m18:37:07.301901 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.stg_customers"
[0m18:37:07.303029 [debug] [Thread-2 (]: Using snowflake connection "model.jaffle_shop.stg_orders"
[0m18:37:07.303432 [debug] [Thread-2 (]: On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */
create or replace   view RAW.JAFFLE_SHOP.stg_orders
  
   as (
    

select
    id as order_id,
    user_id as customer_id,
    order_date,
    status

from raw.jaffle_shop.raw_orders
  );
[0m18:37:07.303815 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m18:37:07.305518 [debug] [Thread-1 (]: Using snowflake connection "model.jaffle_shop.stg_customers"
[0m18:37:07.306042 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */
create or replace   view RAW.JAFFLE_SHOP.stg_customers
  
   as (
    

select
    id as customer_id,
    first_name,
    last_name

from raw.jaffle_shop.raw_customers
  );
[0m18:37:07.306475 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:37:07.857207 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m18:37:07.895059 [debug] [Thread-2 (]: Timing info for model.jaffle_shop.stg_orders (execute): 18:37:07.252995 => 18:37:07.894688
[0m18:37:07.895576 [debug] [Thread-2 (]: On model.jaffle_shop.stg_orders: Close
[0m18:37:08.031168 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'be4b133a-7cb0-447a-a7fc-0232925815c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ad8e210>]}
[0m18:37:08.033043 [info ] [Thread-2 (]: 2 of 3 OK created sql view model JAFFLE_SHOP.stg_orders ........................ [[32mSUCCESS 1[0m in 0.80s]
[0m18:37:08.035723 [debug] [Thread-2 (]: Finished running node model.jaffle_shop.stg_orders
[0m18:37:08.085243 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m18:37:08.093006 [debug] [Thread-1 (]: Timing info for model.jaffle_shop.stg_customers (execute): 18:37:07.246320 => 18:37:08.092447
[0m18:37:08.094032 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: Close
[0m18:37:08.241340 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'be4b133a-7cb0-447a-a7fc-0232925815c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b24ec50>]}
[0m18:37:08.243232 [info ] [Thread-1 (]: 1 of 3 OK created sql view model JAFFLE_SHOP.stg_customers ..................... [[32mSUCCESS 1[0m in 1.02s]
[0m18:37:08.245077 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.stg_customers
[0m18:37:08.246572 [debug] [Thread-4 (]: Began running node model.jaffle_shop.customers
[0m18:37:08.248360 [info ] [Thread-4 (]: 3 of 3 START sql view model JAFFLE_SHOP.customers .............................. [RUN]
[0m18:37:08.250802 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.jaffle_shop.customers'
[0m18:37:08.251716 [debug] [Thread-4 (]: Began compiling node model.jaffle_shop.customers
[0m18:37:08.258189 [debug] [Thread-4 (]: Writing injected SQL for node "model.jaffle_shop.customers"
[0m18:37:08.259565 [debug] [Thread-4 (]: Timing info for model.jaffle_shop.customers (compile): 18:37:08.252205 => 18:37:08.259145
[0m18:37:08.260237 [debug] [Thread-4 (]: Began executing node model.jaffle_shop.customers
[0m18:37:08.265343 [debug] [Thread-4 (]: Writing runtime sql for node "model.jaffle_shop.customers"
[0m18:37:08.267761 [debug] [Thread-4 (]: Using snowflake connection "model.jaffle_shop.customers"
[0m18:37:08.268794 [debug] [Thread-4 (]: On model.jaffle_shop.customers: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.customers"} */
create or replace   view RAW.JAFFLE_SHOP.customers
  
   as (
    


with customers as (

    select * from RAW.JAFFLE_SHOP.stg_customers

),

orders as (

    select * from RAW.JAFFLE_SHOP.stg_orders

),

customer_orders as (

    select
        customer_id,

        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders

    from orders

    group by 1

),

final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce(customer_orders.number_of_orders, 0) as number_of_orders

    from customers

    left join customer_orders using (customer_id)

)

select * from final
  );
[0m18:37:08.269823 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m18:37:09.087156 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m18:37:09.095316 [debug] [Thread-4 (]: Timing info for model.jaffle_shop.customers (execute): 18:37:08.260652 => 18:37:09.094824
[0m18:37:09.096161 [debug] [Thread-4 (]: On model.jaffle_shop.customers: Close
[0m18:37:09.360035 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'be4b133a-7cb0-447a-a7fc-0232925815c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10af13890>]}
[0m18:37:09.361837 [info ] [Thread-4 (]: 3 of 3 OK created sql view model JAFFLE_SHOP.customers ......................... [[32mSUCCESS 1[0m in 1.11s]
[0m18:37:09.364070 [debug] [Thread-4 (]: Finished running node model.jaffle_shop.customers
[0m18:37:09.368849 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:37:09.369829 [debug] [MainThread]: Connection 'model.jaffle_shop.stg_customers' was properly closed.
[0m18:37:09.370484 [debug] [MainThread]: Connection 'model.jaffle_shop.stg_orders' was properly closed.
[0m18:37:09.371124 [debug] [MainThread]: Connection 'model.jaffle_shop.customers' was properly closed.
[0m18:37:09.371841 [info ] [MainThread]: 
[0m18:37:09.372570 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 4.15 seconds (4.15s).
[0m18:37:09.374333 [debug] [MainThread]: Command end result
[0m18:37:09.388127 [info ] [MainThread]: 
[0m18:37:09.388807 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:37:09.389287 [info ] [MainThread]: 
[0m18:37:09.389779 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m18:37:09.392788 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 5.0050635, "process_user_time": 3.182195, "process_kernel_time": 0.481007, "process_mem_max_rss": "135294976", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m18:37:09.393602 [debug] [MainThread]: Command `dbt run` succeeded at 18:37:09.393425 after 5.01 seconds
[0m18:37:09.394133 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a06f0d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a469ad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1060a9d10>]}
[0m18:37:09.394615 [debug] [MainThread]: Flushing usage events
[0m21:00:18.282517 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dc9d350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dc82e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10da033d0>]}


============================== 21:00:18.292606 | f3d9d774-471c-48a7-8954-e03a9b089efa ==============================
[0m21:00:18.292606 [info ] [MainThread]: Running with dbt=1.7.8
[0m21:00:18.293944 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/ben/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/ben/jaffle_shop/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m21:00:19.044660 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f3d9d774-471c-48a7-8954-e03a9b089efa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10da1a310>]}
[0m21:00:19.176178 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f3d9d774-471c-48a7-8954-e03a9b089efa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e402b90>]}
[0m21:00:19.177880 [info ] [MainThread]: Registered adapter: snowflake=1.7.2
[0m21:00:19.204883 [debug] [MainThread]: checksum: 67f0013ca5f0bd43af9a0873dd50792fde83ef69de63b71cacd0b4ac656c52e5, vars: {}, profile: , target: , version: 1.7.8
[0m21:00:19.310187 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 2 files changed.
[0m21:00:19.311173 [debug] [MainThread]: Partial parsing: added file: jaffle_shop://models/staging/stg_payments.sql
[0m21:00:19.311949 [debug] [MainThread]: Partial parsing: updated file: jaffle_shop://models/schema.yml
[0m21:00:19.312649 [debug] [MainThread]: Partial parsing: updated file: jaffle_shop://models/staging/stg_customers.sql
[0m21:00:19.741126 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f3d9d774-471c-48a7-8954-e03a9b089efa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10eaee190>]}
[0m21:00:19.759812 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f3d9d774-471c-48a7-8954-e03a9b089efa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e726d10>]}
[0m21:00:19.760612 [info ] [MainThread]: Found 4 models, 3 seeds, 11 tests, 0 sources, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m21:00:19.761220 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f3d9d774-471c-48a7-8954-e03a9b089efa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e84cf10>]}
[0m21:00:19.765089 [info ] [MainThread]: 
[0m21:00:19.766406 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m21:00:19.768098 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RAW'
[0m21:00:19.787286 [debug] [ThreadPool]: Using snowflake connection "list_RAW"
[0m21:00:19.788281 [debug] [ThreadPool]: On list_RAW: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_RAW"} */
show terse schemas in database RAW
    limit 10000
[0m21:00:19.788898 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:00:20.683215 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.0 seconds
[0m21:00:20.688711 [debug] [ThreadPool]: On list_RAW: Close
[0m21:00:20.854087 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RAW, now list_RAW_JAFFLE_SHOP)
[0m21:00:20.871096 [debug] [ThreadPool]: Using snowflake connection "list_RAW_JAFFLE_SHOP"
[0m21:00:20.871858 [debug] [ThreadPool]: On list_RAW_JAFFLE_SHOP: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_RAW_JAFFLE_SHOP"} */
show terse objects in RAW.JAFFLE_SHOP limit 10000
[0m21:00:20.872442 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:00:21.480302 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.0 seconds
[0m21:00:21.485892 [debug] [ThreadPool]: On list_RAW_JAFFLE_SHOP: Close
[0m21:00:21.641423 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f3d9d774-471c-48a7-8954-e03a9b089efa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e9a3090>]}
[0m21:00:21.643455 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:00:21.644759 [info ] [MainThread]: 
[0m21:00:21.650379 [debug] [Thread-1 (]: Began running node model.jaffle_shop.stg_customers
[0m21:00:21.651314 [debug] [Thread-2 (]: Began running node model.jaffle_shop.stg_orders
[0m21:00:21.652408 [info ] [Thread-1 (]: 1 of 4 START sql view model JAFFLE_SHOP.stg_customers .......................... [RUN]
[0m21:00:21.653401 [debug] [Thread-3 (]: Began running node model.jaffle_shop.stg_payments
[0m21:00:21.654402 [info ] [Thread-2 (]: 2 of 4 START sql view model JAFFLE_SHOP.stg_orders ............................. [RUN]
[0m21:00:21.655830 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_RAW_JAFFLE_SHOP, now model.jaffle_shop.stg_customers)
[0m21:00:21.656927 [info ] [Thread-3 (]: 3 of 4 START sql view model JAFFLE_SHOP.stg_payments ........................... [RUN]
[0m21:00:21.658629 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.jaffle_shop.stg_orders'
[0m21:00:21.659688 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.stg_customers
[0m21:00:21.661041 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.jaffle_shop.stg_payments'
[0m21:00:21.661764 [debug] [Thread-2 (]: Began compiling node model.jaffle_shop.stg_orders
[0m21:00:21.672970 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.stg_customers"
[0m21:00:21.674551 [debug] [Thread-3 (]: Began compiling node model.jaffle_shop.stg_payments
[0m21:00:21.679555 [debug] [Thread-2 (]: Writing injected SQL for node "model.jaffle_shop.stg_orders"
[0m21:00:21.684247 [debug] [Thread-3 (]: Writing injected SQL for node "model.jaffle_shop.stg_payments"
[0m21:00:21.685732 [debug] [Thread-1 (]: Timing info for model.jaffle_shop.stg_customers (compile): 21:00:21.662227 => 21:00:21.685275
[0m21:00:21.686525 [debug] [Thread-2 (]: Timing info for model.jaffle_shop.stg_orders (compile): 21:00:21.675375 => 21:00:21.686198
[0m21:00:21.687170 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.stg_customers
[0m21:00:21.687852 [debug] [Thread-2 (]: Began executing node model.jaffle_shop.stg_orders
[0m21:00:21.701462 [debug] [Thread-3 (]: Timing info for model.jaffle_shop.stg_payments (compile): 21:00:21.680328 => 21:00:21.700982
[0m21:00:21.741163 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.stg_customers"
[0m21:00:21.750400 [debug] [Thread-2 (]: Writing runtime sql for node "model.jaffle_shop.stg_orders"
[0m21:00:21.751133 [debug] [Thread-3 (]: Began executing node model.jaffle_shop.stg_payments
[0m21:00:21.757791 [debug] [Thread-1 (]: Using snowflake connection "model.jaffle_shop.stg_customers"
[0m21:00:21.758508 [debug] [Thread-3 (]: Writing runtime sql for node "model.jaffle_shop.stg_payments"
[0m21:00:21.759193 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */
create or replace   view RAW.JAFFLE_SHOP.stg_customers
  
   as (
    -- noinspection SqlNoDataSourceInspectionForFile



select
    id as customer_id,
    first_name,
    last_name

from raw.jaffle_shop.raw_customers
  );
[0m21:00:21.760447 [debug] [Thread-2 (]: Using snowflake connection "model.jaffle_shop.stg_orders"
[0m21:00:21.761163 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:00:21.761889 [debug] [Thread-2 (]: On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */
create or replace   view RAW.JAFFLE_SHOP.stg_orders
  
   as (
    

select
    id as order_id,
    user_id as customer_id,
    order_date,
    status

from raw.jaffle_shop.raw_orders
  );
[0m21:00:21.763025 [debug] [Thread-3 (]: Using snowflake connection "model.jaffle_shop.stg_payments"
[0m21:00:21.764498 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m21:00:21.765717 [debug] [Thread-3 (]: On model.jaffle_shop.stg_payments: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_payments"} */
create or replace   view RAW.JAFFLE_SHOP.stg_payments
  
   as (
    

select
    id,
    order_id,
    payment_method,
    amount

from raw.jaffle_shop.raw_payments
  );
[0m21:00:21.768163 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m21:00:23.370491 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m21:00:23.372336 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m21:00:23.373398 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m21:00:23.431552 [debug] [Thread-2 (]: Timing info for model.jaffle_shop.stg_orders (execute): 21:00:21.724569 => 21:00:23.431198
[0m21:00:23.433109 [debug] [Thread-1 (]: Timing info for model.jaffle_shop.stg_customers (execute): 21:00:21.688331 => 21:00:23.432795
[0m21:00:23.436840 [debug] [Thread-3 (]: Timing info for model.jaffle_shop.stg_payments (execute): 21:00:21.751986 => 21:00:23.436394
[0m21:00:23.437648 [debug] [Thread-2 (]: On model.jaffle_shop.stg_orders: Close
[0m21:00:23.438302 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: Close
[0m21:00:23.438886 [debug] [Thread-3 (]: On model.jaffle_shop.stg_payments: Close
[0m21:00:23.687992 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f3d9d774-471c-48a7-8954-e03a9b089efa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ed1fc50>]}
[0m21:00:23.690320 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f3d9d774-471c-48a7-8954-e03a9b089efa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ed77e50>]}
[0m21:00:23.692280 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f3d9d774-471c-48a7-8954-e03a9b089efa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ed74390>]}
[0m21:00:23.694958 [info ] [Thread-1 (]: 1 of 4 OK created sql view model JAFFLE_SHOP.stg_customers ..................... [[32mSUCCESS 1[0m in 2.03s]
[0m21:00:23.696664 [info ] [Thread-3 (]: 3 of 4 OK created sql view model JAFFLE_SHOP.stg_payments ...................... [[32mSUCCESS 1[0m in 2.03s]
[0m21:00:23.698427 [info ] [Thread-2 (]: 2 of 4 OK created sql view model JAFFLE_SHOP.stg_orders ........................ [[32mSUCCESS 1[0m in 2.03s]
[0m21:00:23.700633 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.stg_customers
[0m21:00:23.702346 [debug] [Thread-3 (]: Finished running node model.jaffle_shop.stg_payments
[0m21:00:23.703582 [debug] [Thread-2 (]: Finished running node model.jaffle_shop.stg_orders
[0m21:00:23.705363 [debug] [Thread-4 (]: Began running node model.jaffle_shop.customers
[0m21:00:23.706562 [info ] [Thread-4 (]: 4 of 4 START sql view model JAFFLE_SHOP.customers .............................. [RUN]
[0m21:00:23.708418 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.jaffle_shop.customers'
[0m21:00:23.709042 [debug] [Thread-4 (]: Began compiling node model.jaffle_shop.customers
[0m21:00:23.713700 [debug] [Thread-4 (]: Writing injected SQL for node "model.jaffle_shop.customers"
[0m21:00:23.714881 [debug] [Thread-4 (]: Timing info for model.jaffle_shop.customers (compile): 21:00:23.709412 => 21:00:23.714509
[0m21:00:23.715599 [debug] [Thread-4 (]: Began executing node model.jaffle_shop.customers
[0m21:00:23.722097 [debug] [Thread-4 (]: Writing runtime sql for node "model.jaffle_shop.customers"
[0m21:00:23.724993 [debug] [Thread-4 (]: Using snowflake connection "model.jaffle_shop.customers"
[0m21:00:23.726378 [debug] [Thread-4 (]: On model.jaffle_shop.customers: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.customers"} */
create or replace   view RAW.JAFFLE_SHOP.customers
  
   as (
    


with customers as (

    select * from RAW.JAFFLE_SHOP.stg_customers

),

orders as (

    select * from RAW.JAFFLE_SHOP.stg_orders

),

customer_orders as (

    select
        customer_id,

        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders

    from orders

    group by 1

),

final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce(customer_orders.number_of_orders, 0) as number_of_orders

    from customers

    left join customer_orders using (customer_id)

)

select * from final
  );
[0m21:00:23.728085 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m21:00:24.807692 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m21:00:24.815448 [debug] [Thread-4 (]: Timing info for model.jaffle_shop.customers (execute): 21:00:23.716129 => 21:00:24.814919
[0m21:00:24.816412 [debug] [Thread-4 (]: On model.jaffle_shop.customers: Close
[0m21:00:25.094252 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f3d9d774-471c-48a7-8954-e03a9b089efa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ed5f610>]}
[0m21:00:25.095775 [info ] [Thread-4 (]: 4 of 4 OK created sql view model JAFFLE_SHOP.customers ......................... [[32mSUCCESS 1[0m in 1.39s]
[0m21:00:25.097353 [debug] [Thread-4 (]: Finished running node model.jaffle_shop.customers
[0m21:00:25.101661 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:00:25.102599 [debug] [MainThread]: Connection 'model.jaffle_shop.stg_customers' was properly closed.
[0m21:00:25.106088 [debug] [MainThread]: Connection 'model.jaffle_shop.stg_orders' was properly closed.
[0m21:00:25.125778 [debug] [MainThread]: Connection 'model.jaffle_shop.stg_payments' was properly closed.
[0m21:00:25.126918 [debug] [MainThread]: Connection 'model.jaffle_shop.customers' was properly closed.
[0m21:00:25.128280 [info ] [MainThread]: 
[0m21:00:25.129038 [info ] [MainThread]: Finished running 4 view models in 0 hours 0 minutes and 5.36 seconds (5.36s).
[0m21:00:25.130685 [debug] [MainThread]: Command end result
[0m21:00:25.145446 [info ] [MainThread]: 
[0m21:00:25.146702 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:00:25.147420 [info ] [MainThread]: 
[0m21:00:25.148389 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m21:00:25.153167 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 6.9599442, "process_user_time": 4.913296, "process_kernel_time": 0.692451, "process_mem_max_rss": "143544320", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m21:00:25.154214 [debug] [MainThread]: Command `dbt run` succeeded at 21:00:25.153998 after 6.96 seconds
[0m21:00:25.154849 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d8da690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109904050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10998bd90>]}
[0m21:00:25.155455 [debug] [MainThread]: Flushing usage events
[0m21:32:45.029670 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1095c8fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109253090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109253790>]}


============================== 21:32:45.045344 | 2d600f93-3ef1-48f2-85d7-189ac733affe ==============================
[0m21:32:45.045344 [info ] [MainThread]: Running with dbt=1.7.8
[0m21:32:45.046891 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/ben/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/ben/jaffle_shop/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m21:32:45.906214 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2d600f93-3ef1-48f2-85d7-189ac733affe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108f90f90>]}
[0m21:32:46.087585 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2d600f93-3ef1-48f2-85d7-189ac733affe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1099a0f90>]}
[0m21:32:46.089832 [info ] [MainThread]: Registered adapter: snowflake=1.7.2
[0m21:32:46.136849 [debug] [MainThread]: checksum: 67f0013ca5f0bd43af9a0873dd50792fde83ef69de63b71cacd0b4ac656c52e5, vars: {}, profile: , target: , version: 1.7.8
[0m21:32:46.253422 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:32:46.254138 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:32:46.267257 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2d600f93-3ef1-48f2-85d7-189ac733affe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108fbc4d0>]}
[0m21:32:46.290153 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2d600f93-3ef1-48f2-85d7-189ac733affe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a04b510>]}
[0m21:32:46.291010 [info ] [MainThread]: Found 4 models, 3 seeds, 11 tests, 0 sources, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m21:32:46.291653 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2d600f93-3ef1-48f2-85d7-189ac733affe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a00de90>]}
[0m21:32:46.295169 [info ] [MainThread]: 
[0m21:32:46.296570 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m21:32:46.299315 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RAW'
[0m21:32:46.327281 [debug] [ThreadPool]: Using snowflake connection "list_RAW"
[0m21:32:46.328811 [debug] [ThreadPool]: On list_RAW: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_RAW"} */
show terse schemas in database RAW
    limit 10000
[0m21:32:46.329613 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:32:47.120642 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.0 seconds
[0m21:32:47.123985 [debug] [ThreadPool]: On list_RAW: Close
[0m21:32:47.264923 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RAW, now list_RAW_JAFFLE_SHOP)
[0m21:32:47.280729 [debug] [ThreadPool]: Using snowflake connection "list_RAW_JAFFLE_SHOP"
[0m21:32:47.281522 [debug] [ThreadPool]: On list_RAW_JAFFLE_SHOP: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_RAW_JAFFLE_SHOP"} */
show terse objects in RAW.JAFFLE_SHOP limit 10000
[0m21:32:47.282707 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:32:47.817411 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.0 seconds
[0m21:32:47.821346 [debug] [ThreadPool]: On list_RAW_JAFFLE_SHOP: Close
[0m21:32:47.962679 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2d600f93-3ef1-48f2-85d7-189ac733affe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109651010>]}
[0m21:32:47.966282 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:32:47.967503 [info ] [MainThread]: 
[0m21:32:47.973970 [debug] [Thread-1 (]: Began running node model.jaffle_shop.stg_customers
[0m21:32:47.974727 [debug] [Thread-2 (]: Began running node model.jaffle_shop.stg_orders
[0m21:32:47.975471 [debug] [Thread-3 (]: Began running node model.jaffle_shop.stg_payments
[0m21:32:47.976192 [info ] [Thread-1 (]: 1 of 4 START sql view model JAFFLE_SHOP.stg_customers .......................... [RUN]
[0m21:32:47.977197 [info ] [Thread-2 (]: 2 of 4 START sql view model JAFFLE_SHOP.stg_orders ............................. [RUN]
[0m21:32:47.978191 [info ] [Thread-3 (]: 3 of 4 START sql view model JAFFLE_SHOP.stg_payments ........................... [RUN]
[0m21:32:47.980020 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_RAW_JAFFLE_SHOP, now model.jaffle_shop.stg_customers)
[0m21:32:47.981810 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.jaffle_shop.stg_orders'
[0m21:32:47.983262 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.jaffle_shop.stg_payments'
[0m21:32:47.984453 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.stg_customers
[0m21:32:47.985704 [debug] [Thread-2 (]: Began compiling node model.jaffle_shop.stg_orders
[0m21:32:47.986714 [debug] [Thread-3 (]: Began compiling node model.jaffle_shop.stg_payments
[0m21:32:48.005427 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.stg_customers"
[0m21:32:48.010153 [debug] [Thread-2 (]: Writing injected SQL for node "model.jaffle_shop.stg_orders"
[0m21:32:48.015674 [debug] [Thread-3 (]: Writing injected SQL for node "model.jaffle_shop.stg_payments"
[0m21:32:48.018056 [debug] [Thread-3 (]: Timing info for model.jaffle_shop.stg_payments (compile): 21:32:48.010693 => 21:32:48.017289
[0m21:32:48.019488 [debug] [Thread-2 (]: Timing info for model.jaffle_shop.stg_orders (compile): 21:32:48.006340 => 21:32:48.018823
[0m21:32:48.020393 [debug] [Thread-3 (]: Began executing node model.jaffle_shop.stg_payments
[0m21:32:48.021091 [debug] [Thread-1 (]: Timing info for model.jaffle_shop.stg_customers (compile): 21:32:47.987319 => 21:32:48.020755
[0m21:32:48.021770 [debug] [Thread-2 (]: Began executing node model.jaffle_shop.stg_orders
[0m21:32:48.044330 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.stg_customers
[0m21:32:48.090066 [debug] [Thread-3 (]: Writing runtime sql for node "model.jaffle_shop.stg_payments"
[0m21:32:48.100536 [debug] [Thread-2 (]: Writing runtime sql for node "model.jaffle_shop.stg_orders"
[0m21:32:48.107034 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.stg_customers"
[0m21:32:48.108864 [debug] [Thread-3 (]: Using snowflake connection "model.jaffle_shop.stg_payments"
[0m21:32:48.110019 [debug] [Thread-3 (]: On model.jaffle_shop.stg_payments: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_payments"} */
create or replace   view RAW.JAFFLE_SHOP.stg_payments
  
   as (
    

select
    id,
    order_id,
    payment_method,
    amount

from raw.jaffle_shop.raw_payments
  );
[0m21:32:48.111253 [debug] [Thread-1 (]: Using snowflake connection "model.jaffle_shop.stg_customers"
[0m21:32:48.111893 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m21:32:48.112983 [debug] [Thread-2 (]: Using snowflake connection "model.jaffle_shop.stg_orders"
[0m21:32:48.114047 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */
create or replace   view RAW.JAFFLE_SHOP.stg_customers
  
   as (
    -- noinspection SqlNoDataSourceInspectionForFile



select
    id as customer_id,
    first_name,
    last_name

from raw.jaffle_shop.raw_customers
  );
[0m21:32:48.116514 [debug] [Thread-2 (]: On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */
create or replace   view RAW.JAFFLE_SHOP.stg_orders
  
   as (
    

select
    id as order_id,
    user_id as customer_id,
    order_date,
    status

from raw.jaffle_shop.raw_orders
  );
[0m21:32:48.118083 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:32:48.118987 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m21:32:48.766933 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m21:32:48.811682 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m21:32:48.812948 [debug] [Thread-1 (]: Timing info for model.jaffle_shop.stg_customers (execute): 21:32:48.101377 => 21:32:48.810209
[0m21:32:48.820232 [debug] [Thread-2 (]: Timing info for model.jaffle_shop.stg_orders (execute): 21:32:48.073037 => 21:32:48.819481
[0m21:32:48.821531 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: Close
[0m21:32:48.822431 [debug] [Thread-2 (]: On model.jaffle_shop.stg_orders: Close
[0m21:32:48.862875 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m21:32:48.869667 [debug] [Thread-3 (]: Timing info for model.jaffle_shop.stg_payments (execute): 21:32:48.022154 => 21:32:48.869140
[0m21:32:48.870434 [debug] [Thread-3 (]: On model.jaffle_shop.stg_payments: Close
[0m21:32:48.994582 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2d600f93-3ef1-48f2-85d7-189ac733affe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a2ece50>]}
[0m21:32:48.996225 [info ] [Thread-2 (]: 2 of 4 OK created sql view model JAFFLE_SHOP.stg_orders ........................ [[32mSUCCESS 1[0m in 1.01s]
[0m21:32:48.999413 [debug] [Thread-2 (]: Finished running node model.jaffle_shop.stg_orders
[0m21:32:49.011856 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2d600f93-3ef1-48f2-85d7-189ac733affe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a183dd0>]}
[0m21:32:49.013710 [info ] [Thread-1 (]: 1 of 4 OK created sql view model JAFFLE_SHOP.stg_customers ..................... [[32mSUCCESS 1[0m in 1.03s]
[0m21:32:49.014860 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.stg_customers
[0m21:32:49.016370 [debug] [Thread-4 (]: Began running node model.jaffle_shop.customers
[0m21:32:49.017219 [info ] [Thread-4 (]: 4 of 4 START sql view model JAFFLE_SHOP.customers .............................. [RUN]
[0m21:32:49.019549 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.jaffle_shop.customers'
[0m21:32:49.020631 [debug] [Thread-4 (]: Began compiling node model.jaffle_shop.customers
[0m21:32:49.026966 [debug] [Thread-4 (]: Writing injected SQL for node "model.jaffle_shop.customers"
[0m21:32:49.032542 [debug] [Thread-4 (]: Timing info for model.jaffle_shop.customers (compile): 21:32:49.021077 => 21:32:49.031820
[0m21:32:49.035180 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2d600f93-3ef1-48f2-85d7-189ac733affe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a2d3dd0>]}
[0m21:32:49.036821 [debug] [Thread-4 (]: Began executing node model.jaffle_shop.customers
[0m21:32:49.037910 [info ] [Thread-3 (]: 3 of 4 OK created sql view model JAFFLE_SHOP.stg_payments ...................... [[32mSUCCESS 1[0m in 1.05s]
[0m21:32:49.044433 [debug] [Thread-4 (]: Writing runtime sql for node "model.jaffle_shop.customers"
[0m21:32:49.048718 [debug] [Thread-3 (]: Finished running node model.jaffle_shop.stg_payments
[0m21:32:49.055748 [debug] [Thread-4 (]: Using snowflake connection "model.jaffle_shop.customers"
[0m21:32:49.058025 [debug] [Thread-4 (]: On model.jaffle_shop.customers: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.customers"} */
create or replace   view RAW.JAFFLE_SHOP.customers
  
   as (
    


with customers as (

    select * from RAW.JAFFLE_SHOP.stg_customers

),

orders as (

    select * from RAW.JAFFLE_SHOP.stg_orders

),

customer_orders as (

    select
        customer_id,

        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders

    from orders

    group by 1

),

final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce(customer_orders.number_of_orders, 0) as number_of_orders

    from customers

    left join customer_orders using (customer_id)

)

select * from final
  );
[0m21:32:49.059484 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m21:32:49.781313 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m21:32:49.787621 [debug] [Thread-4 (]: Timing info for model.jaffle_shop.customers (execute): 21:32:49.038584 => 21:32:49.787077
[0m21:32:49.788603 [debug] [Thread-4 (]: On model.jaffle_shop.customers: Close
[0m21:32:49.931349 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2d600f93-3ef1-48f2-85d7-189ac733affe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a298590>]}
[0m21:32:49.932962 [info ] [Thread-4 (]: 4 of 4 OK created sql view model JAFFLE_SHOP.customers ......................... [[32mSUCCESS 1[0m in 0.91s]
[0m21:32:49.935000 [debug] [Thread-4 (]: Finished running node model.jaffle_shop.customers
[0m21:32:49.939292 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:32:49.939933 [debug] [MainThread]: Connection 'model.jaffle_shop.stg_customers' was properly closed.
[0m21:32:49.940480 [debug] [MainThread]: Connection 'model.jaffle_shop.stg_orders' was properly closed.
[0m21:32:49.940956 [debug] [MainThread]: Connection 'model.jaffle_shop.stg_payments' was properly closed.
[0m21:32:49.941398 [debug] [MainThread]: Connection 'model.jaffle_shop.customers' was properly closed.
[0m21:32:49.941926 [info ] [MainThread]: 
[0m21:32:49.942492 [info ] [MainThread]: Finished running 4 view models in 0 hours 0 minutes and 3.65 seconds (3.65s).
[0m21:32:49.944400 [debug] [MainThread]: Command end result
[0m21:32:49.960964 [info ] [MainThread]: 
[0m21:32:49.962396 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:32:49.963050 [info ] [MainThread]: 
[0m21:32:49.963740 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m21:32:49.968893 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 5.057345, "process_user_time": 5.351743, "process_kernel_time": 0.892341, "process_mem_max_rss": "137371648", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m21:32:49.970827 [debug] [MainThread]: Command `dbt run` succeeded at 21:32:49.970499 after 5.06 seconds
[0m21:32:49.971783 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10904ca50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105221e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1092f38d0>]}
[0m21:32:49.972615 [debug] [MainThread]: Flushing usage events
[0m21:55:44.464446 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112b3c650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10eba4690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112e8fdd0>]}


============================== 21:55:44.473962 | aeeee37f-4a6c-46a9-a698-4f781cb07f50 ==============================
[0m21:55:44.473962 [info ] [MainThread]: Running with dbt=1.7.8
[0m21:55:44.475690 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/ben/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/Users/ben/jaffle_shop/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt compile --select int_orders__pivoted', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:55:45.248298 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'aeeee37f-4a6c-46a9-a698-4f781cb07f50', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1137d8fd0>]}
[0m21:55:45.378729 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'aeeee37f-4a6c-46a9-a698-4f781cb07f50', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112ed5c50>]}
[0m21:55:45.381378 [info ] [MainThread]: Registered adapter: snowflake=1.7.2
[0m21:55:45.410003 [debug] [MainThread]: checksum: 67f0013ca5f0bd43af9a0873dd50792fde83ef69de63b71cacd0b4ac656c52e5, vars: {}, profile: , target: , version: 1.7.8
[0m21:55:45.519060 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m21:55:45.520078 [debug] [MainThread]: Partial parsing: added file: jaffle_shop://models/marts/core/int_orders__pivoted.sql
[0m21:55:45.737195 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'aeeee37f-4a6c-46a9-a698-4f781cb07f50', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113b9ee50>]}
[0m21:55:45.756080 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'aeeee37f-4a6c-46a9-a698-4f781cb07f50', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113937190>]}
[0m21:55:45.756890 [info ] [MainThread]: Found 5 models, 3 seeds, 11 tests, 0 sources, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m21:55:45.757500 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'aeeee37f-4a6c-46a9-a698-4f781cb07f50', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1137db110>]}
[0m21:55:45.760351 [info ] [MainThread]: 
[0m21:55:45.761627 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m21:55:45.763453 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RAW_JAFFLE_SHOP'
[0m21:55:45.786196 [debug] [ThreadPool]: Using snowflake connection "list_RAW_JAFFLE_SHOP"
[0m21:55:45.786977 [debug] [ThreadPool]: On list_RAW_JAFFLE_SHOP: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_RAW_JAFFLE_SHOP"} */
show terse objects in RAW.JAFFLE_SHOP limit 10000
[0m21:55:45.788347 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:55:46.733427 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.0 seconds
[0m21:55:46.738991 [debug] [ThreadPool]: On list_RAW_JAFFLE_SHOP: Close
[0m21:55:46.905203 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'aeeee37f-4a6c-46a9-a698-4f781cb07f50', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1139d5690>]}
[0m21:55:46.907161 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:55:46.908157 [info ] [MainThread]: 
[0m21:55:46.913705 [debug] [Thread-1 (]: Began running node model.jaffle_shop.int_orders__pivoted
[0m21:55:46.915296 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_RAW_JAFFLE_SHOP, now model.jaffle_shop.int_orders__pivoted)
[0m21:55:46.916177 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.int_orders__pivoted
[0m21:55:46.930409 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.int_orders__pivoted"
[0m21:55:46.932389 [debug] [Thread-1 (]: Timing info for model.jaffle_shop.int_orders__pivoted (compile): 21:55:46.916630 => 21:55:46.931950
[0m21:55:46.933030 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.int_orders__pivoted
[0m21:55:46.933753 [debug] [Thread-1 (]: Timing info for model.jaffle_shop.int_orders__pivoted (execute): 21:55:46.933400 => 21:55:46.933442
[0m21:55:46.935383 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.int_orders__pivoted
[0m21:55:46.937077 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:55:46.938219 [debug] [MainThread]: Connection 'model.jaffle_shop.int_orders__pivoted' was properly closed.
[0m21:55:46.939715 [debug] [MainThread]: Command end result
[0m21:55:46.954132 [info ] [MainThread]: Compiled node 'int_orders__pivoted' is:


WITH payments AS (
    SELECT * FROM RAW.JAFFLE_SHOP.stg_payments
),

pivoted AS (
    SELECT
        order_id,

        

        SUM(CASE WHEN payment_method = 'bank_transfer' THEN amount ELSE 0 END) AS bank_transfer_amount
        
            ,
        

        

        SUM(CASE WHEN payment_method = 'coupon' THEN amount ELSE 0 END) AS coupon_amount
        
            ,
        

        

        SUM(CASE WHEN payment_method = 'credit_card' THEN amount ELSE 0 END) AS credit_card_amount
        
            ,
        

        

        SUM(CASE WHEN payment_method = 'gift_card' THEN amount ELSE 0 END) AS gift_card_amount
        

        

    FROM payments
    WHERE status = 'success'
    GROUP BY 1
)
[0m21:55:46.956639 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_success": true, "command_wall_clock_time": 2.581078, "process_user_time": 4.070062, "process_kernel_time": 0.618077, "process_mem_max_rss": "135831552", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m21:55:46.957618 [debug] [MainThread]: Command `dbt compile` succeeded at 21:55:46.957401 after 2.58 seconds
[0m21:55:46.958407 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112bb7750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112871c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10eb05d10>]}
[0m21:55:46.959194 [debug] [MainThread]: Flushing usage events
[0m21:56:45.399493 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10825b890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1085d6550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1085e4e10>]}


============================== 21:56:45.409289 | d96f8d1d-7a9b-4001-b7b4-43cb817b6fa2 ==============================
[0m21:56:45.409289 [info ] [MainThread]: Running with dbt=1.7.8
[0m21:56:45.410559 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/ben/jaffle_shop/logs', 'profiles_dir': '/Users/ben/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt compile --select int_orders__pivoted', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:56:46.138671 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd96f8d1d-7a9b-4001-b7b4-43cb817b6fa2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108eda090>]}
[0m21:56:46.266550 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd96f8d1d-7a9b-4001-b7b4-43cb817b6fa2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1085d6590>]}
[0m21:56:46.268624 [info ] [MainThread]: Registered adapter: snowflake=1.7.2
[0m21:56:46.296009 [debug] [MainThread]: checksum: 67f0013ca5f0bd43af9a0873dd50792fde83ef69de63b71cacd0b4ac656c52e5, vars: {}, profile: , target: , version: 1.7.8
[0m21:56:46.399248 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m21:56:46.400337 [debug] [MainThread]: Partial parsing: updated file: jaffle_shop://models/marts/core/int_orders__pivoted.sql
[0m21:56:46.615569 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd96f8d1d-7a9b-4001-b7b4-43cb817b6fa2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1090ef250>]}
[0m21:56:46.633838 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd96f8d1d-7a9b-4001-b7b4-43cb817b6fa2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10907a6d0>]}
[0m21:56:46.634643 [info ] [MainThread]: Found 5 models, 3 seeds, 11 tests, 0 sources, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m21:56:46.635288 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd96f8d1d-7a9b-4001-b7b4-43cb817b6fa2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1090d5ed0>]}
[0m21:56:46.638232 [info ] [MainThread]: 
[0m21:56:46.639792 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m21:56:46.641986 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RAW_JAFFLE_SHOP'
[0m21:56:46.665379 [debug] [ThreadPool]: Using snowflake connection "list_RAW_JAFFLE_SHOP"
[0m21:56:46.666151 [debug] [ThreadPool]: On list_RAW_JAFFLE_SHOP: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_RAW_JAFFLE_SHOP"} */
show terse objects in RAW.JAFFLE_SHOP limit 10000
[0m21:56:46.666752 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:56:47.434339 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.0 seconds
[0m21:56:47.439612 [debug] [ThreadPool]: On list_RAW_JAFFLE_SHOP: Close
[0m21:56:47.602258 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd96f8d1d-7a9b-4001-b7b4-43cb817b6fa2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10918be10>]}
[0m21:56:47.604182 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:56:47.605253 [info ] [MainThread]: 
[0m21:56:47.610525 [debug] [Thread-1 (]: Began running node model.jaffle_shop.int_orders__pivoted
[0m21:56:47.612062 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_RAW_JAFFLE_SHOP, now model.jaffle_shop.int_orders__pivoted)
[0m21:56:47.612933 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.int_orders__pivoted
[0m21:56:47.626949 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.int_orders__pivoted"
[0m21:56:47.628304 [debug] [Thread-1 (]: Timing info for model.jaffle_shop.int_orders__pivoted (compile): 21:56:47.613741 => 21:56:47.627895
[0m21:56:47.628938 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.int_orders__pivoted
[0m21:56:47.629672 [debug] [Thread-1 (]: Timing info for model.jaffle_shop.int_orders__pivoted (execute): 21:56:47.629309 => 21:56:47.629353
[0m21:56:47.633167 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.int_orders__pivoted
[0m21:56:47.635254 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:56:47.636163 [debug] [MainThread]: Connection 'model.jaffle_shop.int_orders__pivoted' was properly closed.
[0m21:56:47.637359 [debug] [MainThread]: Command end result
[0m21:56:47.651044 [info ] [MainThread]: Compiled node 'int_orders__pivoted' is:


WITH payments AS (
    SELECT * FROM RAW.JAFFLE_SHOP.stg_payments
),

pivoted AS (
    SELECT
        order_id,

        SUM(CASE WHEN payment_method = 'bank_transfer' THEN amount ELSE 0 END) AS bank_transfer_amount
        
            ,
        

        SUM(CASE WHEN payment_method = 'coupon' THEN amount ELSE 0 END) AS coupon_amount
        
            ,
        

        SUM(CASE WHEN payment_method = 'credit_card' THEN amount ELSE 0 END) AS credit_card_amount
        
            ,
        

        SUM(CASE WHEN payment_method = 'gift_card' THEN amount ELSE 0 END) AS gift_card_amount
        

        

    FROM payments
    WHERE status = 'success'
    GROUP BY 1
)
[0m21:56:47.654127 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_success": true, "command_wall_clock_time": 2.3388984, "process_user_time": 4.077323, "process_kernel_time": 0.576262, "process_mem_max_rss": "136728576", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m21:56:47.655160 [debug] [MainThread]: Command `dbt compile` succeeded at 21:56:47.654945 after 2.34 seconds
[0m21:56:47.655960 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f53b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108265fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104225d50>]}
[0m21:56:47.656677 [debug] [MainThread]: Flushing usage events
[0m21:57:15.788947 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113092a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112a8a350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112a8a650>]}


============================== 21:57:15.795186 | 9b375598-e057-4606-ba3d-d465263e81f7 ==============================
[0m21:57:15.795186 [info ] [MainThread]: Running with dbt=1.7.8
[0m21:57:15.796350 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/ben/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/ben/jaffle_shop/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt compile --select int_orders__pivoted', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:57:16.329936 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9b375598-e057-4606-ba3d-d465263e81f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113876690>]}
[0m21:57:16.458614 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9b375598-e057-4606-ba3d-d465263e81f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1130e3b90>]}
[0m21:57:16.459905 [info ] [MainThread]: Registered adapter: snowflake=1.7.2
[0m21:57:16.482568 [debug] [MainThread]: checksum: 67f0013ca5f0bd43af9a0873dd50792fde83ef69de63b71cacd0b4ac656c52e5, vars: {}, profile: , target: , version: 1.7.8
[0m21:57:16.536704 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m21:57:16.538279 [debug] [MainThread]: Partial parsing: updated file: jaffle_shop://models/marts/core/int_orders__pivoted.sql
[0m21:57:16.750951 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9b375598-e057-4606-ba3d-d465263e81f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113d77710>]}
[0m21:57:16.768090 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9b375598-e057-4606-ba3d-d465263e81f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113b12710>]}
[0m21:57:16.768893 [info ] [MainThread]: Found 5 models, 3 seeds, 11 tests, 0 sources, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m21:57:16.769499 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9b375598-e057-4606-ba3d-d465263e81f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113d8c310>]}
[0m21:57:16.771853 [info ] [MainThread]: 
[0m21:57:16.773060 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m21:57:16.774946 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RAW_JAFFLE_SHOP'
[0m21:57:16.799537 [debug] [ThreadPool]: Using snowflake connection "list_RAW_JAFFLE_SHOP"
[0m21:57:16.800520 [debug] [ThreadPool]: On list_RAW_JAFFLE_SHOP: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_RAW_JAFFLE_SHOP"} */
show terse objects in RAW.JAFFLE_SHOP limit 10000
[0m21:57:16.801162 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:57:17.980774 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.0 seconds
[0m21:57:17.985819 [debug] [ThreadPool]: On list_RAW_JAFFLE_SHOP: Close
[0m21:57:18.147609 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9b375598-e057-4606-ba3d-d465263e81f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11381a7d0>]}
[0m21:57:18.149539 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:57:18.150668 [info ] [MainThread]: 
[0m21:57:18.155678 [debug] [Thread-1 (]: Began running node model.jaffle_shop.int_orders__pivoted
[0m21:57:18.157173 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_RAW_JAFFLE_SHOP, now model.jaffle_shop.int_orders__pivoted)
[0m21:57:18.158021 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.int_orders__pivoted
[0m21:57:18.171374 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.int_orders__pivoted"
[0m21:57:18.172850 [debug] [Thread-1 (]: Timing info for model.jaffle_shop.int_orders__pivoted (compile): 21:57:18.158570 => 21:57:18.172425
[0m21:57:18.173631 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.int_orders__pivoted
[0m21:57:18.174392 [debug] [Thread-1 (]: Timing info for model.jaffle_shop.int_orders__pivoted (execute): 21:57:18.174028 => 21:57:18.174065
[0m21:57:18.177045 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.int_orders__pivoted
[0m21:57:18.179307 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:57:18.180019 [debug] [MainThread]: Connection 'model.jaffle_shop.int_orders__pivoted' was properly closed.
[0m21:57:18.181130 [debug] [MainThread]: Command end result
[0m21:57:18.194125 [info ] [MainThread]: Compiled node 'int_orders__pivoted' is:


WITH payments AS (
    SELECT * FROM RAW.JAFFLE_SHOP.stg_payments
),

pivoted AS (
    SELECT
        order_id,

        SUM(CASE WHEN payment_method = 'bank_transfer' THEN amount ELSE 0 END) AS bank_transfer_amount,
        

        SUM(CASE WHEN payment_method = 'coupon' THEN amount ELSE 0 END) AS coupon_amount,
        

        SUM(CASE WHEN payment_method = 'credit_card' THEN amount ELSE 0 END) AS credit_card_amount,
        

        SUM(CASE WHEN payment_method = 'gift_card' THEN amount ELSE 0 END) AS gift_card_amount

        

    FROM payments
    WHERE status = 'success'
    GROUP BY 1
)
[0m21:57:18.196135 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_success": true, "command_wall_clock_time": 2.4862194, "process_user_time": 3.874459, "process_kernel_time": 0.363151, "process_mem_max_rss": "136937472", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m21:57:18.197088 [debug] [MainThread]: Command `dbt compile` succeeded at 21:57:18.196854 after 2.49 seconds
[0m21:57:18.197741 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113092b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113093390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ed7a650>]}
[0m21:57:18.198362 [debug] [MainThread]: Flushing usage events
[0m21:57:48.026753 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10695bd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a44650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a298d0>]}


============================== 21:57:48.032694 | 2f673b21-d24f-40b3-b8d8-6fe14bde6ac3 ==============================
[0m21:57:48.032694 [info ] [MainThread]: Running with dbt=1.7.8
[0m21:57:48.033831 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/ben/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/ben/jaffle_shop/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt compile --select int_orders__pivoted', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:57:48.563887 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2f673b21-d24f-40b3-b8d8-6fe14bde6ac3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106deb2d0>]}
[0m21:57:48.692386 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2f673b21-d24f-40b3-b8d8-6fe14bde6ac3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f55990>]}
[0m21:57:48.693613 [info ] [MainThread]: Registered adapter: snowflake=1.7.2
[0m21:57:48.717163 [debug] [MainThread]: checksum: 67f0013ca5f0bd43af9a0873dd50792fde83ef69de63b71cacd0b4ac656c52e5, vars: {}, profile: , target: , version: 1.7.8
[0m21:57:48.768123 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m21:57:48.769624 [debug] [MainThread]: Partial parsing: updated file: jaffle_shop://models/marts/core/int_orders__pivoted.sql
[0m21:57:48.981243 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2f673b21-d24f-40b3-b8d8-6fe14bde6ac3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107aa3890>]}
[0m21:57:48.998139 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2f673b21-d24f-40b3-b8d8-6fe14bde6ac3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10783b0d0>]}
[0m21:57:48.998910 [info ] [MainThread]: Found 5 models, 3 seeds, 11 tests, 0 sources, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m21:57:48.999518 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2f673b21-d24f-40b3-b8d8-6fe14bde6ac3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107792ed0>]}
[0m21:57:49.002130 [info ] [MainThread]: 
[0m21:57:49.003599 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m21:57:49.005528 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RAW_JAFFLE_SHOP'
[0m21:57:49.030141 [debug] [ThreadPool]: Using snowflake connection "list_RAW_JAFFLE_SHOP"
[0m21:57:49.031059 [debug] [ThreadPool]: On list_RAW_JAFFLE_SHOP: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_RAW_JAFFLE_SHOP"} */
show terse objects in RAW.JAFFLE_SHOP limit 10000
[0m21:57:49.031649 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:57:49.711436 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.0 seconds
[0m21:57:49.717229 [debug] [ThreadPool]: On list_RAW_JAFFLE_SHOP: Close
[0m21:57:49.858888 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2f673b21-d24f-40b3-b8d8-6fe14bde6ac3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107929f10>]}
[0m21:57:49.860830 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:57:49.861726 [info ] [MainThread]: 
[0m21:57:49.866260 [debug] [Thread-1 (]: Began running node model.jaffle_shop.int_orders__pivoted
[0m21:57:49.867807 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_RAW_JAFFLE_SHOP, now model.jaffle_shop.int_orders__pivoted)
[0m21:57:49.868660 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.int_orders__pivoted
[0m21:57:49.882197 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.int_orders__pivoted"
[0m21:57:49.883516 [debug] [Thread-1 (]: Timing info for model.jaffle_shop.int_orders__pivoted (compile): 21:57:49.869084 => 21:57:49.883134
[0m21:57:49.884295 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.int_orders__pivoted
[0m21:57:49.885039 [debug] [Thread-1 (]: Timing info for model.jaffle_shop.int_orders__pivoted (execute): 21:57:49.884680 => 21:57:49.884718
[0m21:57:49.886731 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.int_orders__pivoted
[0m21:57:49.889598 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:57:49.890248 [debug] [MainThread]: Connection 'model.jaffle_shop.int_orders__pivoted' was properly closed.
[0m21:57:49.891293 [debug] [MainThread]: Command end result
[0m21:57:49.904667 [info ] [MainThread]: Compiled node 'int_orders__pivoted' is:


WITH payments AS (
    SELECT * FROM RAW.JAFFLE_SHOP.stg_payments
),

pivoted AS (
    SELECT
        order_id,

        SUM(CASE WHEN payment_method = 'bank_transfer' THEN amount ELSE 0 END) AS bank_transfer_amount,
        SUM(CASE WHEN payment_method = 'coupon' THEN amount ELSE 0 END) AS coupon_amount,
        SUM(CASE WHEN payment_method = 'credit_card' THEN amount ELSE 0 END) AS credit_card_amount,
        SUM(CASE WHEN payment_method = 'gift_card' THEN amount ELSE 0 END) AS gift_card_amountFROM payments
    WHERE status = 'success'
    GROUP BY 1
)
[0m21:57:49.906679 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_success": true, "command_wall_clock_time": 1.9607381, "process_user_time": 3.861358, "process_kernel_time": 0.338575, "process_mem_max_rss": "137945088", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m21:57:49.907591 [debug] [MainThread]: Command `dbt compile` succeeded at 21:57:49.907372 after 1.96 seconds
[0m21:57:49.908248 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a461d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10682b910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102a06650>]}
[0m21:57:49.908989 [debug] [MainThread]: Flushing usage events
[0m21:58:23.760864 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108160790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1081d2010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1081d1f90>]}


============================== 21:58:23.766618 | 5e89bf70-e3ab-4bc7-bc46-9f91b3ea07b1 ==============================
[0m21:58:23.766618 [info ] [MainThread]: Running with dbt=1.7.8
[0m21:58:23.767629 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/ben/jaffle_shop/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/ben/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt compile --select int_orders__pivoted', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:58:24.328970 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5e89bf70-e3ab-4bc7-bc46-9f91b3ea07b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108dc4b10>]}
[0m21:58:24.457440 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5e89bf70-e3ab-4bc7-bc46-9f91b3ea07b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10823be90>]}
[0m21:58:24.458684 [info ] [MainThread]: Registered adapter: snowflake=1.7.2
[0m21:58:24.481995 [debug] [MainThread]: checksum: 67f0013ca5f0bd43af9a0873dd50792fde83ef69de63b71cacd0b4ac656c52e5, vars: {}, profile: , target: , version: 1.7.8
[0m21:58:24.533672 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m21:58:24.535061 [debug] [MainThread]: Partial parsing: updated file: jaffle_shop://models/marts/core/int_orders__pivoted.sql
[0m21:58:24.747038 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5e89bf70-e3ab-4bc7-bc46-9f91b3ea07b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109174ad0>]}
[0m21:58:24.763820 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5e89bf70-e3ab-4bc7-bc46-9f91b3ea07b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108e94290>]}
[0m21:58:24.764610 [info ] [MainThread]: Found 5 models, 3 seeds, 11 tests, 0 sources, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m21:58:24.765208 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5e89bf70-e3ab-4bc7-bc46-9f91b3ea07b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108bd0e10>]}
[0m21:58:24.767448 [info ] [MainThread]: 
[0m21:58:24.768871 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m21:58:24.771075 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RAW_JAFFLE_SHOP'
[0m21:58:24.795328 [debug] [ThreadPool]: Using snowflake connection "list_RAW_JAFFLE_SHOP"
[0m21:58:24.796144 [debug] [ThreadPool]: On list_RAW_JAFFLE_SHOP: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_RAW_JAFFLE_SHOP"} */
show terse objects in RAW.JAFFLE_SHOP limit 10000
[0m21:58:24.796895 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:58:25.393129 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.0 seconds
[0m21:58:25.398705 [debug] [ThreadPool]: On list_RAW_JAFFLE_SHOP: Close
[0m21:58:25.557455 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5e89bf70-e3ab-4bc7-bc46-9f91b3ea07b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108f83b90>]}
[0m21:58:25.559427 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:58:25.560323 [info ] [MainThread]: 
[0m21:58:25.564599 [debug] [Thread-1 (]: Began running node model.jaffle_shop.int_orders__pivoted
[0m21:58:25.566055 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_RAW_JAFFLE_SHOP, now model.jaffle_shop.int_orders__pivoted)
[0m21:58:25.566884 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.int_orders__pivoted
[0m21:58:25.581171 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.int_orders__pivoted"
[0m21:58:25.582526 [debug] [Thread-1 (]: Timing info for model.jaffle_shop.int_orders__pivoted (compile): 21:58:25.567379 => 21:58:25.582140
[0m21:58:25.583141 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.int_orders__pivoted
[0m21:58:25.583857 [debug] [Thread-1 (]: Timing info for model.jaffle_shop.int_orders__pivoted (execute): 21:58:25.583506 => 21:58:25.583544
[0m21:58:25.585488 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.int_orders__pivoted
[0m21:58:25.588025 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:58:25.588752 [debug] [MainThread]: Connection 'model.jaffle_shop.int_orders__pivoted' was properly closed.
[0m21:58:25.589706 [debug] [MainThread]: Command end result
[0m21:58:25.604301 [info ] [MainThread]: Compiled node 'int_orders__pivoted' is:


WITH payments AS (
    SELECT * FROM RAW.JAFFLE_SHOP.stg_payments
),

pivoted AS (
    SELECT
        order_id,SUM(CASE WHEN payment_method = 'bank_transfer' THEN amount ELSE 0 END) AS bank_transfer_amount,
        SUM(CASE WHEN payment_method = 'coupon' THEN amount ELSE 0 END) AS coupon_amount,
        SUM(CASE WHEN payment_method = 'credit_card' THEN amount ELSE 0 END) AS credit_card_amount,
        SUM(CASE WHEN payment_method = 'gift_card' THEN amount ELSE 0 END) AS gift_card_amount

    FROM payments
    WHERE status = 'success'
    GROUP BY 1
)
[0m21:58:25.606322 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_success": true, "command_wall_clock_time": 1.9249071, "process_user_time": 3.872132, "process_kernel_time": 0.369083, "process_mem_max_rss": "135663616", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m21:58:25.607242 [debug] [MainThread]: Command `dbt compile` succeeded at 21:58:25.607030 after 1.93 seconds
[0m21:58:25.607878 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e83650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e6cd50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e23d50>]}
[0m21:58:25.608491 [debug] [MainThread]: Flushing usage events
[0m21:58:53.038382 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c34d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c84d050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c84c350>]}


============================== 21:58:53.044488 | 77adb6af-7666-498f-85cd-832349d621a6 ==============================
[0m21:58:53.044488 [info ] [MainThread]: Running with dbt=1.7.8
[0m21:58:53.045688 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/ben/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/ben/jaffle_shop/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt compile --select int_orders__pivoted', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:58:53.606251 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '77adb6af-7666-498f-85cd-832349d621a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cb19510>]}
[0m21:58:53.736685 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '77adb6af-7666-498f-85cd-832349d621a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ce92390>]}
[0m21:58:53.738021 [info ] [MainThread]: Registered adapter: snowflake=1.7.2
[0m21:58:53.761209 [debug] [MainThread]: checksum: 67f0013ca5f0bd43af9a0873dd50792fde83ef69de63b71cacd0b4ac656c52e5, vars: {}, profile: , target: , version: 1.7.8
[0m21:58:53.813664 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m21:58:53.814813 [debug] [MainThread]: Partial parsing: updated file: jaffle_shop://models/marts/core/int_orders__pivoted.sql
[0m21:58:54.028291 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '77adb6af-7666-498f-85cd-832349d621a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dbb7950>]}
[0m21:58:54.044752 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '77adb6af-7666-498f-85cd-832349d621a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d93a6d0>]}
[0m21:58:54.045858 [info ] [MainThread]: Found 5 models, 3 seeds, 11 tests, 0 sources, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m21:58:54.046624 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '77adb6af-7666-498f-85cd-832349d621a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dbaa4d0>]}
[0m21:58:54.050115 [info ] [MainThread]: 
[0m21:58:54.051406 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m21:58:54.053268 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RAW_JAFFLE_SHOP'
[0m21:58:54.074599 [debug] [ThreadPool]: Using snowflake connection "list_RAW_JAFFLE_SHOP"
[0m21:58:54.075306 [debug] [ThreadPool]: On list_RAW_JAFFLE_SHOP: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_RAW_JAFFLE_SHOP"} */
show terse objects in RAW.JAFFLE_SHOP limit 10000
[0m21:58:54.075841 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:58:54.829210 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.0 seconds
[0m21:58:54.832652 [debug] [ThreadPool]: On list_RAW_JAFFLE_SHOP: Close
[0m21:58:54.978399 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '77adb6af-7666-498f-85cd-832349d621a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10da2f050>]}
[0m21:58:54.980376 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:58:54.981463 [info ] [MainThread]: 
[0m21:58:54.986735 [debug] [Thread-1 (]: Began running node model.jaffle_shop.int_orders__pivoted
[0m21:58:54.988333 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_RAW_JAFFLE_SHOP, now model.jaffle_shop.int_orders__pivoted)
[0m21:58:54.989173 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.int_orders__pivoted
[0m21:58:55.002487 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.int_orders__pivoted"
[0m21:58:55.003830 [debug] [Thread-1 (]: Timing info for model.jaffle_shop.int_orders__pivoted (compile): 21:58:54.989727 => 21:58:55.003432
[0m21:58:55.004453 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.int_orders__pivoted
[0m21:58:55.005389 [debug] [Thread-1 (]: Timing info for model.jaffle_shop.int_orders__pivoted (execute): 21:58:55.004989 => 21:58:55.005032
[0m21:58:55.007329 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.int_orders__pivoted
[0m21:58:55.010274 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:58:55.011004 [debug] [MainThread]: Connection 'model.jaffle_shop.int_orders__pivoted' was properly closed.
[0m21:58:55.011984 [debug] [MainThread]: Command end result
[0m21:58:55.024406 [info ] [MainThread]: Compiled node 'int_orders__pivoted' is:


WITH payments AS (
    SELECT * FROM RAW.JAFFLE_SHOP.stg_payments
),

pivoted AS (
    SELECT
        order_id,

        SUM(CASE WHEN payment_method = 'bank_transfer' THEN amount ELSE 0 END) AS bank_transfer_amount,
        SUM(CASE WHEN payment_method = 'coupon' THEN amount ELSE 0 END) AS coupon_amount,
        SUM(CASE WHEN payment_method = 'credit_card' THEN amount ELSE 0 END) AS credit_card_amount,
        SUM(CASE WHEN payment_method = 'gift_card' THEN amount ELSE 0 END) AS gift_card_amount

    FROM payments
    WHERE status = 'success'
    GROUP BY 1
)
[0m21:58:55.026329 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_success": true, "command_wall_clock_time": 2.0844827, "process_user_time": 3.881828, "process_kernel_time": 0.343806, "process_mem_max_rss": "134983680", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m21:58:55.027275 [debug] [MainThread]: Command `dbt compile` succeeded at 21:58:55.027052 after 2.09 seconds
[0m21:58:55.027931 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cb54b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d81b010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c890150>]}
[0m21:58:55.028558 [debug] [MainThread]: Flushing usage events
[0m22:01:02.022363 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113a26a50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1136801d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113683350>]}


============================== 22:01:02.028401 | 4a59119d-49af-4063-aaea-48d75a392f57 ==============================
[0m22:01:02.028401 [info ] [MainThread]: Running with dbt=1.7.8
[0m22:01:02.029373 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/ben/jaffle_shop/logs', 'profiles_dir': '/Users/ben/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt compile --select int_orders__pivoted', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m22:01:02.574021 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4a59119d-49af-4063-aaea-48d75a392f57', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1143ce1d0>]}
[0m22:01:02.703526 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4a59119d-49af-4063-aaea-48d75a392f57', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113a4f950>]}
[0m22:01:02.704818 [info ] [MainThread]: Registered adapter: snowflake=1.7.2
[0m22:01:02.728401 [debug] [MainThread]: checksum: 67f0013ca5f0bd43af9a0873dd50792fde83ef69de63b71cacd0b4ac656c52e5, vars: {}, profile: , target: , version: 1.7.8
[0m22:01:02.782755 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m22:01:02.784017 [debug] [MainThread]: Partial parsing: updated file: jaffle_shop://models/marts/core/int_orders__pivoted.sql
[0m22:01:02.996284 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4a59119d-49af-4063-aaea-48d75a392f57', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114737150>]}
[0m22:01:03.014455 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4a59119d-49af-4063-aaea-48d75a392f57', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1144c9f10>]}
[0m22:01:03.015293 [info ] [MainThread]: Found 5 models, 3 seeds, 11 tests, 0 sources, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m22:01:03.015897 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4a59119d-49af-4063-aaea-48d75a392f57', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1147079d0>]}
[0m22:01:03.018357 [info ] [MainThread]: 
[0m22:01:03.019691 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m22:01:03.022369 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RAW_JAFFLE_SHOP'
[0m22:01:03.047667 [debug] [ThreadPool]: Using snowflake connection "list_RAW_JAFFLE_SHOP"
[0m22:01:03.048487 [debug] [ThreadPool]: On list_RAW_JAFFLE_SHOP: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_RAW_JAFFLE_SHOP"} */
show terse objects in RAW.JAFFLE_SHOP limit 10000
[0m22:01:03.049086 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:01:04.120442 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.0 seconds
[0m22:01:04.125687 [debug] [ThreadPool]: On list_RAW_JAFFLE_SHOP: Close
[0m22:01:04.499612 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4a59119d-49af-4063-aaea-48d75a392f57', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11471f7d0>]}
[0m22:01:04.501593 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:01:04.502973 [info ] [MainThread]: 
[0m22:01:04.508731 [debug] [Thread-1 (]: Began running node model.jaffle_shop.int_orders__pivoted
[0m22:01:04.510267 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_RAW_JAFFLE_SHOP, now model.jaffle_shop.int_orders__pivoted)
[0m22:01:04.511094 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.int_orders__pivoted
[0m22:01:04.524844 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.int_orders__pivoted"
[0m22:01:04.526292 [debug] [Thread-1 (]: Timing info for model.jaffle_shop.int_orders__pivoted (compile): 22:01:04.511595 => 22:01:04.525864
[0m22:01:04.526913 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.int_orders__pivoted
[0m22:01:04.527766 [debug] [Thread-1 (]: Timing info for model.jaffle_shop.int_orders__pivoted (execute): 22:01:04.527277 => 22:01:04.527321
[0m22:01:04.529635 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.int_orders__pivoted
[0m22:01:04.532589 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:01:04.533209 [debug] [MainThread]: Connection 'model.jaffle_shop.int_orders__pivoted' was properly closed.
[0m22:01:04.534207 [debug] [MainThread]: Command end result
[0m22:01:04.548023 [info ] [MainThread]: Compiled node 'int_orders__pivoted' is:


WITH payments AS (
    SELECT * FROM RAW.JAFFLE_SHOP.stg_payments
),

pivoted AS (
    SELECT
        order_id,

        SUM(CASE WHEN payment_method = 'bank_transfer' THEN amount ELSE 0 END) AS bank_transfer_amount,
        SUM(CASE WHEN payment_method = 'coupon' THEN amount ELSE 0 END) AS coupon_amount,
        SUM(CASE WHEN payment_method = 'credit_card' THEN amount ELSE 0 END) AS credit_card_amount,
        SUM(CASE WHEN payment_method = 'gift_card' THEN amount ELSE 0 END) AS gift_card_amount

    FROM payments
    WHERE status = 'success'
    GROUP BY 1
)
[0m22:01:04.550122 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_success": true, "command_wall_clock_time": 2.6074977, "process_user_time": 3.90791, "process_kernel_time": 0.371871, "process_mem_max_rss": "137691136", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m22:01:04.551132 [debug] [MainThread]: Command `dbt compile` succeeded at 22:01:04.550910 after 2.61 seconds
[0m22:01:04.551816 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11383e850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113a03ad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f625dd0>]}
[0m22:01:04.552496 [debug] [MainThread]: Flushing usage events
[0m22:01:31.491558 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1134bff10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1134bd010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112ec5a90>]}


============================== 22:01:31.497430 | df5e0afd-2c3f-4ed4-bcf0-179ca62fe80b ==============================
[0m22:01:31.497430 [info ] [MainThread]: Running with dbt=1.7.8
[0m22:01:31.498486 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/ben/jaffle_shop/logs', 'profiles_dir': '/Users/ben/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt compile --select int_orders__pivoted', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:01:32.040912 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'df5e0afd-2c3f-4ed4-bcf0-179ca62fe80b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113e74810>]}
[0m22:01:32.167715 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'df5e0afd-2c3f-4ed4-bcf0-179ca62fe80b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113d07990>]}
[0m22:01:32.169004 [info ] [MainThread]: Registered adapter: snowflake=1.7.2
[0m22:01:32.191578 [debug] [MainThread]: checksum: 67f0013ca5f0bd43af9a0873dd50792fde83ef69de63b71cacd0b4ac656c52e5, vars: {}, profile: , target: , version: 1.7.8
[0m22:01:32.244105 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m22:01:32.245240 [debug] [MainThread]: Partial parsing: updated file: jaffle_shop://models/marts/core/int_orders__pivoted.sql
[0m22:01:32.458344 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'df5e0afd-2c3f-4ed4-bcf0-179ca62fe80b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114036290>]}
[0m22:01:32.476430 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'df5e0afd-2c3f-4ed4-bcf0-179ca62fe80b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113f91e50>]}
[0m22:01:32.477250 [info ] [MainThread]: Found 5 models, 3 seeds, 11 tests, 0 sources, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m22:01:32.477860 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'df5e0afd-2c3f-4ed4-bcf0-179ca62fe80b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112f54a50>]}
[0m22:01:32.480325 [info ] [MainThread]: 
[0m22:01:32.481535 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m22:01:32.483395 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RAW_JAFFLE_SHOP'
[0m22:01:32.504922 [debug] [ThreadPool]: Using snowflake connection "list_RAW_JAFFLE_SHOP"
[0m22:01:32.506149 [debug] [ThreadPool]: On list_RAW_JAFFLE_SHOP: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_RAW_JAFFLE_SHOP"} */
show terse objects in RAW.JAFFLE_SHOP limit 10000
[0m22:01:32.506927 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:01:33.163520 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.0 seconds
[0m22:01:33.168307 [debug] [ThreadPool]: On list_RAW_JAFFLE_SHOP: Close
[0m22:01:33.314090 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'df5e0afd-2c3f-4ed4-bcf0-179ca62fe80b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114283650>]}
[0m22:01:33.316051 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:01:33.317047 [info ] [MainThread]: 
[0m22:01:33.322087 [debug] [Thread-1 (]: Began running node model.jaffle_shop.int_orders__pivoted
[0m22:01:33.323666 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_RAW_JAFFLE_SHOP, now model.jaffle_shop.int_orders__pivoted)
[0m22:01:33.324513 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.int_orders__pivoted
[0m22:01:33.338284 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.int_orders__pivoted"
[0m22:01:33.339592 [debug] [Thread-1 (]: Timing info for model.jaffle_shop.int_orders__pivoted (compile): 22:01:33.325005 => 22:01:33.339186
[0m22:01:33.340207 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.int_orders__pivoted
[0m22:01:33.340912 [debug] [Thread-1 (]: Timing info for model.jaffle_shop.int_orders__pivoted (execute): 22:01:33.340563 => 22:01:33.340608
[0m22:01:33.342577 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.int_orders__pivoted
[0m22:01:33.345555 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:01:33.346167 [debug] [MainThread]: Connection 'model.jaffle_shop.int_orders__pivoted' was properly closed.
[0m22:01:33.347155 [debug] [MainThread]: Command end result
[0m22:01:33.360242 [info ] [MainThread]: Compiled node 'int_orders__pivoted' is:


WITH payments AS (
    SELECT * FROM RAW.JAFFLE_SHOP.stg_payments
),

pivoted AS (
    SELECT
        order_id,SUM(CASE WHEN payment_method = 'bank_transfer' THEN amount ELSE 0 END) AS bank_transfer_amount,
        SUM(CASE WHEN payment_method = 'coupon' THEN amount ELSE 0 END) AS coupon_amount,
        SUM(CASE WHEN payment_method = 'credit_card' THEN amount ELSE 0 END) AS credit_card_amount,
        SUM(CASE WHEN payment_method = 'gift_card' THEN amount ELSE 0 END) AS gift_card_amount

    FROM payments
    WHERE status = 'success'
    GROUP BY 1
)
[0m22:01:33.362269 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_success": true, "command_wall_clock_time": 1.951351, "process_user_time": 3.847951, "process_kernel_time": 0.36333, "process_mem_max_rss": "136404992", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m22:01:33.363201 [debug] [MainThread]: Command `dbt compile` succeeded at 22:01:33.362975 after 1.95 seconds
[0m22:01:33.363831 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1134bebd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113ed04d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112f41850>]}
[0m22:01:33.364523 [debug] [MainThread]: Flushing usage events
[0m22:01:48.020446 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11286a8d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e5eb350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e5e8e50>]}


============================== 22:01:48.026211 | f985dea7-35bf-4d79-a748-772133a20347 ==============================
[0m22:01:48.026211 [info ] [MainThread]: Running with dbt=1.7.8
[0m22:01:48.027240 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/ben/jaffle_shop/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/ben/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt compile --select int_orders__pivoted', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m22:01:48.557526 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f985dea7-35bf-4d79-a748-772133a20347', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1124c9d90>]}
[0m22:01:48.685916 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f985dea7-35bf-4d79-a748-772133a20347', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112205150>]}
[0m22:01:48.687166 [info ] [MainThread]: Registered adapter: snowflake=1.7.2
[0m22:01:48.710164 [debug] [MainThread]: checksum: 67f0013ca5f0bd43af9a0873dd50792fde83ef69de63b71cacd0b4ac656c52e5, vars: {}, profile: , target: , version: 1.7.8
[0m22:01:48.761416 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m22:01:48.762696 [debug] [MainThread]: Partial parsing: updated file: jaffle_shop://models/marts/core/int_orders__pivoted.sql
[0m22:01:48.975237 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f985dea7-35bf-4d79-a748-772133a20347', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113398950>]}
[0m22:01:48.991749 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f985dea7-35bf-4d79-a748-772133a20347', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1133128d0>]}
[0m22:01:48.992561 [info ] [MainThread]: Found 5 models, 3 seeds, 11 tests, 0 sources, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m22:01:48.993175 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f985dea7-35bf-4d79-a748-772133a20347', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1132c8a10>]}
[0m22:01:48.995704 [info ] [MainThread]: 
[0m22:01:48.997071 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m22:01:48.999057 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RAW_JAFFLE_SHOP'
[0m22:01:49.023952 [debug] [ThreadPool]: Using snowflake connection "list_RAW_JAFFLE_SHOP"
[0m22:01:49.024858 [debug] [ThreadPool]: On list_RAW_JAFFLE_SHOP: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_RAW_JAFFLE_SHOP"} */
show terse objects in RAW.JAFFLE_SHOP limit 10000
[0m22:01:49.025596 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:01:49.933486 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.0 seconds
[0m22:01:49.938974 [debug] [ThreadPool]: On list_RAW_JAFFLE_SHOP: Close
[0m22:01:50.092731 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f985dea7-35bf-4d79-a748-772133a20347', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1133d3650>]}
[0m22:01:50.094891 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:01:50.095835 [info ] [MainThread]: 
[0m22:01:50.100655 [debug] [Thread-1 (]: Began running node model.jaffle_shop.int_orders__pivoted
[0m22:01:50.102152 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_RAW_JAFFLE_SHOP, now model.jaffle_shop.int_orders__pivoted)
[0m22:01:50.102963 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.int_orders__pivoted
[0m22:01:50.116545 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.int_orders__pivoted"
[0m22:01:50.117875 [debug] [Thread-1 (]: Timing info for model.jaffle_shop.int_orders__pivoted (compile): 22:01:50.103454 => 22:01:50.117488
[0m22:01:50.118486 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.int_orders__pivoted
[0m22:01:50.119291 [debug] [Thread-1 (]: Timing info for model.jaffle_shop.int_orders__pivoted (execute): 22:01:50.118844 => 22:01:50.118913
[0m22:01:50.120990 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.int_orders__pivoted
[0m22:01:50.123841 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:01:50.124452 [debug] [MainThread]: Connection 'model.jaffle_shop.int_orders__pivoted' was properly closed.
[0m22:01:50.125438 [debug] [MainThread]: Command end result
[0m22:01:50.140568 [info ] [MainThread]: Compiled node 'int_orders__pivoted' is:


WITH payments AS (
    SELECT * FROM RAW.JAFFLE_SHOP.stg_payments
),

pivoted AS (
    SELECT
        order_id,

        SUM(CASE WHEN payment_method = 'bank_transfer' THEN amount ELSE 0 END) AS bank_transfer_amount,
        SUM(CASE WHEN payment_method = 'coupon' THEN amount ELSE 0 END) AS coupon_amount,
        SUM(CASE WHEN payment_method = 'credit_card' THEN amount ELSE 0 END) AS credit_card_amount,
        SUM(CASE WHEN payment_method = 'gift_card' THEN amount ELSE 0 END) AS gift_card_amount

    FROM payments
    WHERE status = 'success'
    GROUP BY 1
)
[0m22:01:50.142525 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_success": true, "command_wall_clock_time": 2.2043316, "process_user_time": 3.850481, "process_kernel_time": 0.335845, "process_mem_max_rss": "135696384", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m22:01:50.143453 [debug] [MainThread]: Command `dbt compile` succeeded at 22:01:50.143227 after 2.21 seconds
[0m22:01:50.144079 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11286a8d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1124fc9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112150d90>]}
[0m22:01:50.144708 [debug] [MainThread]: Flushing usage events
[0m22:02:14.363280 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10605c750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e09a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d2ba10>]}


============================== 22:02:14.369610 | bc15f130-9a04-470b-86f8-42c888dce50a ==============================
[0m22:02:14.369610 [info ] [MainThread]: Running with dbt=1.7.8
[0m22:02:14.371134 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/Users/ben/.dbt', 'log_path': '/Users/ben/jaffle_shop/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt compile --select int_orders__pivoted', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m22:02:14.910131 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bc15f130-9a04-470b-86f8-42c888dce50a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b62710>]}
[0m22:02:15.041273 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bc15f130-9a04-470b-86f8-42c888dce50a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063e8c50>]}
[0m22:02:15.042563 [info ] [MainThread]: Registered adapter: snowflake=1.7.2
[0m22:02:15.065875 [debug] [MainThread]: checksum: 67f0013ca5f0bd43af9a0873dd50792fde83ef69de63b71cacd0b4ac656c52e5, vars: {}, profile: , target: , version: 1.7.8
[0m22:02:15.118106 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m22:02:15.119278 [debug] [MainThread]: Partial parsing: updated file: jaffle_shop://models/marts/core/int_orders__pivoted.sql
[0m22:02:15.336324 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bc15f130-9a04-470b-86f8-42c888dce50a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10708c7d0>]}
[0m22:02:15.352902 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bc15f130-9a04-470b-86f8-42c888dce50a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e12650>]}
[0m22:02:15.353685 [info ] [MainThread]: Found 5 models, 3 seeds, 11 tests, 0 sources, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m22:02:15.354300 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bc15f130-9a04-470b-86f8-42c888dce50a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107075b50>]}
[0m22:02:15.356542 [info ] [MainThread]: 
[0m22:02:15.357901 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m22:02:15.359818 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RAW_JAFFLE_SHOP'
[0m22:02:15.384075 [debug] [ThreadPool]: Using snowflake connection "list_RAW_JAFFLE_SHOP"
[0m22:02:15.384791 [debug] [ThreadPool]: On list_RAW_JAFFLE_SHOP: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_RAW_JAFFLE_SHOP"} */
show terse objects in RAW.JAFFLE_SHOP limit 10000
[0m22:02:15.385429 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:02:16.521126 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.0 seconds
[0m22:02:16.527348 [debug] [ThreadPool]: On list_RAW_JAFFLE_SHOP: Close
[0m22:02:16.873182 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bc15f130-9a04-470b-86f8-42c888dce50a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d63150>]}
[0m22:02:16.875159 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:02:16.876154 [info ] [MainThread]: 
[0m22:02:16.881571 [debug] [Thread-1 (]: Began running node model.jaffle_shop.int_orders__pivoted
[0m22:02:16.883087 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_RAW_JAFFLE_SHOP, now model.jaffle_shop.int_orders__pivoted)
[0m22:02:16.883925 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.int_orders__pivoted
[0m22:02:16.897315 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.int_orders__pivoted"
[0m22:02:16.898671 [debug] [Thread-1 (]: Timing info for model.jaffle_shop.int_orders__pivoted (compile): 22:02:16.884357 => 22:02:16.898271
[0m22:02:16.899296 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.int_orders__pivoted
[0m22:02:16.900038 [debug] [Thread-1 (]: Timing info for model.jaffle_shop.int_orders__pivoted (execute): 22:02:16.899683 => 22:02:16.899716
[0m22:02:16.901793 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.int_orders__pivoted
[0m22:02:16.904708 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:02:16.905332 [debug] [MainThread]: Connection 'model.jaffle_shop.int_orders__pivoted' was properly closed.
[0m22:02:16.906351 [debug] [MainThread]: Command end result
[0m22:02:16.920283 [info ] [MainThread]: Compiled node 'int_orders__pivoted' is:


WITH payments AS (
    SELECT * FROM RAW.JAFFLE_SHOP.stg_payments
),

pivoted AS (
    SELECT
        order_id,
        SUM(CASE WHEN payment_method = 'bank_transfer' THEN amount ELSE 0 END) AS bank_transfer_amount,
        SUM(CASE WHEN payment_method = 'coupon' THEN amount ELSE 0 END) AS coupon_amount,
        SUM(CASE WHEN payment_method = 'credit_card' THEN amount ELSE 0 END) AS credit_card_amount,
        SUM(CASE WHEN payment_method = 'gift_card' THEN amount ELSE 0 END) AS gift_card_amount

    FROM payments
    WHERE status = 'success'
    GROUP BY 1
)
[0m22:02:16.922322 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_success": true, "command_wall_clock_time": 2.639265, "process_user_time": 3.881074, "process_kernel_time": 0.362606, "process_mem_max_rss": "135983104", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m22:02:16.923254 [debug] [MainThread]: Command `dbt compile` succeeded at 22:02:16.923031 after 2.64 seconds
[0m22:02:16.923900 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10638e590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106115d50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102123cd0>]}
[0m22:02:16.924779 [debug] [MainThread]: Flushing usage events
[0m22:02:27.922578 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105107b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b54a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1050e42d0>]}


============================== 22:02:27.928371 | d9f4da81-da62-43ec-80d1-55a0708f28c1 ==============================
[0m22:02:27.928371 [info ] [MainThread]: Running with dbt=1.7.8
[0m22:02:27.929394 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/ben/jaffle_shop/logs', 'profiles_dir': '/Users/ben/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt compile --select int_orders__pivoted', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m22:02:28.462208 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd9f4da81-da62-43ec-80d1-55a0708f28c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a16f10>]}
[0m22:02:28.590059 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd9f4da81-da62-43ec-80d1-55a0708f28c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1051bf990>]}
[0m22:02:28.591304 [info ] [MainThread]: Registered adapter: snowflake=1.7.2
[0m22:02:28.614328 [debug] [MainThread]: checksum: 67f0013ca5f0bd43af9a0873dd50792fde83ef69de63b71cacd0b4ac656c52e5, vars: {}, profile: , target: , version: 1.7.8
[0m22:02:28.668883 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m22:02:28.669972 [debug] [MainThread]: Partial parsing: updated file: jaffle_shop://models/marts/core/int_orders__pivoted.sql
[0m22:02:28.883896 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd9f4da81-da62-43ec-80d1-55a0708f28c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d70ad0>]}
[0m22:02:28.901520 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd9f4da81-da62-43ec-80d1-55a0708f28c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105deb750>]}
[0m22:02:28.902459 [info ] [MainThread]: Found 5 models, 3 seeds, 11 tests, 0 sources, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m22:02:28.903136 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd9f4da81-da62-43ec-80d1-55a0708f28c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105b6cad0>]}
[0m22:02:28.905587 [info ] [MainThread]: 
[0m22:02:28.906783 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m22:02:28.908618 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RAW_JAFFLE_SHOP'
[0m22:02:28.931098 [debug] [ThreadPool]: Using snowflake connection "list_RAW_JAFFLE_SHOP"
[0m22:02:28.932313 [debug] [ThreadPool]: On list_RAW_JAFFLE_SHOP: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_RAW_JAFFLE_SHOP"} */
show terse objects in RAW.JAFFLE_SHOP limit 10000
[0m22:02:28.932905 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:02:29.688101 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.0 seconds
[0m22:02:29.694694 [debug] [ThreadPool]: On list_RAW_JAFFLE_SHOP: Close
[0m22:02:29.843254 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd9f4da81-da62-43ec-80d1-55a0708f28c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a8b810>]}
[0m22:02:29.845170 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:02:29.846099 [info ] [MainThread]: 
[0m22:02:29.851042 [debug] [Thread-1 (]: Began running node model.jaffle_shop.int_orders__pivoted
[0m22:02:29.852636 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_RAW_JAFFLE_SHOP, now model.jaffle_shop.int_orders__pivoted)
[0m22:02:29.853525 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.int_orders__pivoted
[0m22:02:29.866441 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.int_orders__pivoted"
[0m22:02:29.868210 [debug] [Thread-1 (]: Timing info for model.jaffle_shop.int_orders__pivoted (compile): 22:02:29.853967 => 22:02:29.867537
[0m22:02:29.869027 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.int_orders__pivoted
[0m22:02:29.869774 [debug] [Thread-1 (]: Timing info for model.jaffle_shop.int_orders__pivoted (execute): 22:02:29.869418 => 22:02:29.869456
[0m22:02:29.871620 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.int_orders__pivoted
[0m22:02:29.874055 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:02:29.875052 [debug] [MainThread]: Connection 'model.jaffle_shop.int_orders__pivoted' was properly closed.
[0m22:02:29.876064 [debug] [MainThread]: Command end result
[0m22:02:29.888683 [info ] [MainThread]: Compiled node 'int_orders__pivoted' is:


WITH payments AS (
    SELECT * FROM RAW.JAFFLE_SHOP.stg_payments
),

pivoted AS (
    SELECT
        order_id,
        SUM(CASE WHEN payment_method = 'bank_transfer' THEN amount ELSE 0 END) AS bank_transfer_amount,
        SUM(CASE WHEN payment_method = 'coupon' THEN amount ELSE 0 END) AS coupon_amount,
        SUM(CASE WHEN payment_method = 'credit_card' THEN amount ELSE 0 END) AS credit_card_amount,
        SUM(CASE WHEN payment_method = 'gift_card' THEN amount ELSE 0 END) AS gift_card_amount
    FROM payments
    WHERE status = 'success'
    GROUP BY 1
)
[0m22:02:29.890793 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_success": true, "command_wall_clock_time": 2.0490038, "process_user_time": 3.856837, "process_kernel_time": 0.341781, "process_mem_max_rss": "136384512", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m22:02:29.891761 [debug] [MainThread]: Command `dbt compile` succeeded at 22:02:29.891544 after 2.05 seconds
[0m22:02:29.892407 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10511aad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105006a10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d54090>]}
[0m22:02:29.893016 [debug] [MainThread]: Flushing usage events
[0m22:02:38.481000 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e2e8e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e2f9550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e9249d0>]}


============================== 22:02:38.487069 | c6cc6651-563e-4229-be4f-64bb9aac9f18 ==============================
[0m22:02:38.487069 [info ] [MainThread]: Running with dbt=1.7.8
[0m22:02:38.488108 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/ben/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/ben/jaffle_shop/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:02:39.072746 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c6cc6651-563e-4229-be4f-64bb9aac9f18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f1023d0>]}
[0m22:02:39.225217 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c6cc6651-563e-4229-be4f-64bb9aac9f18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e935fd0>]}
[0m22:02:39.226535 [info ] [MainThread]: Registered adapter: snowflake=1.7.2
[0m22:02:39.252389 [debug] [MainThread]: checksum: 67f0013ca5f0bd43af9a0873dd50792fde83ef69de63b71cacd0b4ac656c52e5, vars: {}, profile: , target: , version: 1.7.8
[0m22:02:39.305520 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:02:39.306200 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:02:39.316419 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c6cc6651-563e-4229-be4f-64bb9aac9f18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e32e790>]}
[0m22:02:39.333372 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c6cc6651-563e-4229-be4f-64bb9aac9f18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f14d150>]}
[0m22:02:39.334169 [info ] [MainThread]: Found 5 models, 3 seeds, 11 tests, 0 sources, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m22:02:39.334780 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c6cc6651-563e-4229-be4f-64bb9aac9f18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f155690>]}
[0m22:02:39.338317 [info ] [MainThread]: 
[0m22:02:39.340000 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m22:02:39.342108 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RAW'
[0m22:02:39.364543 [debug] [ThreadPool]: Using snowflake connection "list_RAW"
[0m22:02:39.365223 [debug] [ThreadPool]: On list_RAW: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_RAW"} */
show terse schemas in database RAW
    limit 10000
[0m22:02:39.365796 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:02:39.997062 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.0 seconds
[0m22:02:40.002131 [debug] [ThreadPool]: On list_RAW: Close
[0m22:02:40.146617 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RAW, now list_RAW_JAFFLE_SHOP)
[0m22:02:40.162948 [debug] [ThreadPool]: Using snowflake connection "list_RAW_JAFFLE_SHOP"
[0m22:02:40.163686 [debug] [ThreadPool]: On list_RAW_JAFFLE_SHOP: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_RAW_JAFFLE_SHOP"} */
show terse objects in RAW.JAFFLE_SHOP limit 10000
[0m22:02:40.164247 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:02:40.755801 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.0 seconds
[0m22:02:40.760748 [debug] [ThreadPool]: On list_RAW_JAFFLE_SHOP: Close
[0m22:02:40.925752 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c6cc6651-563e-4229-be4f-64bb9aac9f18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f38e810>]}
[0m22:02:40.928512 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:02:40.929662 [info ] [MainThread]: 
[0m22:02:40.934954 [debug] [Thread-1 (]: Began running node model.jaffle_shop.stg_customers
[0m22:02:40.936071 [info ] [Thread-1 (]: 1 of 5 START sql view model JAFFLE_SHOP.stg_customers .......................... [RUN]
[0m22:02:40.937027 [debug] [Thread-2 (]: Began running node model.jaffle_shop.stg_orders
[0m22:02:40.938375 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_RAW_JAFFLE_SHOP, now model.jaffle_shop.stg_customers)
[0m22:02:40.939152 [debug] [Thread-3 (]: Began running node model.jaffle_shop.stg_payments
[0m22:02:40.940066 [info ] [Thread-2 (]: 2 of 5 START sql view model JAFFLE_SHOP.stg_orders ............................. [RUN]
[0m22:02:40.940895 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.stg_customers
[0m22:02:40.941640 [info ] [Thread-3 (]: 3 of 5 START sql view model JAFFLE_SHOP.stg_payments ........................... [RUN]
[0m22:02:40.942872 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.jaffle_shop.stg_orders'
[0m22:02:40.954045 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.stg_customers"
[0m22:02:40.955499 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.jaffle_shop.stg_payments'
[0m22:02:40.956240 [debug] [Thread-2 (]: Began compiling node model.jaffle_shop.stg_orders
[0m22:02:40.958271 [debug] [Thread-3 (]: Began compiling node model.jaffle_shop.stg_payments
[0m22:02:40.962640 [debug] [Thread-2 (]: Writing injected SQL for node "model.jaffle_shop.stg_orders"
[0m22:02:40.967165 [debug] [Thread-3 (]: Writing injected SQL for node "model.jaffle_shop.stg_payments"
[0m22:02:40.967943 [debug] [Thread-1 (]: Timing info for model.jaffle_shop.stg_customers (compile): 22:02:40.943315 => 22:02:40.967584
[0m22:02:40.969269 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.stg_customers
[0m22:02:40.975963 [debug] [Thread-3 (]: Timing info for model.jaffle_shop.stg_payments (compile): 22:02:40.963236 => 22:02:40.975533
[0m22:02:40.989418 [debug] [Thread-2 (]: Timing info for model.jaffle_shop.stg_orders (compile): 22:02:40.958894 => 22:02:40.988971
[0m22:02:40.989991 [debug] [Thread-3 (]: Began executing node model.jaffle_shop.stg_payments
[0m22:02:41.008307 [debug] [Thread-2 (]: Began executing node model.jaffle_shop.stg_orders
[0m22:02:41.019349 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.stg_customers"
[0m22:02:41.025081 [debug] [Thread-3 (]: Writing runtime sql for node "model.jaffle_shop.stg_payments"
[0m22:02:41.029929 [debug] [Thread-2 (]: Writing runtime sql for node "model.jaffle_shop.stg_orders"
[0m22:02:41.031804 [debug] [Thread-3 (]: Using snowflake connection "model.jaffle_shop.stg_payments"
[0m22:02:41.032928 [debug] [Thread-1 (]: Using snowflake connection "model.jaffle_shop.stg_customers"
[0m22:02:41.033583 [debug] [Thread-3 (]: On model.jaffle_shop.stg_payments: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_payments"} */
create or replace   view RAW.JAFFLE_SHOP.stg_payments
  
   as (
    

select
    id,
    order_id,
    payment_method,
    amount

from raw.jaffle_shop.raw_payments
  );
[0m22:02:41.034646 [debug] [Thread-2 (]: Using snowflake connection "model.jaffle_shop.stg_orders"
[0m22:02:41.035218 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */
create or replace   view RAW.JAFFLE_SHOP.stg_customers
  
   as (
    -- noinspection SqlNoDataSourceInspectionForFile



select
    id as customer_id,
    first_name,
    last_name

from raw.jaffle_shop.raw_customers
  );
[0m22:02:41.035802 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m22:02:41.036376 [debug] [Thread-2 (]: On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */
create or replace   view RAW.JAFFLE_SHOP.stg_orders
  
   as (
    

select
    id as order_id,
    user_id as customer_id,
    order_date,
    status

from raw.jaffle_shop.raw_orders
  );
[0m22:02:41.036926 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:02:41.038391 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m22:02:41.612058 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m22:02:41.651116 [debug] [Thread-1 (]: Timing info for model.jaffle_shop.stg_customers (execute): 22:02:40.969794 => 22:02:41.650746
[0m22:02:41.651853 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: Close
[0m22:02:41.665266 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m22:02:41.670105 [debug] [Thread-2 (]: Timing info for model.jaffle_shop.stg_orders (execute): 22:02:41.025607 => 22:02:41.669608
[0m22:02:41.670915 [debug] [Thread-2 (]: On model.jaffle_shop.stg_orders: Close
[0m22:02:41.688726 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m22:02:41.692732 [debug] [Thread-3 (]: Timing info for model.jaffle_shop.stg_payments (execute): 22:02:41.019901 => 22:02:41.692404
[0m22:02:41.693322 [debug] [Thread-3 (]: On model.jaffle_shop.stg_payments: Close
[0m22:02:41.798434 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c6cc6651-563e-4229-be4f-64bb9aac9f18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f4e1d90>]}
[0m22:02:41.800651 [info ] [Thread-1 (]: 1 of 5 OK created sql view model JAFFLE_SHOP.stg_customers ..................... [[32mSUCCESS 1[0m in 0.86s]
[0m22:02:41.802572 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.stg_customers
[0m22:02:41.820227 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c6cc6651-563e-4229-be4f-64bb9aac9f18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f40be10>]}
[0m22:02:41.822286 [info ] [Thread-2 (]: 2 of 5 OK created sql view model JAFFLE_SHOP.stg_orders ........................ [[32mSUCCESS 1[0m in 0.88s]
[0m22:02:41.823720 [debug] [Thread-2 (]: Finished running node model.jaffle_shop.stg_orders
[0m22:02:41.825015 [debug] [Thread-4 (]: Began running node model.jaffle_shop.customers
[0m22:02:41.826088 [info ] [Thread-4 (]: 4 of 5 START sql view model JAFFLE_SHOP.customers .............................. [RUN]
[0m22:02:41.827838 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.jaffle_shop.customers'
[0m22:02:41.828672 [debug] [Thread-4 (]: Began compiling node model.jaffle_shop.customers
[0m22:02:41.837273 [debug] [Thread-4 (]: Writing injected SQL for node "model.jaffle_shop.customers"
[0m22:02:41.839298 [debug] [Thread-4 (]: Timing info for model.jaffle_shop.customers (compile): 22:02:41.829151 => 22:02:41.838589
[0m22:02:41.840088 [debug] [Thread-4 (]: Began executing node model.jaffle_shop.customers
[0m22:02:41.845285 [debug] [Thread-4 (]: Writing runtime sql for node "model.jaffle_shop.customers"
[0m22:02:41.847913 [debug] [Thread-4 (]: Using snowflake connection "model.jaffle_shop.customers"
[0m22:02:41.848940 [debug] [Thread-4 (]: On model.jaffle_shop.customers: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.customers"} */
create or replace   view RAW.JAFFLE_SHOP.customers
  
   as (
    


with customers as (

    select * from RAW.JAFFLE_SHOP.stg_customers

),

orders as (

    select * from RAW.JAFFLE_SHOP.stg_orders

),

customer_orders as (

    select
        customer_id,

        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders

    from orders

    group by 1

),

final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce(customer_orders.number_of_orders, 0) as number_of_orders

    from customers

    left join customer_orders using (customer_id)

)

select * from final
  );
[0m22:02:41.850181 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m22:02:41.895886 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c6cc6651-563e-4229-be4f-64bb9aac9f18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f65f2d0>]}
[0m22:02:41.896884 [info ] [Thread-3 (]: 3 of 5 OK created sql view model JAFFLE_SHOP.stg_payments ...................... [[32mSUCCESS 1[0m in 0.94s]
[0m22:02:41.897788 [debug] [Thread-3 (]: Finished running node model.jaffle_shop.stg_payments
[0m22:02:41.898694 [debug] [Thread-2 (]: Began running node model.jaffle_shop.int_orders__pivoted
[0m22:02:41.899525 [info ] [Thread-2 (]: 5 of 5 START sql table model JAFFLE_SHOP.int_orders__pivoted ................... [RUN]
[0m22:02:41.900767 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.jaffle_shop.stg_orders, now model.jaffle_shop.int_orders__pivoted)
[0m22:02:41.901462 [debug] [Thread-2 (]: Began compiling node model.jaffle_shop.int_orders__pivoted
[0m22:02:41.908365 [debug] [Thread-2 (]: Writing injected SQL for node "model.jaffle_shop.int_orders__pivoted"
[0m22:02:41.910681 [debug] [Thread-2 (]: Timing info for model.jaffle_shop.int_orders__pivoted (compile): 22:02:41.901873 => 22:02:41.910082
[0m22:02:41.911367 [debug] [Thread-2 (]: Began executing node model.jaffle_shop.int_orders__pivoted
[0m22:02:41.949784 [debug] [Thread-2 (]: Writing runtime sql for node "model.jaffle_shop.int_orders__pivoted"
[0m22:02:41.952183 [debug] [Thread-2 (]: Using snowflake connection "model.jaffle_shop.int_orders__pivoted"
[0m22:02:41.952807 [debug] [Thread-2 (]: On model.jaffle_shop.int_orders__pivoted: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.int_orders__pivoted"} */
create or replace transient table RAW.JAFFLE_SHOP.int_orders__pivoted
         as
        (

WITH payments AS (
    SELECT * FROM RAW.JAFFLE_SHOP.stg_payments
),

pivoted AS (
    SELECT
        order_id,
        SUM(CASE WHEN payment_method = 'bank_transfer' THEN amount ELSE 0 END) AS bank_transfer_amount,
        SUM(CASE WHEN payment_method = 'coupon' THEN amount ELSE 0 END) AS coupon_amount,
        SUM(CASE WHEN payment_method = 'credit_card' THEN amount ELSE 0 END) AS credit_card_amount,
        SUM(CASE WHEN payment_method = 'gift_card' THEN amount ELSE 0 END) AS gift_card_amount
    FROM payments
    WHERE status = 'success'
    GROUP BY 1
)
        );
[0m22:02:41.953378 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:02:42.473023 [debug] [Thread-2 (]: Snowflake adapter: Snowflake query id: 01b3a75a-0001-c86f-0005-81260003e106
[0m22:02:42.474042 [debug] [Thread-2 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 20 at position 8 unexpected ')'.
[0m22:02:42.475167 [debug] [Thread-2 (]: Timing info for model.jaffle_shop.int_orders__pivoted (execute): 22:02:41.911799 => 22:02:42.474731
[0m22:02:42.475944 [debug] [Thread-2 (]: On model.jaffle_shop.int_orders__pivoted: Close
[0m22:02:42.517617 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m22:02:42.525280 [debug] [Thread-4 (]: Timing info for model.jaffle_shop.customers (execute): 22:02:41.840593 => 22:02:42.524734
[0m22:02:42.527718 [debug] [Thread-4 (]: On model.jaffle_shop.customers: Close
[0m22:02:42.636766 [debug] [Thread-2 (]: Database Error in model int_orders__pivoted (models/marts/core/int_orders__pivoted.sql)
  001003 (42000): SQL compilation error:
  syntax error line 20 at position 8 unexpected ')'.
  compiled Code at target/run/jaffle_shop/models/marts/core/int_orders__pivoted.sql
[0m22:02:42.638914 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c6cc6651-563e-4229-be4f-64bb9aac9f18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f765150>]}
[0m22:02:42.640576 [error] [Thread-2 (]: 5 of 5 ERROR creating sql table model JAFFLE_SHOP.int_orders__pivoted .......... [[31mERROR[0m in 0.74s]
[0m22:02:42.642531 [debug] [Thread-2 (]: Finished running node model.jaffle_shop.int_orders__pivoted
[0m22:02:42.665922 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c6cc6651-563e-4229-be4f-64bb9aac9f18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f7a4450>]}
[0m22:02:42.667383 [info ] [Thread-4 (]: 4 of 5 OK created sql view model JAFFLE_SHOP.customers ......................... [[32mSUCCESS 1[0m in 0.84s]
[0m22:02:42.668784 [debug] [Thread-4 (]: Finished running node model.jaffle_shop.customers
[0m22:02:42.672412 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:02:42.673125 [debug] [MainThread]: Connection 'model.jaffle_shop.stg_customers' was properly closed.
[0m22:02:42.673741 [debug] [MainThread]: Connection 'model.jaffle_shop.int_orders__pivoted' was properly closed.
[0m22:02:42.674347 [debug] [MainThread]: Connection 'model.jaffle_shop.stg_payments' was properly closed.
[0m22:02:42.674923 [debug] [MainThread]: Connection 'model.jaffle_shop.customers' was properly closed.
[0m22:02:42.675866 [info ] [MainThread]: 
[0m22:02:42.676559 [info ] [MainThread]: Finished running 4 view models, 1 table model in 0 hours 0 minutes and 3.34 seconds (3.34s).
[0m22:02:42.678480 [debug] [MainThread]: Command end result
[0m22:02:42.691078 [info ] [MainThread]: 
[0m22:02:42.691744 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m22:02:42.692247 [info ] [MainThread]: 
[0m22:02:42.692745 [error] [MainThread]:   Database Error in model int_orders__pivoted (models/marts/core/int_orders__pivoted.sql)
  001003 (42000): SQL compilation error:
  syntax error line 20 at position 8 unexpected ')'.
  compiled Code at target/run/jaffle_shop/models/marts/core/int_orders__pivoted.sql
[0m22:02:42.693246 [info ] [MainThread]: 
[0m22:02:42.693771 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
[0m22:02:42.695564 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 4.294541, "process_user_time": 4.444581, "process_kernel_time": 0.420593, "process_mem_max_rss": "140623872", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m22:02:42.696466 [debug] [MainThread]: Command `dbt run` failed at 22:02:42.696256 after 4.30 seconds
[0m22:02:42.698113 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e5b2790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e318750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e32c090>]}
[0m22:02:42.699781 [debug] [MainThread]: Flushing usage events
[0m22:04:16.235852 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11067e890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110421d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110420e90>]}


============================== 22:04:16.242290 | 4a646595-e338-43f4-9401-a9412cbd7e8f ==============================
[0m22:04:16.242290 [info ] [MainThread]: Running with dbt=1.7.8
[0m22:04:16.244138 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/ben/jaffle_shop/logs', 'profiles_dir': '/Users/ben/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:04:16.781266 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4a646595-e338-43f4-9401-a9412cbd7e8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1113a1910>]}
[0m22:04:16.913187 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4a646595-e338-43f4-9401-a9412cbd7e8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110b6f990>]}
[0m22:04:16.914453 [info ] [MainThread]: Registered adapter: snowflake=1.7.2
[0m22:04:16.939937 [debug] [MainThread]: checksum: 67f0013ca5f0bd43af9a0873dd50792fde83ef69de63b71cacd0b4ac656c52e5, vars: {}, profile: , target: , version: 1.7.8
[0m22:04:16.991756 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m22:04:16.992836 [debug] [MainThread]: Partial parsing: updated file: jaffle_shop://models/marts/core/int_orders__pivoted.sql
[0m22:04:17.208943 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4a646595-e338-43f4-9401-a9412cbd7e8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111546150>]}
[0m22:04:17.226294 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4a646595-e338-43f4-9401-a9412cbd7e8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1114ee790>]}
[0m22:04:17.227097 [info ] [MainThread]: Found 5 models, 3 seeds, 11 tests, 0 sources, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m22:04:17.227707 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4a646595-e338-43f4-9401-a9412cbd7e8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1114b7550>]}
[0m22:04:17.230685 [info ] [MainThread]: 
[0m22:04:17.231876 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m22:04:17.233644 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RAW'
[0m22:04:17.252719 [debug] [ThreadPool]: Using snowflake connection "list_RAW"
[0m22:04:17.253444 [debug] [ThreadPool]: On list_RAW: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_RAW"} */
show terse schemas in database RAW
    limit 10000
[0m22:04:17.253986 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:04:18.032252 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.0 seconds
[0m22:04:18.036262 [debug] [ThreadPool]: On list_RAW: Close
[0m22:04:18.264127 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RAW, now list_RAW_JAFFLE_SHOP)
[0m22:04:18.281617 [debug] [ThreadPool]: Using snowflake connection "list_RAW_JAFFLE_SHOP"
[0m22:04:18.282352 [debug] [ThreadPool]: On list_RAW_JAFFLE_SHOP: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_RAW_JAFFLE_SHOP"} */
show terse objects in RAW.JAFFLE_SHOP limit 10000
[0m22:04:18.282865 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:04:18.900931 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.0 seconds
[0m22:04:18.906696 [debug] [ThreadPool]: On list_RAW_JAFFLE_SHOP: Close
[0m22:04:19.061203 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4a646595-e338-43f4-9401-a9412cbd7e8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1114d57d0>]}
[0m22:04:19.063859 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:04:19.065292 [info ] [MainThread]: 
[0m22:04:19.070359 [debug] [Thread-1 (]: Began running node model.jaffle_shop.stg_customers
[0m22:04:19.071407 [debug] [Thread-2 (]: Began running node model.jaffle_shop.stg_orders
[0m22:04:19.072359 [info ] [Thread-1 (]: 1 of 5 START sql view model JAFFLE_SHOP.stg_customers .......................... [RUN]
[0m22:04:19.073280 [debug] [Thread-3 (]: Began running node model.jaffle_shop.stg_payments
[0m22:04:19.074135 [info ] [Thread-2 (]: 2 of 5 START sql view model JAFFLE_SHOP.stg_orders ............................. [RUN]
[0m22:04:19.075372 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_RAW_JAFFLE_SHOP, now model.jaffle_shop.stg_customers)
[0m22:04:19.076149 [info ] [Thread-3 (]: 3 of 5 START sql view model JAFFLE_SHOP.stg_payments ........................... [RUN]
[0m22:04:19.077413 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.jaffle_shop.stg_orders'
[0m22:04:19.078088 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.stg_customers
[0m22:04:19.079209 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.jaffle_shop.stg_payments'
[0m22:04:19.079780 [debug] [Thread-2 (]: Began compiling node model.jaffle_shop.stg_orders
[0m22:04:19.091759 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.stg_customers"
[0m22:04:19.092539 [debug] [Thread-3 (]: Began compiling node model.jaffle_shop.stg_payments
[0m22:04:19.098117 [debug] [Thread-2 (]: Writing injected SQL for node "model.jaffle_shop.stg_orders"
[0m22:04:19.103127 [debug] [Thread-3 (]: Writing injected SQL for node "model.jaffle_shop.stg_payments"
[0m22:04:19.104496 [debug] [Thread-1 (]: Timing info for model.jaffle_shop.stg_customers (compile): 22:04:19.080159 => 22:04:19.104044
[0m22:04:19.105484 [debug] [Thread-2 (]: Timing info for model.jaffle_shop.stg_orders (compile): 22:04:19.093030 => 22:04:19.105094
[0m22:04:19.106276 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.stg_customers
[0m22:04:19.107066 [debug] [Thread-2 (]: Began executing node model.jaffle_shop.stg_orders
[0m22:04:19.107847 [debug] [Thread-3 (]: Timing info for model.jaffle_shop.stg_payments (compile): 22:04:19.099100 => 22:04:19.107498
[0m22:04:19.168626 [debug] [Thread-2 (]: Writing runtime sql for node "model.jaffle_shop.stg_orders"
[0m22:04:19.172606 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.stg_customers"
[0m22:04:19.173344 [debug] [Thread-3 (]: Began executing node model.jaffle_shop.stg_payments
[0m22:04:19.179358 [debug] [Thread-3 (]: Writing runtime sql for node "model.jaffle_shop.stg_payments"
[0m22:04:19.180750 [debug] [Thread-1 (]: Using snowflake connection "model.jaffle_shop.stg_customers"
[0m22:04:19.181781 [debug] [Thread-2 (]: Using snowflake connection "model.jaffle_shop.stg_orders"
[0m22:04:19.182455 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */
create or replace   view RAW.JAFFLE_SHOP.stg_customers
  
   as (
    -- noinspection SqlNoDataSourceInspectionForFile



select
    id as customer_id,
    first_name,
    last_name

from raw.jaffle_shop.raw_customers
  );
[0m22:04:19.183131 [debug] [Thread-2 (]: On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */
create or replace   view RAW.JAFFLE_SHOP.stg_orders
  
   as (
    

select
    id as order_id,
    user_id as customer_id,
    order_date,
    status

from raw.jaffle_shop.raw_orders
  );
[0m22:04:19.184190 [debug] [Thread-3 (]: Using snowflake connection "model.jaffle_shop.stg_payments"
[0m22:04:19.184699 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:04:19.185376 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m22:04:19.186029 [debug] [Thread-3 (]: On model.jaffle_shop.stg_payments: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_payments"} */
create or replace   view RAW.JAFFLE_SHOP.stg_payments
  
   as (
    

select
    id,
    order_id,
    payment_method,
    amount

from raw.jaffle_shop.raw_payments
  );
[0m22:04:19.189556 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m22:04:19.775042 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m22:04:19.817092 [debug] [Thread-2 (]: Timing info for model.jaffle_shop.stg_orders (execute): 22:04:19.135075 => 22:04:19.816731
[0m22:04:19.818592 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m22:04:19.819271 [debug] [Thread-2 (]: On model.jaffle_shop.stg_orders: Close
[0m22:04:19.823147 [debug] [Thread-1 (]: Timing info for model.jaffle_shop.stg_customers (execute): 22:04:19.108201 => 22:04:19.822816
[0m22:04:19.824917 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: Close
[0m22:04:19.897822 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m22:04:19.908345 [debug] [Thread-3 (]: Timing info for model.jaffle_shop.stg_payments (execute): 22:04:19.174370 => 22:04:19.907199
[0m22:04:19.910306 [debug] [Thread-3 (]: On model.jaffle_shop.stg_payments: Close
[0m22:04:19.991648 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4a646595-e338-43f4-9401-a9412cbd7e8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1118e4410>]}
[0m22:04:19.993470 [info ] [Thread-2 (]: 2 of 5 OK created sql view model JAFFLE_SHOP.stg_orders ........................ [[32mSUCCESS 1[0m in 0.91s]
[0m22:04:19.995391 [debug] [Thread-2 (]: Finished running node model.jaffle_shop.stg_orders
[0m22:04:20.008057 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4a646595-e338-43f4-9401-a9412cbd7e8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1117e4510>]}
[0m22:04:20.009736 [info ] [Thread-1 (]: 1 of 5 OK created sql view model JAFFLE_SHOP.stg_customers ..................... [[32mSUCCESS 1[0m in 0.93s]
[0m22:04:20.011417 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.stg_customers
[0m22:04:20.013431 [debug] [Thread-4 (]: Began running node model.jaffle_shop.customers
[0m22:04:20.014629 [info ] [Thread-4 (]: 4 of 5 START sql view model JAFFLE_SHOP.customers .............................. [RUN]
[0m22:04:20.016146 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.jaffle_shop.customers'
[0m22:04:20.016899 [debug] [Thread-4 (]: Began compiling node model.jaffle_shop.customers
[0m22:04:20.023309 [debug] [Thread-4 (]: Writing injected SQL for node "model.jaffle_shop.customers"
[0m22:04:20.024697 [debug] [Thread-4 (]: Timing info for model.jaffle_shop.customers (compile): 22:04:20.017371 => 22:04:20.024288
[0m22:04:20.025416 [debug] [Thread-4 (]: Began executing node model.jaffle_shop.customers
[0m22:04:20.031792 [debug] [Thread-4 (]: Writing runtime sql for node "model.jaffle_shop.customers"
[0m22:04:20.034685 [debug] [Thread-4 (]: Using snowflake connection "model.jaffle_shop.customers"
[0m22:04:20.035887 [debug] [Thread-4 (]: On model.jaffle_shop.customers: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.customers"} */
create or replace   view RAW.JAFFLE_SHOP.customers
  
   as (
    


with customers as (

    select * from RAW.JAFFLE_SHOP.stg_customers

),

orders as (

    select * from RAW.JAFFLE_SHOP.stg_orders

),

customer_orders as (

    select
        customer_id,

        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders

    from orders

    group by 1

),

final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce(customer_orders.number_of_orders, 0) as number_of_orders

    from customers

    left join customer_orders using (customer_id)

)

select * from final
  );
[0m22:04:20.036810 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m22:04:20.068602 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4a646595-e338-43f4-9401-a9412cbd7e8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11175c410>]}
[0m22:04:20.070369 [info ] [Thread-3 (]: 3 of 5 OK created sql view model JAFFLE_SHOP.stg_payments ...................... [[32mSUCCESS 1[0m in 0.99s]
[0m22:04:20.072027 [debug] [Thread-3 (]: Finished running node model.jaffle_shop.stg_payments
[0m22:04:20.073393 [debug] [Thread-1 (]: Began running node model.jaffle_shop.int_orders__pivoted
[0m22:04:20.074288 [info ] [Thread-1 (]: 5 of 5 START sql table model JAFFLE_SHOP.int_orders__pivoted ................... [RUN]
[0m22:04:20.075537 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.jaffle_shop.stg_customers, now model.jaffle_shop.int_orders__pivoted)
[0m22:04:20.076218 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.int_orders__pivoted
[0m22:04:20.082753 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.int_orders__pivoted"
[0m22:04:20.084039 [debug] [Thread-1 (]: Timing info for model.jaffle_shop.int_orders__pivoted (compile): 22:04:20.076674 => 22:04:20.083656
[0m22:04:20.084641 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.int_orders__pivoted
[0m22:04:20.121341 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.int_orders__pivoted"
[0m22:04:20.123891 [debug] [Thread-1 (]: Using snowflake connection "model.jaffle_shop.int_orders__pivoted"
[0m22:04:20.124602 [debug] [Thread-1 (]: On model.jaffle_shop.int_orders__pivoted: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.int_orders__pivoted"} */
create or replace transient table RAW.JAFFLE_SHOP.int_orders__pivoted
         as
        (

WITH payments AS (
    SELECT * FROM RAW.JAFFLE_SHOP.stg_payments
),

pivoted AS (
    SELECT
        order_id,
        SUM(CASE WHEN payment_method = 'bank_transfer' THEN amount ELSE 0 END) AS bank_transfer_amount,
        SUM(CASE WHEN payment_method = 'coupon' THEN amount ELSE 0 END) AS coupon_amount,
        SUM(CASE WHEN payment_method = 'credit_card' THEN amount ELSE 0 END) AS credit_card_amount,
        SUM(CASE WHEN payment_method = 'gift_card' THEN amount ELSE 0 END) AS gift_card_amount
    FROM payments
    WHERE status = 'success'
    GROUP BY 1
)

SELECT * FROM pivoted
        );
[0m22:04:20.125207 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:04:20.629294 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b3a75c-0001-c86f-0005-81260003e10a
[0m22:04:20.630426 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 17 at position 10
invalid identifier 'STATUS'
[0m22:04:20.631793 [debug] [Thread-1 (]: Timing info for model.jaffle_shop.int_orders__pivoted (execute): 22:04:20.085002 => 22:04:20.631250
[0m22:04:20.632740 [debug] [Thread-1 (]: On model.jaffle_shop.int_orders__pivoted: Close
[0m22:04:20.772354 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m22:04:20.780515 [debug] [Thread-4 (]: Timing info for model.jaffle_shop.customers (execute): 22:04:20.025876 => 22:04:20.779968
[0m22:04:20.784143 [debug] [Thread-4 (]: On model.jaffle_shop.customers: Close
[0m22:04:20.790455 [debug] [Thread-1 (]: Database Error in model int_orders__pivoted (models/marts/core/int_orders__pivoted.sql)
  000904 (42000): SQL compilation error: error line 17 at position 10
  invalid identifier 'STATUS'
  compiled Code at target/run/jaffle_shop/models/marts/core/int_orders__pivoted.sql
[0m22:04:20.791589 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4a646595-e338-43f4-9401-a9412cbd7e8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111a15590>]}
[0m22:04:20.792760 [error] [Thread-1 (]: 5 of 5 ERROR creating sql table model JAFFLE_SHOP.int_orders__pivoted .......... [[31mERROR[0m in 0.72s]
[0m22:04:20.795041 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.int_orders__pivoted
[0m22:04:20.932062 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4a646595-e338-43f4-9401-a9412cbd7e8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111990fd0>]}
[0m22:04:20.934335 [info ] [Thread-4 (]: 4 of 5 OK created sql view model JAFFLE_SHOP.customers ......................... [[32mSUCCESS 1[0m in 0.92s]
[0m22:04:20.939305 [debug] [Thread-4 (]: Finished running node model.jaffle_shop.customers
[0m22:04:20.944024 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:04:20.944878 [debug] [MainThread]: Connection 'model.jaffle_shop.int_orders__pivoted' was properly closed.
[0m22:04:20.945541 [debug] [MainThread]: Connection 'model.jaffle_shop.stg_orders' was properly closed.
[0m22:04:20.946156 [debug] [MainThread]: Connection 'model.jaffle_shop.stg_payments' was properly closed.
[0m22:04:20.946762 [debug] [MainThread]: Connection 'model.jaffle_shop.customers' was properly closed.
[0m22:04:20.947493 [info ] [MainThread]: 
[0m22:04:20.948220 [info ] [MainThread]: Finished running 4 view models, 1 table model in 0 hours 0 minutes and 3.72 seconds (3.72s).
[0m22:04:20.950187 [debug] [MainThread]: Command end result
[0m22:04:20.965650 [info ] [MainThread]: 
[0m22:04:20.966352 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m22:04:20.966891 [info ] [MainThread]: 
[0m22:04:20.967451 [error] [MainThread]:   Database Error in model int_orders__pivoted (models/marts/core/int_orders__pivoted.sql)
  000904 (42000): SQL compilation error: error line 17 at position 10
  invalid identifier 'STATUS'
  compiled Code at target/run/jaffle_shop/models/marts/core/int_orders__pivoted.sql
[0m22:04:20.968008 [info ] [MainThread]: 
[0m22:04:20.968582 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
[0m22:04:20.970423 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 4.814588, "process_user_time": 4.654932, "process_kernel_time": 0.443826, "process_mem_max_rss": "140496896", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m22:04:20.971332 [debug] [MainThread]: Command `dbt run` failed at 22:04:20.971124 after 4.82 seconds
[0m22:04:20.972133 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110a21490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1106b8950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11175f850>]}
[0m22:04:20.972911 [debug] [MainThread]: Flushing usage events
[0m22:27:45.117196 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10715da50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1073ff050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1073ff850>]}


============================== 22:27:45.126390 | 7cb46019-be08-410c-bf96-388bc9cf122b ==============================
[0m22:27:45.126390 [info ] [MainThread]: Running with dbt=1.7.8
[0m22:27:45.128135 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/ben/jaffle_shop/logs', 'profiles_dir': '/Users/ben/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt compile --select int_orders__pivoted', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m22:27:45.875051 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7cb46019-be08-410c-bf96-388bc9cf122b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10778c8d0>]}
[0m22:27:46.013046 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7cb46019-be08-410c-bf96-388bc9cf122b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108002a90>]}
[0m22:27:46.014818 [info ] [MainThread]: Registered adapter: snowflake=1.7.2
[0m22:27:46.041317 [debug] [MainThread]: checksum: 67f0013ca5f0bd43af9a0873dd50792fde83ef69de63b71cacd0b4ac656c52e5, vars: {}, profile: , target: , version: 1.7.8
[0m22:27:46.147295 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m22:27:46.148364 [debug] [MainThread]: Partial parsing: updated file: jaffle_shop://models/marts/core/int_orders__pivoted.sql
[0m22:27:46.372593 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7cb46019-be08-410c-bf96-388bc9cf122b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108493e10>]}
[0m22:27:46.390297 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7cb46019-be08-410c-bf96-388bc9cf122b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108223490>]}
[0m22:27:46.391063 [info ] [MainThread]: Found 5 models, 3 seeds, 11 tests, 0 sources, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m22:27:46.391672 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7cb46019-be08-410c-bf96-388bc9cf122b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1084b8e90>]}
[0m22:27:46.394801 [info ] [MainThread]: 
[0m22:27:46.396483 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m22:27:46.398567 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RAW_JAFFLE_SHOP'
[0m22:27:46.422669 [debug] [ThreadPool]: Using snowflake connection "list_RAW_JAFFLE_SHOP"
[0m22:27:46.424542 [debug] [ThreadPool]: On list_RAW_JAFFLE_SHOP: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_RAW_JAFFLE_SHOP"} */
show terse objects in RAW.JAFFLE_SHOP limit 10000
[0m22:27:46.425219 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:27:47.240551 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.0 seconds
[0m22:27:47.245982 [debug] [ThreadPool]: On list_RAW_JAFFLE_SHOP: Close
[0m22:27:47.404913 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7cb46019-be08-410c-bf96-388bc9cf122b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1081ca110>]}
[0m22:27:47.406582 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:27:47.407348 [info ] [MainThread]: 
[0m22:27:47.412825 [debug] [Thread-1 (]: Began running node model.jaffle_shop.int_orders__pivoted
[0m22:27:47.414347 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_RAW_JAFFLE_SHOP, now model.jaffle_shop.int_orders__pivoted)
[0m22:27:47.415086 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.int_orders__pivoted
[0m22:27:47.429817 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.int_orders__pivoted"
[0m22:27:47.431279 [debug] [Thread-1 (]: Timing info for model.jaffle_shop.int_orders__pivoted (compile): 22:27:47.415514 => 22:27:47.430792
[0m22:27:47.431926 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.int_orders__pivoted
[0m22:27:47.432641 [debug] [Thread-1 (]: Timing info for model.jaffle_shop.int_orders__pivoted (execute): 22:27:47.432296 => 22:27:47.432330
[0m22:27:47.434642 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.int_orders__pivoted
[0m22:27:47.436286 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:27:47.436836 [debug] [MainThread]: Connection 'model.jaffle_shop.int_orders__pivoted' was properly closed.
[0m22:27:47.438183 [debug] [MainThread]: Command end result
[0m22:27:47.454725 [info ] [MainThread]: Compiled node 'int_orders__pivoted' is:


WITH payments AS (
    SELECT p.id AS id,
           p.order_id AS order_id,
           p.payment_method AS payment_method,
           p.amount AS amount,
           o.status AS status
    FROM RAW.JAFFLE_SHOP.stg_payments p
    JOIN RAW.JAFFLE_SHOP.stg_orders o
    ON p.order_id = o.order_id
),
pivoted AS (
    SELECT
        order_id,
        SUM(CASE WHEN payment_method = 'bank_transfer' THEN amount ELSE 0 END) AS bank_transfer_amount,
        SUM(CASE WHEN payment_method = 'coupon' THEN amount ELSE 0 END) AS coupon_amount,
        SUM(CASE WHEN payment_method = 'credit_card' THEN amount ELSE 0 END) AS credit_card_amount,
        SUM(CASE WHEN payment_method = 'gift_card' THEN amount ELSE 0 END) AS gift_card_amount
    FROM payments
    WHERE status = 'success'
    GROUP BY 1
)

SELECT * FROM pivoted
;
[0m22:27:47.458239 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_success": true, "command_wall_clock_time": 2.4354126, "process_user_time": 4.159415, "process_kernel_time": 0.62405, "process_mem_max_rss": "134758400", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m22:27:47.459546 [debug] [MainThread]: Command `dbt compile` succeeded at 22:27:47.459259 after 2.44 seconds
[0m22:27:47.460612 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10510d590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10777f710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103483c90>]}
[0m22:27:47.461406 [debug] [MainThread]: Flushing usage events
[0m22:28:08.466868 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c2cf7d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bccc9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c2dd110>]}


============================== 22:28:08.475571 | df7ec178-e951-4a63-a090-5865a811ec18 ==============================
[0m22:28:08.475571 [info ] [MainThread]: Running with dbt=1.7.8
[0m22:28:08.477220 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/ben/jaffle_shop/logs', 'debug': 'False', 'profiles_dir': '/Users/ben/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m22:28:09.290137 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'df7ec178-e951-4a63-a090-5865a811ec18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c2ce750>]}
[0m22:28:09.420171 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'df7ec178-e951-4a63-a090-5865a811ec18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c2ce750>]}
[0m22:28:09.422402 [info ] [MainThread]: Registered adapter: snowflake=1.7.2
[0m22:28:09.454350 [debug] [MainThread]: checksum: 67f0013ca5f0bd43af9a0873dd50792fde83ef69de63b71cacd0b4ac656c52e5, vars: {}, profile: , target: , version: 1.7.8
[0m22:28:09.536726 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:28:09.537476 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:28:09.548662 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'df7ec178-e951-4a63-a090-5865a811ec18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ce88950>]}
[0m22:28:09.565796 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'df7ec178-e951-4a63-a090-5865a811ec18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cccdd50>]}
[0m22:28:09.566614 [info ] [MainThread]: Found 5 models, 3 seeds, 11 tests, 0 sources, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m22:28:09.567250 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'df7ec178-e951-4a63-a090-5865a811ec18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ccb0610>]}
[0m22:28:09.570873 [info ] [MainThread]: 
[0m22:28:09.572396 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m22:28:09.574355 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RAW'
[0m22:28:09.598767 [debug] [ThreadPool]: Using snowflake connection "list_RAW"
[0m22:28:09.599476 [debug] [ThreadPool]: On list_RAW: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_RAW"} */
show terse schemas in database RAW
    limit 10000
[0m22:28:09.600060 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:28:10.309500 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.0 seconds
[0m22:28:10.314439 [debug] [ThreadPool]: On list_RAW: Close
[0m22:28:10.462721 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RAW, now list_RAW_JAFFLE_SHOP)
[0m22:28:10.479525 [debug] [ThreadPool]: Using snowflake connection "list_RAW_JAFFLE_SHOP"
[0m22:28:10.480269 [debug] [ThreadPool]: On list_RAW_JAFFLE_SHOP: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_RAW_JAFFLE_SHOP"} */
show terse objects in RAW.JAFFLE_SHOP limit 10000
[0m22:28:10.480846 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:28:10.926405 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.0 seconds
[0m22:28:10.931398 [debug] [ThreadPool]: On list_RAW_JAFFLE_SHOP: Close
[0m22:28:11.102354 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'df7ec178-e951-4a63-a090-5865a811ec18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10903e810>]}
[0m22:28:11.104237 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:28:11.105098 [info ] [MainThread]: 
[0m22:28:11.109438 [debug] [Thread-1 (]: Began running node model.jaffle_shop.stg_customers
[0m22:28:11.110172 [debug] [Thread-2 (]: Began running node model.jaffle_shop.stg_orders
[0m22:28:11.111033 [debug] [Thread-3 (]: Began running node model.jaffle_shop.stg_payments
[0m22:28:11.112173 [info ] [Thread-1 (]: 1 of 5 START sql view model JAFFLE_SHOP.stg_customers .......................... [RUN]
[0m22:28:11.113155 [info ] [Thread-2 (]: 2 of 5 START sql view model JAFFLE_SHOP.stg_orders ............................. [RUN]
[0m22:28:11.114267 [info ] [Thread-3 (]: 3 of 5 START sql view model JAFFLE_SHOP.stg_payments ........................... [RUN]
[0m22:28:11.115657 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_RAW_JAFFLE_SHOP, now model.jaffle_shop.stg_customers)
[0m22:28:11.116811 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.jaffle_shop.stg_orders'
[0m22:28:11.117862 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.jaffle_shop.stg_payments'
[0m22:28:11.118456 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.stg_customers
[0m22:28:11.119019 [debug] [Thread-2 (]: Began compiling node model.jaffle_shop.stg_orders
[0m22:28:11.119561 [debug] [Thread-3 (]: Began compiling node model.jaffle_shop.stg_payments
[0m22:28:11.131840 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.stg_customers"
[0m22:28:11.136995 [debug] [Thread-2 (]: Writing injected SQL for node "model.jaffle_shop.stg_orders"
[0m22:28:11.141400 [debug] [Thread-3 (]: Writing injected SQL for node "model.jaffle_shop.stg_payments"
[0m22:28:11.143429 [debug] [Thread-1 (]: Timing info for model.jaffle_shop.stg_customers (compile): 22:28:11.119934 => 22:28:11.142854
[0m22:28:11.144911 [debug] [Thread-2 (]: Timing info for model.jaffle_shop.stg_orders (compile): 22:28:11.132408 => 22:28:11.144419
[0m22:28:11.145829 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.stg_customers
[0m22:28:11.146507 [debug] [Thread-2 (]: Began executing node model.jaffle_shop.stg_orders
[0m22:28:11.160479 [debug] [Thread-3 (]: Timing info for model.jaffle_shop.stg_payments (compile): 22:28:11.137658 => 22:28:11.159610
[0m22:28:11.210999 [debug] [Thread-3 (]: Began executing node model.jaffle_shop.stg_payments
[0m22:28:11.219359 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.stg_customers"
[0m22:28:11.220340 [debug] [Thread-2 (]: Writing runtime sql for node "model.jaffle_shop.stg_orders"
[0m22:28:11.225541 [debug] [Thread-3 (]: Writing runtime sql for node "model.jaffle_shop.stg_payments"
[0m22:28:11.227722 [debug] [Thread-1 (]: Using snowflake connection "model.jaffle_shop.stg_customers"
[0m22:28:11.228941 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */
create or replace   view RAW.JAFFLE_SHOP.stg_customers
  
   as (
    -- noinspection SqlNoDataSourceInspectionForFile



select
    id as customer_id,
    first_name,
    last_name

from raw.jaffle_shop.raw_customers
  );
[0m22:28:11.229887 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:28:11.230968 [debug] [Thread-3 (]: Using snowflake connection "model.jaffle_shop.stg_payments"
[0m22:28:11.233466 [debug] [Thread-2 (]: Using snowflake connection "model.jaffle_shop.stg_orders"
[0m22:28:11.234266 [debug] [Thread-3 (]: On model.jaffle_shop.stg_payments: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_payments"} */
create or replace   view RAW.JAFFLE_SHOP.stg_payments
  
   as (
    

select
    id,
    order_id,
    payment_method,
    amount

from raw.jaffle_shop.raw_payments
  );
[0m22:28:11.234977 [debug] [Thread-2 (]: On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */
create or replace   view RAW.JAFFLE_SHOP.stg_orders
  
   as (
    

select
    id as order_id,
    user_id as customer_id,
    order_date,
    status

from raw.jaffle_shop.raw_orders
  );
[0m22:28:11.235970 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m22:28:11.237539 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m22:28:11.879395 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m22:28:11.920986 [debug] [Thread-2 (]: Timing info for model.jaffle_shop.stg_orders (execute): 22:28:11.166394 => 22:28:11.920528
[0m22:28:11.921779 [debug] [Thread-2 (]: On model.jaffle_shop.stg_orders: Close
[0m22:28:11.923273 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m22:28:11.924507 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m22:28:11.931017 [debug] [Thread-1 (]: Timing info for model.jaffle_shop.stg_customers (execute): 22:28:11.146977 => 22:28:11.930662
[0m22:28:11.934939 [debug] [Thread-3 (]: Timing info for model.jaffle_shop.stg_payments (execute): 22:28:11.220826 => 22:28:11.934612
[0m22:28:11.935757 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: Close
[0m22:28:11.936437 [debug] [Thread-3 (]: On model.jaffle_shop.stg_payments: Close
[0m22:28:12.087982 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'df7ec178-e951-4a63-a090-5865a811ec18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cdc0bd0>]}
[0m22:28:12.089988 [info ] [Thread-3 (]: 3 of 5 OK created sql view model JAFFLE_SHOP.stg_payments ...................... [[32mSUCCESS 1[0m in 0.97s]
[0m22:28:12.092409 [debug] [Thread-3 (]: Finished running node model.jaffle_shop.stg_payments
[0m22:28:12.099929 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'df7ec178-e951-4a63-a090-5865a811ec18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d01ba50>]}
[0m22:28:12.101222 [info ] [Thread-2 (]: 2 of 5 OK created sql view model JAFFLE_SHOP.stg_orders ........................ [[32mSUCCESS 1[0m in 0.98s]
[0m22:28:12.102704 [debug] [Thread-2 (]: Finished running node model.jaffle_shop.stg_orders
[0m22:28:12.103846 [debug] [Thread-4 (]: Began running node model.jaffle_shop.int_orders__pivoted
[0m22:28:12.104810 [info ] [Thread-4 (]: 4 of 5 START sql table model JAFFLE_SHOP.int_orders__pivoted ................... [RUN]
[0m22:28:12.106207 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.jaffle_shop.int_orders__pivoted'
[0m22:28:12.106867 [debug] [Thread-4 (]: Began compiling node model.jaffle_shop.int_orders__pivoted
[0m22:28:12.114106 [debug] [Thread-4 (]: Writing injected SQL for node "model.jaffle_shop.int_orders__pivoted"
[0m22:28:12.115373 [debug] [Thread-4 (]: Timing info for model.jaffle_shop.int_orders__pivoted (compile): 22:28:12.107277 => 22:28:12.114998
[0m22:28:12.115968 [debug] [Thread-4 (]: Began executing node model.jaffle_shop.int_orders__pivoted
[0m22:28:12.161798 [debug] [Thread-4 (]: Writing runtime sql for node "model.jaffle_shop.int_orders__pivoted"
[0m22:28:12.164947 [debug] [Thread-4 (]: Using snowflake connection "model.jaffle_shop.int_orders__pivoted"
[0m22:28:12.165834 [debug] [Thread-4 (]: On model.jaffle_shop.int_orders__pivoted: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.int_orders__pivoted"} */
create or replace transient table RAW.JAFFLE_SHOP.int_orders__pivoted
         as
        (

WITH payments AS (
    SELECT p.id AS id,
           p.order_id AS order_id,
           p.payment_method AS payment_method,
           p.amount AS amount,
           o.status AS status
    FROM RAW.JAFFLE_SHOP.stg_payments p
    JOIN RAW.JAFFLE_SHOP.stg_orders o
    ON p.order_id = o.order_id
),
pivoted AS (
    SELECT
        order_id,
        SUM(CASE WHEN payment_method = 'bank_transfer' THEN amount ELSE 0 END) AS bank_transfer_amount,
        SUM(CASE WHEN payment_method = 'coupon' THEN amount ELSE 0 END) AS coupon_amount,
        SUM(CASE WHEN payment_method = 'credit_card' THEN amount ELSE 0 END) AS credit_card_amount,
        SUM(CASE WHEN payment_method = 'gift_card' THEN amount ELSE 0 END) AS gift_card_amount
    FROM payments
    WHERE status = 'success'
    GROUP BY 1
)

SELECT * FROM pivoted
;
[0m22:28:12.166552 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m22:28:12.167845 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'df7ec178-e951-4a63-a090-5865a811ec18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cdae4d0>]}
[0m22:28:12.170659 [info ] [Thread-1 (]: 1 of 5 OK created sql view model JAFFLE_SHOP.stg_customers ..................... [[32mSUCCESS 1[0m in 1.05s]
[0m22:28:12.172514 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.stg_customers
[0m22:28:12.174451 [debug] [Thread-2 (]: Began running node model.jaffle_shop.customers
[0m22:28:12.175493 [info ] [Thread-2 (]: 5 of 5 START sql view model JAFFLE_SHOP.customers .............................. [RUN]
[0m22:28:12.178285 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.jaffle_shop.stg_orders, now model.jaffle_shop.customers)
[0m22:28:12.179477 [debug] [Thread-2 (]: Began compiling node model.jaffle_shop.customers
[0m22:28:12.186513 [debug] [Thread-2 (]: Writing injected SQL for node "model.jaffle_shop.customers"
[0m22:28:12.188565 [debug] [Thread-2 (]: Timing info for model.jaffle_shop.customers (compile): 22:28:12.180184 => 22:28:12.188076
[0m22:28:12.189253 [debug] [Thread-2 (]: Began executing node model.jaffle_shop.customers
[0m22:28:12.196506 [debug] [Thread-2 (]: Writing runtime sql for node "model.jaffle_shop.customers"
[0m22:28:12.199105 [debug] [Thread-2 (]: Using snowflake connection "model.jaffle_shop.customers"
[0m22:28:12.200507 [debug] [Thread-2 (]: On model.jaffle_shop.customers: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.customers"} */
create or replace   view RAW.JAFFLE_SHOP.customers
  
   as (
    


with customers as (

    select * from RAW.JAFFLE_SHOP.stg_customers

),

orders as (

    select * from RAW.JAFFLE_SHOP.stg_orders

),

customer_orders as (

    select
        customer_id,

        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders

    from orders

    group by 1

),

final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce(customer_orders.number_of_orders, 0) as number_of_orders

    from customers

    left join customer_orders using (customer_id)

)

select * from final
  );
[0m22:28:12.201349 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:28:12.696865 [debug] [Thread-4 (]: Snowflake adapter: Snowflake query id: 01b3a774-0001-c86b-0005-81260003f06e
[0m22:28:12.698001 [debug] [Thread-4 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 28 at position 0 unexpected ';'.
[0m22:28:12.699357 [debug] [Thread-4 (]: Timing info for model.jaffle_shop.int_orders__pivoted (execute): 22:28:12.116333 => 22:28:12.698827
[0m22:28:12.700285 [debug] [Thread-4 (]: On model.jaffle_shop.int_orders__pivoted: Close
[0m22:28:12.781026 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m22:28:12.785219 [debug] [Thread-2 (]: Timing info for model.jaffle_shop.customers (execute): 22:28:12.189686 => 22:28:12.784878
[0m22:28:12.785865 [debug] [Thread-2 (]: On model.jaffle_shop.customers: Close
[0m22:28:12.865758 [debug] [Thread-4 (]: Database Error in model int_orders__pivoted (models/marts/core/int_orders__pivoted.sql)
  001003 (42000): SQL compilation error:
  syntax error line 28 at position 0 unexpected ';'.
  compiled Code at target/run/jaffle_shop/models/marts/core/int_orders__pivoted.sql
[0m22:28:12.866712 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'df7ec178-e951-4a63-a090-5865a811ec18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d027c50>]}
[0m22:28:12.867713 [error] [Thread-4 (]: 4 of 5 ERROR creating sql table model JAFFLE_SHOP.int_orders__pivoted .......... [[31mERROR[0m in 0.76s]
[0m22:28:12.869224 [debug] [Thread-4 (]: Finished running node model.jaffle_shop.int_orders__pivoted
[0m22:28:12.936472 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'df7ec178-e951-4a63-a090-5865a811ec18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d0ee990>]}
[0m22:28:12.938372 [info ] [Thread-2 (]: 5 of 5 OK created sql view model JAFFLE_SHOP.customers ......................... [[32mSUCCESS 1[0m in 0.76s]
[0m22:28:12.940085 [debug] [Thread-2 (]: Finished running node model.jaffle_shop.customers
[0m22:28:12.944354 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:28:12.945201 [debug] [MainThread]: Connection 'model.jaffle_shop.stg_customers' was properly closed.
[0m22:28:12.945877 [debug] [MainThread]: Connection 'model.jaffle_shop.customers' was properly closed.
[0m22:28:12.946489 [debug] [MainThread]: Connection 'model.jaffle_shop.stg_payments' was properly closed.
[0m22:28:12.947425 [debug] [MainThread]: Connection 'model.jaffle_shop.int_orders__pivoted' was properly closed.
[0m22:28:12.948609 [info ] [MainThread]: 
[0m22:28:12.949766 [info ] [MainThread]: Finished running 4 view models, 1 table model in 0 hours 0 minutes and 3.38 seconds (3.38s).
[0m22:28:12.951821 [debug] [MainThread]: Command end result
[0m22:28:12.967806 [info ] [MainThread]: 
[0m22:28:12.968619 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m22:28:12.969177 [info ] [MainThread]: 
[0m22:28:12.969912 [error] [MainThread]:   Database Error in model int_orders__pivoted (models/marts/core/int_orders__pivoted.sql)
  001003 (42000): SQL compilation error:
  syntax error line 28 at position 0 unexpected ';'.
  compiled Code at target/run/jaffle_shop/models/marts/core/int_orders__pivoted.sql
[0m22:28:12.970778 [info ] [MainThread]: 
[0m22:28:12.971485 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
[0m22:28:12.975360 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 4.6028, "process_user_time": 4.812681, "process_kernel_time": 0.689233, "process_mem_max_rss": "137707520", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m22:28:12.976367 [debug] [MainThread]: Command `dbt run` failed at 22:28:12.976146 after 4.60 seconds
[0m22:28:12.977154 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c2d5bd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bf0bfd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bcadc10>]}
[0m22:28:12.978216 [debug] [MainThread]: Flushing usage events
[0m22:29:15.050869 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b27510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107509b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ea4ad0>]}


============================== 22:29:15.061096 | e8e729b3-856e-46b5-a821-d295115bdc8c ==============================
[0m22:29:15.061096 [info ] [MainThread]: Running with dbt=1.7.8
[0m22:29:15.062673 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/ben/jaffle_shop/logs', 'profiles_dir': '/Users/ben/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m22:29:15.821797 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e8e729b3-856e-46b5-a821-d295115bdc8c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ef1150>]}
[0m22:29:15.945235 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e8e729b3-856e-46b5-a821-d295115bdc8c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107dc6c10>]}
[0m22:29:15.947084 [info ] [MainThread]: Registered adapter: snowflake=1.7.2
[0m22:29:15.973014 [debug] [MainThread]: checksum: 67f0013ca5f0bd43af9a0873dd50792fde83ef69de63b71cacd0b4ac656c52e5, vars: {}, profile: , target: , version: 1.7.8
[0m22:29:16.080919 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m22:29:16.082053 [debug] [MainThread]: Partial parsing: updated file: jaffle_shop://models/marts/core/int_orders__pivoted.sql
[0m22:29:16.294161 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e8e729b3-856e-46b5-a821-d295115bdc8c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108b8f110>]}
[0m22:29:16.311387 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e8e729b3-856e-46b5-a821-d295115bdc8c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10893e690>]}
[0m22:29:16.312169 [info ] [MainThread]: Found 5 models, 3 seeds, 11 tests, 0 sources, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m22:29:16.312779 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e8e729b3-856e-46b5-a821-d295115bdc8c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1089af490>]}
[0m22:29:16.316108 [info ] [MainThread]: 
[0m22:29:16.317390 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m22:29:16.319146 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RAW'
[0m22:29:16.338714 [debug] [ThreadPool]: Using snowflake connection "list_RAW"
[0m22:29:16.339393 [debug] [ThreadPool]: On list_RAW: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_RAW"} */
show terse schemas in database RAW
    limit 10000
[0m22:29:16.339948 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:29:17.138090 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.0 seconds
[0m22:29:17.143188 [debug] [ThreadPool]: On list_RAW: Close
[0m22:29:17.293331 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RAW, now list_RAW_JAFFLE_SHOP)
[0m22:29:17.309847 [debug] [ThreadPool]: Using snowflake connection "list_RAW_JAFFLE_SHOP"
[0m22:29:17.310583 [debug] [ThreadPool]: On list_RAW_JAFFLE_SHOP: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_RAW_JAFFLE_SHOP"} */
show terse objects in RAW.JAFFLE_SHOP limit 10000
[0m22:29:17.311170 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:29:17.845538 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.0 seconds
[0m22:29:17.850555 [debug] [ThreadPool]: On list_RAW_JAFFLE_SHOP: Close
[0m22:29:18.022948 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e8e729b3-856e-46b5-a821-d295115bdc8c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108a2d2d0>]}
[0m22:29:18.024927 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:29:18.025944 [info ] [MainThread]: 
[0m22:29:18.031844 [debug] [Thread-1 (]: Began running node model.jaffle_shop.stg_customers
[0m22:29:18.032988 [info ] [Thread-1 (]: 1 of 5 START sql view model JAFFLE_SHOP.stg_customers .......................... [RUN]
[0m22:29:18.033796 [debug] [Thread-2 (]: Began running node model.jaffle_shop.stg_orders
[0m22:29:18.034432 [debug] [Thread-3 (]: Began running node model.jaffle_shop.stg_payments
[0m22:29:18.035549 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_RAW_JAFFLE_SHOP, now model.jaffle_shop.stg_customers)
[0m22:29:18.036304 [info ] [Thread-2 (]: 2 of 5 START sql view model JAFFLE_SHOP.stg_orders ............................. [RUN]
[0m22:29:18.037218 [info ] [Thread-3 (]: 3 of 5 START sql view model JAFFLE_SHOP.stg_payments ........................... [RUN]
[0m22:29:18.038003 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.stg_customers
[0m22:29:18.039230 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.jaffle_shop.stg_orders'
[0m22:29:18.040328 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.jaffle_shop.stg_payments'
[0m22:29:18.051899 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.stg_customers"
[0m22:29:18.052635 [debug] [Thread-2 (]: Began compiling node model.jaffle_shop.stg_orders
[0m22:29:18.053247 [debug] [Thread-3 (]: Began compiling node model.jaffle_shop.stg_payments
[0m22:29:18.059402 [debug] [Thread-2 (]: Writing injected SQL for node "model.jaffle_shop.stg_orders"
[0m22:29:18.063735 [debug] [Thread-3 (]: Writing injected SQL for node "model.jaffle_shop.stg_payments"
[0m22:29:18.064744 [debug] [Thread-1 (]: Timing info for model.jaffle_shop.stg_customers (compile): 22:29:18.040762 => 22:29:18.064202
[0m22:29:18.066040 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.stg_customers
[0m22:29:18.078797 [debug] [Thread-2 (]: Timing info for model.jaffle_shop.stg_orders (compile): 22:29:18.054006 => 22:29:18.078337
[0m22:29:18.079537 [debug] [Thread-2 (]: Began executing node model.jaffle_shop.stg_orders
[0m22:29:18.091870 [debug] [Thread-3 (]: Timing info for model.jaffle_shop.stg_payments (compile): 22:29:18.060254 => 22:29:18.091438
[0m22:29:18.123188 [debug] [Thread-3 (]: Began executing node model.jaffle_shop.stg_payments
[0m22:29:18.149940 [debug] [Thread-2 (]: Writing runtime sql for node "model.jaffle_shop.stg_orders"
[0m22:29:18.153710 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.stg_customers"
[0m22:29:18.156223 [debug] [Thread-3 (]: Writing runtime sql for node "model.jaffle_shop.stg_payments"
[0m22:29:18.157926 [debug] [Thread-2 (]: Using snowflake connection "model.jaffle_shop.stg_orders"
[0m22:29:18.158909 [debug] [Thread-1 (]: Using snowflake connection "model.jaffle_shop.stg_customers"
[0m22:29:18.159756 [debug] [Thread-3 (]: Using snowflake connection "model.jaffle_shop.stg_payments"
[0m22:29:18.160315 [debug] [Thread-2 (]: On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */
create or replace   view RAW.JAFFLE_SHOP.stg_orders
  
   as (
    

select
    id as order_id,
    user_id as customer_id,
    order_date,
    status

from raw.jaffle_shop.raw_orders
  );
[0m22:29:18.161067 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */
create or replace   view RAW.JAFFLE_SHOP.stg_customers
  
   as (
    -- noinspection SqlNoDataSourceInspectionForFile



select
    id as customer_id,
    first_name,
    last_name

from raw.jaffle_shop.raw_customers
  );
[0m22:29:18.161696 [debug] [Thread-3 (]: On model.jaffle_shop.stg_payments: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_payments"} */
create or replace   view RAW.JAFFLE_SHOP.stg_payments
  
   as (
    

select
    id,
    order_id,
    payment_method,
    amount

from raw.jaffle_shop.raw_payments
  );
[0m22:29:18.162282 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m22:29:18.162837 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:29:18.163367 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m22:29:18.724515 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m22:29:18.745350 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m22:29:18.772138 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m22:29:18.773300 [debug] [Thread-1 (]: Timing info for model.jaffle_shop.stg_customers (execute): 22:29:18.066466 => 22:29:18.772956
[0m22:29:18.777422 [debug] [Thread-2 (]: Timing info for model.jaffle_shop.stg_orders (execute): 22:29:18.085268 => 22:29:18.777091
[0m22:29:18.781028 [debug] [Thread-3 (]: Timing info for model.jaffle_shop.stg_payments (execute): 22:29:18.123749 => 22:29:18.780710
[0m22:29:18.781685 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: Close
[0m22:29:18.782277 [debug] [Thread-2 (]: On model.jaffle_shop.stg_orders: Close
[0m22:29:18.782846 [debug] [Thread-3 (]: On model.jaffle_shop.stg_payments: Close
[0m22:29:19.029057 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e8e729b3-856e-46b5-a821-d295115bdc8c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108cc0750>]}
[0m22:29:19.031183 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e8e729b3-856e-46b5-a821-d295115bdc8c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108cdbcd0>]}
[0m22:29:19.032994 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e8e729b3-856e-46b5-a821-d295115bdc8c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108cc1750>]}
[0m22:29:19.035857 [info ] [Thread-2 (]: 2 of 5 OK created sql view model JAFFLE_SHOP.stg_orders ........................ [[32mSUCCESS 1[0m in 0.99s]
[0m22:29:19.038190 [info ] [Thread-1 (]: 1 of 5 OK created sql view model JAFFLE_SHOP.stg_customers ..................... [[32mSUCCESS 1[0m in 1.00s]
[0m22:29:19.039904 [info ] [Thread-3 (]: 3 of 5 OK created sql view model JAFFLE_SHOP.stg_payments ...................... [[32mSUCCESS 1[0m in 0.99s]
[0m22:29:19.041545 [debug] [Thread-2 (]: Finished running node model.jaffle_shop.stg_orders
[0m22:29:19.042704 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.stg_customers
[0m22:29:19.043755 [debug] [Thread-3 (]: Finished running node model.jaffle_shop.stg_payments
[0m22:29:19.045754 [debug] [Thread-4 (]: Began running node model.jaffle_shop.customers
[0m22:29:19.046800 [info ] [Thread-4 (]: 4 of 5 START sql view model JAFFLE_SHOP.customers .............................. [RUN]
[0m22:29:19.048269 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.jaffle_shop.customers'
[0m22:29:19.049107 [debug] [Thread-2 (]: Began running node model.jaffle_shop.int_orders__pivoted
[0m22:29:19.049801 [debug] [Thread-4 (]: Began compiling node model.jaffle_shop.customers
[0m22:29:19.050608 [info ] [Thread-2 (]: 5 of 5 START sql table model JAFFLE_SHOP.int_orders__pivoted ................... [RUN]
[0m22:29:19.057675 [debug] [Thread-4 (]: Writing injected SQL for node "model.jaffle_shop.customers"
[0m22:29:19.058815 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.jaffle_shop.stg_orders, now model.jaffle_shop.int_orders__pivoted)
[0m22:29:19.059680 [debug] [Thread-2 (]: Began compiling node model.jaffle_shop.int_orders__pivoted
[0m22:29:19.066641 [debug] [Thread-4 (]: Timing info for model.jaffle_shop.customers (compile): 22:29:19.051114 => 22:29:19.065542
[0m22:29:19.067499 [debug] [Thread-2 (]: Writing injected SQL for node "model.jaffle_shop.int_orders__pivoted"
[0m22:29:19.068369 [debug] [Thread-4 (]: Began executing node model.jaffle_shop.customers
[0m22:29:19.075545 [debug] [Thread-4 (]: Writing runtime sql for node "model.jaffle_shop.customers"
[0m22:29:19.076800 [debug] [Thread-2 (]: Timing info for model.jaffle_shop.int_orders__pivoted (compile): 22:29:19.060241 => 22:29:19.076304
[0m22:29:19.077673 [debug] [Thread-2 (]: Began executing node model.jaffle_shop.int_orders__pivoted
[0m22:29:19.081582 [debug] [Thread-4 (]: Using snowflake connection "model.jaffle_shop.customers"
[0m22:29:19.094099 [debug] [Thread-4 (]: On model.jaffle_shop.customers: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.customers"} */
create or replace   view RAW.JAFFLE_SHOP.customers
  
   as (
    


with customers as (

    select * from RAW.JAFFLE_SHOP.stg_customers

),

orders as (

    select * from RAW.JAFFLE_SHOP.stg_orders

),

customer_orders as (

    select
        customer_id,

        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders

    from orders

    group by 1

),

final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce(customer_orders.number_of_orders, 0) as number_of_orders

    from customers

    left join customer_orders using (customer_id)

)

select * from final
  );
[0m22:29:19.112006 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m22:29:19.142428 [debug] [Thread-2 (]: Writing runtime sql for node "model.jaffle_shop.int_orders__pivoted"
[0m22:29:19.147978 [debug] [Thread-2 (]: Using snowflake connection "model.jaffle_shop.int_orders__pivoted"
[0m22:29:19.149656 [debug] [Thread-2 (]: On model.jaffle_shop.int_orders__pivoted: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.int_orders__pivoted"} */
create or replace transient table RAW.JAFFLE_SHOP.int_orders__pivoted
         as
        (

WITH payments AS (
    SELECT p.id AS id,
           p.order_id AS order_id,
           p.payment_method AS payment_method,
           p.amount AS amount,
           o.status AS status
    FROM RAW.JAFFLE_SHOP.stg_payments p
    JOIN RAW.JAFFLE_SHOP.stg_orders o
    ON p.order_id = o.order_id
),
pivoted AS (
    SELECT
        order_id,
        SUM(CASE WHEN payment_method = 'bank_transfer' THEN amount ELSE 0 END) AS bank_transfer_amount,
        SUM(CASE WHEN payment_method = 'coupon' THEN amount ELSE 0 END) AS coupon_amount,
        SUM(CASE WHEN payment_method = 'credit_card' THEN amount ELSE 0 END) AS credit_card_amount,
        SUM(CASE WHEN payment_method = 'gift_card' THEN amount ELSE 0 END) AS gift_card_amount
    FROM payments
    WHERE status = 'success'
    GROUP BY 1
)

SELECT * FROM pivoted
        );
[0m22:29:19.152107 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:29:20.061918 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m22:29:20.069390 [debug] [Thread-4 (]: Timing info for model.jaffle_shop.customers (execute): 22:29:19.068968 => 22:29:20.068878
[0m22:29:20.070359 [debug] [Thread-4 (]: On model.jaffle_shop.customers: Close
[0m22:29:20.225896 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e8e729b3-856e-46b5-a821-d295115bdc8c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108cdb8d0>]}
[0m22:29:20.227728 [info ] [Thread-4 (]: 4 of 5 OK created sql view model JAFFLE_SHOP.customers ......................... [[32mSUCCESS 1[0m in 1.18s]
[0m22:29:20.229687 [debug] [Thread-4 (]: Finished running node model.jaffle_shop.customers
[0m22:29:20.664591 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m22:29:20.672301 [debug] [Thread-2 (]: Timing info for model.jaffle_shop.int_orders__pivoted (execute): 22:29:19.082529 => 22:29:20.671757
[0m22:29:20.673330 [debug] [Thread-2 (]: On model.jaffle_shop.int_orders__pivoted: Close
[0m22:29:20.827096 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e8e729b3-856e-46b5-a821-d295115bdc8c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ddf010>]}
[0m22:29:20.829203 [info ] [Thread-2 (]: 5 of 5 OK created sql table model JAFFLE_SHOP.int_orders__pivoted .............. [[32mSUCCESS 1[0m in 1.77s]
[0m22:29:20.831244 [debug] [Thread-2 (]: Finished running node model.jaffle_shop.int_orders__pivoted
[0m22:29:20.835559 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:29:20.836490 [debug] [MainThread]: Connection 'model.jaffle_shop.stg_customers' was properly closed.
[0m22:29:20.837253 [debug] [MainThread]: Connection 'model.jaffle_shop.int_orders__pivoted' was properly closed.
[0m22:29:20.837852 [debug] [MainThread]: Connection 'model.jaffle_shop.stg_payments' was properly closed.
[0m22:29:20.838444 [debug] [MainThread]: Connection 'model.jaffle_shop.customers' was properly closed.
[0m22:29:20.839227 [info ] [MainThread]: 
[0m22:29:20.840030 [info ] [MainThread]: Finished running 4 view models, 1 table model in 0 hours 0 minutes and 4.52 seconds (4.52s).
[0m22:29:20.842273 [debug] [MainThread]: Command end result
[0m22:29:20.855854 [info ] [MainThread]: 
[0m22:29:20.856534 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:29:20.857058 [info ] [MainThread]: 
[0m22:29:20.857605 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m22:29:20.861620 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 5.8983526, "process_user_time": 4.864004, "process_kernel_time": 0.687396, "process_mem_max_rss": "139304960", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m22:29:20.862740 [debug] [MainThread]: Command `dbt run` succeeded at 22:29:20.862519 after 5.90 seconds
[0m22:29:20.863401 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ed6dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103b9fc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b24550>]}
[0m22:29:20.864247 [debug] [MainThread]: Flushing usage events
[0m22:32:13.618404 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108fc64d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1089cdbd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1089cc090>]}


============================== 22:32:13.626854 | 0f439a7d-4d75-408c-a4de-6506b300a265 ==============================
[0m22:32:13.626854 [info ] [MainThread]: Running with dbt=1.7.8
[0m22:32:13.628034 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/ben/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/Users/ben/jaffle_shop/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:32:14.327411 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0f439a7d-4d75-408c-a4de-6506b300a265', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109757050>]}
[0m22:32:14.462743 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0f439a7d-4d75-408c-a4de-6506b300a265', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108a45c50>]}
[0m22:32:14.463997 [info ] [MainThread]: Registered adapter: snowflake=1.7.2
[0m22:32:14.489285 [debug] [MainThread]: checksum: 67f0013ca5f0bd43af9a0873dd50792fde83ef69de63b71cacd0b4ac656c52e5, vars: {}, profile: , target: , version: 1.7.8
[0m22:32:14.547426 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m22:32:14.548527 [debug] [MainThread]: Partial parsing: updated file: jaffle_shop://models/marts/core/int_orders__pivoted.sql
[0m22:32:14.770488 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0f439a7d-4d75-408c-a4de-6506b300a265', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109ca8e10>]}
[0m22:32:14.788650 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0f439a7d-4d75-408c-a4de-6506b300a265', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109a45110>]}
[0m22:32:14.789542 [info ] [MainThread]: Found 5 models, 3 seeds, 11 tests, 0 sources, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m22:32:14.790322 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0f439a7d-4d75-408c-a4de-6506b300a265', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109cc44d0>]}
[0m22:32:14.793857 [info ] [MainThread]: 
[0m22:32:14.795165 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m22:32:14.796942 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RAW'
[0m22:32:14.817304 [debug] [ThreadPool]: Using snowflake connection "list_RAW"
[0m22:32:14.817983 [debug] [ThreadPool]: On list_RAW: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_RAW"} */
show terse schemas in database RAW
    limit 10000
[0m22:32:14.818772 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:32:15.544703 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.0 seconds
[0m22:32:15.548773 [debug] [ThreadPool]: On list_RAW: Close
[0m22:32:15.705932 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RAW, now list_RAW_JAFFLE_SHOP)
[0m22:32:15.723147 [debug] [ThreadPool]: Using snowflake connection "list_RAW_JAFFLE_SHOP"
[0m22:32:15.723826 [debug] [ThreadPool]: On list_RAW_JAFFLE_SHOP: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_RAW_JAFFLE_SHOP"} */
show terse objects in RAW.JAFFLE_SHOP limit 10000
[0m22:32:15.724332 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:32:16.169543 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 0.0 seconds
[0m22:32:16.175522 [debug] [ThreadPool]: On list_RAW_JAFFLE_SHOP: Close
[0m22:32:16.329113 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0f439a7d-4d75-408c-a4de-6506b300a265', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1098fc290>]}
[0m22:32:16.331063 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:32:16.332008 [info ] [MainThread]: 
[0m22:32:16.338275 [debug] [Thread-1 (]: Began running node model.jaffle_shop.stg_customers
[0m22:32:16.339409 [debug] [Thread-2 (]: Began running node model.jaffle_shop.stg_orders
[0m22:32:16.340217 [info ] [Thread-1 (]: 1 of 5 START sql view model JAFFLE_SHOP.stg_customers .......................... [RUN]
[0m22:32:16.341031 [debug] [Thread-3 (]: Began running node model.jaffle_shop.stg_payments
[0m22:32:16.341869 [info ] [Thread-2 (]: 2 of 5 START sql view model JAFFLE_SHOP.stg_orders ............................. [RUN]
[0m22:32:16.343071 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_RAW_JAFFLE_SHOP, now model.jaffle_shop.stg_customers)
[0m22:32:16.343827 [info ] [Thread-3 (]: 3 of 5 START sql view model JAFFLE_SHOP.stg_payments ........................... [RUN]
[0m22:32:16.345442 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.jaffle_shop.stg_orders'
[0m22:32:16.346334 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.stg_customers
[0m22:32:16.347503 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.jaffle_shop.stg_payments'
[0m22:32:16.348146 [debug] [Thread-2 (]: Began compiling node model.jaffle_shop.stg_orders
[0m22:32:16.361817 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.stg_customers"
[0m22:32:16.362969 [debug] [Thread-3 (]: Began compiling node model.jaffle_shop.stg_payments
[0m22:32:16.369042 [debug] [Thread-2 (]: Writing injected SQL for node "model.jaffle_shop.stg_orders"
[0m22:32:16.373788 [debug] [Thread-3 (]: Writing injected SQL for node "model.jaffle_shop.stg_payments"
[0m22:32:16.375188 [debug] [Thread-2 (]: Timing info for model.jaffle_shop.stg_orders (compile): 22:32:16.364129 => 22:32:16.374762
[0m22:32:16.376082 [debug] [Thread-1 (]: Timing info for model.jaffle_shop.stg_customers (compile): 22:32:16.348574 => 22:32:16.375701
[0m22:32:16.376783 [debug] [Thread-2 (]: Began executing node model.jaffle_shop.stg_orders
[0m22:32:16.377516 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.stg_customers
[0m22:32:16.378323 [debug] [Thread-3 (]: Timing info for model.jaffle_shop.stg_payments (compile): 22:32:16.369922 => 22:32:16.377981
[0m22:32:16.433161 [debug] [Thread-3 (]: Began executing node model.jaffle_shop.stg_payments
[0m22:32:16.446691 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.stg_customers"
[0m22:32:16.457368 [debug] [Thread-3 (]: Writing runtime sql for node "model.jaffle_shop.stg_payments"
[0m22:32:16.457933 [debug] [Thread-2 (]: Writing runtime sql for node "model.jaffle_shop.stg_orders"
[0m22:32:16.459684 [debug] [Thread-1 (]: Using snowflake connection "model.jaffle_shop.stg_customers"
[0m22:32:16.460499 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */
create or replace   view RAW.JAFFLE_SHOP.stg_customers
  
   as (
    -- noinspection SqlNoDataSourceInspectionForFile



select
    id as customer_id,
    first_name,
    last_name

from raw.jaffle_shop.raw_customers
  );
[0m22:32:16.461600 [debug] [Thread-3 (]: Using snowflake connection "model.jaffle_shop.stg_payments"
[0m22:32:16.462179 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:32:16.463225 [debug] [Thread-2 (]: Using snowflake connection "model.jaffle_shop.stg_orders"
[0m22:32:16.463793 [debug] [Thread-3 (]: On model.jaffle_shop.stg_payments: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_payments"} */
create or replace   view RAW.JAFFLE_SHOP.stg_payments
  
   as (
    

select
    id,
    order_id,
    payment_method,
    amount

from raw.jaffle_shop.raw_payments
  );
[0m22:32:16.466108 [debug] [Thread-2 (]: On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */
create or replace   view RAW.JAFFLE_SHOP.stg_orders
  
   as (
    

select
    id as order_id,
    user_id as customer_id,
    order_date,
    status

from raw.jaffle_shop.raw_orders
  );
[0m22:32:16.467041 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m22:32:16.467843 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m22:32:17.044171 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m22:32:17.071634 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m22:32:17.086421 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m22:32:17.103985 [debug] [Thread-3 (]: Timing info for model.jaffle_shop.stg_payments (execute): 22:32:16.452649 => 22:32:17.103568
[0m22:32:17.107840 [debug] [Thread-1 (]: Timing info for model.jaffle_shop.stg_customers (execute): 22:32:16.391334 => 22:32:17.107518
[0m22:32:17.111069 [debug] [Thread-2 (]: Timing info for model.jaffle_shop.stg_orders (execute): 22:32:16.378643 => 22:32:17.110741
[0m22:32:17.111838 [debug] [Thread-3 (]: On model.jaffle_shop.stg_payments: Close
[0m22:32:17.112613 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: Close
[0m22:32:17.113287 [debug] [Thread-2 (]: On model.jaffle_shop.stg_orders: Close
[0m22:32:17.281714 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0f439a7d-4d75-408c-a4de-6506b300a265', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109c7b210>]}
[0m22:32:17.283515 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0f439a7d-4d75-408c-a4de-6506b300a265', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109b10450>]}
[0m22:32:17.285637 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0f439a7d-4d75-408c-a4de-6506b300a265', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1099ed710>]}
[0m22:32:17.287447 [info ] [Thread-1 (]: 1 of 5 OK created sql view model JAFFLE_SHOP.stg_customers ..................... [[32mSUCCESS 1[0m in 0.94s]
[0m22:32:17.289837 [info ] [Thread-3 (]: 3 of 5 OK created sql view model JAFFLE_SHOP.stg_payments ...................... [[32mSUCCESS 1[0m in 0.94s]
[0m22:32:17.291170 [info ] [Thread-2 (]: 2 of 5 OK created sql view model JAFFLE_SHOP.stg_orders ........................ [[32mSUCCESS 1[0m in 0.94s]
[0m22:32:17.292972 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.stg_customers
[0m22:32:17.294035 [debug] [Thread-3 (]: Finished running node model.jaffle_shop.stg_payments
[0m22:32:17.294929 [debug] [Thread-2 (]: Finished running node model.jaffle_shop.stg_orders
[0m22:32:17.296407 [debug] [Thread-4 (]: Began running node model.jaffle_shop.customers
[0m22:32:17.297241 [debug] [Thread-1 (]: Began running node model.jaffle_shop.int_orders__pivoted
[0m22:32:17.297910 [info ] [Thread-4 (]: 4 of 5 START sql view model JAFFLE_SHOP.customers .............................. [RUN]
[0m22:32:17.298829 [info ] [Thread-1 (]: 5 of 5 START sql view model JAFFLE_SHOP.int_orders__pivoted .................... [RUN]
[0m22:32:17.300513 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.jaffle_shop.customers'
[0m22:32:17.301769 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.jaffle_shop.stg_customers, now model.jaffle_shop.int_orders__pivoted)
[0m22:32:17.302518 [debug] [Thread-4 (]: Began compiling node model.jaffle_shop.customers
[0m22:32:17.303180 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.int_orders__pivoted
[0m22:32:17.309434 [debug] [Thread-4 (]: Writing injected SQL for node "model.jaffle_shop.customers"
[0m22:32:17.315929 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.int_orders__pivoted"
[0m22:32:17.317474 [debug] [Thread-4 (]: Timing info for model.jaffle_shop.customers (compile): 22:32:17.303782 => 22:32:17.316967
[0m22:32:17.318234 [debug] [Thread-4 (]: Began executing node model.jaffle_shop.customers
[0m22:32:17.319245 [debug] [Thread-1 (]: Timing info for model.jaffle_shop.int_orders__pivoted (compile): 22:32:17.309987 => 22:32:17.318756
[0m22:32:17.327790 [debug] [Thread-4 (]: Writing runtime sql for node "model.jaffle_shop.customers"
[0m22:32:17.328555 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.int_orders__pivoted
[0m22:32:17.349345 [debug] [Thread-4 (]: Using snowflake connection "model.jaffle_shop.customers"
[0m22:32:17.350170 [debug] [Thread-1 (]: Dropping relation "RAW"."JAFFLE_SHOP"."INT_ORDERS__PIVOTED" because it is of type table
[0m22:32:17.351457 [debug] [Thread-4 (]: On model.jaffle_shop.customers: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.customers"} */
create or replace   view RAW.JAFFLE_SHOP.customers
  
   as (
    


with customers as (

    select * from RAW.JAFFLE_SHOP.stg_customers

),

orders as (

    select * from RAW.JAFFLE_SHOP.stg_orders

),

customer_orders as (

    select
        customer_id,

        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders

    from orders

    group by 1

),

final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce(customer_orders.number_of_orders, 0) as number_of_orders

    from customers

    left join customer_orders using (customer_id)

)

select * from final
  );
[0m22:32:17.365541 [debug] [Thread-1 (]: Applying DROP to: "RAW"."JAFFLE_SHOP"."INT_ORDERS__PIVOTED"
[0m22:32:17.366634 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m22:32:17.382732 [debug] [Thread-1 (]: Using snowflake connection "model.jaffle_shop.int_orders__pivoted"
[0m22:32:17.385726 [debug] [Thread-1 (]: On model.jaffle_shop.int_orders__pivoted: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.int_orders__pivoted"} */
drop table if exists "RAW"."JAFFLE_SHOP"."INT_ORDERS__PIVOTED" cascade
[0m22:32:17.386975 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:32:17.945673 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m22:32:17.952679 [debug] [Thread-4 (]: Timing info for model.jaffle_shop.customers (execute): 22:32:17.319784 => 22:32:17.952249
[0m22:32:17.953617 [debug] [Thread-4 (]: On model.jaffle_shop.customers: Close
[0m22:32:18.049161 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m22:32:18.052819 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.int_orders__pivoted"
[0m22:32:18.055916 [debug] [Thread-1 (]: Using snowflake connection "model.jaffle_shop.int_orders__pivoted"
[0m22:32:18.056648 [debug] [Thread-1 (]: On model.jaffle_shop.int_orders__pivoted: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.int_orders__pivoted"} */
create or replace   view RAW.JAFFLE_SHOP.int_orders__pivoted
  
   as (
    



WITH payments AS (
    SELECT p.id AS id,
           p.order_id AS order_id,
           p.payment_method AS payment_method,
           p.amount AS amount,
           o.status AS status
    FROM RAW.JAFFLE_SHOP.stg_payments p
    JOIN RAW.JAFFLE_SHOP.stg_orders o
    ON p.order_id = o.order_id
),
pivoted AS (
    SELECT
        order_id,
        SUM(CASE WHEN payment_method = 'bank_transfer' THEN amount ELSE 0 END) AS bank_transfer_amount,
        SUM(CASE WHEN payment_method = 'coupon' THEN amount ELSE 0 END) AS coupon_amount,
        SUM(CASE WHEN payment_method = 'credit_card' THEN amount ELSE 0 END) AS credit_card_amount,
        SUM(CASE WHEN payment_method = 'gift_card' THEN amount ELSE 0 END) AS gift_card_amount
    FROM payments
    WHERE status = 'success'
    GROUP BY 1
)

SELECT * FROM pivoted
  );
[0m22:32:18.096965 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0f439a7d-4d75-408c-a4de-6506b300a265', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109d32550>]}
[0m22:32:18.098079 [info ] [Thread-4 (]: 4 of 5 OK created sql view model JAFFLE_SHOP.customers ......................... [[32mSUCCESS 1[0m in 0.80s]
[0m22:32:18.099274 [debug] [Thread-4 (]: Finished running node model.jaffle_shop.customers
[0m22:32:18.300174 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m22:32:18.308646 [debug] [Thread-1 (]: Timing info for model.jaffle_shop.int_orders__pivoted (execute): 22:32:17.329400 => 22:32:18.308094
[0m22:32:18.309692 [debug] [Thread-1 (]: On model.jaffle_shop.int_orders__pivoted: Close
[0m22:32:18.492140 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0f439a7d-4d75-408c-a4de-6506b300a265', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109dc4050>]}
[0m22:32:18.493878 [info ] [Thread-1 (]: 5 of 5 OK created sql view model JAFFLE_SHOP.int_orders__pivoted ............... [[32mSUCCESS 1[0m in 1.19s]
[0m22:32:18.495313 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.int_orders__pivoted
[0m22:32:18.499477 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:32:18.500210 [debug] [MainThread]: Connection 'model.jaffle_shop.int_orders__pivoted' was properly closed.
[0m22:32:18.501055 [debug] [MainThread]: Connection 'model.jaffle_shop.stg_orders' was properly closed.
[0m22:32:18.501703 [debug] [MainThread]: Connection 'model.jaffle_shop.stg_payments' was properly closed.
[0m22:32:18.502500 [debug] [MainThread]: Connection 'model.jaffle_shop.customers' was properly closed.
[0m22:32:18.503373 [info ] [MainThread]: 
[0m22:32:18.504738 [info ] [MainThread]: Finished running 5 view models in 0 hours 0 minutes and 3.71 seconds (3.71s).
[0m22:32:18.507181 [debug] [MainThread]: Command end result
[0m22:32:18.522358 [info ] [MainThread]: 
[0m22:32:18.523079 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:32:18.523620 [info ] [MainThread]: 
[0m22:32:18.524180 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m22:32:18.526798 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 4.998042, "process_user_time": 4.875185, "process_kernel_time": 0.64821, "process_mem_max_rss": "140267520", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m22:32:18.528433 [debug] [MainThread]: Command `dbt run` succeeded at 22:32:18.528160 after 5.00 seconds
[0m22:32:18.529337 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10901e950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10901ee50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d77c10>]}
[0m22:32:18.530096 [debug] [MainThread]: Flushing usage events
[0m22:42:12.242935 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1099ff950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10994bc90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10994b810>]}


============================== 22:42:12.251601 | 8cc72603-ed6b-4e1c-9720-14e1a08b4085 ==============================
[0m22:42:12.251601 [info ] [MainThread]: Running with dbt=1.7.8
[0m22:42:12.252720 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/ben/jaffle_shop/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/ben/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt run', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:42:12.960209 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8cc72603-ed6b-4e1c-9720-14e1a08b4085', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109f92590>]}
[0m22:42:13.099688 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8cc72603-ed6b-4e1c-9720-14e1a08b4085', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a930f90>]}
[0m22:42:13.100983 [info ] [MainThread]: Registered adapter: snowflake=1.7.2
[0m22:42:13.126720 [debug] [MainThread]: checksum: 67f0013ca5f0bd43af9a0873dd50792fde83ef69de63b71cacd0b4ac656c52e5, vars: {}, profile: , target: , version: 1.7.8
[0m22:42:13.187152 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m22:42:13.188354 [debug] [MainThread]: Partial parsing: updated file: jaffle_shop://models/marts/core/int_orders__pivoted.sql
[0m22:42:13.420544 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8cc72603-ed6b-4e1c-9720-14e1a08b4085', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aac4a90>]}
[0m22:42:13.439031 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8cc72603-ed6b-4e1c-9720-14e1a08b4085', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ac91d90>]}
[0m22:42:13.439974 [info ] [MainThread]: Found 5 models, 3 seeds, 11 tests, 0 sources, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m22:42:13.441373 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8cc72603-ed6b-4e1c-9720-14e1a08b4085', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ac7bed0>]}
[0m22:42:13.445020 [info ] [MainThread]: 
[0m22:42:13.446357 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m22:42:13.448607 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RAW'
[0m22:42:13.469872 [debug] [ThreadPool]: Using snowflake connection "list_RAW"
[0m22:42:13.470926 [debug] [ThreadPool]: On list_RAW: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_RAW"} */
show terse schemas in database RAW
    limit 10000
[0m22:42:13.471818 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:42:14.290414 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.0 seconds
[0m22:42:14.295829 [debug] [ThreadPool]: On list_RAW: Close
[0m22:42:14.463333 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RAW, now list_RAW_JAFFLE_SHOP)
[0m22:42:14.480172 [debug] [ThreadPool]: Using snowflake connection "list_RAW_JAFFLE_SHOP"
[0m22:42:14.480885 [debug] [ThreadPool]: On list_RAW_JAFFLE_SHOP: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_RAW_JAFFLE_SHOP"} */
show terse objects in RAW.JAFFLE_SHOP limit 10000
[0m22:42:14.481403 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:42:15.012803 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 1.0 seconds
[0m22:42:15.016973 [debug] [ThreadPool]: On list_RAW_JAFFLE_SHOP: Close
[0m22:42:15.153573 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8cc72603-ed6b-4e1c-9720-14e1a08b4085', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aa81910>]}
[0m22:42:15.155376 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:42:15.156312 [info ] [MainThread]: 
[0m22:42:15.160373 [debug] [Thread-1 (]: Began running node model.jaffle_shop.stg_customers
[0m22:42:15.161145 [debug] [Thread-2 (]: Began running node model.jaffle_shop.stg_orders
[0m22:42:15.161886 [info ] [Thread-1 (]: 1 of 5 START sql view model JAFFLE_SHOP.stg_customers .......................... [RUN]
[0m22:42:15.162598 [debug] [Thread-3 (]: Began running node model.jaffle_shop.stg_payments
[0m22:42:15.163332 [info ] [Thread-2 (]: 2 of 5 START sql view model JAFFLE_SHOP.stg_orders ............................. [RUN]
[0m22:42:15.164413 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_RAW_JAFFLE_SHOP, now model.jaffle_shop.stg_customers)
[0m22:42:15.165097 [info ] [Thread-3 (]: 3 of 5 START sql view model JAFFLE_SHOP.stg_payments ........................... [RUN]
[0m22:42:15.166341 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.jaffle_shop.stg_orders'
[0m22:42:15.167114 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.stg_customers
[0m22:42:15.168287 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.jaffle_shop.stg_payments'
[0m22:42:15.168973 [debug] [Thread-2 (]: Began compiling node model.jaffle_shop.stg_orders
[0m22:42:15.182962 [debug] [Thread-3 (]: Began compiling node model.jaffle_shop.stg_payments
[0m22:42:15.182270 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.stg_customers"
[0m22:42:15.188298 [debug] [Thread-2 (]: Writing injected SQL for node "model.jaffle_shop.stg_orders"
[0m22:42:15.194025 [debug] [Thread-3 (]: Writing injected SQL for node "model.jaffle_shop.stg_payments"
[0m22:42:15.196057 [debug] [Thread-2 (]: Timing info for model.jaffle_shop.stg_orders (compile): 22:42:15.183484 => 22:42:15.195601
[0m22:42:15.196909 [debug] [Thread-1 (]: Timing info for model.jaffle_shop.stg_customers (compile): 22:42:15.169411 => 22:42:15.196505
[0m22:42:15.197582 [debug] [Thread-2 (]: Began executing node model.jaffle_shop.stg_orders
[0m22:42:15.198333 [debug] [Thread-3 (]: Timing info for model.jaffle_shop.stg_payments (compile): 22:42:15.189049 => 22:42:15.198010
[0m22:42:15.198847 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.stg_customers
[0m22:42:15.222431 [debug] [Thread-3 (]: Began executing node model.jaffle_shop.stg_payments
[0m22:42:15.246708 [debug] [Thread-2 (]: Writing runtime sql for node "model.jaffle_shop.stg_orders"
[0m22:42:15.251584 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.stg_customers"
[0m22:42:15.256958 [debug] [Thread-3 (]: Writing runtime sql for node "model.jaffle_shop.stg_payments"
[0m22:42:15.259107 [debug] [Thread-1 (]: Using snowflake connection "model.jaffle_shop.stg_customers"
[0m22:42:15.260317 [debug] [Thread-2 (]: Using snowflake connection "model.jaffle_shop.stg_orders"
[0m22:42:15.261035 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */
create or replace   view RAW.JAFFLE_SHOP.stg_customers
  
   as (
    -- noinspection SqlNoDataSourceInspectionForFile



select
    id as customer_id,
    first_name,
    last_name

from raw.jaffle_shop.raw_customers
  );
[0m22:42:15.261812 [debug] [Thread-2 (]: On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */
create or replace   view RAW.JAFFLE_SHOP.stg_orders
  
   as (
    

select
    id as order_id,
    user_id as customer_id,
    order_date,
    status

from raw.jaffle_shop.raw_orders
  );
[0m22:42:15.262919 [debug] [Thread-3 (]: Using snowflake connection "model.jaffle_shop.stg_payments"
[0m22:42:15.263522 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:42:15.264097 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m22:42:15.264659 [debug] [Thread-3 (]: On model.jaffle_shop.stg_payments: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_payments"} */
create or replace   view RAW.JAFFLE_SHOP.stg_payments
  
   as (
    

select
    id,
    order_id,
    payment_method,
    amount

from raw.jaffle_shop.raw_payments
  );
[0m22:42:15.268310 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m22:42:15.816215 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m22:42:15.858603 [debug] [Thread-1 (]: Timing info for model.jaffle_shop.stg_customers (execute): 22:42:15.247280 => 22:42:15.858245
[0m22:42:15.859290 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: Close
[0m22:42:15.913484 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m22:42:15.919980 [debug] [Thread-2 (]: Timing info for model.jaffle_shop.stg_orders (execute): 22:42:15.199221 => 22:42:15.919450
[0m22:42:15.923060 [debug] [Thread-2 (]: On model.jaffle_shop.stg_orders: Close
[0m22:42:15.978756 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m22:42:15.985919 [debug] [Thread-3 (]: Timing info for model.jaffle_shop.stg_payments (execute): 22:42:15.252029 => 22:42:15.985381
[0m22:42:15.986986 [debug] [Thread-3 (]: On model.jaffle_shop.stg_payments: Close
[0m22:42:16.004996 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8cc72603-ed6b-4e1c-9720-14e1a08b4085', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ad20590>]}
[0m22:42:16.006650 [info ] [Thread-1 (]: 1 of 5 OK created sql view model JAFFLE_SHOP.stg_customers ..................... [[32mSUCCESS 1[0m in 0.84s]
[0m22:42:16.008704 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.stg_customers
[0m22:42:16.063922 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8cc72603-ed6b-4e1c-9720-14e1a08b4085', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ab13d90>]}
[0m22:42:16.064899 [info ] [Thread-2 (]: 2 of 5 OK created sql view model JAFFLE_SHOP.stg_orders ........................ [[32mSUCCESS 1[0m in 0.90s]
[0m22:42:16.065806 [debug] [Thread-2 (]: Finished running node model.jaffle_shop.stg_orders
[0m22:42:16.066749 [debug] [Thread-4 (]: Began running node model.jaffle_shop.customers
[0m22:42:16.067505 [info ] [Thread-4 (]: 4 of 5 START sql view model JAFFLE_SHOP.customers .............................. [RUN]
[0m22:42:16.068616 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.jaffle_shop.customers'
[0m22:42:16.069192 [debug] [Thread-4 (]: Began compiling node model.jaffle_shop.customers
[0m22:42:16.075614 [debug] [Thread-4 (]: Writing injected SQL for node "model.jaffle_shop.customers"
[0m22:42:16.076901 [debug] [Thread-4 (]: Timing info for model.jaffle_shop.customers (compile): 22:42:16.069558 => 22:42:16.076519
[0m22:42:16.077493 [debug] [Thread-4 (]: Began executing node model.jaffle_shop.customers
[0m22:42:16.082200 [debug] [Thread-4 (]: Writing runtime sql for node "model.jaffle_shop.customers"
[0m22:42:16.084786 [debug] [Thread-4 (]: Using snowflake connection "model.jaffle_shop.customers"
[0m22:42:16.085541 [debug] [Thread-4 (]: On model.jaffle_shop.customers: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.customers"} */
create or replace   view RAW.JAFFLE_SHOP.customers
  
   as (
    


with customers as (

    select * from RAW.JAFFLE_SHOP.stg_customers

),

orders as (

    select * from RAW.JAFFLE_SHOP.stg_orders

),

customer_orders as (

    select
        customer_id,

        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders

    from orders

    group by 1

),

final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce(customer_orders.number_of_orders, 0) as number_of_orders

    from customers

    left join customer_orders using (customer_id)

)

select * from final
  );
[0m22:42:16.086338 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m22:42:16.127394 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8cc72603-ed6b-4e1c-9720-14e1a08b4085', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ad3cf50>]}
[0m22:42:16.128432 [info ] [Thread-3 (]: 3 of 5 OK created sql view model JAFFLE_SHOP.stg_payments ...................... [[32mSUCCESS 1[0m in 0.96s]
[0m22:42:16.129472 [debug] [Thread-3 (]: Finished running node model.jaffle_shop.stg_payments
[0m22:42:16.130559 [debug] [Thread-2 (]: Began running node model.jaffle_shop.int_orders__pivoted
[0m22:42:16.131354 [info ] [Thread-2 (]: 5 of 5 START sql view model JAFFLE_SHOP.int_orders__pivoted .................... [RUN]
[0m22:42:16.132471 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.jaffle_shop.stg_orders, now model.jaffle_shop.int_orders__pivoted)
[0m22:42:16.133235 [debug] [Thread-2 (]: Began compiling node model.jaffle_shop.int_orders__pivoted
[0m22:42:16.142479 [debug] [Thread-2 (]: Writing injected SQL for node "model.jaffle_shop.int_orders__pivoted"
[0m22:42:16.144228 [debug] [Thread-2 (]: Timing info for model.jaffle_shop.int_orders__pivoted (compile): 22:42:16.134111 => 22:42:16.143591
[0m22:42:16.145155 [debug] [Thread-2 (]: Began executing node model.jaffle_shop.int_orders__pivoted
[0m22:42:16.152083 [debug] [Thread-2 (]: Writing runtime sql for node "model.jaffle_shop.int_orders__pivoted"
[0m22:42:16.155895 [debug] [Thread-2 (]: Using snowflake connection "model.jaffle_shop.int_orders__pivoted"
[0m22:42:16.156734 [debug] [Thread-2 (]: On model.jaffle_shop.int_orders__pivoted: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.int_orders__pivoted"} */
create or replace   view RAW.JAFFLE_SHOP.int_orders__pivoted
  
   as (
    



WITH payments AS (
    SELECT p.id AS id,
           p.order_id AS order_id,
           p.payment_method AS payment_method,
           p.amount AS amount,
           o.status AS status
    FROM RAW.JAFFLE_SHOP.stg_payments p
    JOIN RAW.JAFFLE_SHOP.stg_orders o
    ON p.order_id = o.order_id
),
pivoted AS (
    SELECT
        order_id,
        SUM(CASE WHEN payment_method = 'bank_transfer' THEN amount ELSE 0 END) AS bank_transfer_amount,
        SUM(CASE WHEN payment_method = 'coupon' THEN amount ELSE 0 END) AS coupon_amount,
        SUM(CASE WHEN payment_method = 'credit_card' THEN amount ELSE 0 END) AS credit_card_amount,
        SUM(CASE WHEN payment_method = 'gift_card' THEN amount ELSE 0 END) AS gift_card_amount
    FROM payments
    WHERE status = 'completed'
    GROUP BY 1
)

SELECT * FROM pivoted
  );
[0m22:42:16.157432 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:42:16.637717 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m22:42:16.645182 [debug] [Thread-4 (]: Timing info for model.jaffle_shop.customers (execute): 22:42:16.077853 => 22:42:16.644729
[0m22:42:16.646100 [debug] [Thread-4 (]: On model.jaffle_shop.customers: Close
[0m22:42:16.724708 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m22:42:16.731960 [debug] [Thread-2 (]: Timing info for model.jaffle_shop.int_orders__pivoted (execute): 22:42:16.145725 => 22:42:16.731501
[0m22:42:16.733415 [debug] [Thread-2 (]: On model.jaffle_shop.int_orders__pivoted: Close
[0m22:42:16.809578 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8cc72603-ed6b-4e1c-9720-14e1a08b4085', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10acfb750>]}
[0m22:42:16.811108 [info ] [Thread-4 (]: 4 of 5 OK created sql view model JAFFLE_SHOP.customers ......................... [[32mSUCCESS 1[0m in 0.74s]
[0m22:42:16.812533 [debug] [Thread-4 (]: Finished running node model.jaffle_shop.customers
[0m22:42:16.882536 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8cc72603-ed6b-4e1c-9720-14e1a08b4085', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ad342d0>]}
[0m22:42:16.883794 [info ] [Thread-2 (]: 5 of 5 OK created sql view model JAFFLE_SHOP.int_orders__pivoted ............... [[32mSUCCESS 1[0m in 0.75s]
[0m22:42:16.885413 [debug] [Thread-2 (]: Finished running node model.jaffle_shop.int_orders__pivoted
[0m22:42:16.889371 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:42:16.890216 [debug] [MainThread]: Connection 'model.jaffle_shop.stg_customers' was properly closed.
[0m22:42:16.891016 [debug] [MainThread]: Connection 'model.jaffle_shop.int_orders__pivoted' was properly closed.
[0m22:42:16.891753 [debug] [MainThread]: Connection 'model.jaffle_shop.stg_payments' was properly closed.
[0m22:42:16.892423 [debug] [MainThread]: Connection 'model.jaffle_shop.customers' was properly closed.
[0m22:42:16.893050 [info ] [MainThread]: 
[0m22:42:16.893632 [info ] [MainThread]: Finished running 5 view models in 0 hours 0 minutes and 3.45 seconds (3.45s).
[0m22:42:16.895591 [debug] [MainThread]: Command end result
[0m22:42:16.910336 [info ] [MainThread]: 
[0m22:42:16.911032 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:42:16.911565 [info ] [MainThread]: 
[0m22:42:16.912156 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m22:42:16.914035 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 4.7626257, "process_user_time": 4.798391, "process_kernel_time": 0.639125, "process_mem_max_rss": "138211328", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m22:42:16.914945 [debug] [MainThread]: Command `dbt run` succeeded at 22:42:16.914735 after 4.76 seconds
[0m22:42:16.915601 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109963650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109fdac90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105c8bd90>]}
[0m22:42:16.916200 [debug] [MainThread]: Flushing usage events
[0m13:18:38.289584 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bf45750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bf45310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bf163d0>]}


============================== 13:18:38.299531 | ab39f00b-ce3f-460c-954a-59ec1b1c0fd8 ==============================
[0m13:18:38.299531 [info ] [MainThread]: Running with dbt=1.7.8
[0m13:18:38.301116 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/ben/jaffle_shop/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/ben/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:18:39.044422 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ab39f00b-ce3f-460c-954a-59ec1b1c0fd8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ca1e150>]}
[0m13:18:39.169221 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ab39f00b-ce3f-460c-954a-59ec1b1c0fd8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ca45710>]}
[0m13:18:39.171082 [info ] [MainThread]: Registered adapter: snowflake=1.7.2
[0m13:18:39.194853 [debug] [MainThread]: checksum: 67f0013ca5f0bd43af9a0873dd50792fde83ef69de63b71cacd0b4ac656c52e5, vars: {}, profile: , target: , version: 1.7.8
[0m13:18:39.300090 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m13:18:39.301319 [debug] [MainThread]: Partial parsing: added file: jaffle_shop://macros/cents_to_dollars.sql
[0m13:18:39.302203 [debug] [MainThread]: Partial parsing: updated file: jaffle_shop://models/staging/stg_payments.sql
[0m13:18:39.478723 [error] [MainThread]: Encountered an error:
Compilation Error in model stg_payments (models/staging/stg_payments.sql)
  unexpected '%'
    line 11
      {{% cents_to_dollars(amount, 2) %}} AS amount
[0m13:18:39.481348 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 1.2742366, "process_user_time": 3.785739, "process_kernel_time": 0.550046, "process_mem_max_rss": "124698624", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m13:18:39.482562 [debug] [MainThread]: Command `dbt run` failed at 13:18:39.482324 after 1.28 seconds
[0m13:18:39.483275 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bc59ad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c282c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bf2ff90>]}
[0m13:18:39.484020 [debug] [MainThread]: Flushing usage events
[0m13:19:12.042589 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b550890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bded350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bd43f90>]}


============================== 13:19:12.048619 | 1198959b-cad6-4402-a9a5-996fdf39c6bc ==============================
[0m13:19:12.048619 [info ] [MainThread]: Running with dbt=1.7.8
[0m13:19:12.049891 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/ben/jaffle_shop/logs', 'profiles_dir': '/Users/ben/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m13:19:12.571681 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1198959b-cad6-4402-a9a5-996fdf39c6bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bded910>]}
[0m13:19:12.699142 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1198959b-cad6-4402-a9a5-996fdf39c6bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c0f7790>]}
[0m13:19:12.700390 [info ] [MainThread]: Registered adapter: snowflake=1.7.2
[0m13:19:12.722841 [debug] [MainThread]: checksum: 67f0013ca5f0bd43af9a0873dd50792fde83ef69de63b71cacd0b4ac656c52e5, vars: {}, profile: , target: , version: 1.7.8
[0m13:19:12.774353 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m13:19:12.775363 [debug] [MainThread]: Partial parsing: added file: jaffle_shop://macros/cents_to_dollars.sql
[0m13:19:12.776111 [debug] [MainThread]: Partial parsing: updated file: jaffle_shop://models/staging/stg_payments.sql
[0m13:19:12.947019 [error] [MainThread]: Encountered an error:
Compilation Error in model stg_payments (models/staging/stg_payments.sql)
  Encountered unknown tag 'cents_to_dollars'.
    line 11
      {% cents_to_dollars(amount, 2) %} AS amount
[0m13:19:12.948971 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.98693496, "process_user_time": 3.598834, "process_kernel_time": 0.311528, "process_mem_max_rss": "125575168", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m13:19:12.949888 [debug] [MainThread]: Command `dbt run` failed at 13:19:12.949672 after 0.99 seconds
[0m13:19:12.950564 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bded190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c0b9310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bab5e10>]}
[0m13:19:12.951234 [debug] [MainThread]: Flushing usage events
[0m13:20:39.214203 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110b51490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110f16510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110b5f890>]}


============================== 13:20:39.221137 | f579c266-1956-4119-88cf-dc043af86022 ==============================
[0m13:20:39.221137 [info ] [MainThread]: Running with dbt=1.7.8
[0m13:20:39.222291 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/ben/jaffle_shop/logs', 'version_check': 'True', 'profiles_dir': '/Users/ben/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:20:39.751471 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f579c266-1956-4119-88cf-dc043af86022', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f9a4950>]}
[0m13:20:39.876870 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f579c266-1956-4119-88cf-dc043af86022', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111aa8250>]}
[0m13:20:39.878246 [info ] [MainThread]: Registered adapter: snowflake=1.7.2
[0m13:20:39.901795 [debug] [MainThread]: checksum: 67f0013ca5f0bd43af9a0873dd50792fde83ef69de63b71cacd0b4ac656c52e5, vars: {}, profile: , target: , version: 1.7.8
[0m13:20:39.955369 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m13:20:39.956397 [debug] [MainThread]: Partial parsing: added file: jaffle_shop://macros/cents_to_dollars.sql
[0m13:20:39.957150 [debug] [MainThread]: Partial parsing: updated file: jaffle_shop://models/staging/stg_payments.sql
[0m13:20:40.369637 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f579c266-1956-4119-88cf-dc043af86022', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111ea7b10>]}
[0m13:20:40.390242 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f579c266-1956-4119-88cf-dc043af86022', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111f26fd0>]}
[0m13:20:40.391112 [info ] [MainThread]: Found 5 models, 3 seeds, 11 tests, 0 sources, 0 exposures, 0 metrics, 431 macros, 0 groups, 0 semantic models
[0m13:20:40.391730 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f579c266-1956-4119-88cf-dc043af86022', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111d71310>]}
[0m13:20:40.395271 [info ] [MainThread]: 
[0m13:20:40.396662 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m13:20:40.398435 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RAW'
[0m13:20:40.417814 [debug] [ThreadPool]: Using snowflake connection "list_RAW"
[0m13:20:40.418515 [debug] [ThreadPool]: On list_RAW: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_RAW"} */
show terse schemas in database RAW
    limit 10000
[0m13:20:40.419058 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:20:41.252190 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.0 seconds
[0m13:20:41.257141 [debug] [ThreadPool]: On list_RAW: Close
[0m13:20:41.420239 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RAW, now list_RAW_JAFFLE_SHOP)
[0m13:20:41.437480 [debug] [ThreadPool]: Using snowflake connection "list_RAW_JAFFLE_SHOP"
[0m13:20:41.438255 [debug] [ThreadPool]: On list_RAW_JAFFLE_SHOP: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_RAW_JAFFLE_SHOP"} */
show terse objects in RAW.JAFFLE_SHOP limit 10000
[0m13:20:41.438831 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:20:42.021645 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 1.0 seconds
[0m13:20:42.026054 [debug] [ThreadPool]: On list_RAW_JAFFLE_SHOP: Close
[0m13:20:42.177093 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f579c266-1956-4119-88cf-dc043af86022', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111f53d50>]}
[0m13:20:42.179037 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:20:42.179954 [info ] [MainThread]: 
[0m13:20:42.186196 [debug] [Thread-1 (]: Began running node model.jaffle_shop.stg_customers
[0m13:20:42.187171 [debug] [Thread-2 (]: Began running node model.jaffle_shop.stg_orders
[0m13:20:42.188089 [debug] [Thread-3 (]: Began running node model.jaffle_shop.stg_payments
[0m13:20:42.188978 [info ] [Thread-1 (]: 1 of 5 START sql view model JAFFLE_SHOP.stg_customers .......................... [RUN]
[0m13:20:42.189928 [info ] [Thread-2 (]: 2 of 5 START sql view model JAFFLE_SHOP.stg_orders ............................. [RUN]
[0m13:20:42.190778 [info ] [Thread-3 (]: 3 of 5 START sql view model JAFFLE_SHOP.stg_payments ........................... [RUN]
[0m13:20:42.192158 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_RAW_JAFFLE_SHOP, now model.jaffle_shop.stg_customers)
[0m13:20:42.193370 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.jaffle_shop.stg_orders'
[0m13:20:42.194498 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.jaffle_shop.stg_payments'
[0m13:20:42.195094 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.stg_customers
[0m13:20:42.195641 [debug] [Thread-2 (]: Began compiling node model.jaffle_shop.stg_orders
[0m13:20:42.196172 [debug] [Thread-3 (]: Began compiling node model.jaffle_shop.stg_payments
[0m13:20:42.207499 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.stg_customers"
[0m13:20:42.213394 [debug] [Thread-2 (]: Writing injected SQL for node "model.jaffle_shop.stg_orders"
[0m13:20:42.218428 [debug] [Thread-3 (]: Writing injected SQL for node "model.jaffle_shop.stg_payments"
[0m13:20:42.220031 [debug] [Thread-1 (]: Timing info for model.jaffle_shop.stg_customers (compile): 13:20:42.196538 => 13:20:42.219581
[0m13:20:42.221062 [debug] [Thread-2 (]: Timing info for model.jaffle_shop.stg_orders (compile): 13:20:42.208042 => 13:20:42.220618
[0m13:20:42.221791 [debug] [Thread-3 (]: Timing info for model.jaffle_shop.stg_payments (compile): 13:20:42.214135 => 13:20:42.221467
[0m13:20:42.222323 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.stg_customers
[0m13:20:42.223049 [debug] [Thread-2 (]: Began executing node model.jaffle_shop.stg_orders
[0m13:20:42.224125 [debug] [Thread-3 (]: Began executing node model.jaffle_shop.stg_payments
[0m13:20:42.279920 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.stg_customers"
[0m13:20:42.282580 [debug] [Thread-2 (]: Writing runtime sql for node "model.jaffle_shop.stg_orders"
[0m13:20:42.286811 [debug] [Thread-3 (]: Writing runtime sql for node "model.jaffle_shop.stg_payments"
[0m13:20:42.288680 [debug] [Thread-1 (]: Using snowflake connection "model.jaffle_shop.stg_customers"
[0m13:20:42.289328 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */
create or replace   view RAW.JAFFLE_SHOP.stg_customers
  
   as (
    -- noinspection SqlNoDataSourceInspectionForFile



select
    id as customer_id,
    first_name,
    last_name

from raw.jaffle_shop.raw_customers
  );
[0m13:20:42.290337 [debug] [Thread-2 (]: Using snowflake connection "model.jaffle_shop.stg_orders"
[0m13:20:42.290836 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:20:42.291714 [debug] [Thread-3 (]: Using snowflake connection "model.jaffle_shop.stg_payments"
[0m13:20:42.292287 [debug] [Thread-2 (]: On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */
create or replace   view RAW.JAFFLE_SHOP.stg_orders
  
   as (
    

select
    id as order_id,
    user_id as customer_id,
    order_date,
    status

from raw.jaffle_shop.raw_orders
  );
[0m13:20:42.294349 [debug] [Thread-3 (]: On model.jaffle_shop.stg_payments: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_payments"} */
create or replace   view RAW.JAFFLE_SHOP.stg_payments
  
   as (
    

select
    id,
    order_id,
    payment_method,
    
round(1.0 *  / 100, 2) AS amount

from raw.jaffle_shop.raw_payments
  );
[0m13:20:42.295188 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m13:20:42.295880 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m13:20:42.867275 [debug] [Thread-3 (]: Snowflake adapter: Snowflake query id: 01b3aaf0-0001-c86b-0005-81260003f1ba
[0m13:20:42.868387 [debug] [Thread-3 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 11 at position 13 unexpected '/'.
[0m13:20:42.869546 [debug] [Thread-3 (]: Timing info for model.jaffle_shop.stg_payments (execute): 13:20:42.282973 => 13:20:42.869106
[0m13:20:42.870333 [debug] [Thread-3 (]: On model.jaffle_shop.stg_payments: Close
[0m13:20:42.891351 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m13:20:42.915792 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m13:20:42.940740 [debug] [Thread-1 (]: Timing info for model.jaffle_shop.stg_customers (execute): 13:20:42.224599 => 13:20:42.940374
[0m13:20:42.942325 [debug] [Thread-2 (]: Timing info for model.jaffle_shop.stg_orders (execute): 13:20:42.257905 => 13:20:42.942001
[0m13:20:42.942987 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: Close
[0m13:20:42.944921 [debug] [Thread-2 (]: On model.jaffle_shop.stg_orders: Close
[0m13:20:43.024498 [debug] [Thread-3 (]: Database Error in model stg_payments (models/staging/stg_payments.sql)
  001003 (42000): SQL compilation error:
  syntax error line 11 at position 13 unexpected '/'.
  compiled Code at target/run/jaffle_shop/models/staging/stg_payments.sql
[0m13:20:43.025643 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f579c266-1956-4119-88cf-dc043af86022', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11227add0>]}
[0m13:20:43.026814 [error] [Thread-3 (]: 3 of 5 ERROR creating sql view model JAFFLE_SHOP.stg_payments .................. [[31mERROR[0m in 0.83s]
[0m13:20:43.027908 [debug] [Thread-3 (]: Finished running node model.jaffle_shop.stg_payments
[0m13:20:43.090101 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f579c266-1956-4119-88cf-dc043af86022', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112183650>]}
[0m13:20:43.091902 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f579c266-1956-4119-88cf-dc043af86022', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1120c9490>]}
[0m13:20:43.092994 [info ] [Thread-1 (]: 1 of 5 OK created sql view model JAFFLE_SHOP.stg_customers ..................... [[32mSUCCESS 1[0m in 0.90s]
[0m13:20:43.094294 [info ] [Thread-2 (]: 2 of 5 OK created sql view model JAFFLE_SHOP.stg_orders ........................ [[32mSUCCESS 1[0m in 0.90s]
[0m13:20:43.095565 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.stg_customers
[0m13:20:43.096657 [debug] [Thread-2 (]: Finished running node model.jaffle_shop.stg_orders
[0m13:20:43.098410 [debug] [Thread-4 (]: Began running node model.jaffle_shop.customers
[0m13:20:43.099222 [debug] [Thread-3 (]: Began running node model.jaffle_shop.int_orders__pivoted
[0m13:20:43.099973 [info ] [Thread-4 (]: 4 of 5 START sql view model JAFFLE_SHOP.customers .............................. [RUN]
[0m13:20:43.100847 [info ] [Thread-3 (]: 5 of 5 SKIP relation JAFFLE_SHOP.int_orders__pivoted ........................... [[33mSKIP[0m]
[0m13:20:43.102298 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.jaffle_shop.customers'
[0m13:20:43.103132 [debug] [Thread-3 (]: Finished running node model.jaffle_shop.int_orders__pivoted
[0m13:20:43.103829 [debug] [Thread-4 (]: Began compiling node model.jaffle_shop.customers
[0m13:20:43.109304 [debug] [Thread-4 (]: Writing injected SQL for node "model.jaffle_shop.customers"
[0m13:20:43.111507 [debug] [Thread-4 (]: Timing info for model.jaffle_shop.customers (compile): 13:20:43.104435 => 13:20:43.110990
[0m13:20:43.112298 [debug] [Thread-4 (]: Began executing node model.jaffle_shop.customers
[0m13:20:43.117522 [debug] [Thread-4 (]: Writing runtime sql for node "model.jaffle_shop.customers"
[0m13:20:43.120504 [debug] [Thread-4 (]: Using snowflake connection "model.jaffle_shop.customers"
[0m13:20:43.121995 [debug] [Thread-4 (]: On model.jaffle_shop.customers: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.customers"} */
create or replace   view RAW.JAFFLE_SHOP.customers
  
   as (
    


with customers as (

    select * from RAW.JAFFLE_SHOP.stg_customers

),

orders as (

    select * from RAW.JAFFLE_SHOP.stg_orders

),

customer_orders as (

    select
        customer_id,

        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders

    from orders

    group by 1

),

final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce(customer_orders.number_of_orders, 0) as number_of_orders

    from customers

    left join customer_orders using (customer_id)

)

select * from final
  );
[0m13:20:43.122839 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m13:20:44.109012 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m13:20:44.116228 [debug] [Thread-4 (]: Timing info for model.jaffle_shop.customers (execute): 13:20:43.112839 => 13:20:44.115575
[0m13:20:44.117206 [debug] [Thread-4 (]: On model.jaffle_shop.customers: Close
[0m13:20:44.252345 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f579c266-1956-4119-88cf-dc043af86022', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111c3d3d0>]}
[0m13:20:44.254182 [info ] [Thread-4 (]: 4 of 5 OK created sql view model JAFFLE_SHOP.customers ......................... [[32mSUCCESS 1[0m in 1.15s]
[0m13:20:44.256390 [debug] [Thread-4 (]: Finished running node model.jaffle_shop.customers
[0m13:20:44.261168 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:20:44.262054 [debug] [MainThread]: Connection 'model.jaffle_shop.stg_customers' was properly closed.
[0m13:20:44.262720 [debug] [MainThread]: Connection 'model.jaffle_shop.stg_orders' was properly closed.
[0m13:20:44.263351 [debug] [MainThread]: Connection 'model.jaffle_shop.stg_payments' was properly closed.
[0m13:20:44.263960 [debug] [MainThread]: Connection 'model.jaffle_shop.customers' was properly closed.
[0m13:20:44.264681 [info ] [MainThread]: 
[0m13:20:44.265413 [info ] [MainThread]: Finished running 5 view models in 0 hours 0 minutes and 3.87 seconds (3.87s).
[0m13:20:44.267508 [debug] [MainThread]: Command end result
[0m13:20:44.280952 [info ] [MainThread]: 
[0m13:20:44.281623 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m13:20:44.282137 [info ] [MainThread]: 
[0m13:20:44.282654 [error] [MainThread]:   Database Error in model stg_payments (models/staging/stg_payments.sql)
  001003 (42000): SQL compilation error:
  syntax error line 11 at position 13 unexpected '/'.
  compiled Code at target/run/jaffle_shop/models/staging/stg_payments.sql
[0m13:20:44.283158 [info ] [MainThread]: 
[0m13:20:44.283692 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=1 TOTAL=5
[0m13:20:44.289030 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 5.1567845, "process_user_time": 4.609221, "process_kernel_time": 0.452207, "process_mem_max_rss": "144125952", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m13:20:44.290753 [debug] [MainThread]: Command `dbt run` failed at 13:20:44.290399 after 5.16 seconds
[0m13:20:44.291501 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110e44210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f40b2d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ceac6d0>]}
[0m13:20:44.292120 [debug] [MainThread]: Flushing usage events
[0m13:23:13.202167 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e82a890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e586210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e584410>]}


============================== 13:23:13.211972 | dfebd63b-0652-4a45-ae82-64dbe2175239 ==============================
[0m13:23:13.211972 [info ] [MainThread]: Running with dbt=1.7.8
[0m13:23:13.213319 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/ben/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/ben/jaffle_shop/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:23:13.929965 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'dfebd63b-0652-4a45-ae82-64dbe2175239', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f4a92d0>]}
[0m13:23:14.057715 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'dfebd63b-0652-4a45-ae82-64dbe2175239', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f31b190>]}
[0m13:23:14.059786 [info ] [MainThread]: Registered adapter: snowflake=1.7.2
[0m13:23:14.084320 [debug] [MainThread]: checksum: 67f0013ca5f0bd43af9a0873dd50792fde83ef69de63b71cacd0b4ac656c52e5, vars: {}, profile: , target: , version: 1.7.8
[0m13:23:14.192204 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:23:14.193625 [debug] [MainThread]: Partial parsing: updated file: jaffle_shop://macros/cents_to_dollars.sql
[0m13:23:14.611232 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'dfebd63b-0652-4a45-ae82-64dbe2175239', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fa26390>]}
[0m13:23:14.629704 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'dfebd63b-0652-4a45-ae82-64dbe2175239', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f454390>]}
[0m13:23:14.630478 [info ] [MainThread]: Found 5 models, 3 seeds, 11 tests, 0 sources, 0 exposures, 0 metrics, 431 macros, 0 groups, 0 semantic models
[0m13:23:14.631079 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dfebd63b-0652-4a45-ae82-64dbe2175239', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f641f90>]}
[0m13:23:14.634927 [info ] [MainThread]: 
[0m13:23:14.636229 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m13:23:14.637948 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RAW'
[0m13:23:14.657139 [debug] [ThreadPool]: Using snowflake connection "list_RAW"
[0m13:23:14.657868 [debug] [ThreadPool]: On list_RAW: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_RAW"} */
show terse schemas in database RAW
    limit 10000
[0m13:23:14.658396 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:23:15.601824 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.0 seconds
[0m13:23:15.606521 [debug] [ThreadPool]: On list_RAW: Close
[0m13:23:15.766032 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RAW, now list_RAW_JAFFLE_SHOP)
[0m13:23:15.782289 [debug] [ThreadPool]: Using snowflake connection "list_RAW_JAFFLE_SHOP"
[0m13:23:15.783034 [debug] [ThreadPool]: On list_RAW_JAFFLE_SHOP: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_RAW_JAFFLE_SHOP"} */
show terse objects in RAW.JAFFLE_SHOP limit 10000
[0m13:23:15.783620 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:23:16.338386 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 1.0 seconds
[0m13:23:16.343417 [debug] [ThreadPool]: On list_RAW_JAFFLE_SHOP: Close
[0m13:23:16.501242 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dfebd63b-0652-4a45-ae82-64dbe2175239', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f8cae10>]}
[0m13:23:16.503240 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:23:16.504740 [info ] [MainThread]: 
[0m13:23:16.511210 [debug] [Thread-1 (]: Began running node model.jaffle_shop.stg_customers
[0m13:23:16.512191 [debug] [Thread-2 (]: Began running node model.jaffle_shop.stg_orders
[0m13:23:16.513208 [info ] [Thread-1 (]: 1 of 5 START sql view model JAFFLE_SHOP.stg_customers .......................... [RUN]
[0m13:23:16.514194 [info ] [Thread-2 (]: 2 of 5 START sql view model JAFFLE_SHOP.stg_orders ............................. [RUN]
[0m13:23:16.514993 [debug] [Thread-3 (]: Began running node model.jaffle_shop.stg_payments
[0m13:23:16.516213 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_RAW_JAFFLE_SHOP, now model.jaffle_shop.stg_customers)
[0m13:23:16.517833 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.jaffle_shop.stg_orders'
[0m13:23:16.518887 [info ] [Thread-3 (]: 3 of 5 START sql view model JAFFLE_SHOP.stg_payments ........................... [RUN]
[0m13:23:16.520283 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.stg_customers
[0m13:23:16.521154 [debug] [Thread-2 (]: Began compiling node model.jaffle_shop.stg_orders
[0m13:23:16.523051 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.jaffle_shop.stg_payments'
[0m13:23:16.529367 [debug] [Thread-2 (]: Writing injected SQL for node "model.jaffle_shop.stg_orders"
[0m13:23:16.541180 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.stg_customers"
[0m13:23:16.541927 [debug] [Thread-3 (]: Began compiling node model.jaffle_shop.stg_payments
[0m13:23:16.547982 [debug] [Thread-3 (]: Writing injected SQL for node "model.jaffle_shop.stg_payments"
[0m13:23:16.549445 [debug] [Thread-2 (]: Timing info for model.jaffle_shop.stg_orders (compile): 13:23:16.525121 => 13:23:16.548870
[0m13:23:16.550362 [debug] [Thread-2 (]: Began executing node model.jaffle_shop.stg_orders
[0m13:23:16.556515 [debug] [Thread-1 (]: Timing info for model.jaffle_shop.stg_customers (compile): 13:23:16.523830 => 13:23:16.556051
[0m13:23:16.557222 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.stg_customers
[0m13:23:16.575705 [debug] [Thread-3 (]: Timing info for model.jaffle_shop.stg_payments (compile): 13:23:16.542897 => 13:23:16.574955
[0m13:23:16.614170 [debug] [Thread-3 (]: Began executing node model.jaffle_shop.stg_payments
[0m13:23:16.634132 [debug] [Thread-2 (]: Writing runtime sql for node "model.jaffle_shop.stg_orders"
[0m13:23:16.635189 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.stg_customers"
[0m13:23:16.643040 [debug] [Thread-3 (]: Writing runtime sql for node "model.jaffle_shop.stg_payments"
[0m13:23:16.644703 [debug] [Thread-2 (]: Using snowflake connection "model.jaffle_shop.stg_orders"
[0m13:23:16.645873 [debug] [Thread-1 (]: Using snowflake connection "model.jaffle_shop.stg_customers"
[0m13:23:16.646633 [debug] [Thread-2 (]: On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */
create or replace   view RAW.JAFFLE_SHOP.stg_orders
  
   as (
    

select
    id as order_id,
    user_id as customer_id,
    order_date,
    status

from raw.jaffle_shop.raw_orders
  );
[0m13:23:16.647736 [debug] [Thread-3 (]: Using snowflake connection "model.jaffle_shop.stg_payments"
[0m13:23:16.648269 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */
create or replace   view RAW.JAFFLE_SHOP.stg_customers
  
   as (
    -- noinspection SqlNoDataSourceInspectionForFile



select
    id as customer_id,
    first_name,
    last_name

from raw.jaffle_shop.raw_customers
  );
[0m13:23:16.648874 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m13:23:16.649448 [debug] [Thread-3 (]: On model.jaffle_shop.stg_payments: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_payments"} */
create or replace   view RAW.JAFFLE_SHOP.stg_payments
  
   as (
    

select
    id,
    order_id,
    payment_method,
    round(1.0 *  / 100, 2) AS amount

from raw.jaffle_shop.raw_payments
  );
[0m13:23:16.649997 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:23:16.651454 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m13:23:17.245441 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m13:23:17.284671 [debug] [Thread-1 (]: Timing info for model.jaffle_shop.stg_customers (execute): 13:23:16.563160 => 13:23:17.284132
[0m13:23:17.285660 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: Close
[0m13:23:17.291555 [debug] [Thread-3 (]: Snowflake adapter: Snowflake query id: 01b3aaf3-0001-c86b-0005-81260003f1be
[0m13:23:17.292295 [debug] [Thread-3 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 10 at position 17 unexpected '/'.
[0m13:23:17.293654 [debug] [Thread-3 (]: Timing info for model.jaffle_shop.stg_payments (execute): 13:23:16.635576 => 13:23:17.293141
[0m13:23:17.294369 [debug] [Thread-3 (]: On model.jaffle_shop.stg_payments: Close
[0m13:23:17.405815 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m13:23:17.413334 [debug] [Thread-2 (]: Timing info for model.jaffle_shop.stg_orders (execute): 13:23:16.550787 => 13:23:17.412781
[0m13:23:17.414398 [debug] [Thread-2 (]: On model.jaffle_shop.stg_orders: Close
[0m13:23:17.423986 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dfebd63b-0652-4a45-ae82-64dbe2175239', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fa585d0>]}
[0m13:23:17.425155 [info ] [Thread-1 (]: 1 of 5 OK created sql view model JAFFLE_SHOP.stg_customers ..................... [[32mSUCCESS 1[0m in 0.91s]
[0m13:23:17.426401 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.stg_customers
[0m13:23:17.458755 [debug] [Thread-3 (]: Database Error in model stg_payments (models/staging/stg_payments.sql)
  001003 (42000): SQL compilation error:
  syntax error line 10 at position 17 unexpected '/'.
  compiled Code at target/run/jaffle_shop/models/staging/stg_payments.sql
[0m13:23:17.460771 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dfebd63b-0652-4a45-ae82-64dbe2175239', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f8f02d0>]}
[0m13:23:17.462009 [error] [Thread-3 (]: 3 of 5 ERROR creating sql view model JAFFLE_SHOP.stg_payments .................. [[31mERROR[0m in 0.94s]
[0m13:23:17.463067 [debug] [Thread-3 (]: Finished running node model.jaffle_shop.stg_payments
[0m13:23:17.575329 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dfebd63b-0652-4a45-ae82-64dbe2175239', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fad3e10>]}
[0m13:23:17.576946 [info ] [Thread-2 (]: 2 of 5 OK created sql view model JAFFLE_SHOP.stg_orders ........................ [[32mSUCCESS 1[0m in 1.06s]
[0m13:23:17.578462 [debug] [Thread-2 (]: Finished running node model.jaffle_shop.stg_orders
[0m13:23:17.580771 [debug] [Thread-4 (]: Began running node model.jaffle_shop.customers
[0m13:23:17.582084 [debug] [Thread-1 (]: Began running node model.jaffle_shop.int_orders__pivoted
[0m13:23:17.583195 [info ] [Thread-4 (]: 4 of 5 START sql view model JAFFLE_SHOP.customers .............................. [RUN]
[0m13:23:17.584421 [info ] [Thread-1 (]: 5 of 5 SKIP relation JAFFLE_SHOP.int_orders__pivoted ........................... [[33mSKIP[0m]
[0m13:23:17.585975 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.jaffle_shop.customers'
[0m13:23:17.586851 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.int_orders__pivoted
[0m13:23:17.587703 [debug] [Thread-4 (]: Began compiling node model.jaffle_shop.customers
[0m13:23:17.593303 [debug] [Thread-4 (]: Writing injected SQL for node "model.jaffle_shop.customers"
[0m13:23:17.594595 [debug] [Thread-4 (]: Timing info for model.jaffle_shop.customers (compile): 13:23:17.588465 => 13:23:17.594220
[0m13:23:17.595201 [debug] [Thread-4 (]: Began executing node model.jaffle_shop.customers
[0m13:23:17.600487 [debug] [Thread-4 (]: Writing runtime sql for node "model.jaffle_shop.customers"
[0m13:23:17.603009 [debug] [Thread-4 (]: Using snowflake connection "model.jaffle_shop.customers"
[0m13:23:17.603658 [debug] [Thread-4 (]: On model.jaffle_shop.customers: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.customers"} */
create or replace   view RAW.JAFFLE_SHOP.customers
  
   as (
    


with customers as (

    select * from RAW.JAFFLE_SHOP.stg_customers

),

orders as (

    select * from RAW.JAFFLE_SHOP.stg_orders

),

customer_orders as (

    select
        customer_id,

        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders

    from orders

    group by 1

),

final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce(customer_orders.number_of_orders, 0) as number_of_orders

    from customers

    left join customer_orders using (customer_id)

)

select * from final
  );
[0m13:23:17.604268 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m13:23:18.306415 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m13:23:18.313243 [debug] [Thread-4 (]: Timing info for model.jaffle_shop.customers (execute): 13:23:17.595578 => 13:23:18.312680
[0m13:23:18.314234 [debug] [Thread-4 (]: On model.jaffle_shop.customers: Close
[0m13:23:18.451378 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dfebd63b-0652-4a45-ae82-64dbe2175239', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fab0e90>]}
[0m13:23:18.453215 [info ] [Thread-4 (]: 4 of 5 OK created sql view model JAFFLE_SHOP.customers ......................... [[32mSUCCESS 1[0m in 0.87s]
[0m13:23:18.455324 [debug] [Thread-4 (]: Finished running node model.jaffle_shop.customers
[0m13:23:18.459567 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:23:18.460497 [debug] [MainThread]: Connection 'model.jaffle_shop.stg_customers' was properly closed.
[0m13:23:18.461265 [debug] [MainThread]: Connection 'model.jaffle_shop.stg_orders' was properly closed.
[0m13:23:18.461998 [debug] [MainThread]: Connection 'model.jaffle_shop.stg_payments' was properly closed.
[0m13:23:18.462608 [debug] [MainThread]: Connection 'model.jaffle_shop.customers' was properly closed.
[0m13:23:18.463329 [info ] [MainThread]: 
[0m13:23:18.464076 [info ] [MainThread]: Finished running 5 view models in 0 hours 0 minutes and 3.83 seconds (3.83s).
[0m13:23:18.466155 [debug] [MainThread]: Command end result
[0m13:23:18.481001 [info ] [MainThread]: 
[0m13:23:18.481673 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m13:23:18.482186 [info ] [MainThread]: 
[0m13:23:18.482694 [error] [MainThread]:   Database Error in model stg_payments (models/staging/stg_payments.sql)
  001003 (42000): SQL compilation error:
  syntax error line 10 at position 17 unexpected '/'.
  compiled Code at target/run/jaffle_shop/models/staging/stg_payments.sql
[0m13:23:18.483202 [info ] [MainThread]: 
[0m13:23:18.483743 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=1 TOTAL=5
[0m13:23:18.486712 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 5.369939, "process_user_time": 4.869076, "process_kernel_time": 0.660874, "process_mem_max_rss": "143007744", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m13:23:18.487975 [debug] [MainThread]: Command `dbt run` failed at 13:23:18.487709 after 5.37 seconds
[0m13:23:18.488872 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e513e90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10eb95250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10eb969d0>]}
[0m13:23:18.490143 [debug] [MainThread]: Flushing usage events
[0m13:25:42.169523 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c4e650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ba3710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107909310>]}


============================== 13:25:42.178850 | 8e41974a-055c-4bd8-9ffa-85c6c1745663 ==============================
[0m13:25:42.178850 [info ] [MainThread]: Running with dbt=1.7.8
[0m13:25:42.180259 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/ben/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/ben/jaffle_shop/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m13:25:42.924849 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8e41974a-055c-4bd8-9ffa-85c6c1745663', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107918850>]}
[0m13:25:43.051937 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8e41974a-055c-4bd8-9ffa-85c6c1745663', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ba3710>]}
[0m13:25:43.053990 [info ] [MainThread]: Registered adapter: snowflake=1.7.2
[0m13:25:43.079227 [debug] [MainThread]: checksum: 67f0013ca5f0bd43af9a0873dd50792fde83ef69de63b71cacd0b4ac656c52e5, vars: {}, profile: , target: , version: 1.7.8
[0m13:25:43.187438 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:25:43.188575 [debug] [MainThread]: Partial parsing: updated file: jaffle_shop://models/staging/stg_payments.sql
[0m13:25:43.594973 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8e41974a-055c-4bd8-9ffa-85c6c1745663', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108cc8b50>]}
[0m13:25:43.613270 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8e41974a-055c-4bd8-9ffa-85c6c1745663', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c44050>]}
[0m13:25:43.614155 [info ] [MainThread]: Found 5 models, 3 seeds, 11 tests, 0 sources, 0 exposures, 0 metrics, 431 macros, 0 groups, 0 semantic models
[0m13:25:43.614833 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8e41974a-055c-4bd8-9ffa-85c6c1745663', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108b1fd50>]}
[0m13:25:43.618499 [info ] [MainThread]: 
[0m13:25:43.619796 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m13:25:43.621515 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RAW'
[0m13:25:43.640462 [debug] [ThreadPool]: Using snowflake connection "list_RAW"
[0m13:25:43.641192 [debug] [ThreadPool]: On list_RAW: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_RAW"} */
show terse schemas in database RAW
    limit 10000
[0m13:25:43.641723 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:25:44.459271 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.0 seconds
[0m13:25:44.464334 [debug] [ThreadPool]: On list_RAW: Close
[0m13:25:44.629906 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RAW, now list_RAW_JAFFLE_SHOP)
[0m13:25:44.646041 [debug] [ThreadPool]: Using snowflake connection "list_RAW_JAFFLE_SHOP"
[0m13:25:44.646782 [debug] [ThreadPool]: On list_RAW_JAFFLE_SHOP: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_RAW_JAFFLE_SHOP"} */
show terse objects in RAW.JAFFLE_SHOP limit 10000
[0m13:25:44.647357 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:25:45.207018 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 1.0 seconds
[0m13:25:45.212358 [debug] [ThreadPool]: On list_RAW_JAFFLE_SHOP: Close
[0m13:25:45.357528 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8e41974a-055c-4bd8-9ffa-85c6c1745663', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108747950>]}
[0m13:25:45.359501 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:25:45.360425 [info ] [MainThread]: 
[0m13:25:45.366207 [debug] [Thread-1 (]: Began running node model.jaffle_shop.stg_customers
[0m13:25:45.367298 [debug] [Thread-2 (]: Began running node model.jaffle_shop.stg_orders
[0m13:25:45.368244 [info ] [Thread-1 (]: 1 of 5 START sql view model JAFFLE_SHOP.stg_customers .......................... [RUN]
[0m13:25:45.369194 [debug] [Thread-3 (]: Began running node model.jaffle_shop.stg_payments
[0m13:25:45.370037 [info ] [Thread-2 (]: 2 of 5 START sql view model JAFFLE_SHOP.stg_orders ............................. [RUN]
[0m13:25:45.371240 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_RAW_JAFFLE_SHOP, now model.jaffle_shop.stg_customers)
[0m13:25:45.372015 [info ] [Thread-3 (]: 3 of 5 START sql view model JAFFLE_SHOP.stg_payments ........................... [RUN]
[0m13:25:45.373253 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.jaffle_shop.stg_orders'
[0m13:25:45.373903 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.stg_customers
[0m13:25:45.375027 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.jaffle_shop.stg_payments'
[0m13:25:45.375658 [debug] [Thread-2 (]: Began compiling node model.jaffle_shop.stg_orders
[0m13:25:45.386704 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.stg_customers"
[0m13:25:45.387478 [debug] [Thread-3 (]: Began compiling node model.jaffle_shop.stg_payments
[0m13:25:45.391552 [debug] [Thread-2 (]: Writing injected SQL for node "model.jaffle_shop.stg_orders"
[0m13:25:45.398668 [debug] [Thread-3 (]: Writing injected SQL for node "model.jaffle_shop.stg_payments"
[0m13:25:45.400109 [debug] [Thread-1 (]: Timing info for model.jaffle_shop.stg_customers (compile): 13:25:45.376041 => 13:25:45.399653
[0m13:25:45.401204 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.stg_customers
[0m13:25:45.407579 [debug] [Thread-2 (]: Timing info for model.jaffle_shop.stg_orders (compile): 13:25:45.387946 => 13:25:45.407033
[0m13:25:45.408343 [debug] [Thread-2 (]: Began executing node model.jaffle_shop.stg_orders
[0m13:25:45.409244 [debug] [Thread-3 (]: Timing info for model.jaffle_shop.stg_payments (compile): 13:25:45.392470 => 13:25:45.408728
[0m13:25:45.435322 [debug] [Thread-3 (]: Began executing node model.jaffle_shop.stg_payments
[0m13:25:45.496358 [debug] [Thread-3 (]: Writing runtime sql for node "model.jaffle_shop.stg_payments"
[0m13:25:45.497445 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.stg_customers"
[0m13:25:45.498284 [debug] [Thread-2 (]: Writing runtime sql for node "model.jaffle_shop.stg_orders"
[0m13:25:45.500123 [debug] [Thread-3 (]: Using snowflake connection "model.jaffle_shop.stg_payments"
[0m13:25:45.500819 [debug] [Thread-3 (]: On model.jaffle_shop.stg_payments: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_payments"} */
create or replace   view RAW.JAFFLE_SHOP.stg_payments
  
   as (
    

select
    id,
    order_id,
    payment_method,
    round(1.0 *  / 100, 2) AS amount

from raw.jaffle_shop.raw_payments
  );
[0m13:25:45.502035 [debug] [Thread-1 (]: Using snowflake connection "model.jaffle_shop.stg_customers"
[0m13:25:45.502584 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m13:25:45.503605 [debug] [Thread-2 (]: Using snowflake connection "model.jaffle_shop.stg_orders"
[0m13:25:45.504131 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */
create or replace   view RAW.JAFFLE_SHOP.stg_customers
  
   as (
    -- noinspection SqlNoDataSourceInspectionForFile



select
    id as customer_id,
    first_name,
    last_name

from raw.jaffle_shop.raw_customers
  );
[0m13:25:45.505694 [debug] [Thread-2 (]: On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */
create or replace   view RAW.JAFFLE_SHOP.stg_orders
  
   as (
    

select
    id as order_id,
    user_id as customer_id,
    order_date,
    status

from raw.jaffle_shop.raw_orders
  );
[0m13:25:45.506995 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:25:45.507748 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m13:25:46.014778 [debug] [Thread-3 (]: Snowflake adapter: Snowflake query id: 01b3aaf5-0001-c86b-0005-81260003f1c6
[0m13:25:46.015855 [debug] [Thread-3 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 10 at position 17 unexpected '/'.
[0m13:25:46.017503 [debug] [Thread-3 (]: Timing info for model.jaffle_shop.stg_payments (execute): 13:25:45.454782 => 13:25:46.016722
[0m13:25:46.018393 [debug] [Thread-3 (]: On model.jaffle_shop.stg_payments: Close
[0m13:25:46.183549 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m13:25:46.192847 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m13:25:46.245626 [debug] [Thread-2 (]: Timing info for model.jaffle_shop.stg_orders (execute): 13:25:45.409607 => 13:25:46.245250
[0m13:25:46.247945 [debug] [Thread-1 (]: Timing info for model.jaffle_shop.stg_customers (execute): 13:25:45.401964 => 13:25:46.247622
[0m13:25:46.248914 [debug] [Thread-2 (]: On model.jaffle_shop.stg_orders: Close
[0m13:25:46.249774 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: Close
[0m13:25:46.252896 [debug] [Thread-3 (]: Database Error in model stg_payments (models/staging/stg_payments.sql)
  001003 (42000): SQL compilation error:
  syntax error line 10 at position 17 unexpected '/'.
  compiled Code at target/run/jaffle_shop/models/staging/stg_payments.sql
[0m13:25:46.256797 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8e41974a-055c-4bd8-9ffa-85c6c1745663', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108f3d550>]}
[0m13:25:46.259179 [error] [Thread-3 (]: 3 of 5 ERROR creating sql view model JAFFLE_SHOP.stg_payments .................. [[31mERROR[0m in 0.88s]
[0m13:25:46.260661 [debug] [Thread-3 (]: Finished running node model.jaffle_shop.stg_payments
[0m13:25:46.395561 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8e41974a-055c-4bd8-9ffa-85c6c1745663', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108e01150>]}
[0m13:25:46.397420 [info ] [Thread-1 (]: 1 of 5 OK created sql view model JAFFLE_SHOP.stg_customers ..................... [[32mSUCCESS 1[0m in 1.02s]
[0m13:25:46.399759 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.stg_customers
[0m13:25:46.406644 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8e41974a-055c-4bd8-9ffa-85c6c1745663', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108f641d0>]}
[0m13:25:46.407886 [info ] [Thread-2 (]: 2 of 5 OK created sql view model JAFFLE_SHOP.stg_orders ........................ [[32mSUCCESS 1[0m in 1.03s]
[0m13:25:46.409094 [debug] [Thread-2 (]: Finished running node model.jaffle_shop.stg_orders
[0m13:25:46.410702 [debug] [Thread-4 (]: Began running node model.jaffle_shop.customers
[0m13:25:46.411575 [debug] [Thread-3 (]: Began running node model.jaffle_shop.int_orders__pivoted
[0m13:25:46.412507 [info ] [Thread-4 (]: 4 of 5 START sql view model JAFFLE_SHOP.customers .............................. [RUN]
[0m13:25:46.413337 [info ] [Thread-3 (]: 5 of 5 SKIP relation JAFFLE_SHOP.int_orders__pivoted ........................... [[33mSKIP[0m]
[0m13:25:46.414808 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.jaffle_shop.customers'
[0m13:25:46.415698 [debug] [Thread-3 (]: Finished running node model.jaffle_shop.int_orders__pivoted
[0m13:25:46.416561 [debug] [Thread-4 (]: Began compiling node model.jaffle_shop.customers
[0m13:25:46.421643 [debug] [Thread-4 (]: Writing injected SQL for node "model.jaffle_shop.customers"
[0m13:25:46.422802 [debug] [Thread-4 (]: Timing info for model.jaffle_shop.customers (compile): 13:25:46.417342 => 13:25:46.422453
[0m13:25:46.423532 [debug] [Thread-4 (]: Began executing node model.jaffle_shop.customers
[0m13:25:46.428527 [debug] [Thread-4 (]: Writing runtime sql for node "model.jaffle_shop.customers"
[0m13:25:46.432776 [debug] [Thread-4 (]: Using snowflake connection "model.jaffle_shop.customers"
[0m13:25:46.434359 [debug] [Thread-4 (]: On model.jaffle_shop.customers: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.customers"} */
create or replace   view RAW.JAFFLE_SHOP.customers
  
   as (
    


with customers as (

    select * from RAW.JAFFLE_SHOP.stg_customers

),

orders as (

    select * from RAW.JAFFLE_SHOP.stg_orders

),

customer_orders as (

    select
        customer_id,

        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders

    from orders

    group by 1

),

final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce(customer_orders.number_of_orders, 0) as number_of_orders

    from customers

    left join customer_orders using (customer_id)

)

select * from final
  );
[0m13:25:46.435786 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m13:25:47.191536 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m13:25:47.199982 [debug] [Thread-4 (]: Timing info for model.jaffle_shop.customers (execute): 13:25:46.423913 => 13:25:47.199018
[0m13:25:47.200859 [debug] [Thread-4 (]: On model.jaffle_shop.customers: Close
[0m13:25:47.331360 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8e41974a-055c-4bd8-9ffa-85c6c1745663', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108e6edd0>]}
[0m13:25:47.332384 [info ] [Thread-4 (]: 4 of 5 OK created sql view model JAFFLE_SHOP.customers ......................... [[32mSUCCESS 1[0m in 0.92s]
[0m13:25:47.333322 [debug] [Thread-4 (]: Finished running node model.jaffle_shop.customers
[0m13:25:47.336089 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:25:47.336707 [debug] [MainThread]: Connection 'model.jaffle_shop.stg_customers' was properly closed.
[0m13:25:47.337204 [debug] [MainThread]: Connection 'model.jaffle_shop.stg_orders' was properly closed.
[0m13:25:47.337670 [debug] [MainThread]: Connection 'model.jaffle_shop.stg_payments' was properly closed.
[0m13:25:47.338113 [debug] [MainThread]: Connection 'model.jaffle_shop.customers' was properly closed.
[0m13:25:47.338651 [info ] [MainThread]: 
[0m13:25:47.339211 [info ] [MainThread]: Finished running 5 view models in 0 hours 0 minutes and 3.72 seconds (3.72s).
[0m13:25:47.340860 [debug] [MainThread]: Command end result
[0m13:25:47.354607 [info ] [MainThread]: 
[0m13:25:47.355570 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m13:25:47.356423 [info ] [MainThread]: 
[0m13:25:47.357294 [error] [MainThread]:   Database Error in model stg_payments (models/staging/stg_payments.sql)
  001003 (42000): SQL compilation error:
  syntax error line 10 at position 17 unexpected '/'.
  compiled Code at target/run/jaffle_shop/models/staging/stg_payments.sql
[0m13:25:47.358153 [info ] [MainThread]: 
[0m13:25:47.359044 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=1 TOTAL=5
[0m13:25:47.363329 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 5.281146, "process_user_time": 4.828182, "process_kernel_time": 0.679488, "process_mem_max_rss": "143327232", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m13:25:47.364782 [debug] [MainThread]: Command `dbt run` failed at 13:25:47.364406 after 5.28 seconds
[0m13:25:47.366394 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ba3150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f1a090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f19b90>]}
[0m13:25:47.367816 [debug] [MainThread]: Flushing usage events
[0m13:32:31.937974 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105599e90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1052c9810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1052ca1d0>]}


============================== 13:32:31.946278 | 537844e5-b0db-4ee8-bf0d-41387c125650 ==============================
[0m13:32:31.946278 [info ] [MainThread]: Running with dbt=1.7.8
[0m13:32:31.947339 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/ben/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/ben/jaffle_shop/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m13:32:32.638827 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '537844e5-b0db-4ee8-bf0d-41387c125650', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e5c310>]}
[0m13:32:32.769821 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '537844e5-b0db-4ee8-bf0d-41387c125650', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1055ce090>]}
[0m13:32:32.771747 [info ] [MainThread]: Registered adapter: snowflake=1.7.2
[0m13:32:32.794704 [debug] [MainThread]: checksum: 67f0013ca5f0bd43af9a0873dd50792fde83ef69de63b71cacd0b4ac656c52e5, vars: {}, profile: , target: , version: 1.7.8
[0m13:32:32.900606 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:32:32.901753 [debug] [MainThread]: Partial parsing: updated file: jaffle_shop://models/staging/stg_payments.sql
[0m13:32:33.316515 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '537844e5-b0db-4ee8-bf0d-41387c125650', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1064bff10>]}
[0m13:32:33.334231 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '537844e5-b0db-4ee8-bf0d-41387c125650', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106042f90>]}
[0m13:32:33.335008 [info ] [MainThread]: Found 5 models, 3 seeds, 11 tests, 0 sources, 0 exposures, 0 metrics, 431 macros, 0 groups, 0 semantic models
[0m13:32:33.335605 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '537844e5-b0db-4ee8-bf0d-41387c125650', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105002250>]}
[0m13:32:33.339280 [info ] [MainThread]: 
[0m13:32:33.340608 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m13:32:33.342339 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RAW'
[0m13:32:33.361559 [debug] [ThreadPool]: Using snowflake connection "list_RAW"
[0m13:32:33.362269 [debug] [ThreadPool]: On list_RAW: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_RAW"} */
show terse schemas in database RAW
    limit 10000
[0m13:32:33.362805 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:32:34.159216 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.0 seconds
[0m13:32:34.164536 [debug] [ThreadPool]: On list_RAW: Close
[0m13:32:34.315268 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RAW, now list_RAW_JAFFLE_SHOP)
[0m13:32:34.332118 [debug] [ThreadPool]: Using snowflake connection "list_RAW_JAFFLE_SHOP"
[0m13:32:34.332865 [debug] [ThreadPool]: On list_RAW_JAFFLE_SHOP: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_RAW_JAFFLE_SHOP"} */
show terse objects in RAW.JAFFLE_SHOP limit 10000
[0m13:32:34.333437 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:32:34.882202 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 1.0 seconds
[0m13:32:34.887194 [debug] [ThreadPool]: On list_RAW_JAFFLE_SHOP: Close
[0m13:32:35.045138 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '537844e5-b0db-4ee8-bf0d-41387c125650', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ff11d0>]}
[0m13:32:35.047109 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:32:35.048145 [info ] [MainThread]: 
[0m13:32:35.054472 [debug] [Thread-1 (]: Began running node model.jaffle_shop.stg_customers
[0m13:32:35.055459 [debug] [Thread-2 (]: Began running node model.jaffle_shop.stg_orders
[0m13:32:35.056337 [debug] [Thread-3 (]: Began running node model.jaffle_shop.stg_payments
[0m13:32:35.057149 [info ] [Thread-1 (]: 1 of 5 START sql view model JAFFLE_SHOP.stg_customers .......................... [RUN]
[0m13:32:35.058069 [info ] [Thread-2 (]: 2 of 5 START sql view model JAFFLE_SHOP.stg_orders ............................. [RUN]
[0m13:32:35.058940 [info ] [Thread-3 (]: 3 of 5 START sql view model JAFFLE_SHOP.stg_payments ........................... [RUN]
[0m13:32:35.060171 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_RAW_JAFFLE_SHOP, now model.jaffle_shop.stg_customers)
[0m13:32:35.061388 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.jaffle_shop.stg_orders'
[0m13:32:35.062555 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.jaffle_shop.stg_payments'
[0m13:32:35.063132 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.stg_customers
[0m13:32:35.063692 [debug] [Thread-2 (]: Began compiling node model.jaffle_shop.stg_orders
[0m13:32:35.064233 [debug] [Thread-3 (]: Began compiling node model.jaffle_shop.stg_payments
[0m13:32:35.074838 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.stg_customers"
[0m13:32:35.079486 [debug] [Thread-2 (]: Writing injected SQL for node "model.jaffle_shop.stg_orders"
[0m13:32:35.086330 [debug] [Thread-3 (]: Writing injected SQL for node "model.jaffle_shop.stg_payments"
[0m13:32:35.087946 [debug] [Thread-1 (]: Timing info for model.jaffle_shop.stg_customers (compile): 13:32:35.064597 => 13:32:35.087471
[0m13:32:35.089014 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.stg_customers
[0m13:32:35.089980 [debug] [Thread-2 (]: Timing info for model.jaffle_shop.stg_orders (compile): 13:32:35.075335 => 13:32:35.089562
[0m13:32:35.109534 [debug] [Thread-2 (]: Began executing node model.jaffle_shop.stg_orders
[0m13:32:35.115936 [debug] [Thread-3 (]: Timing info for model.jaffle_shop.stg_payments (compile): 13:32:35.081117 => 13:32:35.115487
[0m13:32:35.116635 [debug] [Thread-3 (]: Began executing node model.jaffle_shop.stg_payments
[0m13:32:35.172183 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.stg_customers"
[0m13:32:35.178540 [debug] [Thread-3 (]: Writing runtime sql for node "model.jaffle_shop.stg_payments"
[0m13:32:35.184228 [debug] [Thread-2 (]: Writing runtime sql for node "model.jaffle_shop.stg_orders"
[0m13:32:35.186000 [debug] [Thread-3 (]: Using snowflake connection "model.jaffle_shop.stg_payments"
[0m13:32:35.186974 [debug] [Thread-1 (]: Using snowflake connection "model.jaffle_shop.stg_customers"
[0m13:32:35.187840 [debug] [Thread-2 (]: Using snowflake connection "model.jaffle_shop.stg_orders"
[0m13:32:35.188363 [debug] [Thread-3 (]: On model.jaffle_shop.stg_payments: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_payments"} */
create or replace   view RAW.JAFFLE_SHOP.stg_payments
  
   as (
    

select
    id,
    order_id,
    payment_method,
    round(1.0 * amount / 100, 2) AS amount

from raw.jaffle_shop.raw_payments
  );
[0m13:32:35.188964 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */
create or replace   view RAW.JAFFLE_SHOP.stg_customers
  
   as (
    -- noinspection SqlNoDataSourceInspectionForFile



select
    id as customer_id,
    first_name,
    last_name

from raw.jaffle_shop.raw_customers
  );
[0m13:32:35.189672 [debug] [Thread-2 (]: On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */
create or replace   view RAW.JAFFLE_SHOP.stg_orders
  
   as (
    

select
    id as order_id,
    user_id as customer_id,
    order_date,
    status

from raw.jaffle_shop.raw_orders
  );
[0m13:32:35.190312 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m13:32:35.190871 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:32:35.191417 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m13:32:35.798729 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m13:32:35.827251 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m13:32:35.852291 [debug] [Thread-3 (]: Timing info for model.jaffle_shop.stg_payments (execute): 13:32:35.123360 => 13:32:35.851959
[0m13:32:35.853783 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m13:32:35.847501 [debug] [Thread-1 (]: Timing info for model.jaffle_shop.stg_customers (execute): 13:32:35.090412 => 13:32:35.847140
[0m13:32:35.854549 [debug] [Thread-3 (]: On model.jaffle_shop.stg_payments: Close
[0m13:32:35.857856 [debug] [Thread-2 (]: Timing info for model.jaffle_shop.stg_orders (execute): 13:32:35.110054 => 13:32:35.857540
[0m13:32:35.858541 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: Close
[0m13:32:35.860336 [debug] [Thread-2 (]: On model.jaffle_shop.stg_orders: Close
[0m13:32:36.006584 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '537844e5-b0db-4ee8-bf0d-41387c125650', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105faa510>]}
[0m13:32:36.008920 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '537844e5-b0db-4ee8-bf0d-41387c125650', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10621bc90>]}
[0m13:32:36.010411 [info ] [Thread-2 (]: 2 of 5 OK created sql view model JAFFLE_SHOP.stg_orders ........................ [[32mSUCCESS 1[0m in 0.95s]
[0m13:32:36.011936 [info ] [Thread-1 (]: 1 of 5 OK created sql view model JAFFLE_SHOP.stg_customers ..................... [[32mSUCCESS 1[0m in 0.95s]
[0m13:32:36.014741 [debug] [Thread-2 (]: Finished running node model.jaffle_shop.stg_orders
[0m13:32:36.016142 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.stg_customers
[0m13:32:36.019555 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '537844e5-b0db-4ee8-bf0d-41387c125650', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1064d2690>]}
[0m13:32:36.020875 [debug] [Thread-4 (]: Began running node model.jaffle_shop.customers
[0m13:32:36.022039 [info ] [Thread-3 (]: 3 of 5 OK created sql view model JAFFLE_SHOP.stg_payments ...................... [[32mSUCCESS 1[0m in 0.96s]
[0m13:32:36.022962 [info ] [Thread-4 (]: 4 of 5 START sql view model JAFFLE_SHOP.customers .............................. [RUN]
[0m13:32:36.024035 [debug] [Thread-3 (]: Finished running node model.jaffle_shop.stg_payments
[0m13:32:36.025258 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.jaffle_shop.customers'
[0m13:32:36.026298 [debug] [Thread-1 (]: Began running node model.jaffle_shop.int_orders__pivoted
[0m13:32:36.027021 [debug] [Thread-4 (]: Began compiling node model.jaffle_shop.customers
[0m13:32:36.027783 [info ] [Thread-1 (]: 5 of 5 START sql view model JAFFLE_SHOP.int_orders__pivoted .................... [RUN]
[0m13:32:36.032674 [debug] [Thread-4 (]: Writing injected SQL for node "model.jaffle_shop.customers"
[0m13:32:36.034460 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.jaffle_shop.stg_customers, now model.jaffle_shop.int_orders__pivoted)
[0m13:32:36.035284 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.int_orders__pivoted
[0m13:32:36.041179 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.int_orders__pivoted"
[0m13:32:36.042408 [debug] [Thread-4 (]: Timing info for model.jaffle_shop.customers (compile): 13:32:36.028216 => 13:32:36.041997
[0m13:32:36.043361 [debug] [Thread-4 (]: Began executing node model.jaffle_shop.customers
[0m13:32:36.052860 [debug] [Thread-4 (]: Writing runtime sql for node "model.jaffle_shop.customers"
[0m13:32:36.054297 [debug] [Thread-1 (]: Timing info for model.jaffle_shop.int_orders__pivoted (compile): 13:32:36.035691 => 13:32:36.053580
[0m13:32:36.055785 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.int_orders__pivoted
[0m13:32:36.064797 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.int_orders__pivoted"
[0m13:32:36.068542 [debug] [Thread-4 (]: Using snowflake connection "model.jaffle_shop.customers"
[0m13:32:36.070030 [debug] [Thread-4 (]: On model.jaffle_shop.customers: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.customers"} */
create or replace   view RAW.JAFFLE_SHOP.customers
  
   as (
    


with customers as (

    select * from RAW.JAFFLE_SHOP.stg_customers

),

orders as (

    select * from RAW.JAFFLE_SHOP.stg_orders

),

customer_orders as (

    select
        customer_id,

        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders

    from orders

    group by 1

),

final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce(customer_orders.number_of_orders, 0) as number_of_orders

    from customers

    left join customer_orders using (customer_id)

)

select * from final
  );
[0m13:32:36.071359 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m13:32:36.074285 [debug] [Thread-1 (]: Using snowflake connection "model.jaffle_shop.int_orders__pivoted"
[0m13:32:36.076860 [debug] [Thread-1 (]: On model.jaffle_shop.int_orders__pivoted: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.int_orders__pivoted"} */
create or replace   view RAW.JAFFLE_SHOP.int_orders__pivoted
  
   as (
    



WITH payments AS (
    SELECT p.id AS id,
           p.order_id AS order_id,
           p.payment_method AS payment_method,
           p.amount AS amount,
           o.status AS status
    FROM RAW.JAFFLE_SHOP.stg_payments p
    JOIN RAW.JAFFLE_SHOP.stg_orders o
    ON p.order_id = o.order_id
),
pivoted AS (
    SELECT
        order_id,
        SUM(CASE WHEN payment_method = 'bank_transfer' THEN amount ELSE 0 END) AS bank_transfer_amount,
        SUM(CASE WHEN payment_method = 'coupon' THEN amount ELSE 0 END) AS coupon_amount,
        SUM(CASE WHEN payment_method = 'credit_card' THEN amount ELSE 0 END) AS credit_card_amount,
        SUM(CASE WHEN payment_method = 'gift_card' THEN amount ELSE 0 END) AS gift_card_amount
    FROM payments
    WHERE status = 'completed'
    GROUP BY 1
)

SELECT * FROM pivoted
  );
[0m13:32:36.077894 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:32:36.687316 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m13:32:36.694264 [debug] [Thread-4 (]: Timing info for model.jaffle_shop.customers (execute): 13:32:36.044630 => 13:32:36.693617
[0m13:32:36.695186 [debug] [Thread-4 (]: On model.jaffle_shop.customers: Close
[0m13:32:36.750519 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m13:32:36.757074 [debug] [Thread-1 (]: Timing info for model.jaffle_shop.int_orders__pivoted (execute): 13:32:36.056601 => 13:32:36.756560
[0m13:32:36.758036 [debug] [Thread-1 (]: On model.jaffle_shop.int_orders__pivoted: Close
[0m13:32:36.869466 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '537844e5-b0db-4ee8-bf0d-41387c125650', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066ec990>]}
[0m13:32:36.871832 [info ] [Thread-4 (]: 4 of 5 OK created sql view model JAFFLE_SHOP.customers ......................... [[32mSUCCESS 1[0m in 0.84s]
[0m13:32:36.873745 [debug] [Thread-4 (]: Finished running node model.jaffle_shop.customers
[0m13:32:36.921789 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '537844e5-b0db-4ee8-bf0d-41387c125650', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106510ad0>]}
[0m13:32:36.924305 [info ] [Thread-1 (]: 5 of 5 OK created sql view model JAFFLE_SHOP.int_orders__pivoted ............... [[32mSUCCESS 1[0m in 0.89s]
[0m13:32:36.926073 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.int_orders__pivoted
[0m13:32:36.930881 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:32:36.931856 [debug] [MainThread]: Connection 'model.jaffle_shop.int_orders__pivoted' was properly closed.
[0m13:32:36.932495 [debug] [MainThread]: Connection 'model.jaffle_shop.stg_orders' was properly closed.
[0m13:32:36.933103 [debug] [MainThread]: Connection 'model.jaffle_shop.stg_payments' was properly closed.
[0m13:32:36.933689 [debug] [MainThread]: Connection 'model.jaffle_shop.customers' was properly closed.
[0m13:32:36.934400 [info ] [MainThread]: 
[0m13:32:36.935153 [info ] [MainThread]: Finished running 5 view models in 0 hours 0 minutes and 3.59 seconds (3.59s).
[0m13:32:36.938216 [debug] [MainThread]: Command end result
[0m13:32:36.952303 [info ] [MainThread]: 
[0m13:32:36.952989 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:32:36.953521 [info ] [MainThread]: 
[0m13:32:36.954075 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m13:32:36.955879 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 5.102632, "process_user_time": 5.039018, "process_kernel_time": 0.640815, "process_mem_max_rss": "141967360", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m13:32:36.957515 [debug] [MainThread]: Command `dbt run` succeeded at 13:32:36.956950 after 5.10 seconds
[0m13:32:36.958688 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10501b610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b30690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1012b3d90>]}
[0m13:32:36.959928 [debug] [MainThread]: Flushing usage events
[0m13:34:37.928448 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1083b4d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c020c90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c5a0850>]}


============================== 13:34:37.935395 | 976eac3a-37a8-41b7-96cc-605aac18c2c1 ==============================
[0m13:34:37.935395 [info ] [MainThread]: Running with dbt=1.7.8
[0m13:34:37.936501 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/ben/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/ben/jaffle_shop/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m13:34:38.465351 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '976eac3a-37a8-41b7-96cc-605aac18c2c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bf9a690>]}
[0m13:34:38.591274 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '976eac3a-37a8-41b7-96cc-605aac18c2c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cf33c90>]}
[0m13:34:38.592569 [info ] [MainThread]: Registered adapter: snowflake=1.7.2
[0m13:34:38.616285 [debug] [MainThread]: checksum: 67f0013ca5f0bd43af9a0873dd50792fde83ef69de63b71cacd0b4ac656c52e5, vars: {}, profile: , target: , version: 1.7.8
[0m13:34:38.672024 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:34:38.673176 [debug] [MainThread]: Partial parsing: updated file: jaffle_shop://models/staging/stg_payments.sql
[0m13:34:39.080983 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '976eac3a-37a8-41b7-96cc-605aac18c2c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d26b950>]}
[0m13:34:39.099437 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '976eac3a-37a8-41b7-96cc-605aac18c2c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d108310>]}
[0m13:34:39.100243 [info ] [MainThread]: Found 5 models, 3 seeds, 11 tests, 0 sources, 0 exposures, 0 metrics, 431 macros, 0 groups, 0 semantic models
[0m13:34:39.100862 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '976eac3a-37a8-41b7-96cc-605aac18c2c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d143f50>]}
[0m13:34:39.104713 [info ] [MainThread]: 
[0m13:34:39.106006 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m13:34:39.107801 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RAW'
[0m13:34:39.127193 [debug] [ThreadPool]: Using snowflake connection "list_RAW"
[0m13:34:39.127910 [debug] [ThreadPool]: On list_RAW: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_RAW"} */
show terse schemas in database RAW
    limit 10000
[0m13:34:39.128466 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:34:39.820613 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.0 seconds
[0m13:34:39.825429 [debug] [ThreadPool]: On list_RAW: Close
[0m13:34:40.019835 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RAW, now list_RAW_JAFFLE_SHOP)
[0m13:34:40.037530 [debug] [ThreadPool]: Using snowflake connection "list_RAW_JAFFLE_SHOP"
[0m13:34:40.038297 [debug] [ThreadPool]: On list_RAW_JAFFLE_SHOP: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_RAW_JAFFLE_SHOP"} */
show terse objects in RAW.JAFFLE_SHOP limit 10000
[0m13:34:40.038892 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:34:40.516770 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 0.0 seconds
[0m13:34:40.521768 [debug] [ThreadPool]: On list_RAW_JAFFLE_SHOP: Close
[0m13:34:40.685625 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '976eac3a-37a8-41b7-96cc-605aac18c2c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d318210>]}
[0m13:34:40.687705 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:34:40.688744 [info ] [MainThread]: 
[0m13:34:40.693845 [debug] [Thread-1 (]: Began running node model.jaffle_shop.stg_customers
[0m13:34:40.694871 [debug] [Thread-2 (]: Began running node model.jaffle_shop.stg_orders
[0m13:34:40.695827 [info ] [Thread-1 (]: 1 of 5 START sql view model JAFFLE_SHOP.stg_customers .......................... [RUN]
[0m13:34:40.696812 [debug] [Thread-3 (]: Began running node model.jaffle_shop.stg_payments
[0m13:34:40.697604 [info ] [Thread-2 (]: 2 of 5 START sql view model JAFFLE_SHOP.stg_orders ............................. [RUN]
[0m13:34:40.698873 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_RAW_JAFFLE_SHOP, now model.jaffle_shop.stg_customers)
[0m13:34:40.699663 [info ] [Thread-3 (]: 3 of 5 START sql view model JAFFLE_SHOP.stg_payments ........................... [RUN]
[0m13:34:40.700877 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.jaffle_shop.stg_orders'
[0m13:34:40.701538 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.stg_customers
[0m13:34:40.702685 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.jaffle_shop.stg_payments'
[0m13:34:40.703254 [debug] [Thread-2 (]: Began compiling node model.jaffle_shop.stg_orders
[0m13:34:40.714369 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.stg_customers"
[0m13:34:40.715103 [debug] [Thread-3 (]: Began compiling node model.jaffle_shop.stg_payments
[0m13:34:40.718739 [debug] [Thread-2 (]: Writing injected SQL for node "model.jaffle_shop.stg_orders"
[0m13:34:40.724693 [debug] [Thread-3 (]: Writing injected SQL for node "model.jaffle_shop.stg_payments"
[0m13:34:40.726307 [debug] [Thread-1 (]: Timing info for model.jaffle_shop.stg_customers (compile): 13:34:40.703639 => 13:34:40.725866
[0m13:34:40.727111 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.stg_customers
[0m13:34:40.727945 [debug] [Thread-3 (]: Timing info for model.jaffle_shop.stg_payments (compile): 13:34:40.719414 => 13:34:40.727536
[0m13:34:40.728582 [debug] [Thread-2 (]: Timing info for model.jaffle_shop.stg_orders (compile): 13:34:40.715515 => 13:34:40.728269
[0m13:34:40.751445 [debug] [Thread-3 (]: Began executing node model.jaffle_shop.stg_payments
[0m13:34:40.774170 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.stg_customers"
[0m13:34:40.774933 [debug] [Thread-2 (]: Began executing node model.jaffle_shop.stg_orders
[0m13:34:40.779399 [debug] [Thread-3 (]: Writing runtime sql for node "model.jaffle_shop.stg_payments"
[0m13:34:40.784307 [debug] [Thread-2 (]: Writing runtime sql for node "model.jaffle_shop.stg_orders"
[0m13:34:40.785652 [debug] [Thread-1 (]: Using snowflake connection "model.jaffle_shop.stg_customers"
[0m13:34:40.786612 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */
create or replace   view RAW.JAFFLE_SHOP.stg_customers
  
   as (
    -- noinspection SqlNoDataSourceInspectionForFile



select
    id as customer_id,
    first_name,
    last_name

from raw.jaffle_shop.raw_customers
  );
[0m13:34:40.787400 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:34:40.788494 [debug] [Thread-2 (]: Using snowflake connection "model.jaffle_shop.stg_orders"
[0m13:34:40.789920 [debug] [Thread-3 (]: Using snowflake connection "model.jaffle_shop.stg_payments"
[0m13:34:40.791709 [debug] [Thread-2 (]: On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */
create or replace   view RAW.JAFFLE_SHOP.stg_orders
  
   as (
    

select
    id as order_id,
    user_id as customer_id,
    order_date,
    status

from raw.jaffle_shop.raw_orders
  );
[0m13:34:40.792501 [debug] [Thread-3 (]: On model.jaffle_shop.stg_payments: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_payments"} */
create or replace   view RAW.JAFFLE_SHOP.stg_payments
  
   as (
    

select
    id,
    order_id,
    payment_method,
    round(1.0 * amount / 100, 2) AS amount_usd

from raw.jaffle_shop.raw_payments
  );
[0m13:34:40.793186 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m13:34:40.794213 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m13:34:41.402866 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m13:34:41.442874 [debug] [Thread-2 (]: Timing info for model.jaffle_shop.stg_orders (execute): 13:34:40.780252 => 13:34:41.442514
[0m13:34:41.444493 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m13:34:41.445156 [debug] [Thread-2 (]: On model.jaffle_shop.stg_orders: Close
[0m13:34:41.448515 [debug] [Thread-1 (]: Timing info for model.jaffle_shop.stg_customers (execute): 13:34:40.728893 => 13:34:41.448150
[0m13:34:41.450868 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: Close
[0m13:34:41.469897 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m13:34:41.474166 [debug] [Thread-3 (]: Timing info for model.jaffle_shop.stg_payments (execute): 13:34:40.775367 => 13:34:41.473818
[0m13:34:41.474821 [debug] [Thread-3 (]: On model.jaffle_shop.stg_payments: Close
[0m13:34:41.596962 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '976eac3a-37a8-41b7-96cc-605aac18c2c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d485190>]}
[0m13:34:41.600337 [info ] [Thread-1 (]: 1 of 5 OK created sql view model JAFFLE_SHOP.stg_customers ..................... [[32mSUCCESS 1[0m in 0.90s]
[0m13:34:41.602676 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.stg_customers
[0m13:34:41.604908 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '976eac3a-37a8-41b7-96cc-605aac18c2c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bf64f90>]}
[0m13:34:41.606637 [info ] [Thread-2 (]: 2 of 5 OK created sql view model JAFFLE_SHOP.stg_orders ........................ [[32mSUCCESS 1[0m in 0.90s]
[0m13:34:41.608939 [debug] [Thread-2 (]: Finished running node model.jaffle_shop.stg_orders
[0m13:34:41.610160 [debug] [Thread-4 (]: Began running node model.jaffle_shop.customers
[0m13:34:41.611201 [info ] [Thread-4 (]: 4 of 5 START sql view model JAFFLE_SHOP.customers .............................. [RUN]
[0m13:34:41.612793 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '976eac3a-37a8-41b7-96cc-605aac18c2c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d4854d0>]}
[0m13:34:41.614057 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.jaffle_shop.customers'
[0m13:34:41.615013 [info ] [Thread-3 (]: 3 of 5 OK created sql view model JAFFLE_SHOP.stg_payments ...................... [[32mSUCCESS 1[0m in 0.91s]
[0m13:34:41.615914 [debug] [Thread-4 (]: Began compiling node model.jaffle_shop.customers
[0m13:34:41.616965 [debug] [Thread-3 (]: Finished running node model.jaffle_shop.stg_payments
[0m13:34:41.622071 [debug] [Thread-4 (]: Writing injected SQL for node "model.jaffle_shop.customers"
[0m13:34:41.623124 [debug] [Thread-2 (]: Began running node model.jaffle_shop.int_orders__pivoted
[0m13:34:41.624090 [info ] [Thread-2 (]: 5 of 5 START sql view model JAFFLE_SHOP.int_orders__pivoted .................... [RUN]
[0m13:34:41.626288 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.jaffle_shop.stg_orders, now model.jaffle_shop.int_orders__pivoted)
[0m13:34:41.627004 [debug] [Thread-2 (]: Began compiling node model.jaffle_shop.int_orders__pivoted
[0m13:34:41.635396 [debug] [Thread-2 (]: Writing injected SQL for node "model.jaffle_shop.int_orders__pivoted"
[0m13:34:41.636873 [debug] [Thread-4 (]: Timing info for model.jaffle_shop.customers (compile): 13:34:41.617450 => 13:34:41.636346
[0m13:34:41.637929 [debug] [Thread-4 (]: Began executing node model.jaffle_shop.customers
[0m13:34:41.643276 [debug] [Thread-4 (]: Writing runtime sql for node "model.jaffle_shop.customers"
[0m13:34:41.644656 [debug] [Thread-2 (]: Timing info for model.jaffle_shop.int_orders__pivoted (compile): 13:34:41.627483 => 13:34:41.644244
[0m13:34:41.645510 [debug] [Thread-2 (]: Began executing node model.jaffle_shop.int_orders__pivoted
[0m13:34:41.653472 [debug] [Thread-2 (]: Writing runtime sql for node "model.jaffle_shop.int_orders__pivoted"
[0m13:34:41.657208 [debug] [Thread-4 (]: Using snowflake connection "model.jaffle_shop.customers"
[0m13:34:41.658680 [debug] [Thread-4 (]: On model.jaffle_shop.customers: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.customers"} */
create or replace   view RAW.JAFFLE_SHOP.customers
  
   as (
    


with customers as (

    select * from RAW.JAFFLE_SHOP.stg_customers

),

orders as (

    select * from RAW.JAFFLE_SHOP.stg_orders

),

customer_orders as (

    select
        customer_id,

        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders

    from orders

    group by 1

),

final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce(customer_orders.number_of_orders, 0) as number_of_orders

    from customers

    left join customer_orders using (customer_id)

)

select * from final
  );
[0m13:34:41.659998 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m13:34:41.664223 [debug] [Thread-2 (]: Using snowflake connection "model.jaffle_shop.int_orders__pivoted"
[0m13:34:41.665722 [debug] [Thread-2 (]: On model.jaffle_shop.int_orders__pivoted: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.int_orders__pivoted"} */
create or replace   view RAW.JAFFLE_SHOP.int_orders__pivoted
  
   as (
    



WITH payments AS (
    SELECT p.id AS id,
           p.order_id AS order_id,
           p.payment_method AS payment_method,
           p.amount AS amount,
           o.status AS status
    FROM RAW.JAFFLE_SHOP.stg_payments p
    JOIN RAW.JAFFLE_SHOP.stg_orders o
    ON p.order_id = o.order_id
),
pivoted AS (
    SELECT
        order_id,
        SUM(CASE WHEN payment_method = 'bank_transfer' THEN amount ELSE 0 END) AS bank_transfer_amount,
        SUM(CASE WHEN payment_method = 'coupon' THEN amount ELSE 0 END) AS coupon_amount,
        SUM(CASE WHEN payment_method = 'credit_card' THEN amount ELSE 0 END) AS credit_card_amount,
        SUM(CASE WHEN payment_method = 'gift_card' THEN amount ELSE 0 END) AS gift_card_amount
    FROM payments
    WHERE status = 'completed'
    GROUP BY 1
)

SELECT * FROM pivoted
  );
[0m13:34:41.666575 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m13:34:42.197273 [debug] [Thread-2 (]: Snowflake adapter: Snowflake query id: 01b3aafe-0001-c86f-0005-81260003e28a
[0m13:34:42.198369 [debug] [Thread-2 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 12 at position 11
invalid identifier 'P.AMOUNT'
[0m13:34:42.199759 [debug] [Thread-2 (]: Timing info for model.jaffle_shop.int_orders__pivoted (execute): 13:34:41.646066 => 13:34:42.199227
[0m13:34:42.200695 [debug] [Thread-2 (]: On model.jaffle_shop.int_orders__pivoted: Close
[0m13:34:42.264263 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m13:34:42.270448 [debug] [Thread-4 (]: Timing info for model.jaffle_shop.customers (execute): 13:34:41.638554 => 13:34:42.269922
[0m13:34:42.273253 [debug] [Thread-4 (]: On model.jaffle_shop.customers: Close
[0m13:34:42.381345 [debug] [Thread-2 (]: Database Error in model int_orders__pivoted (models/marts/core/int_orders__pivoted.sql)
  000904 (42000): SQL compilation error: error line 12 at position 11
  invalid identifier 'P.AMOUNT'
  compiled Code at target/run/jaffle_shop/models/marts/core/int_orders__pivoted.sql
[0m13:34:42.382625 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '976eac3a-37a8-41b7-96cc-605aac18c2c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d5396d0>]}
[0m13:34:42.384190 [error] [Thread-2 (]: 5 of 5 ERROR creating sql view model JAFFLE_SHOP.int_orders__pivoted ........... [[31mERROR[0m in 0.76s]
[0m13:34:42.385890 [debug] [Thread-2 (]: Finished running node model.jaffle_shop.int_orders__pivoted
[0m13:34:42.414662 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '976eac3a-37a8-41b7-96cc-605aac18c2c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d4fbdd0>]}
[0m13:34:42.416195 [info ] [Thread-4 (]: 4 of 5 OK created sql view model JAFFLE_SHOP.customers ......................... [[32mSUCCESS 1[0m in 0.80s]
[0m13:34:42.417604 [debug] [Thread-4 (]: Finished running node model.jaffle_shop.customers
[0m13:34:42.421096 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:34:42.421823 [debug] [MainThread]: Connection 'model.jaffle_shop.stg_customers' was properly closed.
[0m13:34:42.422471 [debug] [MainThread]: Connection 'model.jaffle_shop.int_orders__pivoted' was properly closed.
[0m13:34:42.423097 [debug] [MainThread]: Connection 'model.jaffle_shop.stg_payments' was properly closed.
[0m13:34:42.423693 [debug] [MainThread]: Connection 'model.jaffle_shop.customers' was properly closed.
[0m13:34:42.424623 [info ] [MainThread]: 
[0m13:34:42.425426 [info ] [MainThread]: Finished running 5 view models in 0 hours 0 minutes and 3.32 seconds (3.32s).
[0m13:34:42.428713 [debug] [MainThread]: Command end result
[0m13:34:42.444840 [info ] [MainThread]: 
[0m13:34:42.445644 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m13:34:42.446194 [info ] [MainThread]: 
[0m13:34:42.446721 [error] [MainThread]:   Database Error in model int_orders__pivoted (models/marts/core/int_orders__pivoted.sql)
  000904 (42000): SQL compilation error: error line 12 at position 11
  invalid identifier 'P.AMOUNT'
  compiled Code at target/run/jaffle_shop/models/marts/core/int_orders__pivoted.sql
[0m13:34:42.447310 [info ] [MainThread]: 
[0m13:34:42.447901 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
[0m13:34:42.449798 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 4.6035523, "process_user_time": 4.722194, "process_kernel_time": 0.448025, "process_mem_max_rss": "144666624", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m13:34:42.450767 [debug] [MainThread]: Command `dbt run` failed at 13:34:42.450552 after 4.60 seconds
[0m13:34:42.451466 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bf64a50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c599010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c1fa690>]}
[0m13:34:42.452370 [debug] [MainThread]: Flushing usage events
[0m13:35:21.699692 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cf13250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cad16d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cad36d0>]}


============================== 13:35:21.705680 | f71eb853-cad7-44ba-a1d8-f6256d005435 ==============================
[0m13:35:21.705680 [info ] [MainThread]: Running with dbt=1.7.8
[0m13:35:21.707106 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/ben/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/Users/ben/jaffle_shop/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt run', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:35:22.239045 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f71eb853-cad7-44ba-a1d8-f6256d005435', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cab0350>]}
[0m13:35:22.364185 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f71eb853-cad7-44ba-a1d8-f6256d005435', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cd61810>]}
[0m13:35:22.365443 [info ] [MainThread]: Registered adapter: snowflake=1.7.2
[0m13:35:22.388508 [debug] [MainThread]: checksum: 67f0013ca5f0bd43af9a0873dd50792fde83ef69de63b71cacd0b4ac656c52e5, vars: {}, profile: , target: , version: 1.7.8
[0m13:35:22.442795 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:35:22.443490 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:35:22.453590 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f71eb853-cad7-44ba-a1d8-f6256d005435', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dc66e90>]}
[0m13:35:22.470712 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f71eb853-cad7-44ba-a1d8-f6256d005435', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10daca050>]}
[0m13:35:22.471503 [info ] [MainThread]: Found 5 models, 3 seeds, 11 tests, 0 sources, 0 exposures, 0 metrics, 431 macros, 0 groups, 0 semantic models
[0m13:35:22.472312 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f71eb853-cad7-44ba-a1d8-f6256d005435', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10db28250>]}
[0m13:35:22.475597 [info ] [MainThread]: 
[0m13:35:22.476892 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m13:35:22.478672 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RAW'
[0m13:35:22.500104 [debug] [ThreadPool]: Using snowflake connection "list_RAW"
[0m13:35:22.501223 [debug] [ThreadPool]: On list_RAW: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_RAW"} */
show terse schemas in database RAW
    limit 10000
[0m13:35:22.501891 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:35:23.103048 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.0 seconds
[0m13:35:23.107331 [debug] [ThreadPool]: On list_RAW: Close
[0m13:35:23.296162 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RAW, now list_RAW_JAFFLE_SHOP)
[0m13:35:23.312883 [debug] [ThreadPool]: Using snowflake connection "list_RAW_JAFFLE_SHOP"
[0m13:35:23.313674 [debug] [ThreadPool]: On list_RAW_JAFFLE_SHOP: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_RAW_JAFFLE_SHOP"} */
show terse objects in RAW.JAFFLE_SHOP limit 10000
[0m13:35:23.314291 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:35:23.826897 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 1.0 seconds
[0m13:35:23.832095 [debug] [ThreadPool]: On list_RAW_JAFFLE_SHOP: Close
[0m13:35:23.984476 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f71eb853-cad7-44ba-a1d8-f6256d005435', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d97e5d0>]}
[0m13:35:23.986472 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:35:23.987386 [info ] [MainThread]: 
[0m13:35:23.992721 [debug] [Thread-1 (]: Began running node model.jaffle_shop.stg_customers
[0m13:35:23.994058 [debug] [Thread-2 (]: Began running node model.jaffle_shop.stg_orders
[0m13:35:23.995456 [debug] [Thread-3 (]: Began running node model.jaffle_shop.stg_payments
[0m13:35:23.996464 [info ] [Thread-1 (]: 1 of 5 START sql view model JAFFLE_SHOP.stg_customers .......................... [RUN]
[0m13:35:23.997462 [info ] [Thread-2 (]: 2 of 5 START sql view model JAFFLE_SHOP.stg_orders ............................. [RUN]
[0m13:35:23.998355 [info ] [Thread-3 (]: 3 of 5 START sql view model JAFFLE_SHOP.stg_payments ........................... [RUN]
[0m13:35:23.999567 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_RAW_JAFFLE_SHOP, now model.jaffle_shop.stg_customers)
[0m13:35:24.000797 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.jaffle_shop.stg_orders'
[0m13:35:24.002077 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.jaffle_shop.stg_payments'
[0m13:35:24.002806 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.stg_customers
[0m13:35:24.003559 [debug] [Thread-2 (]: Began compiling node model.jaffle_shop.stg_orders
[0m13:35:24.004156 [debug] [Thread-3 (]: Began compiling node model.jaffle_shop.stg_payments
[0m13:35:24.015986 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.stg_customers"
[0m13:35:24.021048 [debug] [Thread-2 (]: Writing injected SQL for node "model.jaffle_shop.stg_orders"
[0m13:35:24.027329 [debug] [Thread-3 (]: Writing injected SQL for node "model.jaffle_shop.stg_payments"
[0m13:35:24.028781 [debug] [Thread-1 (]: Timing info for model.jaffle_shop.stg_customers (compile): 13:35:24.004539 => 13:35:24.028340
[0m13:35:24.029417 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.stg_customers
[0m13:35:24.043276 [debug] [Thread-2 (]: Timing info for model.jaffle_shop.stg_orders (compile): 13:35:24.016502 => 13:35:24.042581
[0m13:35:24.049581 [debug] [Thread-3 (]: Timing info for model.jaffle_shop.stg_payments (compile): 13:35:24.021839 => 13:35:24.049116
[0m13:35:24.063575 [debug] [Thread-2 (]: Began executing node model.jaffle_shop.stg_orders
[0m13:35:24.079771 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.stg_customers"
[0m13:35:24.080510 [debug] [Thread-3 (]: Began executing node model.jaffle_shop.stg_payments
[0m13:35:24.085128 [debug] [Thread-2 (]: Writing runtime sql for node "model.jaffle_shop.stg_orders"
[0m13:35:24.089721 [debug] [Thread-3 (]: Writing runtime sql for node "model.jaffle_shop.stg_payments"
[0m13:35:24.091116 [debug] [Thread-1 (]: Using snowflake connection "model.jaffle_shop.stg_customers"
[0m13:35:24.092557 [debug] [Thread-2 (]: Using snowflake connection "model.jaffle_shop.stg_orders"
[0m13:35:24.093143 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */
create or replace   view RAW.JAFFLE_SHOP.stg_customers
  
   as (
    -- noinspection SqlNoDataSourceInspectionForFile



select
    id as customer_id,
    first_name,
    last_name

from raw.jaffle_shop.raw_customers
  );
[0m13:35:24.094102 [debug] [Thread-3 (]: Using snowflake connection "model.jaffle_shop.stg_payments"
[0m13:35:24.094687 [debug] [Thread-2 (]: On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */
create or replace   view RAW.JAFFLE_SHOP.stg_orders
  
   as (
    

select
    id as order_id,
    user_id as customer_id,
    order_date,
    status

from raw.jaffle_shop.raw_orders
  );
[0m13:35:24.095261 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:35:24.095830 [debug] [Thread-3 (]: On model.jaffle_shop.stg_payments: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_payments"} */
create or replace   view RAW.JAFFLE_SHOP.stg_payments
  
   as (
    

select
    id,
    order_id,
    payment_method,
    round(1.0 * amount / 100, 2) AS amount_usd

from raw.jaffle_shop.raw_payments
  );
[0m13:35:24.096380 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m13:35:24.098718 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m13:35:24.668585 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m13:35:24.700112 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m13:35:24.715886 [debug] [Thread-2 (]: Timing info for model.jaffle_shop.stg_orders (execute): 13:35:24.080916 => 13:35:24.715536
[0m13:35:24.716596 [debug] [Thread-2 (]: On model.jaffle_shop.stg_orders: Close
[0m13:35:24.719208 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m13:35:24.720586 [debug] [Thread-1 (]: Timing info for model.jaffle_shop.stg_customers (execute): 13:35:24.029895 => 13:35:24.720259
[0m13:35:24.724391 [debug] [Thread-3 (]: Timing info for model.jaffle_shop.stg_payments (execute): 13:35:24.085857 => 13:35:24.724063
[0m13:35:24.725208 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: Close
[0m13:35:24.725880 [debug] [Thread-3 (]: On model.jaffle_shop.stg_payments: Close
[0m13:35:24.872755 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f71eb853-cad7-44ba-a1d8-f6256d005435', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ded9dd0>]}
[0m13:35:24.874510 [info ] [Thread-2 (]: 2 of 5 OK created sql view model JAFFLE_SHOP.stg_orders ........................ [[32mSUCCESS 1[0m in 0.87s]
[0m13:35:24.876296 [debug] [Thread-2 (]: Finished running node model.jaffle_shop.stg_orders
[0m13:35:24.878110 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f71eb853-cad7-44ba-a1d8-f6256d005435', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dbd1090>]}
[0m13:35:24.880983 [info ] [Thread-1 (]: 1 of 5 OK created sql view model JAFFLE_SHOP.stg_customers ..................... [[32mSUCCESS 1[0m in 0.88s]
[0m13:35:24.882569 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.stg_customers
[0m13:35:24.884134 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f71eb853-cad7-44ba-a1d8-f6256d005435', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ddc3f50>]}
[0m13:35:24.885368 [debug] [Thread-4 (]: Began running node model.jaffle_shop.customers
[0m13:35:24.886401 [info ] [Thread-3 (]: 3 of 5 OK created sql view model JAFFLE_SHOP.stg_payments ...................... [[32mSUCCESS 1[0m in 0.88s]
[0m13:35:24.887270 [info ] [Thread-4 (]: 4 of 5 START sql view model JAFFLE_SHOP.customers .............................. [RUN]
[0m13:35:24.888405 [debug] [Thread-3 (]: Finished running node model.jaffle_shop.stg_payments
[0m13:35:24.889743 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.jaffle_shop.customers'
[0m13:35:24.890895 [debug] [Thread-1 (]: Began running node model.jaffle_shop.int_orders__pivoted
[0m13:35:24.891651 [debug] [Thread-4 (]: Began compiling node model.jaffle_shop.customers
[0m13:35:24.892372 [info ] [Thread-1 (]: 5 of 5 START sql view model JAFFLE_SHOP.int_orders__pivoted .................... [RUN]
[0m13:35:24.897643 [debug] [Thread-4 (]: Writing injected SQL for node "model.jaffle_shop.customers"
[0m13:35:24.898845 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.jaffle_shop.stg_customers, now model.jaffle_shop.int_orders__pivoted)
[0m13:35:24.899710 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.int_orders__pivoted
[0m13:35:24.907376 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.int_orders__pivoted"
[0m13:35:24.908565 [debug] [Thread-4 (]: Timing info for model.jaffle_shop.customers (compile): 13:35:24.892810 => 13:35:24.908162
[0m13:35:24.909248 [debug] [Thread-4 (]: Began executing node model.jaffle_shop.customers
[0m13:35:24.914676 [debug] [Thread-4 (]: Writing runtime sql for node "model.jaffle_shop.customers"
[0m13:35:24.916038 [debug] [Thread-1 (]: Timing info for model.jaffle_shop.int_orders__pivoted (compile): 13:35:24.900125 => 13:35:24.915337
[0m13:35:24.917854 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.int_orders__pivoted
[0m13:35:24.927612 [debug] [Thread-4 (]: Using snowflake connection "model.jaffle_shop.customers"
[0m13:35:24.930139 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.int_orders__pivoted"
[0m13:35:24.931146 [debug] [Thread-4 (]: On model.jaffle_shop.customers: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.customers"} */
create or replace   view RAW.JAFFLE_SHOP.customers
  
   as (
    


with customers as (

    select * from RAW.JAFFLE_SHOP.stg_customers

),

orders as (

    select * from RAW.JAFFLE_SHOP.stg_orders

),

customer_orders as (

    select
        customer_id,

        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders

    from orders

    group by 1

),

final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce(customer_orders.number_of_orders, 0) as number_of_orders

    from customers

    left join customer_orders using (customer_id)

)

select * from final
  );
[0m13:35:24.932203 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m13:35:24.936293 [debug] [Thread-1 (]: Using snowflake connection "model.jaffle_shop.int_orders__pivoted"
[0m13:35:24.937209 [debug] [Thread-1 (]: On model.jaffle_shop.int_orders__pivoted: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.int_orders__pivoted"} */
create or replace   view RAW.JAFFLE_SHOP.int_orders__pivoted
  
   as (
    



WITH payments AS (
    SELECT p.id AS id,
           p.order_id AS order_id,
           p.payment_method AS payment_method,
           p.amount AS amount,
           o.status AS status
    FROM RAW.JAFFLE_SHOP.stg_payments p
    JOIN RAW.JAFFLE_SHOP.stg_orders o
    ON p.order_id = o.order_id
),
pivoted AS (
    SELECT
        order_id,
        SUM(CASE WHEN payment_method = 'bank_transfer' THEN amount ELSE 0 END) AS bank_transfer_amount,
        SUM(CASE WHEN payment_method = 'coupon' THEN amount ELSE 0 END) AS coupon_amount,
        SUM(CASE WHEN payment_method = 'credit_card' THEN amount ELSE 0 END) AS credit_card_amount,
        SUM(CASE WHEN payment_method = 'gift_card' THEN amount ELSE 0 END) AS gift_card_amount
    FROM payments
    WHERE status = 'completed'
    GROUP BY 1
)

SELECT * FROM pivoted
  );
[0m13:35:24.937983 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:35:25.439790 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b3aaff-0001-c86b-0005-81260003f20a
[0m13:35:25.440922 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 12 at position 11
invalid identifier 'P.AMOUNT'
[0m13:35:25.442376 [debug] [Thread-1 (]: Timing info for model.jaffle_shop.int_orders__pivoted (execute): 13:35:24.919182 => 13:35:25.441840
[0m13:35:25.443301 [debug] [Thread-1 (]: On model.jaffle_shop.int_orders__pivoted: Close
[0m13:35:25.546975 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m13:35:25.554020 [debug] [Thread-4 (]: Timing info for model.jaffle_shop.customers (execute): 13:35:24.909765 => 13:35:25.553487
[0m13:35:25.555014 [debug] [Thread-4 (]: On model.jaffle_shop.customers: Close
[0m13:35:25.586457 [debug] [Thread-1 (]: Database Error in model int_orders__pivoted (models/marts/core/int_orders__pivoted.sql)
  000904 (42000): SQL compilation error: error line 12 at position 11
  invalid identifier 'P.AMOUNT'
  compiled Code at target/run/jaffle_shop/models/marts/core/int_orders__pivoted.sql
[0m13:35:25.587725 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f71eb853-cad7-44ba-a1d8-f6256d005435', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10db9ba90>]}
[0m13:35:25.589100 [error] [Thread-1 (]: 5 of 5 ERROR creating sql view model JAFFLE_SHOP.int_orders__pivoted ........... [[31mERROR[0m in 0.69s]
[0m13:35:25.590524 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.int_orders__pivoted
[0m13:35:25.688383 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f71eb853-cad7-44ba-a1d8-f6256d005435', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dc87950>]}
[0m13:35:25.690199 [info ] [Thread-4 (]: 4 of 5 OK created sql view model JAFFLE_SHOP.customers ......................... [[32mSUCCESS 1[0m in 0.80s]
[0m13:35:25.692025 [debug] [Thread-4 (]: Finished running node model.jaffle_shop.customers
[0m13:35:25.696329 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:35:25.697256 [debug] [MainThread]: Connection 'model.jaffle_shop.int_orders__pivoted' was properly closed.
[0m13:35:25.698046 [debug] [MainThread]: Connection 'model.jaffle_shop.stg_orders' was properly closed.
[0m13:35:25.698717 [debug] [MainThread]: Connection 'model.jaffle_shop.stg_payments' was properly closed.
[0m13:35:25.699328 [debug] [MainThread]: Connection 'model.jaffle_shop.customers' was properly closed.
[0m13:35:25.700101 [info ] [MainThread]: 
[0m13:35:25.700868 [info ] [MainThread]: Finished running 5 view models in 0 hours 0 minutes and 3.22 seconds (3.22s).
[0m13:35:25.703108 [debug] [MainThread]: Command end result
[0m13:35:25.719362 [info ] [MainThread]: 
[0m13:35:25.720311 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m13:35:25.720884 [info ] [MainThread]: 
[0m13:35:25.721400 [error] [MainThread]:   Database Error in model int_orders__pivoted (models/marts/core/int_orders__pivoted.sql)
  000904 (42000): SQL compilation error: error line 12 at position 11
  invalid identifier 'P.AMOUNT'
  compiled Code at target/run/jaffle_shop/models/marts/core/int_orders__pivoted.sql
[0m13:35:25.721923 [info ] [MainThread]: 
[0m13:35:25.722475 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
[0m13:35:25.724547 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 4.1113963, "process_user_time": 4.36107, "process_kernel_time": 0.447005, "process_mem_max_rss": "139055104", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m13:35:25.725754 [debug] [MainThread]: Command `dbt run` failed at 13:35:25.725448 after 4.11 seconds
[0m13:35:25.726794 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d127950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cad3790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dab4210>]}
[0m13:35:25.727752 [debug] [MainThread]: Flushing usage events
[0m13:36:59.924658 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108b2fe10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108779890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1084e9890>]}


============================== 13:36:59.930605 | b6bed763-86fb-4aab-bde1-06507a9ffb58 ==============================
[0m13:36:59.930605 [info ] [MainThread]: Running with dbt=1.7.8
[0m13:36:59.932013 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/Users/ben/.dbt', 'log_path': '/Users/ben/jaffle_shop/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m13:37:00.460250 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b6bed763-86fb-4aab-bde1-06507a9ffb58', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1093f8090>]}
[0m13:37:00.585779 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b6bed763-86fb-4aab-bde1-06507a9ffb58', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10939fb10>]}
[0m13:37:00.587078 [info ] [MainThread]: Registered adapter: snowflake=1.7.2
[0m13:37:00.610164 [debug] [MainThread]: checksum: 67f0013ca5f0bd43af9a0873dd50792fde83ef69de63b71cacd0b4ac656c52e5, vars: {}, profile: , target: , version: 1.7.8
[0m13:37:00.665331 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:37:00.666059 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:37:00.676647 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b6bed763-86fb-4aab-bde1-06507a9ffb58', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1096b37d0>]}
[0m13:37:00.694491 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b6bed763-86fb-4aab-bde1-06507a9ffb58', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10951ab50>]}
[0m13:37:00.695339 [info ] [MainThread]: Found 5 models, 3 seeds, 11 tests, 0 sources, 0 exposures, 0 metrics, 431 macros, 0 groups, 0 semantic models
[0m13:37:00.695970 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b6bed763-86fb-4aab-bde1-06507a9ffb58', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1087a4390>]}
[0m13:37:00.699608 [info ] [MainThread]: 
[0m13:37:00.700954 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m13:37:00.703457 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RAW'
[0m13:37:00.724940 [debug] [ThreadPool]: Using snowflake connection "list_RAW"
[0m13:37:00.725644 [debug] [ThreadPool]: On list_RAW: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_RAW"} */
show terse schemas in database RAW
    limit 10000
[0m13:37:00.726193 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:37:01.421388 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.0 seconds
[0m13:37:01.426037 [debug] [ThreadPool]: On list_RAW: Close
[0m13:37:01.581193 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RAW, now list_RAW_JAFFLE_SHOP)
[0m13:37:01.597693 [debug] [ThreadPool]: Using snowflake connection "list_RAW_JAFFLE_SHOP"
[0m13:37:01.598543 [debug] [ThreadPool]: On list_RAW_JAFFLE_SHOP: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_RAW_JAFFLE_SHOP"} */
show terse objects in RAW.JAFFLE_SHOP limit 10000
[0m13:37:01.599137 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:37:02.131297 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 1.0 seconds
[0m13:37:02.136364 [debug] [ThreadPool]: On list_RAW_JAFFLE_SHOP: Close
[0m13:37:02.292472 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b6bed763-86fb-4aab-bde1-06507a9ffb58', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10945d9d0>]}
[0m13:37:02.294561 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:37:02.295470 [info ] [MainThread]: 
[0m13:37:02.300957 [debug] [Thread-1 (]: Began running node model.jaffle_shop.stg_customers
[0m13:37:02.302089 [info ] [Thread-1 (]: 1 of 5 START sql view model JAFFLE_SHOP.stg_customers .......................... [RUN]
[0m13:37:02.303023 [debug] [Thread-2 (]: Began running node model.jaffle_shop.stg_orders
[0m13:37:02.303945 [debug] [Thread-3 (]: Began running node model.jaffle_shop.stg_payments
[0m13:37:02.305088 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_RAW_JAFFLE_SHOP, now model.jaffle_shop.stg_customers)
[0m13:37:02.305910 [info ] [Thread-2 (]: 2 of 5 START sql view model JAFFLE_SHOP.stg_orders ............................. [RUN]
[0m13:37:02.306732 [info ] [Thread-3 (]: 3 of 5 START sql view model JAFFLE_SHOP.stg_payments ........................... [RUN]
[0m13:37:02.307724 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.stg_customers
[0m13:37:02.309165 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.jaffle_shop.stg_orders'
[0m13:37:02.310312 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.jaffle_shop.stg_payments'
[0m13:37:02.320996 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.stg_customers"
[0m13:37:02.321720 [debug] [Thread-2 (]: Began compiling node model.jaffle_shop.stg_orders
[0m13:37:02.322396 [debug] [Thread-3 (]: Began compiling node model.jaffle_shop.stg_payments
[0m13:37:02.327206 [debug] [Thread-2 (]: Writing injected SQL for node "model.jaffle_shop.stg_orders"
[0m13:37:02.335327 [debug] [Thread-3 (]: Writing injected SQL for node "model.jaffle_shop.stg_payments"
[0m13:37:02.336272 [debug] [Thread-1 (]: Timing info for model.jaffle_shop.stg_customers (compile): 13:37:02.310709 => 13:37:02.335825
[0m13:37:02.337512 [debug] [Thread-2 (]: Timing info for model.jaffle_shop.stg_orders (compile): 13:37:02.322962 => 13:37:02.337137
[0m13:37:02.338173 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.stg_customers
[0m13:37:02.338865 [debug] [Thread-2 (]: Began executing node model.jaffle_shop.stg_orders
[0m13:37:02.339522 [debug] [Thread-3 (]: Timing info for model.jaffle_shop.stg_payments (compile): 13:37:02.328106 => 13:37:02.339213
[0m13:37:02.401222 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.stg_customers"
[0m13:37:02.401907 [debug] [Thread-3 (]: Began executing node model.jaffle_shop.stg_payments
[0m13:37:02.406664 [debug] [Thread-2 (]: Writing runtime sql for node "model.jaffle_shop.stg_orders"
[0m13:37:02.411448 [debug] [Thread-3 (]: Writing runtime sql for node "model.jaffle_shop.stg_payments"
[0m13:37:02.413315 [debug] [Thread-1 (]: Using snowflake connection "model.jaffle_shop.stg_customers"
[0m13:37:02.414384 [debug] [Thread-3 (]: Using snowflake connection "model.jaffle_shop.stg_payments"
[0m13:37:02.415020 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */
create or replace   view RAW.JAFFLE_SHOP.stg_customers
  
   as (
    -- noinspection SqlNoDataSourceInspectionForFile



select
    id as customer_id,
    first_name,
    last_name

from raw.jaffle_shop.raw_customers
  );
[0m13:37:02.415995 [debug] [Thread-2 (]: Using snowflake connection "model.jaffle_shop.stg_orders"
[0m13:37:02.416640 [debug] [Thread-3 (]: On model.jaffle_shop.stg_payments: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_payments"} */
create or replace   view RAW.JAFFLE_SHOP.stg_payments
  
   as (
    

select
    id,
    order_id,
    payment_method,
    round(1.0 * amount / 100, 2) AS amount_usd

from raw.jaffle_shop.raw_payments
  );
[0m13:37:02.417379 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:37:02.418013 [debug] [Thread-2 (]: On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */
create or replace   view RAW.JAFFLE_SHOP.stg_orders
  
   as (
    

select
    id as order_id,
    user_id as customer_id,
    order_date,
    status

from raw.jaffle_shop.raw_orders
  );
[0m13:37:02.418756 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m13:37:02.420307 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m13:37:02.987933 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m13:37:03.004728 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m13:37:03.045460 [debug] [Thread-1 (]: Timing info for model.jaffle_shop.stg_customers (execute): 13:37:02.339888 => 13:37:03.044898
[0m13:37:03.046362 [debug] [Thread-3 (]: Timing info for model.jaffle_shop.stg_payments (execute): 13:37:02.407360 => 13:37:03.046003
[0m13:37:03.046996 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: Close
[0m13:37:03.047597 [debug] [Thread-3 (]: On model.jaffle_shop.stg_payments: Close
[0m13:37:03.055728 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m13:37:03.059255 [debug] [Thread-2 (]: Timing info for model.jaffle_shop.stg_orders (execute): 13:37:02.352117 => 13:37:03.058925
[0m13:37:03.059890 [debug] [Thread-2 (]: On model.jaffle_shop.stg_orders: Close
[0m13:37:03.198387 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b6bed763-86fb-4aab-bde1-06507a9ffb58', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1096bf8d0>]}
[0m13:37:03.200265 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b6bed763-86fb-4aab-bde1-06507a9ffb58', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1096bda10>]}
[0m13:37:03.201979 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b6bed763-86fb-4aab-bde1-06507a9ffb58', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1096b1d50>]}
[0m13:37:03.203369 [info ] [Thread-1 (]: 1 of 5 OK created sql view model JAFFLE_SHOP.stg_customers ..................... [[32mSUCCESS 1[0m in 0.89s]
[0m13:37:03.204889 [info ] [Thread-3 (]: 3 of 5 OK created sql view model JAFFLE_SHOP.stg_payments ...................... [[32mSUCCESS 1[0m in 0.89s]
[0m13:37:03.206162 [info ] [Thread-2 (]: 2 of 5 OK created sql view model JAFFLE_SHOP.stg_orders ........................ [[32mSUCCESS 1[0m in 0.89s]
[0m13:37:03.207469 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.stg_customers
[0m13:37:03.208664 [debug] [Thread-3 (]: Finished running node model.jaffle_shop.stg_payments
[0m13:37:03.209649 [debug] [Thread-2 (]: Finished running node model.jaffle_shop.stg_orders
[0m13:37:03.211409 [debug] [Thread-4 (]: Began running node model.jaffle_shop.customers
[0m13:37:03.212183 [debug] [Thread-1 (]: Began running node model.jaffle_shop.int_orders__pivoted
[0m13:37:03.212981 [info ] [Thread-4 (]: 4 of 5 START sql view model JAFFLE_SHOP.customers .............................. [RUN]
[0m13:37:03.213805 [info ] [Thread-1 (]: 5 of 5 START sql view model JAFFLE_SHOP.int_orders__pivoted .................... [RUN]
[0m13:37:03.215107 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.jaffle_shop.customers'
[0m13:37:03.216051 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.jaffle_shop.stg_customers, now model.jaffle_shop.int_orders__pivoted)
[0m13:37:03.216641 [debug] [Thread-4 (]: Began compiling node model.jaffle_shop.customers
[0m13:37:03.217200 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.int_orders__pivoted
[0m13:37:03.222435 [debug] [Thread-4 (]: Writing injected SQL for node "model.jaffle_shop.customers"
[0m13:37:03.228270 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.int_orders__pivoted"
[0m13:37:03.229491 [debug] [Thread-4 (]: Timing info for model.jaffle_shop.customers (compile): 13:37:03.217567 => 13:37:03.229140
[0m13:37:03.230089 [debug] [Thread-4 (]: Began executing node model.jaffle_shop.customers
[0m13:37:03.234991 [debug] [Thread-4 (]: Writing runtime sql for node "model.jaffle_shop.customers"
[0m13:37:03.236077 [debug] [Thread-1 (]: Timing info for model.jaffle_shop.int_orders__pivoted (compile): 13:37:03.222901 => 13:37:03.235666
[0m13:37:03.236838 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.int_orders__pivoted
[0m13:37:03.245140 [debug] [Thread-4 (]: Using snowflake connection "model.jaffle_shop.customers"
[0m13:37:03.246096 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.int_orders__pivoted"
[0m13:37:03.247075 [debug] [Thread-4 (]: On model.jaffle_shop.customers: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.customers"} */
create or replace   view RAW.JAFFLE_SHOP.customers
  
   as (
    


with customers as (

    select * from RAW.JAFFLE_SHOP.stg_customers

),

orders as (

    select * from RAW.JAFFLE_SHOP.stg_orders

),

customer_orders as (

    select
        customer_id,

        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders

    from orders

    group by 1

),

final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce(customer_orders.number_of_orders, 0) as number_of_orders

    from customers

    left join customer_orders using (customer_id)

)

select * from final
  );
[0m13:37:03.248830 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m13:37:03.255540 [debug] [Thread-1 (]: Using snowflake connection "model.jaffle_shop.int_orders__pivoted"
[0m13:37:03.257357 [debug] [Thread-1 (]: On model.jaffle_shop.int_orders__pivoted: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.int_orders__pivoted"} */
create or replace   view RAW.JAFFLE_SHOP.int_orders__pivoted
  
   as (
    



WITH payments AS (
    SELECT p.id AS id,
           p.order_id AS order_id,
           p.payment_method AS payment_method,
           p.amount AS amount,
           o.status AS status
    FROM RAW.JAFFLE_SHOP.stg_payments p
    JOIN RAW.JAFFLE_SHOP.stg_orders o
    ON p.order_id = o.order_id
),
pivoted AS (
    SELECT
        order_id,
        SUM(CASE WHEN payment_method = 'bank_transfer' THEN amount ELSE 0 END) AS bank_transfer_amount,
        SUM(CASE WHEN payment_method = 'coupon' THEN amount ELSE 0 END) AS coupon_amount,
        SUM(CASE WHEN payment_method = 'credit_card' THEN amount ELSE 0 END) AS credit_card_amount,
        SUM(CASE WHEN payment_method = 'gift_card' THEN amount ELSE 0 END) AS gift_card_amount
    FROM payments
    WHERE status = 'completed'
    GROUP BY 1
)

SELECT * FROM pivoted
  );
[0m13:37:03.259072 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:37:03.826963 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b3ab01-0001-c86b-0005-81260003f212
[0m13:37:03.828079 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 12 at position 11
invalid identifier 'P.AMOUNT'
[0m13:37:03.829458 [debug] [Thread-1 (]: Timing info for model.jaffle_shop.int_orders__pivoted (execute): 13:37:03.237311 => 13:37:03.828933
[0m13:37:03.830386 [debug] [Thread-1 (]: On model.jaffle_shop.int_orders__pivoted: Close
[0m13:37:03.977467 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m13:37:03.986805 [debug] [Thread-4 (]: Timing info for model.jaffle_shop.customers (execute): 13:37:03.230516 => 13:37:03.986289
[0m13:37:03.987696 [debug] [Thread-4 (]: On model.jaffle_shop.customers: Close
[0m13:37:03.993812 [debug] [Thread-1 (]: Database Error in model int_orders__pivoted (models/marts/core/int_orders__pivoted.sql)
  000904 (42000): SQL compilation error: error line 12 at position 11
  invalid identifier 'P.AMOUNT'
  compiled Code at target/run/jaffle_shop/models/marts/core/int_orders__pivoted.sql
[0m13:37:03.994746 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b6bed763-86fb-4aab-bde1-06507a9ffb58', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10997a950>]}
[0m13:37:03.995744 [error] [Thread-1 (]: 5 of 5 ERROR creating sql view model JAFFLE_SHOP.int_orders__pivoted ........... [[31mERROR[0m in 0.78s]
[0m13:37:03.997364 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.int_orders__pivoted
[0m13:37:04.142454 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b6bed763-86fb-4aab-bde1-06507a9ffb58', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109873d90>]}
[0m13:37:04.144234 [info ] [Thread-4 (]: 4 of 5 OK created sql view model JAFFLE_SHOP.customers ......................... [[32mSUCCESS 1[0m in 0.93s]
[0m13:37:04.145976 [debug] [Thread-4 (]: Finished running node model.jaffle_shop.customers
[0m13:37:04.150090 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:37:04.151002 [debug] [MainThread]: Connection 'model.jaffle_shop.int_orders__pivoted' was properly closed.
[0m13:37:04.151768 [debug] [MainThread]: Connection 'model.jaffle_shop.stg_orders' was properly closed.
[0m13:37:04.152453 [debug] [MainThread]: Connection 'model.jaffle_shop.stg_payments' was properly closed.
[0m13:37:04.153039 [debug] [MainThread]: Connection 'model.jaffle_shop.customers' was properly closed.
[0m13:37:04.153811 [info ] [MainThread]: 
[0m13:37:04.154636 [info ] [MainThread]: Finished running 5 view models in 0 hours 0 minutes and 3.45 seconds (3.45s).
[0m13:37:04.156899 [debug] [MainThread]: Command end result
[0m13:37:04.171962 [info ] [MainThread]: 
[0m13:37:04.172641 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m13:37:04.173154 [info ] [MainThread]: 
[0m13:37:04.173683 [error] [MainThread]:   Database Error in model int_orders__pivoted (models/marts/core/int_orders__pivoted.sql)
  000904 (42000): SQL compilation error: error line 12 at position 11
  invalid identifier 'P.AMOUNT'
  compiled Code at target/run/jaffle_shop/models/marts/core/int_orders__pivoted.sql
[0m13:37:04.174207 [info ] [MainThread]: 
[0m13:37:04.174738 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
[0m13:37:04.176652 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 4.331591, "process_user_time": 4.327137, "process_kernel_time": 0.432081, "process_mem_max_rss": "138067968", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m13:37:04.177820 [debug] [MainThread]: Command `dbt run` failed at 13:37:04.177420 after 4.33 seconds
[0m13:37:04.178910 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10846f490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108aeb650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1047340d0>]}
[0m13:37:04.180113 [debug] [MainThread]: Flushing usage events
[0m13:38:05.533550 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1130da790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112d94f90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112e6f1d0>]}


============================== 13:38:05.539453 | 72a3bd10-02c4-412b-89ec-0dfe18223ac2 ==============================
[0m13:38:05.539453 [info ] [MainThread]: Running with dbt=1.7.8
[0m13:38:05.540550 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/ben/jaffle_shop/logs', 'debug': 'False', 'profiles_dir': '/Users/ben/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:38:06.073450 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '72a3bd10-02c4-412b-89ec-0dfe18223ac2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1131126d0>]}
[0m13:38:06.199125 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '72a3bd10-02c4-412b-89ec-0dfe18223ac2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113d6b7d0>]}
[0m13:38:06.200410 [info ] [MainThread]: Registered adapter: snowflake=1.7.2
[0m13:38:06.223029 [debug] [MainThread]: checksum: 67f0013ca5f0bd43af9a0873dd50792fde83ef69de63b71cacd0b4ac656c52e5, vars: {}, profile: , target: , version: 1.7.8
[0m13:38:06.276424 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:38:06.277515 [debug] [MainThread]: Partial parsing: updated file: jaffle_shop://models/marts/core/int_orders__pivoted.sql
[0m13:38:06.483560 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '72a3bd10-02c4-412b-89ec-0dfe18223ac2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113fe3490>]}
[0m13:38:06.500645 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '72a3bd10-02c4-412b-89ec-0dfe18223ac2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113f26cd0>]}
[0m13:38:06.501444 [info ] [MainThread]: Found 5 models, 3 seeds, 11 tests, 0 sources, 0 exposures, 0 metrics, 431 macros, 0 groups, 0 semantic models
[0m13:38:06.502041 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '72a3bd10-02c4-412b-89ec-0dfe18223ac2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11349c410>]}
[0m13:38:06.505228 [info ] [MainThread]: 
[0m13:38:06.506494 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m13:38:06.508311 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RAW'
[0m13:38:06.527312 [debug] [ThreadPool]: Using snowflake connection "list_RAW"
[0m13:38:06.528015 [debug] [ThreadPool]: On list_RAW: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_RAW"} */
show terse schemas in database RAW
    limit 10000
[0m13:38:06.528541 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:38:07.201554 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.0 seconds
[0m13:38:07.205233 [debug] [ThreadPool]: On list_RAW: Close
[0m13:38:07.344123 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RAW, now list_RAW_JAFFLE_SHOP)
[0m13:38:07.360723 [debug] [ThreadPool]: Using snowflake connection "list_RAW_JAFFLE_SHOP"
[0m13:38:07.369887 [debug] [ThreadPool]: On list_RAW_JAFFLE_SHOP: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_RAW_JAFFLE_SHOP"} */
show terse objects in RAW.JAFFLE_SHOP limit 10000
[0m13:38:07.371960 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:38:07.917017 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 1.0 seconds
[0m13:38:07.922818 [debug] [ThreadPool]: On list_RAW_JAFFLE_SHOP: Close
[0m13:38:08.070511 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '72a3bd10-02c4-412b-89ec-0dfe18223ac2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11426d710>]}
[0m13:38:08.072907 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:38:08.074120 [info ] [MainThread]: 
[0m13:38:08.078899 [debug] [Thread-1 (]: Began running node model.jaffle_shop.stg_customers
[0m13:38:08.080026 [info ] [Thread-1 (]: 1 of 5 START sql view model JAFFLE_SHOP.stg_customers .......................... [RUN]
[0m13:38:08.081666 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_RAW_JAFFLE_SHOP, now model.jaffle_shop.stg_customers)
[0m13:38:08.082495 [debug] [Thread-2 (]: Began running node model.jaffle_shop.stg_orders
[0m13:38:08.083293 [debug] [Thread-3 (]: Began running node model.jaffle_shop.stg_payments
[0m13:38:08.084053 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.stg_customers
[0m13:38:08.085073 [info ] [Thread-2 (]: 2 of 5 START sql view model JAFFLE_SHOP.stg_orders ............................. [RUN]
[0m13:38:08.086063 [info ] [Thread-3 (]: 3 of 5 START sql view model JAFFLE_SHOP.stg_payments ........................... [RUN]
[0m13:38:08.098735 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.stg_customers"
[0m13:38:08.099862 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.jaffle_shop.stg_orders'
[0m13:38:08.101432 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.jaffle_shop.stg_payments'
[0m13:38:08.102562 [debug] [Thread-2 (]: Began compiling node model.jaffle_shop.stg_orders
[0m13:38:08.103440 [debug] [Thread-3 (]: Began compiling node model.jaffle_shop.stg_payments
[0m13:38:08.109540 [debug] [Thread-2 (]: Writing injected SQL for node "model.jaffle_shop.stg_orders"
[0m13:38:08.116088 [debug] [Thread-1 (]: Timing info for model.jaffle_shop.stg_customers (compile): 13:38:08.086601 => 13:38:08.115595
[0m13:38:08.117774 [debug] [Thread-3 (]: Writing injected SQL for node "model.jaffle_shop.stg_payments"
[0m13:38:08.119098 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.stg_customers
[0m13:38:08.126175 [debug] [Thread-2 (]: Timing info for model.jaffle_shop.stg_orders (compile): 13:38:08.104321 => 13:38:08.125685
[0m13:38:08.157974 [debug] [Thread-2 (]: Began executing node model.jaffle_shop.stg_orders
[0m13:38:08.169932 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.stg_customers"
[0m13:38:08.170713 [debug] [Thread-3 (]: Timing info for model.jaffle_shop.stg_payments (compile): 13:38:08.110358 => 13:38:08.170377
[0m13:38:08.175016 [debug] [Thread-2 (]: Writing runtime sql for node "model.jaffle_shop.stg_orders"
[0m13:38:08.176017 [debug] [Thread-3 (]: Began executing node model.jaffle_shop.stg_payments
[0m13:38:08.177243 [debug] [Thread-1 (]: Using snowflake connection "model.jaffle_shop.stg_customers"
[0m13:38:08.181909 [debug] [Thread-3 (]: Writing runtime sql for node "model.jaffle_shop.stg_payments"
[0m13:38:08.183024 [debug] [Thread-2 (]: Using snowflake connection "model.jaffle_shop.stg_orders"
[0m13:38:08.183581 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */
create or replace   view RAW.JAFFLE_SHOP.stg_customers
  
   as (
    -- noinspection SqlNoDataSourceInspectionForFile



select
    id as customer_id,
    first_name,
    last_name

from raw.jaffle_shop.raw_customers
  );
[0m13:38:08.184437 [debug] [Thread-2 (]: On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */
create or replace   view RAW.JAFFLE_SHOP.stg_orders
  
   as (
    

select
    id as order_id,
    user_id as customer_id,
    order_date,
    status

from raw.jaffle_shop.raw_orders
  );
[0m13:38:08.185171 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:38:08.186270 [debug] [Thread-3 (]: Using snowflake connection "model.jaffle_shop.stg_payments"
[0m13:38:08.186781 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m13:38:08.189019 [debug] [Thread-3 (]: On model.jaffle_shop.stg_payments: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_payments"} */
create or replace   view RAW.JAFFLE_SHOP.stg_payments
  
   as (
    

select
    id,
    order_id,
    payment_method,
    round(1.0 * amount / 100, 2) AS amount_usd

from raw.jaffle_shop.raw_payments
  );
[0m13:38:08.191203 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m13:38:08.784286 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m13:38:08.823454 [debug] [Thread-1 (]: Timing info for model.jaffle_shop.stg_customers (execute): 13:38:08.120098 => 13:38:08.823095
[0m13:38:08.824163 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: Close
[0m13:38:08.869137 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m13:38:08.875879 [debug] [Thread-3 (]: Timing info for model.jaffle_shop.stg_payments (execute): 13:38:08.177722 => 13:38:08.875274
[0m13:38:08.877109 [debug] [Thread-3 (]: On model.jaffle_shop.stg_payments: Close
[0m13:38:08.952977 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '72a3bd10-02c4-412b-89ec-0dfe18223ac2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11400ddd0>]}
[0m13:38:08.954710 [info ] [Thread-1 (]: 1 of 5 OK created sql view model JAFFLE_SHOP.stg_customers ..................... [[32mSUCCESS 1[0m in 0.87s]
[0m13:38:08.956329 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.stg_customers
[0m13:38:08.958202 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m13:38:08.962670 [debug] [Thread-2 (]: Timing info for model.jaffle_shop.stg_orders (execute): 13:38:08.171038 => 13:38:08.962290
[0m13:38:08.963359 [debug] [Thread-2 (]: On model.jaffle_shop.stg_orders: Close
[0m13:38:09.021161 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '72a3bd10-02c4-412b-89ec-0dfe18223ac2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1143d9910>]}
[0m13:38:09.022768 [info ] [Thread-3 (]: 3 of 5 OK created sql view model JAFFLE_SHOP.stg_payments ...................... [[32mSUCCESS 1[0m in 0.92s]
[0m13:38:09.024043 [debug] [Thread-3 (]: Finished running node model.jaffle_shop.stg_payments
[0m13:38:09.154986 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '72a3bd10-02c4-412b-89ec-0dfe18223ac2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114038290>]}
[0m13:38:09.156778 [info ] [Thread-2 (]: 2 of 5 OK created sql view model JAFFLE_SHOP.stg_orders ........................ [[32mSUCCESS 1[0m in 1.06s]
[0m13:38:09.158501 [debug] [Thread-2 (]: Finished running node model.jaffle_shop.stg_orders
[0m13:38:09.160380 [debug] [Thread-4 (]: Began running node model.jaffle_shop.customers
[0m13:38:09.161859 [debug] [Thread-1 (]: Began running node model.jaffle_shop.int_orders__pivoted
[0m13:38:09.163062 [info ] [Thread-4 (]: 4 of 5 START sql view model JAFFLE_SHOP.customers .............................. [RUN]
[0m13:38:09.164391 [info ] [Thread-1 (]: 5 of 5 START sql view model JAFFLE_SHOP.int_orders__pivoted .................... [RUN]
[0m13:38:09.166064 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.jaffle_shop.customers'
[0m13:38:09.167483 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.jaffle_shop.stg_customers, now model.jaffle_shop.int_orders__pivoted)
[0m13:38:09.168337 [debug] [Thread-4 (]: Began compiling node model.jaffle_shop.customers
[0m13:38:09.169105 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.int_orders__pivoted
[0m13:38:09.175554 [debug] [Thread-4 (]: Writing injected SQL for node "model.jaffle_shop.customers"
[0m13:38:09.181946 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.int_orders__pivoted"
[0m13:38:09.183217 [debug] [Thread-4 (]: Timing info for model.jaffle_shop.customers (compile): 13:38:09.169604 => 13:38:09.182852
[0m13:38:09.183991 [debug] [Thread-1 (]: Timing info for model.jaffle_shop.int_orders__pivoted (compile): 13:38:09.176187 => 13:38:09.183605
[0m13:38:09.184544 [debug] [Thread-4 (]: Began executing node model.jaffle_shop.customers
[0m13:38:09.185123 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.int_orders__pivoted
[0m13:38:09.192906 [debug] [Thread-4 (]: Writing runtime sql for node "model.jaffle_shop.customers"
[0m13:38:09.197616 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.int_orders__pivoted"
[0m13:38:09.200875 [debug] [Thread-4 (]: Using snowflake connection "model.jaffle_shop.customers"
[0m13:38:09.201759 [debug] [Thread-4 (]: On model.jaffle_shop.customers: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.customers"} */
create or replace   view RAW.JAFFLE_SHOP.customers
  
   as (
    


with customers as (

    select * from RAW.JAFFLE_SHOP.stg_customers

),

orders as (

    select * from RAW.JAFFLE_SHOP.stg_orders

),

customer_orders as (

    select
        customer_id,

        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders

    from orders

    group by 1

),

final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce(customer_orders.number_of_orders, 0) as number_of_orders

    from customers

    left join customer_orders using (customer_id)

)

select * from final
  );
[0m13:38:09.205509 [debug] [Thread-1 (]: Using snowflake connection "model.jaffle_shop.int_orders__pivoted"
[0m13:38:09.207194 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m13:38:09.208530 [debug] [Thread-1 (]: On model.jaffle_shop.int_orders__pivoted: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.int_orders__pivoted"} */
create or replace   view RAW.JAFFLE_SHOP.int_orders__pivoted
  
   as (
    



WITH payments AS (
    SELECT p.id AS id,
           p.order_id AS order_id,
           p.payment_method AS payment_method,
           p.amount_usd AS amount,
           o.status AS status
    FROM RAW.JAFFLE_SHOP.stg_payments p
    JOIN RAW.JAFFLE_SHOP.stg_orders o
    ON p.order_id = o.order_id
),
pivoted AS (
    SELECT
        order_id,
        SUM(CASE WHEN payment_method = 'bank_transfer' THEN amount ELSE 0 END) AS bank_transfer_amount,
        SUM(CASE WHEN payment_method = 'coupon' THEN amount ELSE 0 END) AS coupon_amount,
        SUM(CASE WHEN payment_method = 'credit_card' THEN amount ELSE 0 END) AS credit_card_amount,
        SUM(CASE WHEN payment_method = 'gift_card' THEN amount ELSE 0 END) AS gift_card_amount
    FROM payments
    WHERE status = 'completed'
    GROUP BY 1
)

SELECT * FROM pivoted
  );
[0m13:38:09.211660 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:38:09.886217 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m13:38:09.894514 [debug] [Thread-1 (]: Timing info for model.jaffle_shop.int_orders__pivoted (execute): 13:38:09.193709 => 13:38:09.893964
[0m13:38:09.903469 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m13:38:09.910117 [debug] [Thread-1 (]: On model.jaffle_shop.int_orders__pivoted: Close
[0m13:38:09.917797 [debug] [Thread-4 (]: Timing info for model.jaffle_shop.customers (execute): 13:38:09.185543 => 13:38:09.917030
[0m13:38:09.921935 [debug] [Thread-4 (]: On model.jaffle_shop.customers: Close
[0m13:38:10.057807 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '72a3bd10-02c4-412b-89ec-0dfe18223ac2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113fa8650>]}
[0m13:38:10.060540 [info ] [Thread-4 (]: 4 of 5 OK created sql view model JAFFLE_SHOP.customers ......................... [[32mSUCCESS 1[0m in 0.89s]
[0m13:38:10.063195 [debug] [Thread-4 (]: Finished running node model.jaffle_shop.customers
[0m13:38:10.070777 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '72a3bd10-02c4-412b-89ec-0dfe18223ac2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1142ec850>]}
[0m13:38:10.072220 [info ] [Thread-1 (]: 5 of 5 OK created sql view model JAFFLE_SHOP.int_orders__pivoted ............... [[32mSUCCESS 1[0m in 0.90s]
[0m13:38:10.073385 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.int_orders__pivoted
[0m13:38:10.077023 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:38:10.077895 [debug] [MainThread]: Connection 'model.jaffle_shop.int_orders__pivoted' was properly closed.
[0m13:38:10.078524 [debug] [MainThread]: Connection 'model.jaffle_shop.stg_orders' was properly closed.
[0m13:38:10.079033 [debug] [MainThread]: Connection 'model.jaffle_shop.stg_payments' was properly closed.
[0m13:38:10.079663 [debug] [MainThread]: Connection 'model.jaffle_shop.customers' was properly closed.
[0m13:38:10.080619 [info ] [MainThread]: 
[0m13:38:10.081427 [info ] [MainThread]: Finished running 5 view models in 0 hours 0 minutes and 3.57 seconds (3.57s).
[0m13:38:10.083422 [debug] [MainThread]: Command end result
[0m13:38:10.097942 [info ] [MainThread]: 
[0m13:38:10.098941 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:38:10.099609 [info ] [MainThread]: 
[0m13:38:10.100300 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m13:38:10.102162 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 4.648193, "process_user_time": 4.47435, "process_kernel_time": 0.432336, "process_mem_max_rss": "141418496", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m13:38:10.103037 [debug] [MainThread]: Command `dbt run` succeeded at 13:38:10.102830 after 4.65 seconds
[0m13:38:10.103651 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11349e890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1134d74d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f197c90>]}
[0m13:38:10.104291 [debug] [MainThread]: Flushing usage events
[0m14:20:36.996716 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c9e9d50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c9daf50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ca3bc50>]}


============================== 14:20:37.004891 | 6a14bdac-d39b-4a5c-93f2-28276800bba6 ==============================
[0m14:20:37.004891 [info ] [MainThread]: Running with dbt=1.8.7
[0m14:20:37.005805 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/Users/ben/.dbt', 'log_path': '/Users/ben/Dbt Certification/dbt-tutorial/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt debug', 'send_anonymous_usage_stats': 'True'}
[0m14:20:37.034467 [info ] [MainThread]: dbt version: 1.8.7
[0m14:20:37.035148 [info ] [MainThread]: python version: 3.11.0
[0m14:20:37.035537 [info ] [MainThread]: python path: /Users/ben/Dbt Certification/venv/bin/python
[0m14:20:37.035895 [info ] [MainThread]: os info: macOS-15.0.1-x86_64-i386-64bit
[0m14:20:37.317429 [info ] [MainThread]: Using profiles dir at /Users/ben/.dbt
[0m14:20:37.318244 [info ] [MainThread]: Using profiles.yml file at /Users/ben/.dbt/profiles.yml
[0m14:20:37.318698 [info ] [MainThread]: Using dbt_project.yml file at /Users/ben/Dbt Certification/dbt-tutorial/dbt_project.yml
[0m14:20:37.319317 [info ] [MainThread]: adapter type: snowflake
[0m14:20:37.319666 [info ] [MainThread]: adapter version: 1.8.3
[0m14:20:37.417521 [info ] [MainThread]: Configuration:
[0m14:20:37.418153 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m14:20:37.418580 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m14:20:37.418946 [info ] [MainThread]: Required dependencies:
[0m14:20:37.419397 [debug] [MainThread]: Executing "git --help"
[0m14:20:37.455759 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m14:20:37.456840 [debug] [MainThread]: STDERR: "b''"
[0m14:20:37.457324 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m14:20:37.457731 [info ] [MainThread]: Connection:
[0m14:20:37.458190 [info ] [MainThread]:   account: yifonrp-eda19207
[0m14:20:37.458512 [info ] [MainThread]:   user: dbt
[0m14:20:37.458826 [info ] [MainThread]:   database: RAW
[0m14:20:37.459138 [info ] [MainThread]:   warehouse: COMPUTE_WH
[0m14:20:37.459800 [info ] [MainThread]:   role: transform
[0m14:20:37.460148 [info ] [MainThread]:   schema: JAFFLE_SHOP
[0m14:20:37.460472 [info ] [MainThread]:   authenticator: None
[0m14:20:37.460785 [info ] [MainThread]:   oauth_client_id: None
[0m14:20:37.461090 [info ] [MainThread]:   query_tag: None
[0m14:20:37.461395 [info ] [MainThread]:   client_session_keep_alive: False
[0m14:20:37.461696 [info ] [MainThread]:   host: None
[0m14:20:37.461997 [info ] [MainThread]:   port: None
[0m14:20:37.462308 [info ] [MainThread]:   proxy_host: None
[0m14:20:37.462621 [info ] [MainThread]:   proxy_port: None
[0m14:20:37.462944 [info ] [MainThread]:   protocol: None
[0m14:20:37.463266 [info ] [MainThread]:   connect_retries: 1
[0m14:20:37.463586 [info ] [MainThread]:   connect_timeout: None
[0m14:20:37.463882 [info ] [MainThread]:   retry_on_database_errors: False
[0m14:20:37.464183 [info ] [MainThread]:   retry_all: False
[0m14:20:37.465093 [info ] [MainThread]:   insecure_mode: False
[0m14:20:37.465495 [info ] [MainThread]:   reuse_connections: None
[0m14:20:37.466645 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m14:20:37.492814 [debug] [MainThread]: Acquiring new snowflake connection 'debug'
[0m14:20:37.494537 [debug] [MainThread]: Using snowflake connection "debug"
[0m14:20:37.494985 [debug] [MainThread]: On debug: select 1 as id
[0m14:20:37.495370 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:20:38.392570 [debug] [MainThread]: Snowflake adapter: Error running SQL: select 1 as id
[0m14:20:38.393394 [debug] [MainThread]: Snowflake adapter: Rolling back transaction.
[0m14:20:38.394359 [debug] [MainThread]: On debug: No close available on handle
[0m14:20:38.395158 [info ] [MainThread]:   Connection test: [[31mERROR[0m]

[0m14:20:38.395808 [info ] [MainThread]: [31m1 check failed:[0m
[0m14:20:38.396544 [info ] [MainThread]: dbt was unable to connect to the specified database.
The database returned the following error:

  >Database Error
  250001 (08001): Failed to connect to DB: yifonrp-eda19207.snowflakecomputing.com:443. Your free trial has ended and all of your virtual warehouses have been suspended. Add billing information in the Snowflake web UI to continue using the full set of Snowflake features.

Check your database credentials and try again. For more information, visit:
https://docs.getdbt.com/docs/configure-your-profile


[0m14:20:38.414018 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_wall_clock_time": 1.5023036, "process_user_time": 1.782491, "process_kernel_time": 0.329826, "process_mem_max_rss": "120713216", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:20:38.415123 [debug] [MainThread]: Command `dbt debug` failed at 14:20:38.414840 after 1.50 seconds
[0m14:20:38.416093 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m14:20:38.417018 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ca2dfd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ca4e510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d751d90>]}
[0m14:20:38.417843 [debug] [MainThread]: Flushing usage events
[0m14:22:46.501731 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110eb96d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110e67010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110eb9050>]}


============================== 14:22:46.511730 | 2ec8c862-72c7-4612-8ca4-1d2f9f65e00c ==============================
[0m14:22:46.511730 [info ] [MainThread]: Running with dbt=1.8.7
[0m14:22:46.512520 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/ben/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/ben/Dbt Certification/dbt-tutorial/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt debug', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:22:46.536066 [info ] [MainThread]: dbt version: 1.8.7
[0m14:22:46.536836 [info ] [MainThread]: python version: 3.11.0
[0m14:22:46.537328 [info ] [MainThread]: python path: /Users/ben/Dbt Certification/venv/bin/python
[0m14:22:46.537713 [info ] [MainThread]: os info: macOS-15.0.1-x86_64-i386-64bit
[0m14:22:46.988633 [info ] [MainThread]: Using profiles dir at /Users/ben/.dbt
[0m14:22:46.989512 [info ] [MainThread]: Using profiles.yml file at /Users/ben/.dbt/profiles.yml
[0m14:22:46.989942 [info ] [MainThread]: Using dbt_project.yml file at /Users/ben/Dbt Certification/dbt-tutorial/dbt_project.yml
[0m14:22:46.990948 [info ] [MainThread]: adapter type: snowflake
[0m14:22:46.991384 [info ] [MainThread]: adapter version: 1.8.3
[0m14:22:47.089800 [info ] [MainThread]: Configuration:
[0m14:22:47.090440 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m14:22:47.090867 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m14:22:47.091234 [info ] [MainThread]: Required dependencies:
[0m14:22:47.091679 [debug] [MainThread]: Executing "git --help"
[0m14:22:47.126420 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m14:22:47.127455 [debug] [MainThread]: STDERR: "b''"
[0m14:22:47.127868 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m14:22:47.128364 [info ] [MainThread]: Connection:
[0m14:22:47.129228 [info ] [MainThread]:   account: QMOSCFC.CSA00550
[0m14:22:47.129740 [info ] [MainThread]:   user: DBT
[0m14:22:47.130215 [info ] [MainThread]:   database: ANALYTICS
[0m14:22:47.130736 [info ] [MainThread]:   warehouse: COMPUTE_WH
[0m14:22:47.131150 [info ] [MainThread]:   role: TRANSFORM
[0m14:22:47.131463 [info ] [MainThread]:   schema: JAFFLE_SHOP
[0m14:22:47.131848 [info ] [MainThread]:   authenticator: None
[0m14:22:47.132164 [info ] [MainThread]:   oauth_client_id: None
[0m14:22:47.132479 [info ] [MainThread]:   query_tag: None
[0m14:22:47.132794 [info ] [MainThread]:   client_session_keep_alive: False
[0m14:22:47.133385 [info ] [MainThread]:   host: None
[0m14:22:47.133857 [info ] [MainThread]:   port: None
[0m14:22:47.134247 [info ] [MainThread]:   proxy_host: None
[0m14:22:47.134593 [info ] [MainThread]:   proxy_port: None
[0m14:22:47.134981 [info ] [MainThread]:   protocol: None
[0m14:22:47.135348 [info ] [MainThread]:   connect_retries: 1
[0m14:22:47.135954 [info ] [MainThread]:   connect_timeout: None
[0m14:22:47.136349 [info ] [MainThread]:   retry_on_database_errors: False
[0m14:22:47.136691 [info ] [MainThread]:   retry_all: False
[0m14:22:47.137028 [info ] [MainThread]:   insecure_mode: False
[0m14:22:47.137605 [info ] [MainThread]:   reuse_connections: None
[0m14:22:47.138413 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m14:22:47.149871 [debug] [MainThread]: Acquiring new snowflake connection 'debug'
[0m14:22:47.151561 [debug] [MainThread]: Using snowflake connection "debug"
[0m14:22:47.151967 [debug] [MainThread]: On debug: select 1 as id
[0m14:22:47.152314 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:22:49.931371 [debug] [MainThread]: Snowflake adapter: Error running SQL: select 1 as id
[0m14:22:49.932177 [debug] [MainThread]: Snowflake adapter: Rolling back transaction.
[0m14:22:49.932801 [debug] [MainThread]: On debug: No close available on handle
[0m14:22:49.933422 [info ] [MainThread]:   Connection test: [[31mERROR[0m]

[0m14:22:49.934042 [info ] [MainThread]: [31m1 check failed:[0m
[0m14:22:49.934602 [info ] [MainThread]: dbt was unable to connect to the specified database.
The database returned the following error:

  >Database Error
  250001: Could not connect to Snowflake backend after 2 attempt(s).Aborting

Check your database credentials and try again. For more information, visit:
https://docs.getdbt.com/docs/configure-your-profile


[0m14:22:49.938216 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_wall_clock_time": 3.5166805, "process_user_time": 2.024591, "process_kernel_time": 0.483948, "process_mem_max_rss": "123715584", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:22:49.939240 [debug] [MainThread]: Command `dbt debug` failed at 14:22:49.939072 after 3.52 seconds
[0m14:22:49.939874 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m14:22:49.940457 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110eb9d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110ec0490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110e77190>]}
[0m14:22:49.941084 [debug] [MainThread]: Flushing usage events
[0m14:27:44.999416 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1049fbb90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104a68190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104a68ad0>]}


============================== 14:27:45.009066 | c2b485a0-9cab-4309-bad0-bff2091fbcbd ==============================
[0m14:27:45.009066 [info ] [MainThread]: Running with dbt=1.8.7
[0m14:27:45.009947 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/ben/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/ben/Dbt Certification/dbt-tutorial/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'invocation_command': 'dbt debug', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:27:45.037524 [info ] [MainThread]: dbt version: 1.8.7
[0m14:27:45.038223 [info ] [MainThread]: python version: 3.11.0
[0m14:27:45.038647 [info ] [MainThread]: python path: /Users/ben/Dbt Certification/venv/bin/python
[0m14:27:45.039117 [info ] [MainThread]: os info: macOS-15.0.1-x86_64-i386-64bit
[0m14:27:45.484138 [info ] [MainThread]: Using profiles dir at /Users/ben/.dbt
[0m14:27:45.484791 [info ] [MainThread]: Using profiles.yml file at /Users/ben/.dbt/profiles.yml
[0m14:27:45.485197 [info ] [MainThread]: Using dbt_project.yml file at /Users/ben/Dbt Certification/dbt-tutorial/dbt_project.yml
[0m14:27:45.486459 [info ] [MainThread]: adapter type: snowflake
[0m14:27:45.486993 [info ] [MainThread]: adapter version: 1.8.3
[0m14:27:45.593773 [info ] [MainThread]: Configuration:
[0m14:27:45.594456 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m14:27:45.594953 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m14:27:45.595303 [info ] [MainThread]: Required dependencies:
[0m14:27:45.595804 [debug] [MainThread]: Executing "git --help"
[0m14:27:45.633680 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m14:27:45.634787 [debug] [MainThread]: STDERR: "b''"
[0m14:27:45.635451 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m14:27:45.635942 [info ] [MainThread]: Connection:
[0m14:27:45.636501 [info ] [MainThread]:   account: qmoscfc-csa00550
[0m14:27:45.636888 [info ] [MainThread]:   user: DBT
[0m14:27:45.637408 [info ] [MainThread]:   database: ANALYTICS
[0m14:27:45.637763 [info ] [MainThread]:   warehouse: COMPUTE_WH
[0m14:27:45.638087 [info ] [MainThread]:   role: TRANSFORM
[0m14:27:45.638736 [info ] [MainThread]:   schema: JAFFLE_SHOP
[0m14:27:45.639177 [info ] [MainThread]:   authenticator: None
[0m14:27:45.639686 [info ] [MainThread]:   oauth_client_id: None
[0m14:27:45.640018 [info ] [MainThread]:   query_tag: None
[0m14:27:45.640600 [info ] [MainThread]:   client_session_keep_alive: False
[0m14:27:45.641105 [info ] [MainThread]:   host: None
[0m14:27:45.641508 [info ] [MainThread]:   port: None
[0m14:27:45.641864 [info ] [MainThread]:   proxy_host: None
[0m14:27:45.642267 [info ] [MainThread]:   proxy_port: None
[0m14:27:45.642897 [info ] [MainThread]:   protocol: None
[0m14:27:45.643410 [info ] [MainThread]:   connect_retries: 1
[0m14:27:45.643944 [info ] [MainThread]:   connect_timeout: None
[0m14:27:45.644565 [info ] [MainThread]:   retry_on_database_errors: False
[0m14:27:45.644961 [info ] [MainThread]:   retry_all: False
[0m14:27:45.645315 [info ] [MainThread]:   insecure_mode: False
[0m14:27:45.645664 [info ] [MainThread]:   reuse_connections: None
[0m14:27:45.646389 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m14:27:45.657182 [debug] [MainThread]: Acquiring new snowflake connection 'debug'
[0m14:27:45.659127 [debug] [MainThread]: Using snowflake connection "debug"
[0m14:27:45.659654 [debug] [MainThread]: On debug: select 1 as id
[0m14:27:45.660218 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:27:47.258665 [debug] [MainThread]: SQL status: SUCCESS 1 in 1.597 seconds
[0m14:27:47.262246 [debug] [MainThread]: On debug: Close
[0m14:27:47.423645 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m14:27:47.441851 [info ] [MainThread]: [32mAll checks passed![0m
[0m14:27:47.445509 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 2.5311728, "process_user_time": 1.979308, "process_kernel_time": 0.456416, "process_mem_max_rss": "121524224", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:27:47.446686 [debug] [MainThread]: Command `dbt debug` succeeded at 14:27:47.446536 after 2.53 seconds
[0m14:27:47.447413 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m14:27:47.448429 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104a6a810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103997d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x101515410>]}
[0m14:27:47.449246 [debug] [MainThread]: Flushing usage events
[0m14:28:55.435114 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11299c5d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112a0c950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112a0d290>]}


============================== 14:28:55.445151 | fc60d9bf-1086-406d-ba4c-f09eabb8aa8d ==============================
[0m14:28:55.445151 [info ] [MainThread]: Running with dbt=1.8.7
[0m14:28:55.445994 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/ben/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/ben/Dbt Certification/dbt-tutorial/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:28:56.003125 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fc60d9bf-1086-406d-ba4c-f09eabb8aa8d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1136be1d0>]}
[0m14:28:56.062236 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fc60d9bf-1086-406d-ba4c-f09eabb8aa8d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11244eb90>]}
[0m14:28:56.063941 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m14:28:56.075525 [error] [MainThread]: Encountered an error:
Compilation Error
  dbt found 1 package(s) specified in packages.yml, but only 0 package(s) installed in dbt_packages. Run "dbt deps" to install package dependencies.
[0m14:28:56.079301 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.7309153, "process_user_time": 1.740697, "process_kernel_time": 0.396948, "process_mem_max_rss": "111808512", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:28:56.080174 [debug] [MainThread]: Command `dbt run` failed at 14:28:56.080032 after 0.73 seconds
[0m14:28:56.080911 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112642a50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f3d4a50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113668cd0>]}
[0m14:28:56.081673 [debug] [MainThread]: Flushing usage events
[0m14:29:08.159974 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10586da90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1058ae910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1058bbfd0>]}


============================== 14:29:08.166362 | ffdc79a9-1b96-4967-a6d0-f0380502963e ==============================
[0m14:29:08.166362 [info ] [MainThread]: Running with dbt=1.8.7
[0m14:29:08.167138 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/Users/ben/.dbt', 'log_path': '/Users/ben/Dbt Certification/dbt-tutorial/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'invocation_command': 'dbt deps', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:29:08.284469 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ffdc79a9-1b96-4967-a6d0-f0380502963e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105913cd0>]}
[0m14:29:08.326552 [debug] [MainThread]: Set downloads directory='/var/folders/r5/kwzghqz92v73843mkcq0vhp40000gn/T/dbt-downloads-fukrk27z'
[0m14:29:08.327084 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m14:29:08.494700 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m14:29:08.496780 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m14:29:08.607965 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m14:29:08.616168 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m14:29:09.059770 [info ] [MainThread]: Installed from version 1.1.1
[0m14:29:09.060554 [info ] [MainThread]: Updated version available: 1.3.0
[0m14:29:09.061362 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'ffdc79a9-1b96-4967-a6d0-f0380502963e', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1044d8b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1044dac90>]}
[0m14:29:09.062354 [info ] [MainThread]: 
[0m14:29:09.063134 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m14:29:09.067036 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.9856244, "process_user_time": 1.499422, "process_kernel_time": 0.290385, "process_mem_max_rss": "97234944", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:29:09.068301 [debug] [MainThread]: Command `dbt deps` succeeded at 14:29:09.068040 after 0.99 seconds
[0m14:29:09.069232 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10234d310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10229c250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10229cb50>]}
[0m14:29:09.070108 [debug] [MainThread]: Flushing usage events
[0m14:29:35.166652 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d9cf7d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10da1e050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10da39050>]}


============================== 14:29:35.176326 | e510897f-7847-4194-a50a-43f7c94290ed ==============================
[0m14:29:35.176326 [info ] [MainThread]: Running with dbt=1.8.7
[0m14:29:35.177156 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/ben/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/Users/ben/Dbt Certification/dbt-tutorial/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt deps', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:29:35.293670 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e510897f-7847-4194-a50a-43f7c94290ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d9dc410>]}
[0m14:29:35.325692 [debug] [MainThread]: Set downloads directory='/var/folders/r5/kwzghqz92v73843mkcq0vhp40000gn/T/dbt-downloads-4tu8o9l0'
[0m14:29:35.326277 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m14:29:35.450720 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m14:29:35.452754 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m14:29:35.572169 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m14:29:35.595911 [info ] [MainThread]: Updating lock file in file path: /Users/ben/Dbt Certification/dbt-tutorial/package-lock.yml
[0m14:29:35.630273 [debug] [MainThread]: Set downloads directory='/var/folders/r5/kwzghqz92v73843mkcq0vhp40000gn/T/dbt-downloads-k8d1h8vi'
[0m14:29:35.634094 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m14:29:35.963339 [info ] [MainThread]: Installed from version 1.3.0
[0m14:29:35.964144 [info ] [MainThread]: Up to date!
[0m14:29:35.964858 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'e510897f-7847-4194-a50a-43f7c94290ed', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10da61b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dbac1d0>]}
[0m14:29:35.969235 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.8860463, "process_user_time": 1.566673, "process_kernel_time": 0.448986, "process_mem_max_rss": "96317440", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:29:35.970405 [debug] [MainThread]: Command `dbt deps` succeeded at 14:29:35.970187 after 0.89 seconds
[0m14:29:35.971208 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10da3a850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a4e9410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a438350>]}
[0m14:29:35.971986 [debug] [MainThread]: Flushing usage events
[0m14:29:43.246455 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fe87ad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fee7910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fefd490>]}


============================== 14:29:43.253323 | 1733190f-19a4-4420-8075-07abf9dc42a4 ==============================
[0m14:29:43.253323 [info ] [MainThread]: Running with dbt=1.8.7
[0m14:29:43.254074 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/ben/Dbt Certification/dbt-tutorial/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/ben/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:29:43.794424 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1733190f-19a4-4420-8075-07abf9dc42a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110b93510>]}
[0m14:29:43.857096 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1733190f-19a4-4420-8075-07abf9dc42a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f93ec90>]}
[0m14:29:43.859909 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m14:29:43.890269 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m14:29:44.003753 [debug] [MainThread]: Failed to load parsed file from disk at /Users/ben/Dbt Certification/dbt-tutorial/target/partial_parse.msgpack: Field "flat_graph" of type Dict[str, Any] in Manifest has invalid value None
[0m14:29:44.005151 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '1733190f-19a4-4420-8075-07abf9dc42a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10eb24790>]}
[0m14:29:45.525165 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m14:29:45.525848 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '1733190f-19a4-4420-8075-07abf9dc42a4', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1110f9490>]}
[0m14:29:45.737861 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1733190f-19a4-4420-8075-07abf9dc42a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1111a1610>]}
[0m14:29:45.844415 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1733190f-19a4-4420-8075-07abf9dc42a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111365f50>]}
[0m14:29:45.844986 [info ] [MainThread]: Found 7 models, 3 seeds, 11 data tests, 572 macros
[0m14:29:45.845432 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1733190f-19a4-4420-8075-07abf9dc42a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1111d78d0>]}
[0m14:29:45.847564 [info ] [MainThread]: 
[0m14:29:45.848196 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:29:45.852864 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ANALYTICS'
[0m14:29:45.863471 [debug] [ThreadPool]: Using snowflake connection "list_ANALYTICS"
[0m14:29:45.864201 [debug] [ThreadPool]: On list_ANALYTICS: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_ANALYTICS"} */
show terse schemas in database ANALYTICS
    limit 10000
[0m14:29:45.864726 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:29:46.686416 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01b7b635-0000-862e-002a-090300026102
[0m14:29:46.687280 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m14:29:46.688217 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_schemas
[0m14:29:46.689237 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m14:29:46.690218 [debug] [ThreadPool]: On list_ANALYTICS: Close
[0m14:29:46.830243 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:29:46.831478 [debug] [MainThread]: Connection 'list_ANALYTICS' was properly closed.
[0m14:29:46.832509 [info ] [MainThread]: 
[0m14:29:46.833615 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.98 seconds (0.98s).
[0m14:29:46.834857 [error] [MainThread]: Encountered an error:
Runtime Error
  Database error while listing schemas in database "ANALYTICS"
  Database Error
    002043 (02000): SQL compilation error:
    Object does not exist, or operation cannot be performed.
[0m14:29:46.837740 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 3.6685784, "process_user_time": 3.683739, "process_kernel_time": 0.381693, "process_mem_max_rss": "134283264", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:29:46.839126 [debug] [MainThread]: Command `dbt run` failed at 14:29:46.838875 after 3.67 seconds
[0m14:29:46.840324 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c8c8390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111363790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111342510>]}
[0m14:29:46.841174 [debug] [MainThread]: Flushing usage events
[0m14:34:29.890732 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f73e90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104fe4410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104fe4d50>]}


============================== 14:34:29.900339 | 3fe52a55-803c-4697-9af9-603bd39c7bf5 ==============================
[0m14:34:29.900339 [info ] [MainThread]: Running with dbt=1.8.7
[0m14:34:29.901125 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/ben/Dbt Certification/dbt-tutorial/logs', 'profiles_dir': '/Users/ben/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:34:30.472929 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3fe52a55-803c-4697-9af9-603bd39c7bf5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105c34110>]}
[0m14:34:30.529117 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3fe52a55-803c-4697-9af9-603bd39c7bf5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104a3aad0>]}
[0m14:34:30.531593 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m14:34:30.562748 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m14:34:30.768832 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:34:30.769379 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:34:30.819487 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3fe52a55-803c-4697-9af9-603bd39c7bf5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e40690>]}
[0m14:34:30.939288 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3fe52a55-803c-4697-9af9-603bd39c7bf5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105fbaf10>]}
[0m14:34:30.939875 [info ] [MainThread]: Found 7 models, 3 seeds, 11 data tests, 572 macros
[0m14:34:30.940380 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3fe52a55-803c-4697-9af9-603bd39c7bf5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e6e090>]}
[0m14:34:30.942560 [info ] [MainThread]: 
[0m14:34:30.943228 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:34:30.948105 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ANALYTICS'
[0m14:34:30.966422 [debug] [ThreadPool]: Using snowflake connection "list_ANALYTICS"
[0m14:34:30.967457 [debug] [ThreadPool]: On list_ANALYTICS: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_ANALYTICS"} */
show terse schemas in database ANALYTICS
    limit 10000
[0m14:34:30.968004 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:34:31.939557 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.971 seconds
[0m14:34:31.944331 [debug] [ThreadPool]: On list_ANALYTICS: Close
[0m14:34:32.148084 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ANALYTICS, now create_ANALYTICS_JAFFLE_SHOP)
[0m14:34:32.149780 [debug] [ThreadPool]: Creating schema "database: "ANALYTICS"
schema: "JAFFLE_SHOP"
"
[0m14:34:32.160531 [debug] [ThreadPool]: Using snowflake connection "create_ANALYTICS_JAFFLE_SHOP"
[0m14:34:32.161337 [debug] [ThreadPool]: On create_ANALYTICS_JAFFLE_SHOP: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "create_ANALYTICS_JAFFLE_SHOP"} */
create schema if not exists ANALYTICS.JAFFLE_SHOP
[0m14:34:32.162196 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:34:32.924788 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.763 seconds
[0m14:34:32.926376 [debug] [ThreadPool]: On create_ANALYTICS_JAFFLE_SHOP: Close
[0m14:34:33.273638 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_ANALYTICS_JAFFLE_SHOP, now list_ANALYTICS_JAFFLE_SHOP)
[0m14:34:33.291150 [debug] [ThreadPool]: Using snowflake connection "list_ANALYTICS_JAFFLE_SHOP"
[0m14:34:33.291852 [debug] [ThreadPool]: On list_ANALYTICS_JAFFLE_SHOP: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_ANALYTICS_JAFFLE_SHOP"} */
show objects in ANALYTICS.JAFFLE_SHOP limit 10000
[0m14:34:33.292420 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:34:34.083057 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.790 seconds
[0m14:34:34.087353 [debug] [ThreadPool]: On list_ANALYTICS_JAFFLE_SHOP: Close
[0m14:34:34.231189 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3fe52a55-803c-4697-9af9-603bd39c7bf5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105eb0ad0>]}
[0m14:34:34.233000 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:34:34.234142 [info ] [MainThread]: 
[0m14:34:34.241218 [debug] [Thread-1 (]: Began running node model.jaffle_shop.customer_orders
[0m14:34:34.242634 [debug] [Thread-2 (]: Began running node model.jaffle_shop.int_orders_test
[0m14:34:34.243481 [debug] [Thread-3 (]: Began running node model.jaffle_shop.stg_customers
[0m14:34:34.244308 [debug] [Thread-4 (]: Began running node model.jaffle_shop.stg_orders
[0m14:34:34.245463 [info ] [Thread-1 (]: 1 of 7 START sql table model JAFFLE_SHOP.customer_orders ....................... [RUN]
[0m14:34:34.247008 [info ] [Thread-2 (]: 2 of 7 START sql view model JAFFLE_SHOP.int_orders_test ........................ [RUN]
[0m14:34:34.248436 [info ] [Thread-3 (]: 3 of 7 START sql view model JAFFLE_SHOP.stg_customers .......................... [RUN]
[0m14:34:34.249604 [info ] [Thread-4 (]: 4 of 7 START sql view model JAFFLE_SHOP.stg_orders ............................. [RUN]
[0m14:34:34.250651 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_ANALYTICS_JAFFLE_SHOP, now model.jaffle_shop.customer_orders)
[0m14:34:34.251579 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.jaffle_shop.int_orders_test'
[0m14:34:34.253044 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.jaffle_shop.stg_customers'
[0m14:34:34.253910 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.jaffle_shop.stg_orders'
[0m14:34:34.254522 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.customer_orders
[0m14:34:34.255081 [debug] [Thread-2 (]: Began compiling node model.jaffle_shop.int_orders_test
[0m14:34:34.255635 [debug] [Thread-3 (]: Began compiling node model.jaffle_shop.stg_customers
[0m14:34:34.256343 [debug] [Thread-4 (]: Began compiling node model.jaffle_shop.stg_orders
[0m14:34:34.265921 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.customer_orders"
[0m14:34:34.276040 [debug] [Thread-3 (]: Writing injected SQL for node "model.jaffle_shop.stg_customers"
[0m14:34:34.284724 [debug] [Thread-2 (]: Using snowflake connection "model.jaffle_shop.int_orders_test"
[0m14:34:34.287623 [debug] [Thread-4 (]: Writing injected SQL for node "model.jaffle_shop.stg_orders"
[0m14:34:34.288764 [debug] [Thread-2 (]: On model.jaffle_shop.int_orders_test: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.int_orders_test"} */
select datediff(
        day,
        cast('2023-01-01' as date),
        cast('2024-01-01' as date)
        )
[0m14:34:34.289929 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m14:34:34.291771 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.customer_orders
[0m14:34:34.292356 [debug] [Thread-4 (]: Began executing node model.jaffle_shop.stg_orders
[0m14:34:34.292728 [debug] [Thread-3 (]: Began executing node model.jaffle_shop.stg_customers
[0m14:34:34.345458 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.customer_orders"
[0m14:34:34.350284 [debug] [Thread-4 (]: Writing runtime sql for node "model.jaffle_shop.stg_orders"
[0m14:34:34.353458 [debug] [Thread-3 (]: Writing runtime sql for node "model.jaffle_shop.stg_customers"
[0m14:34:34.357291 [debug] [Thread-1 (]: Using snowflake connection "model.jaffle_shop.customer_orders"
[0m14:34:34.357897 [debug] [Thread-1 (]: On model.jaffle_shop.customer_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.customer_orders"} */
create or replace transient table ANALYTICS.JAFFLE_SHOP.customer_orders
         as
        (WITH paid_orders as (select Orders.ID as order_id,
    Orders.USER_ID	as customer_id,
    Orders.ORDER_DATE AS order_placed_at,
        Orders.STATUS AS order_status,
    p.total_amount_paid,
    p.payment_finalized_date,
    C.FIRST_NAME    as customer_first_name,
        C.LAST_NAME as customer_last_name
FROM raw.jaffle_shop.orders as Orders
left join (select ORDERID as order_id, max(CREATED) as payment_finalized_date, sum(AMOUNT) / 100.0 as total_amount_paid
        from raw.stripe.payment
        where STATUS <> 'fail'
        group by 1) p ON orders.ID = p.order_id
left join raw.jaffle_shop.customers C on orders.USER_ID = C.ID ),

customer_orders 
as (select C.ID as customer_id
    , min(ORDER_DATE) as first_order_date
    , max(ORDER_DATE) as most_recent_order_date
    , count(ORDERS.ID) AS number_of_orders
from raw.jaffle_shop.customers C 
left join raw.jaffle_shop.orders as Orders
on orders.USER_ID = C.ID 
group by 1)

select
p.*,
ROW_NUMBER() OVER (ORDER BY p.order_id) as transaction_seq,
ROW_NUMBER() OVER (PARTITION BY customer_id ORDER BY p.order_id) as customer_sales_seq,
CASE WHEN c.first_order_date = p.order_placed_at
THEN 'new'
ELSE 'return' END as nvsr,
x.clv_bad as customer_lifetime_value,
c.first_order_date as fdos
FROM paid_orders p
left join customer_orders as c USING (customer_id)
LEFT OUTER JOIN 
(
        select
        p.order_id,
        sum(t2.total_amount_paid) as clv_bad
    from paid_orders p
    left join paid_orders t2 on p.customer_id = t2.customer_id and p.order_id >= t2.order_id
    group by 1
    order by p.order_id
) x on x.order_id = p.order_id
ORDER BY order_id
        );
[0m14:34:34.358409 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:34:34.360609 [debug] [Thread-3 (]: Using snowflake connection "model.jaffle_shop.stg_customers"
[0m14:34:34.361579 [debug] [Thread-4 (]: Using snowflake connection "model.jaffle_shop.stg_orders"
[0m14:34:34.362053 [debug] [Thread-3 (]: On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */
create or replace   view ANALYTICS.JAFFLE_SHOP.stg_customers
  
   as (
    -- noinspection SqlNoDataSourceInspectionForFile



select
    id as customer_id,
    first_name,
    last_name

from raw.jaffle_shop.raw_customers
  );
[0m14:34:34.362829 [debug] [Thread-4 (]: On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */
create or replace   view ANALYTICS.JAFFLE_SHOP.stg_orders
  
   as (
    

select
    id as order_id,
    user_id as customer_id,
    order_date,
    status

from raw.jaffle_shop.raw_orders
  );
[0m14:34:34.363953 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m14:34:34.364423 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m14:34:34.934162 [debug] [Thread-4 (]: Snowflake adapter: Snowflake query id: 01b7b63a-0000-862e-002a-09030002614a
[0m14:34:34.934681 [debug] [Thread-4 (]: Snowflake adapter: Snowflake error: 002003 (02000): SQL compilation error:
Database 'RAW' does not exist or not authorized.
[0m14:34:34.935215 [debug] [Thread-4 (]: On model.jaffle_shop.stg_orders: Close
[0m14:34:35.002387 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b7b63a-0000-864f-002a-09030002904a
[0m14:34:35.004270 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 002003 (02000): SQL compilation error:
Database 'RAW' does not exist or not authorized.
[0m14:34:35.006871 [debug] [Thread-1 (]: On model.jaffle_shop.customer_orders: Close
[0m14:34:35.081838 [debug] [Thread-4 (]: Database Error in model stg_orders (models/staging/stg_orders.sql)
  002003 (02000): SQL compilation error:
  Database 'RAW' does not exist or not authorized.
  compiled code at target/run/jaffle_shop/models/staging/stg_orders.sql
[0m14:34:35.084051 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3fe52a55-803c-4697-9af9-603bd39c7bf5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1060089d0>]}
[0m14:34:35.084989 [error] [Thread-4 (]: 4 of 7 ERROR creating sql view model JAFFLE_SHOP.stg_orders .................... [[31mERROR[0m in 0.83s]
[0m14:34:35.085886 [debug] [Thread-4 (]: Finished running node model.jaffle_shop.stg_orders
[0m14:34:35.086542 [debug] [Thread-4 (]: Began running node model.jaffle_shop.stg_payments
[0m14:34:35.088080 [info ] [Thread-4 (]: 5 of 7 START sql view model JAFFLE_SHOP.stg_payments ........................... [RUN]
[0m14:34:35.088770 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.jaffle_shop.stg_orders, now model.jaffle_shop.stg_payments)
[0m14:34:35.089292 [debug] [Thread-4 (]: Began compiling node model.jaffle_shop.stg_payments
[0m14:34:35.094734 [debug] [Thread-4 (]: Writing injected SQL for node "model.jaffle_shop.stg_payments"
[0m14:34:35.095644 [debug] [Thread-4 (]: Began executing node model.jaffle_shop.stg_payments
[0m14:34:35.099802 [debug] [Thread-4 (]: Writing runtime sql for node "model.jaffle_shop.stg_payments"
[0m14:34:35.101170 [debug] [Thread-4 (]: Using snowflake connection "model.jaffle_shop.stg_payments"
[0m14:34:35.102532 [debug] [Thread-4 (]: On model.jaffle_shop.stg_payments: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_payments"} */
create or replace   view ANALYTICS.JAFFLE_SHOP.stg_payments
  
   as (
    

select
    id,
    order_id,
    payment_method,
    round(1.0 * amount / 100, 2) AS amount_usd

from raw.jaffle_shop.raw_payments
  );
[0m14:34:35.103131 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:34:35.105146 [debug] [Thread-3 (]: Snowflake adapter: Snowflake query id: 01b7b63a-0000-8600-002a-0903000270de
[0m14:34:35.106276 [debug] [Thread-3 (]: Snowflake adapter: Snowflake error: 002003 (02000): SQL compilation error:
Database 'RAW' does not exist or not authorized.
[0m14:34:35.107803 [debug] [Thread-3 (]: On model.jaffle_shop.stg_customers: Close
[0m14:34:35.189351 [debug] [Thread-1 (]: Database Error in model customer_orders (models/customer_orders.sql)
  002003 (02000): SQL compilation error:
  Database 'RAW' does not exist or not authorized.
  compiled code at target/run/jaffle_shop/models/customer_orders.sql
[0m14:34:35.190263 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3fe52a55-803c-4697-9af9-603bd39c7bf5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10641fdd0>]}
[0m14:34:35.191357 [error] [Thread-1 (]: 1 of 7 ERROR creating sql table model JAFFLE_SHOP.customer_orders .............. [[31mERROR[0m in 0.94s]
[0m14:34:35.192318 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.customer_orders
[0m14:34:35.269450 [debug] [Thread-3 (]: Database Error in model stg_customers (models/staging/stg_customers.sql)
  002003 (02000): SQL compilation error:
  Database 'RAW' does not exist or not authorized.
  compiled code at target/run/jaffle_shop/models/staging/stg_customers.sql
[0m14:34:35.270743 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3fe52a55-803c-4697-9af9-603bd39c7bf5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ad7190>]}
[0m14:34:35.272279 [error] [Thread-3 (]: 3 of 7 ERROR creating sql view model JAFFLE_SHOP.stg_customers ................. [[31mERROR[0m in 1.02s]
[0m14:34:35.274309 [debug] [Thread-3 (]: Finished running node model.jaffle_shop.stg_customers
[0m14:34:35.275967 [debug] [Thread-1 (]: Began running node model.jaffle_shop.customers
[0m14:34:35.276901 [info ] [Thread-1 (]: 6 of 7 SKIP relation JAFFLE_SHOP.customers ..................................... [[33mSKIP[0m]
[0m14:34:35.278549 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.customers
[0m14:34:35.409675 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.120 seconds
[0m14:34:35.434397 [debug] [Thread-2 (]: Writing injected SQL for node "model.jaffle_shop.int_orders_test"
[0m14:34:35.435808 [debug] [Thread-2 (]: Began executing node model.jaffle_shop.int_orders_test
[0m14:34:35.440631 [debug] [Thread-2 (]: Writing runtime sql for node "model.jaffle_shop.int_orders_test"
[0m14:34:35.446451 [debug] [Thread-2 (]: Using snowflake connection "model.jaffle_shop.int_orders_test"
[0m14:34:35.447477 [debug] [Thread-2 (]: On model.jaffle_shop.int_orders_test: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.int_orders_test"} */
create or replace   view ANALYTICS.JAFFLE_SHOP.int_orders_test
  
   as (
    







with rawdata as (

    

    

    with p as (
        select 0 as generated_number union all select 1
    ), unioned as (

    select

    
    p0.generated_number * power(2, 0)
     + 
    
    p1.generated_number * power(2, 1)
     + 
    
    p2.generated_number * power(2, 2)
     + 
    
    p3.generated_number * power(2, 3)
     + 
    
    p4.generated_number * power(2, 4)
     + 
    
    p5.generated_number * power(2, 5)
     + 
    
    p6.generated_number * power(2, 6)
     + 
    
    p7.generated_number * power(2, 7)
     + 
    
    p8.generated_number * power(2, 8)
    
    
    + 1
    as generated_number

    from

    
    p as p0
     cross join 
    
    p as p1
     cross join 
    
    p as p2
     cross join 
    
    p as p3
     cross join 
    
    p as p4
     cross join 
    
    p as p5
     cross join 
    
    p as p6
     cross join 
    
    p as p7
     cross join 
    
    p as p8
    
    

    )

    select *
    from unioned
    where generated_number <= 365
    order by generated_number



),

all_periods as (

    select (
        

    dateadd(
        day,
        row_number() over (order by 1) - 1,
        cast('2023-01-01' as date)
        )


    ) as date_day
    from rawdata

),

filtered as (

    select *
    from all_periods
    where date_day <= cast('2024-01-01' as date)

)

select * from filtered


  );
[0m14:34:35.577922 [debug] [Thread-4 (]: Snowflake adapter: Snowflake query id: 01b7b63a-0000-854a-002a-09030001e142
[0m14:34:35.579284 [debug] [Thread-4 (]: Snowflake adapter: Snowflake error: 002003 (02000): SQL compilation error:
Database 'RAW' does not exist or not authorized.
[0m14:34:35.580766 [debug] [Thread-4 (]: On model.jaffle_shop.stg_payments: Close
[0m14:34:35.728564 [debug] [Thread-4 (]: Database Error in model stg_payments (models/staging/stg_payments.sql)
  002003 (02000): SQL compilation error:
  Database 'RAW' does not exist or not authorized.
  compiled code at target/run/jaffle_shop/models/staging/stg_payments.sql
[0m14:34:35.729843 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3fe52a55-803c-4697-9af9-603bd39c7bf5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103c4ec90>]}
[0m14:34:35.731256 [error] [Thread-4 (]: 5 of 7 ERROR creating sql view model JAFFLE_SHOP.stg_payments .................. [[31mERROR[0m in 0.64s]
[0m14:34:35.732564 [debug] [Thread-4 (]: Finished running node model.jaffle_shop.stg_payments
[0m14:34:35.734002 [debug] [Thread-3 (]: Began running node model.jaffle_shop.int_orders__pivoted
[0m14:34:35.734944 [info ] [Thread-3 (]: 7 of 7 SKIP relation JAFFLE_SHOP.int_orders__pivoted ........................... [[33mSKIP[0m]
[0m14:34:35.735990 [debug] [Thread-3 (]: Finished running node model.jaffle_shop.int_orders__pivoted
[0m14:34:36.114382 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.665 seconds
[0m14:34:36.150857 [debug] [Thread-2 (]: On model.jaffle_shop.int_orders_test: Close
[0m14:34:36.287683 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3fe52a55-803c-4697-9af9-603bd39c7bf5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1062e5190>]}
[0m14:34:36.289651 [info ] [Thread-2 (]: 2 of 7 OK created sql view model JAFFLE_SHOP.int_orders_test ................... [[32mSUCCESS 1[0m in 2.04s]
[0m14:34:36.291430 [debug] [Thread-2 (]: Finished running node model.jaffle_shop.int_orders_test
[0m14:34:36.294667 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:34:36.295499 [debug] [MainThread]: Connection 'model.jaffle_shop.customer_orders' was properly closed.
[0m14:34:36.296233 [debug] [MainThread]: Connection 'model.jaffle_shop.int_orders_test' was properly closed.
[0m14:34:36.296922 [debug] [MainThread]: Connection 'model.jaffle_shop.stg_customers' was properly closed.
[0m14:34:36.297615 [debug] [MainThread]: Connection 'model.jaffle_shop.stg_payments' was properly closed.
[0m14:34:36.298701 [info ] [MainThread]: 
[0m14:34:36.299858 [info ] [MainThread]: Finished running 6 view models, 1 table model in 0 hours 0 minutes and 5.36 seconds (5.36s).
[0m14:34:36.302472 [debug] [MainThread]: Command end result
[0m14:34:36.346317 [info ] [MainThread]: 
[0m14:34:36.347049 [info ] [MainThread]: [31mCompleted with 4 errors and 0 warnings:[0m
[0m14:34:36.347509 [info ] [MainThread]: 
[0m14:34:36.348042 [error] [MainThread]:   Database Error in model stg_orders (models/staging/stg_orders.sql)
  002003 (02000): SQL compilation error:
  Database 'RAW' does not exist or not authorized.
  compiled code at target/run/jaffle_shop/models/staging/stg_orders.sql
[0m14:34:36.348566 [info ] [MainThread]: 
[0m14:34:36.349168 [error] [MainThread]:   Database Error in model customer_orders (models/customer_orders.sql)
  002003 (02000): SQL compilation error:
  Database 'RAW' does not exist or not authorized.
  compiled code at target/run/jaffle_shop/models/customer_orders.sql
[0m14:34:36.349835 [info ] [MainThread]: 
[0m14:34:36.350280 [error] [MainThread]:   Database Error in model stg_customers (models/staging/stg_customers.sql)
  002003 (02000): SQL compilation error:
  Database 'RAW' does not exist or not authorized.
  compiled code at target/run/jaffle_shop/models/staging/stg_customers.sql
[0m14:34:36.350625 [info ] [MainThread]: 
[0m14:34:36.351044 [error] [MainThread]:   Database Error in model stg_payments (models/staging/stg_payments.sql)
  002003 (02000): SQL compilation error:
  Database 'RAW' does not exist or not authorized.
  compiled code at target/run/jaffle_shop/models/staging/stg_payments.sql
[0m14:34:36.351388 [info ] [MainThread]: 
[0m14:34:36.351745 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=4 SKIP=2 TOTAL=7
[0m14:34:36.354004 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 6.5583963, "process_user_time": 3.046428, "process_kernel_time": 0.586277, "process_mem_max_rss": "130318336", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:34:36.354637 [debug] [MainThread]: Command `dbt run` failed at 14:34:36.354532 after 6.56 seconds
[0m14:34:36.355097 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104fc2390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104fe69d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x101a14350>]}
[0m14:34:36.355490 [debug] [MainThread]: Flushing usage events
[0m14:35:40.449989 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1098a2e90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1098ffe10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1098fffd0>]}


============================== 14:35:40.459301 | e2e8e4c4-2b34-4be7-8146-4214fffa108d ==============================
[0m14:35:40.459301 [info ] [MainThread]: Running with dbt=1.8.7
[0m14:35:40.460193 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/ben/Dbt Certification/dbt-tutorial/logs', 'profiles_dir': '/Users/ben/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt clean', 'send_anonymous_usage_stats': 'True'}
[0m14:35:40.574349 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e2e8e4c4-2b34-4be7-8146-4214fffa108d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1097cdd90>]}
[0m14:35:40.649492 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.2833204, "process_user_time": 1.464816, "process_kernel_time": 0.352285, "process_mem_max_rss": "93253632", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:35:40.650474 [debug] [MainThread]: Command `dbt clean` succeeded at 14:35:40.650312 after 0.28 seconds
[0m14:35:40.651072 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1098d7b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1098b2f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1098f5990>]}
[0m14:35:40.651586 [debug] [MainThread]: Flushing usage events
[0m14:35:47.987714 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e13750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e84ad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e85390>]}


============================== 14:35:47.994960 | 9ec3b48f-f668-48d9-88bc-ce53e3f10d70 ==============================
[0m14:35:47.994960 [info ] [MainThread]: Running with dbt=1.8.7
[0m14:35:47.995719 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/ben/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/ben/Dbt Certification/dbt-tutorial/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m14:35:48.532934 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9ec3b48f-f668-48d9-88bc-ce53e3f10d70', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104abe1d0>]}
[0m14:35:48.586431 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9ec3b48f-f668-48d9-88bc-ce53e3f10d70', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1048ca9d0>]}
[0m14:35:48.588699 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m14:35:48.603214 [error] [MainThread]: Encountered an error:
Compilation Error
  dbt found 1 package(s) specified in packages.yml, but only 0 package(s) installed in dbt_packages. Run "dbt deps" to install package dependencies.
[0m14:35:48.605234 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.6915436, "process_user_time": 1.597704, "process_kernel_time": 0.274349, "process_mem_max_rss": "112848896", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:35:48.606027 [debug] [MainThread]: Command `dbt run` failed at 14:35:48.605889 after 0.69 seconds
[0m14:35:48.606665 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e63810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104abe410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105c01390>]}
[0m14:35:48.607236 [debug] [MainThread]: Flushing usage events
[0m14:35:57.003724 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c20fe50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c23fc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c267910>]}


============================== 14:35:57.010092 | fae2327d-49c8-4f06-b2fb-d17259578a0e ==============================
[0m14:35:57.010092 [info ] [MainThread]: Running with dbt=1.8.7
[0m14:35:57.010844 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/ben/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/ben/Dbt Certification/dbt-tutorial/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt deps', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:35:57.128856 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fae2327d-49c8-4f06-b2fb-d17259578a0e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c3518d0>]}
[0m14:35:57.151422 [debug] [MainThread]: Set downloads directory='/var/folders/r5/kwzghqz92v73843mkcq0vhp40000gn/T/dbt-downloads-bs85e5iq'
[0m14:35:57.151907 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m14:35:57.354550 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m14:35:57.356863 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m14:35:57.468096 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m14:35:57.479509 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m14:35:57.841820 [info ] [MainThread]: Installed from version 1.3.0
[0m14:35:57.843366 [info ] [MainThread]: Up to date!
[0m14:35:57.844245 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'fae2327d-49c8-4f06-b2fb-d17259578a0e', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ae8d2d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ae8ad50>]}
[0m14:35:57.847819 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.9176198, "process_user_time": 1.43439, "process_kernel_time": 0.260136, "process_mem_max_rss": "96722944", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:35:57.849096 [debug] [MainThread]: Command `dbt deps` succeeded at 14:35:57.848843 after 0.92 seconds
[0m14:35:57.849972 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c2ede10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d01390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c50390>]}
[0m14:35:57.850780 [debug] [MainThread]: Flushing usage events
[0m14:36:03.906680 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10adc3050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ae1fed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ae39650>]}


============================== 14:36:03.913942 | 6b64b61a-3573-4109-a98c-bcd6d81a4d6c ==============================
[0m14:36:03.913942 [info ] [MainThread]: Running with dbt=1.8.7
[0m14:36:03.915020 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/ben/Dbt Certification/dbt-tutorial/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/ben/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m14:36:04.357310 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6b64b61a-3573-4109-a98c-bcd6d81a4d6c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bafaad0>]}
[0m14:36:04.424117 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6b64b61a-3573-4109-a98c-bcd6d81a4d6c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a87aa90>]}
[0m14:36:04.425132 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m14:36:04.461664 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m14:36:04.463438 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m14:36:04.464264 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '6b64b61a-3573-4109-a98c-bcd6d81a4d6c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bb56850>]}
[0m14:36:06.123858 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m14:36:06.124596 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '6b64b61a-3573-4109-a98c-bcd6d81a4d6c', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10be1ea50>]}
[0m14:36:06.359933 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6b64b61a-3573-4109-a98c-bcd6d81a4d6c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bf38390>]}
[0m14:36:06.470161 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6b64b61a-3573-4109-a98c-bcd6d81a4d6c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c0aef90>]}
[0m14:36:06.470756 [info ] [MainThread]: Found 7 models, 3 seeds, 11 data tests, 572 macros
[0m14:36:06.471285 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6b64b61a-3573-4109-a98c-bcd6d81a4d6c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10be0f650>]}
[0m14:36:06.473412 [info ] [MainThread]: 
[0m14:36:06.474206 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:36:06.480902 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ANALYTICS'
[0m14:36:06.490237 [debug] [ThreadPool]: Using snowflake connection "list_ANALYTICS"
[0m14:36:06.490756 [debug] [ThreadPool]: On list_ANALYTICS: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_ANALYTICS"} */
show terse schemas in database ANALYTICS
    limit 10000
[0m14:36:06.491103 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:36:13.471985 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 6.981 seconds
[0m14:36:13.476881 [debug] [ThreadPool]: On list_ANALYTICS: Close
[0m14:36:13.624192 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ANALYTICS, now list_ANALYTICS_JAFFLE_SHOP)
[0m14:36:13.642530 [debug] [ThreadPool]: Using snowflake connection "list_ANALYTICS_JAFFLE_SHOP"
[0m14:36:13.643387 [debug] [ThreadPool]: On list_ANALYTICS_JAFFLE_SHOP: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_ANALYTICS_JAFFLE_SHOP"} */
show objects in ANALYTICS.JAFFLE_SHOP limit 10000
[0m14:36:13.643963 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:36:14.215407 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.571 seconds
[0m14:36:14.220219 [debug] [ThreadPool]: On list_ANALYTICS_JAFFLE_SHOP: Close
[0m14:36:14.363275 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6b64b61a-3573-4109-a98c-bcd6d81a4d6c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bd793d0>]}
[0m14:36:14.365074 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:36:14.366318 [info ] [MainThread]: 
[0m14:36:14.372704 [debug] [Thread-1 (]: Began running node model.jaffle_shop.customer_orders
[0m14:36:14.373777 [debug] [Thread-2 (]: Began running node model.jaffle_shop.int_orders_test
[0m14:36:14.375033 [debug] [Thread-3 (]: Began running node model.jaffle_shop.stg_customers
[0m14:36:14.376045 [info ] [Thread-1 (]: 1 of 7 START sql table model JAFFLE_SHOP.customer_orders ....................... [RUN]
[0m14:36:14.377001 [debug] [Thread-4 (]: Began running node model.jaffle_shop.stg_orders
[0m14:36:14.378369 [info ] [Thread-2 (]: 2 of 7 START sql view model JAFFLE_SHOP.int_orders_test ........................ [RUN]
[0m14:36:14.379578 [info ] [Thread-3 (]: 3 of 7 START sql view model JAFFLE_SHOP.stg_customers .......................... [RUN]
[0m14:36:14.381106 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_ANALYTICS_JAFFLE_SHOP, now model.jaffle_shop.customer_orders)
[0m14:36:14.382000 [info ] [Thread-4 (]: 4 of 7 START sql view model JAFFLE_SHOP.stg_orders ............................. [RUN]
[0m14:36:14.382970 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.jaffle_shop.int_orders_test'
[0m14:36:14.383865 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.jaffle_shop.stg_customers'
[0m14:36:14.384788 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.customer_orders
[0m14:36:14.386021 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.jaffle_shop.stg_orders'
[0m14:36:14.387000 [debug] [Thread-2 (]: Began compiling node model.jaffle_shop.int_orders_test
[0m14:36:14.387650 [debug] [Thread-3 (]: Began compiling node model.jaffle_shop.stg_customers
[0m14:36:14.396877 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.customer_orders"
[0m14:36:14.397435 [debug] [Thread-4 (]: Began compiling node model.jaffle_shop.stg_orders
[0m14:36:14.406816 [debug] [Thread-2 (]: Using snowflake connection "model.jaffle_shop.int_orders_test"
[0m14:36:14.468127 [debug] [Thread-3 (]: Writing injected SQL for node "model.jaffle_shop.stg_customers"
[0m14:36:14.471144 [debug] [Thread-4 (]: Writing injected SQL for node "model.jaffle_shop.stg_orders"
[0m14:36:14.471696 [debug] [Thread-2 (]: On model.jaffle_shop.int_orders_test: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.int_orders_test"} */
select datediff(
        day,
        cast('2023-01-01' as date),
        cast('2024-01-01' as date)
        )
[0m14:36:14.472740 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m14:36:14.474828 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.customer_orders
[0m14:36:14.475318 [debug] [Thread-4 (]: Began executing node model.jaffle_shop.stg_orders
[0m14:36:14.475745 [debug] [Thread-3 (]: Began executing node model.jaffle_shop.stg_customers
[0m14:36:14.512831 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.customer_orders"
[0m14:36:14.538460 [debug] [Thread-4 (]: Writing runtime sql for node "model.jaffle_shop.stg_orders"
[0m14:36:14.538903 [debug] [Thread-3 (]: Writing runtime sql for node "model.jaffle_shop.stg_customers"
[0m14:36:14.540895 [debug] [Thread-3 (]: Using snowflake connection "model.jaffle_shop.stg_customers"
[0m14:36:14.541355 [debug] [Thread-3 (]: On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */
create or replace   view ANALYTICS.JAFFLE_SHOP.stg_customers
  
   as (
    -- noinspection SqlNoDataSourceInspectionForFile



select
    id as customer_id,
    first_name,
    last_name

from raw.jaffle_shop.raw_customers
  );
[0m14:36:14.541810 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m14:36:14.545871 [debug] [Thread-1 (]: Using snowflake connection "model.jaffle_shop.customer_orders"
[0m14:36:14.546577 [debug] [Thread-1 (]: On model.jaffle_shop.customer_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.customer_orders"} */
create or replace transient table ANALYTICS.JAFFLE_SHOP.customer_orders
         as
        (WITH paid_orders as (select Orders.ID as order_id,
    Orders.USER_ID	as customer_id,
    Orders.ORDER_DATE AS order_placed_at,
        Orders.STATUS AS order_status,
    p.total_amount_paid,
    p.payment_finalized_date,
    C.FIRST_NAME    as customer_first_name,
        C.LAST_NAME as customer_last_name
FROM raw.jaffle_shop.orders as Orders
left join (select ORDERID as order_id, max(CREATED) as payment_finalized_date, sum(AMOUNT) / 100.0 as total_amount_paid
        from raw.stripe.payment
        where STATUS <> 'fail'
        group by 1) p ON orders.ID = p.order_id
left join raw.jaffle_shop.customers C on orders.USER_ID = C.ID ),

customer_orders 
as (select C.ID as customer_id
    , min(ORDER_DATE) as first_order_date
    , max(ORDER_DATE) as most_recent_order_date
    , count(ORDERS.ID) AS number_of_orders
from raw.jaffle_shop.customers C 
left join raw.jaffle_shop.orders as Orders
on orders.USER_ID = C.ID 
group by 1)

select
p.*,
ROW_NUMBER() OVER (ORDER BY p.order_id) as transaction_seq,
ROW_NUMBER() OVER (PARTITION BY customer_id ORDER BY p.order_id) as customer_sales_seq,
CASE WHEN c.first_order_date = p.order_placed_at
THEN 'new'
ELSE 'return' END as nvsr,
x.clv_bad as customer_lifetime_value,
c.first_order_date as fdos
FROM paid_orders p
left join customer_orders as c USING (customer_id)
LEFT OUTER JOIN 
(
        select
        p.order_id,
        sum(t2.total_amount_paid) as clv_bad
    from paid_orders p
    left join paid_orders t2 on p.customer_id = t2.customer_id and p.order_id >= t2.order_id
    group by 1
    order by p.order_id
) x on x.order_id = p.order_id
ORDER BY order_id
        );
[0m14:36:14.547207 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:36:14.548208 [debug] [Thread-4 (]: Using snowflake connection "model.jaffle_shop.stg_orders"
[0m14:36:14.548797 [debug] [Thread-4 (]: On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */
create or replace   view ANALYTICS.JAFFLE_SHOP.stg_orders
  
   as (
    

select
    id as order_id,
    user_id as customer_id,
    order_date,
    status

from raw.jaffle_shop.raw_orders
  );
[0m14:36:14.550146 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m14:36:15.172872 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b7b63c-0000-8615-002a-090300028092
[0m14:36:15.174066 [debug] [Thread-3 (]: Snowflake adapter: Snowflake query id: 01b7b63c-0000-85e7-002a-090300023142
[0m14:36:15.175386 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.703 seconds
[0m14:36:15.176087 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 002003 (42S02): SQL compilation error:
Object 'RAW.JAFFLE_SHOP.ORDERS' does not exist or not authorized.
[0m14:36:15.176804 [debug] [Thread-3 (]: Snowflake adapter: Snowflake error: 002003 (42S02): SQL compilation error:
Object 'RAW.JAFFLE_SHOP.RAW_CUSTOMERS' does not exist or not authorized.
[0m14:36:15.180343 [debug] [Thread-2 (]: Writing injected SQL for node "model.jaffle_shop.int_orders_test"
[0m14:36:15.181363 [debug] [Thread-1 (]: On model.jaffle_shop.customer_orders: Close
[0m14:36:15.183009 [debug] [Thread-3 (]: On model.jaffle_shop.stg_customers: Close
[0m14:36:15.187057 [debug] [Thread-4 (]: Snowflake adapter: Snowflake query id: 01b7b63c-0000-85ce-002a-0903000250ea
[0m14:36:15.188144 [debug] [Thread-4 (]: Snowflake adapter: Snowflake error: 002003 (42S02): SQL compilation error:
Object 'RAW.JAFFLE_SHOP.RAW_ORDERS' does not exist or not authorized.
[0m14:36:15.189680 [debug] [Thread-4 (]: On model.jaffle_shop.stg_orders: Close
[0m14:36:15.190797 [debug] [Thread-2 (]: Began executing node model.jaffle_shop.int_orders_test
[0m14:36:15.196510 [debug] [Thread-2 (]: Writing runtime sql for node "model.jaffle_shop.int_orders_test"
[0m14:36:15.202332 [debug] [Thread-2 (]: Using snowflake connection "model.jaffle_shop.int_orders_test"
[0m14:36:15.203577 [debug] [Thread-2 (]: On model.jaffle_shop.int_orders_test: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.int_orders_test"} */
create or replace   view ANALYTICS.JAFFLE_SHOP.int_orders_test
  
   as (
    







with rawdata as (

    

    

    with p as (
        select 0 as generated_number union all select 1
    ), unioned as (

    select

    
    p0.generated_number * power(2, 0)
     + 
    
    p1.generated_number * power(2, 1)
     + 
    
    p2.generated_number * power(2, 2)
     + 
    
    p3.generated_number * power(2, 3)
     + 
    
    p4.generated_number * power(2, 4)
     + 
    
    p5.generated_number * power(2, 5)
     + 
    
    p6.generated_number * power(2, 6)
     + 
    
    p7.generated_number * power(2, 7)
     + 
    
    p8.generated_number * power(2, 8)
    
    
    + 1
    as generated_number

    from

    
    p as p0
     cross join 
    
    p as p1
     cross join 
    
    p as p2
     cross join 
    
    p as p3
     cross join 
    
    p as p4
     cross join 
    
    p as p5
     cross join 
    
    p as p6
     cross join 
    
    p as p7
     cross join 
    
    p as p8
    
    

    )

    select *
    from unioned
    where generated_number <= 365
    order by generated_number



),

all_periods as (

    select (
        

    dateadd(
        day,
        row_number() over (order by 1) - 1,
        cast('2023-01-01' as date)
        )


    ) as date_day
    from rawdata

),

filtered as (

    select *
    from all_periods
    where date_day <= cast('2024-01-01' as date)

)

select * from filtered


  );
[0m14:36:15.349708 [debug] [Thread-3 (]: Database Error in model stg_customers (models/staging/stg_customers.sql)
  002003 (42S02): SQL compilation error:
  Object 'RAW.JAFFLE_SHOP.RAW_CUSTOMERS' does not exist or not authorized.
  compiled code at target/run/jaffle_shop/models/staging/stg_customers.sql
[0m14:36:15.353433 [debug] [Thread-1 (]: Database Error in model customer_orders (models/customer_orders.sql)
  002003 (42S02): SQL compilation error:
  Object 'RAW.JAFFLE_SHOP.ORDERS' does not exist or not authorized.
  compiled code at target/run/jaffle_shop/models/customer_orders.sql
[0m14:36:15.356248 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6b64b61a-3573-4109-a98c-bcd6d81a4d6c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bd40390>]}
[0m14:36:15.358872 [debug] [Thread-4 (]: Database Error in model stg_orders (models/staging/stg_orders.sql)
  002003 (42S02): SQL compilation error:
  Object 'RAW.JAFFLE_SHOP.RAW_ORDERS' does not exist or not authorized.
  compiled code at target/run/jaffle_shop/models/staging/stg_orders.sql
[0m14:36:15.359750 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6b64b61a-3573-4109-a98c-bcd6d81a4d6c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bdd0810>]}
[0m14:36:15.360810 [error] [Thread-3 (]: 3 of 7 ERROR creating sql view model JAFFLE_SHOP.stg_customers ................. [[31mERROR[0m in 0.97s]
[0m14:36:15.361764 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6b64b61a-3573-4109-a98c-bcd6d81a4d6c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bff7950>]}
[0m14:36:15.362725 [error] [Thread-1 (]: 1 of 7 ERROR creating sql table model JAFFLE_SHOP.customer_orders .............. [[31mERROR[0m in 0.98s]
[0m14:36:15.363788 [debug] [Thread-3 (]: Finished running node model.jaffle_shop.stg_customers
[0m14:36:15.364623 [error] [Thread-4 (]: 4 of 7 ERROR creating sql view model JAFFLE_SHOP.stg_orders .................... [[31mERROR[0m in 0.98s]
[0m14:36:15.365497 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.customer_orders
[0m14:36:15.366155 [debug] [Thread-3 (]: Began running node model.jaffle_shop.stg_payments
[0m14:36:15.367915 [debug] [Thread-4 (]: Finished running node model.jaffle_shop.stg_orders
[0m14:36:15.368948 [info ] [Thread-3 (]: 5 of 7 START sql view model JAFFLE_SHOP.stg_payments ........................... [RUN]
[0m14:36:15.370034 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.jaffle_shop.stg_customers, now model.jaffle_shop.stg_payments)
[0m14:36:15.370662 [debug] [Thread-1 (]: Began running node model.jaffle_shop.customers
[0m14:36:15.371151 [debug] [Thread-3 (]: Began compiling node model.jaffle_shop.stg_payments
[0m14:36:15.371760 [info ] [Thread-1 (]: 6 of 7 SKIP relation JAFFLE_SHOP.customers ..................................... [[33mSKIP[0m]
[0m14:36:15.376051 [debug] [Thread-3 (]: Writing injected SQL for node "model.jaffle_shop.stg_payments"
[0m14:36:15.376711 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.customers
[0m14:36:15.377772 [debug] [Thread-3 (]: Began executing node model.jaffle_shop.stg_payments
[0m14:36:15.381571 [debug] [Thread-3 (]: Writing runtime sql for node "model.jaffle_shop.stg_payments"
[0m14:36:15.383694 [debug] [Thread-3 (]: Using snowflake connection "model.jaffle_shop.stg_payments"
[0m14:36:15.384248 [debug] [Thread-3 (]: On model.jaffle_shop.stg_payments: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_payments"} */
create or replace   view ANALYTICS.JAFFLE_SHOP.stg_payments
  
   as (
    

select
    id,
    order_id,
    payment_method,
    round(1.0 * amount / 100, 2) AS amount_usd

from raw.jaffle_shop.raw_payments
  );
[0m14:36:15.384651 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:36:15.539841 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.333 seconds
[0m14:36:15.585993 [debug] [Thread-2 (]: On model.jaffle_shop.int_orders_test: Close
[0m14:36:15.715392 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6b64b61a-3573-4109-a98c-bcd6d81a4d6c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bfc6d50>]}
[0m14:36:15.717349 [info ] [Thread-2 (]: 2 of 7 OK created sql view model JAFFLE_SHOP.int_orders_test ................... [[32mSUCCESS 1[0m in 1.33s]
[0m14:36:15.719173 [debug] [Thread-2 (]: Finished running node model.jaffle_shop.int_orders_test
[0m14:36:15.928900 [debug] [Thread-3 (]: Snowflake adapter: Snowflake query id: 01b7b63c-0000-862e-002a-090300026156
[0m14:36:15.930283 [debug] [Thread-3 (]: Snowflake adapter: Snowflake error: 002003 (42S02): SQL compilation error:
Object 'RAW.JAFFLE_SHOP.RAW_PAYMENTS' does not exist or not authorized.
[0m14:36:15.931785 [debug] [Thread-3 (]: On model.jaffle_shop.stg_payments: Close
[0m14:36:16.075256 [debug] [Thread-3 (]: Database Error in model stg_payments (models/staging/stg_payments.sql)
  002003 (42S02): SQL compilation error:
  Object 'RAW.JAFFLE_SHOP.RAW_PAYMENTS' does not exist or not authorized.
  compiled code at target/run/jaffle_shop/models/staging/stg_payments.sql
[0m14:36:16.076508 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6b64b61a-3573-4109-a98c-bcd6d81a4d6c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109a58690>]}
[0m14:36:16.077913 [error] [Thread-3 (]: 5 of 7 ERROR creating sql view model JAFFLE_SHOP.stg_payments .................. [[31mERROR[0m in 0.71s]
[0m14:36:16.079332 [debug] [Thread-3 (]: Finished running node model.jaffle_shop.stg_payments
[0m14:36:16.080905 [debug] [Thread-4 (]: Began running node model.jaffle_shop.int_orders__pivoted
[0m14:36:16.081895 [info ] [Thread-4 (]: 7 of 7 SKIP relation JAFFLE_SHOP.int_orders__pivoted ........................... [[33mSKIP[0m]
[0m14:36:16.082983 [debug] [Thread-4 (]: Finished running node model.jaffle_shop.int_orders__pivoted
[0m14:36:16.085767 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:36:16.086415 [debug] [MainThread]: Connection 'model.jaffle_shop.customer_orders' was properly closed.
[0m14:36:16.086948 [debug] [MainThread]: Connection 'model.jaffle_shop.int_orders_test' was properly closed.
[0m14:36:16.087445 [debug] [MainThread]: Connection 'model.jaffle_shop.stg_payments' was properly closed.
[0m14:36:16.088244 [debug] [MainThread]: Connection 'model.jaffle_shop.stg_orders' was properly closed.
[0m14:36:16.089167 [info ] [MainThread]: 
[0m14:36:16.089878 [info ] [MainThread]: Finished running 6 view models, 1 table model in 0 hours 0 minutes and 9.62 seconds (9.62s).
[0m14:36:16.092351 [debug] [MainThread]: Command end result
[0m14:36:16.135350 [info ] [MainThread]: 
[0m14:36:16.135925 [info ] [MainThread]: [31mCompleted with 4 errors and 0 warnings:[0m
[0m14:36:16.136301 [info ] [MainThread]: 
[0m14:36:16.136903 [error] [MainThread]:   Database Error in model stg_customers (models/staging/stg_customers.sql)
  002003 (42S02): SQL compilation error:
  Object 'RAW.JAFFLE_SHOP.RAW_CUSTOMERS' does not exist or not authorized.
  compiled code at target/run/jaffle_shop/models/staging/stg_customers.sql
[0m14:36:16.137308 [info ] [MainThread]: 
[0m14:36:16.137721 [error] [MainThread]:   Database Error in model customer_orders (models/customer_orders.sql)
  002003 (42S02): SQL compilation error:
  Object 'RAW.JAFFLE_SHOP.ORDERS' does not exist or not authorized.
  compiled code at target/run/jaffle_shop/models/customer_orders.sql
[0m14:36:16.138117 [info ] [MainThread]: 
[0m14:36:16.138658 [error] [MainThread]:   Database Error in model stg_orders (models/staging/stg_orders.sql)
  002003 (42S02): SQL compilation error:
  Object 'RAW.JAFFLE_SHOP.RAW_ORDERS' does not exist or not authorized.
  compiled code at target/run/jaffle_shop/models/staging/stg_orders.sql
[0m14:36:16.139095 [info ] [MainThread]: 
[0m14:36:16.139593 [error] [MainThread]:   Database Error in model stg_payments (models/staging/stg_payments.sql)
  002003 (42S02): SQL compilation error:
  Object 'RAW.JAFFLE_SHOP.RAW_PAYMENTS' does not exist or not authorized.
  compiled code at target/run/jaffle_shop/models/staging/stg_payments.sql
[0m14:36:16.139975 [info ] [MainThread]: 
[0m14:36:16.140370 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=4 SKIP=2 TOTAL=7
[0m14:36:16.142328 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 12.314133, "process_user_time": 4.406945, "process_kernel_time": 0.443736, "process_mem_max_rss": "137441280", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:36:16.143484 [debug] [MainThread]: Command `dbt run` failed at 14:36:16.143210 after 12.32 seconds
[0m14:36:16.143985 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107800b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107800290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c34ce50>]}
[0m14:36:16.144413 [debug] [MainThread]: Flushing usage events
[0m14:37:16.505385 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1123bb9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1123f8090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112413950>]}


============================== 14:37:16.511131 | 0bcf01a1-7a14-4277-95f6-f824db9795b9 ==============================
[0m14:37:16.511131 [info ] [MainThread]: Running with dbt=1.8.7
[0m14:37:16.512144 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/Users/ben/.dbt', 'log_path': '/Users/ben/Dbt Certification/dbt-tutorial/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:37:16.869152 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0bcf01a1-7a14-4277-95f6-f824db9795b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112409f90>]}
[0m14:37:16.925069 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0bcf01a1-7a14-4277-95f6-f824db9795b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111e72c50>]}
[0m14:37:16.926130 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m14:37:16.952498 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m14:37:17.092870 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:37:17.093398 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:37:17.142184 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0bcf01a1-7a14-4277-95f6-f824db9795b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113355550>]}
[0m14:37:17.247735 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0bcf01a1-7a14-4277-95f6-f824db9795b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1132d29d0>]}
[0m14:37:17.248398 [info ] [MainThread]: Found 7 models, 3 seeds, 11 data tests, 572 macros
[0m14:37:17.248863 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0bcf01a1-7a14-4277-95f6-f824db9795b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11240a550>]}
[0m14:37:17.251813 [info ] [MainThread]: 
[0m14:37:17.252640 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:37:17.259315 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ANALYTICS'
[0m14:37:17.275751 [debug] [ThreadPool]: Using snowflake connection "list_ANALYTICS"
[0m14:37:17.276260 [debug] [ThreadPool]: On list_ANALYTICS: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_ANALYTICS"} */
show terse schemas in database ANALYTICS
    limit 10000
[0m14:37:17.276617 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:37:17.994916 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.718 seconds
[0m14:37:17.998507 [debug] [ThreadPool]: On list_ANALYTICS: Close
[0m14:37:18.148428 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ANALYTICS, now list_ANALYTICS_JAFFLE_SHOP)
[0m14:37:18.165519 [debug] [ThreadPool]: Using snowflake connection "list_ANALYTICS_JAFFLE_SHOP"
[0m14:37:18.166211 [debug] [ThreadPool]: On list_ANALYTICS_JAFFLE_SHOP: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_ANALYTICS_JAFFLE_SHOP"} */
show objects in ANALYTICS.JAFFLE_SHOP limit 10000
[0m14:37:18.166718 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:37:18.737168 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.570 seconds
[0m14:37:18.739880 [debug] [ThreadPool]: On list_ANALYTICS_JAFFLE_SHOP: Close
[0m14:37:18.887130 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0bcf01a1-7a14-4277-95f6-f824db9795b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111058f90>]}
[0m14:37:18.888951 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:37:18.890112 [info ] [MainThread]: 
[0m14:37:18.896510 [debug] [Thread-2 (]: Began running node model.jaffle_shop.int_orders_test
[0m14:37:18.897856 [debug] [Thread-1 (]: Began running node model.jaffle_shop.customer_orders
[0m14:37:18.898958 [debug] [Thread-3 (]: Began running node model.jaffle_shop.stg_customers
[0m14:37:18.899857 [debug] [Thread-4 (]: Began running node model.jaffle_shop.stg_orders
[0m14:37:18.901347 [info ] [Thread-2 (]: 2 of 7 START sql view model JAFFLE_SHOP.int_orders_test ........................ [RUN]
[0m14:37:18.903030 [info ] [Thread-1 (]: 1 of 7 START sql table model JAFFLE_SHOP.customer_orders ....................... [RUN]
[0m14:37:18.904134 [info ] [Thread-3 (]: 3 of 7 START sql view model JAFFLE_SHOP.stg_customers .......................... [RUN]
[0m14:37:18.905123 [info ] [Thread-4 (]: 4 of 7 START sql view model JAFFLE_SHOP.stg_orders ............................. [RUN]
[0m14:37:18.906225 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.jaffle_shop.int_orders_test'
[0m14:37:18.907093 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_ANALYTICS_JAFFLE_SHOP, now model.jaffle_shop.customer_orders)
[0m14:37:18.907945 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.jaffle_shop.stg_customers'
[0m14:37:18.908766 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.jaffle_shop.stg_orders'
[0m14:37:18.909397 [debug] [Thread-2 (]: Began compiling node model.jaffle_shop.int_orders_test
[0m14:37:18.909970 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.customer_orders
[0m14:37:18.910517 [debug] [Thread-3 (]: Began compiling node model.jaffle_shop.stg_customers
[0m14:37:18.911060 [debug] [Thread-4 (]: Began compiling node model.jaffle_shop.stg_orders
[0m14:37:18.930780 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.customer_orders"
[0m14:37:18.937244 [debug] [Thread-2 (]: Using snowflake connection "model.jaffle_shop.int_orders_test"
[0m14:37:18.940290 [debug] [Thread-3 (]: Writing injected SQL for node "model.jaffle_shop.stg_customers"
[0m14:37:18.943245 [debug] [Thread-4 (]: Writing injected SQL for node "model.jaffle_shop.stg_orders"
[0m14:37:18.943932 [debug] [Thread-2 (]: On model.jaffle_shop.int_orders_test: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.int_orders_test"} */
select datediff(
        day,
        cast('2023-01-01' as date),
        cast('2024-01-01' as date)
        )
[0m14:37:18.945008 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m14:37:18.946765 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.customer_orders
[0m14:37:18.959166 [debug] [Thread-3 (]: Began executing node model.jaffle_shop.stg_customers
[0m14:37:18.960067 [debug] [Thread-4 (]: Began executing node model.jaffle_shop.stg_orders
[0m14:37:19.002121 [debug] [Thread-3 (]: Writing runtime sql for node "model.jaffle_shop.stg_customers"
[0m14:37:19.011585 [debug] [Thread-4 (]: Writing runtime sql for node "model.jaffle_shop.stg_orders"
[0m14:37:19.015644 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.customer_orders"
[0m14:37:19.017565 [debug] [Thread-3 (]: Using snowflake connection "model.jaffle_shop.stg_customers"
[0m14:37:19.018103 [debug] [Thread-3 (]: On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */
create or replace   view ANALYTICS.JAFFLE_SHOP.stg_customers
  
   as (
    -- noinspection SqlNoDataSourceInspectionForFile



select
    id as customer_id,
    first_name,
    last_name

from raw.jaffle_shop.raw_customers
  );
[0m14:37:19.018712 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m14:37:19.020196 [debug] [Thread-4 (]: Using snowflake connection "model.jaffle_shop.stg_orders"
[0m14:37:19.021190 [debug] [Thread-4 (]: On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */
create or replace   view ANALYTICS.JAFFLE_SHOP.stg_orders
  
   as (
    

select
    id as order_id,
    user_id as customer_id,
    order_date,
    status

from raw.jaffle_shop.raw_orders
  );
[0m14:37:19.021634 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m14:37:19.025433 [debug] [Thread-1 (]: Using snowflake connection "model.jaffle_shop.customer_orders"
[0m14:37:19.026482 [debug] [Thread-1 (]: On model.jaffle_shop.customer_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.customer_orders"} */
create or replace transient table ANALYTICS.JAFFLE_SHOP.customer_orders
         as
        (WITH paid_orders as (select Orders.ID as order_id,
    Orders.USER_ID	as customer_id,
    Orders.ORDER_DATE AS order_placed_at,
        Orders.STATUS AS order_status,
    p.total_amount_paid,
    p.payment_finalized_date,
    C.FIRST_NAME    as customer_first_name,
        C.LAST_NAME as customer_last_name
FROM raw.jaffle_shop.orders as Orders
left join (select ORDERID as order_id, max(CREATED) as payment_finalized_date, sum(AMOUNT) / 100.0 as total_amount_paid
        from raw.stripe.payment
        where STATUS <> 'fail'
        group by 1) p ON orders.ID = p.order_id
left join raw.jaffle_shop.customers C on orders.USER_ID = C.ID ),

customer_orders 
as (select C.ID as customer_id
    , min(ORDER_DATE) as first_order_date
    , max(ORDER_DATE) as most_recent_order_date
    , count(ORDERS.ID) AS number_of_orders
from raw.jaffle_shop.customers C 
left join raw.jaffle_shop.orders as Orders
on orders.USER_ID = C.ID 
group by 1)

select
p.*,
ROW_NUMBER() OVER (ORDER BY p.order_id) as transaction_seq,
ROW_NUMBER() OVER (PARTITION BY customer_id ORDER BY p.order_id) as customer_sales_seq,
CASE WHEN c.first_order_date = p.order_placed_at
THEN 'new'
ELSE 'return' END as nvsr,
x.clv_bad as customer_lifetime_value,
c.first_order_date as fdos
FROM paid_orders p
left join customer_orders as c USING (customer_id)
LEFT OUTER JOIN 
(
        select
        p.order_id,
        sum(t2.total_amount_paid) as clv_bad
    from paid_orders p
    left join paid_orders t2 on p.customer_id = t2.customer_id and p.order_id >= t2.order_id
    group by 1
    order by p.order_id
) x on x.order_id = p.order_id
ORDER BY order_id
        );
[0m14:37:19.027927 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:37:19.469790 [debug] [Thread-3 (]: Snowflake adapter: Snowflake query id: 01b7b63d-0000-85ce-002a-0903000250f2
[0m14:37:19.471116 [debug] [Thread-3 (]: Snowflake adapter: Snowflake error: 002003 (42S02): SQL compilation error:
Object 'RAW.JAFFLE_SHOP.RAW_CUSTOMERS' does not exist or not authorized.
[0m14:37:19.472477 [debug] [Thread-3 (]: On model.jaffle_shop.stg_customers: Close
[0m14:37:19.540794 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.595 seconds
[0m14:37:19.566056 [debug] [Thread-2 (]: Writing injected SQL for node "model.jaffle_shop.int_orders_test"
[0m14:37:19.567346 [debug] [Thread-2 (]: Began executing node model.jaffle_shop.int_orders_test
[0m14:37:19.571235 [debug] [Thread-2 (]: Writing runtime sql for node "model.jaffle_shop.int_orders_test"
[0m14:37:19.576446 [debug] [Thread-2 (]: Using snowflake connection "model.jaffle_shop.int_orders_test"
[0m14:37:19.577164 [debug] [Thread-2 (]: On model.jaffle_shop.int_orders_test: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.int_orders_test"} */
create or replace   view ANALYTICS.JAFFLE_SHOP.int_orders_test
  
   as (
    







with rawdata as (

    

    

    with p as (
        select 0 as generated_number union all select 1
    ), unioned as (

    select

    
    p0.generated_number * power(2, 0)
     + 
    
    p1.generated_number * power(2, 1)
     + 
    
    p2.generated_number * power(2, 2)
     + 
    
    p3.generated_number * power(2, 3)
     + 
    
    p4.generated_number * power(2, 4)
     + 
    
    p5.generated_number * power(2, 5)
     + 
    
    p6.generated_number * power(2, 6)
     + 
    
    p7.generated_number * power(2, 7)
     + 
    
    p8.generated_number * power(2, 8)
    
    
    + 1
    as generated_number

    from

    
    p as p0
     cross join 
    
    p as p1
     cross join 
    
    p as p2
     cross join 
    
    p as p3
     cross join 
    
    p as p4
     cross join 
    
    p as p5
     cross join 
    
    p as p6
     cross join 
    
    p as p7
     cross join 
    
    p as p8
    
    

    )

    select *
    from unioned
    where generated_number <= 365
    order by generated_number



),

all_periods as (

    select (
        

    dateadd(
        day,
        row_number() over (order by 1) - 1,
        cast('2023-01-01' as date)
        )


    ) as date_day
    from rawdata

),

filtered as (

    select *
    from all_periods
    where date_day <= cast('2024-01-01' as date)

)

select * from filtered


  );
[0m14:37:19.627570 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b7b63d-0000-862e-002a-09030002615a
[0m14:37:19.628383 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 002003 (42S02): SQL compilation error:
Object 'RAW.STRIPE.PAYMENT' does not exist or not authorized.
[0m14:37:19.629758 [debug] [Thread-1 (]: On model.jaffle_shop.customer_orders: Close
[0m14:37:19.632062 [debug] [Thread-3 (]: Database Error in model stg_customers (models/staging/stg_customers.sql)
  002003 (42S02): SQL compilation error:
  Object 'RAW.JAFFLE_SHOP.RAW_CUSTOMERS' does not exist or not authorized.
  compiled code at target/run/jaffle_shop/models/staging/stg_customers.sql
[0m14:37:19.634900 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0bcf01a1-7a14-4277-95f6-f824db9795b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112435310>]}
[0m14:37:19.636572 [error] [Thread-3 (]: 3 of 7 ERROR creating sql view model JAFFLE_SHOP.stg_customers ................. [[31mERROR[0m in 0.73s]
[0m14:37:19.637773 [debug] [Thread-3 (]: Finished running node model.jaffle_shop.stg_customers
[0m14:37:19.638580 [debug] [Thread-3 (]: Began running node model.jaffle_shop.stg_payments
[0m14:37:19.641073 [info ] [Thread-3 (]: 5 of 7 START sql view model JAFFLE_SHOP.stg_payments ........................... [RUN]
[0m14:37:19.642136 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.jaffle_shop.stg_customers, now model.jaffle_shop.stg_payments)
[0m14:37:19.642877 [debug] [Thread-3 (]: Began compiling node model.jaffle_shop.stg_payments
[0m14:37:19.648552 [debug] [Thread-3 (]: Writing injected SQL for node "model.jaffle_shop.stg_payments"
[0m14:37:19.649358 [debug] [Thread-3 (]: Began executing node model.jaffle_shop.stg_payments
[0m14:37:19.652282 [debug] [Thread-3 (]: Writing runtime sql for node "model.jaffle_shop.stg_payments"
[0m14:37:19.653568 [debug] [Thread-3 (]: Using snowflake connection "model.jaffle_shop.stg_payments"
[0m14:37:19.654304 [debug] [Thread-3 (]: On model.jaffle_shop.stg_payments: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_payments"} */
create or replace   view ANALYTICS.JAFFLE_SHOP.stg_payments
  
   as (
    

select
    id,
    order_id,
    payment_method,
    round(1.0 * amount / 100, 2) AS amount_usd

from raw.jaffle_shop.raw_payments
  );
[0m14:37:19.654985 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:37:19.718004 [debug] [Thread-4 (]: Snowflake adapter: Snowflake query id: 01b7b63d-0000-854a-002a-09030001e152
[0m14:37:19.719203 [debug] [Thread-4 (]: Snowflake adapter: Snowflake error: 002003 (42S02): SQL compilation error:
Object 'RAW.JAFFLE_SHOP.RAW_ORDERS' does not exist or not authorized.
[0m14:37:19.720164 [debug] [Thread-4 (]: On model.jaffle_shop.stg_orders: Close
[0m14:37:19.811809 [debug] [Thread-1 (]: Database Error in model customer_orders (models/customer_orders.sql)
  002003 (42S02): SQL compilation error:
  Object 'RAW.STRIPE.PAYMENT' does not exist or not authorized.
  compiled code at target/run/jaffle_shop/models/customer_orders.sql
[0m14:37:19.813062 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0bcf01a1-7a14-4277-95f6-f824db9795b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112253950>]}
[0m14:37:19.814481 [error] [Thread-1 (]: 1 of 7 ERROR creating sql table model JAFFLE_SHOP.customer_orders .............. [[31mERROR[0m in 0.91s]
[0m14:37:19.815963 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.customer_orders
[0m14:37:19.907644 [debug] [Thread-4 (]: Database Error in model stg_orders (models/staging/stg_orders.sql)
  002003 (42S02): SQL compilation error:
  Object 'RAW.JAFFLE_SHOP.RAW_ORDERS' does not exist or not authorized.
  compiled code at target/run/jaffle_shop/models/staging/stg_orders.sql
[0m14:37:19.908857 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0bcf01a1-7a14-4277-95f6-f824db9795b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1136a4050>]}
[0m14:37:19.910240 [error] [Thread-4 (]: 4 of 7 ERROR creating sql view model JAFFLE_SHOP.stg_orders .................... [[31mERROR[0m in 1.00s]
[0m14:37:19.911619 [debug] [Thread-4 (]: Finished running node model.jaffle_shop.stg_orders
[0m14:37:19.912744 [debug] [Thread-1 (]: Began running node model.jaffle_shop.customers
[0m14:37:19.913460 [info ] [Thread-1 (]: 6 of 7 SKIP relation JAFFLE_SHOP.customers ..................................... [[33mSKIP[0m]
[0m14:37:19.914183 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.customers
[0m14:37:19.952013 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.374 seconds
[0m14:37:19.984268 [debug] [Thread-2 (]: On model.jaffle_shop.int_orders_test: Close
[0m14:37:20.078666 [debug] [Thread-3 (]: Snowflake adapter: Snowflake query id: 01b7b63d-0000-862e-002a-09030002615e
[0m14:37:20.080077 [debug] [Thread-3 (]: Snowflake adapter: Snowflake error: 002003 (42S02): SQL compilation error:
Object 'RAW.JAFFLE_SHOP.RAW_PAYMENTS' does not exist or not authorized.
[0m14:37:20.081608 [debug] [Thread-3 (]: On model.jaffle_shop.stg_payments: Close
[0m14:37:20.116297 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0bcf01a1-7a14-4277-95f6-f824db9795b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113766bd0>]}
[0m14:37:20.117486 [info ] [Thread-2 (]: 2 of 7 OK created sql view model JAFFLE_SHOP.int_orders_test ................... [[32mSUCCESS 1[0m in 1.21s]
[0m14:37:20.118565 [debug] [Thread-2 (]: Finished running node model.jaffle_shop.int_orders_test
[0m14:37:20.219766 [debug] [Thread-3 (]: Database Error in model stg_payments (models/staging/stg_payments.sql)
  002003 (42S02): SQL compilation error:
  Object 'RAW.JAFFLE_SHOP.RAW_PAYMENTS' does not exist or not authorized.
  compiled code at target/run/jaffle_shop/models/staging/stg_payments.sql
[0m14:37:20.220741 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0bcf01a1-7a14-4277-95f6-f824db9795b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1137b8150>]}
[0m14:37:20.221777 [error] [Thread-3 (]: 5 of 7 ERROR creating sql view model JAFFLE_SHOP.stg_payments .................. [[31mERROR[0m in 0.58s]
[0m14:37:20.223163 [debug] [Thread-3 (]: Finished running node model.jaffle_shop.stg_payments
[0m14:37:20.224885 [debug] [Thread-4 (]: Began running node model.jaffle_shop.int_orders__pivoted
[0m14:37:20.225918 [info ] [Thread-4 (]: 7 of 7 SKIP relation JAFFLE_SHOP.int_orders__pivoted ........................... [[33mSKIP[0m]
[0m14:37:20.226865 [debug] [Thread-4 (]: Finished running node model.jaffle_shop.int_orders__pivoted
[0m14:37:20.228942 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:37:20.229621 [debug] [MainThread]: Connection 'model.jaffle_shop.customer_orders' was properly closed.
[0m14:37:20.230128 [debug] [MainThread]: Connection 'model.jaffle_shop.int_orders_test' was properly closed.
[0m14:37:20.230560 [debug] [MainThread]: Connection 'model.jaffle_shop.stg_payments' was properly closed.
[0m14:37:20.230946 [debug] [MainThread]: Connection 'model.jaffle_shop.stg_orders' was properly closed.
[0m14:37:20.231739 [info ] [MainThread]: 
[0m14:37:20.232237 [info ] [MainThread]: Finished running 6 view models, 1 table model in 0 hours 0 minutes and 2.98 seconds (2.98s).
[0m14:37:20.233987 [debug] [MainThread]: Command end result
[0m14:37:20.272043 [info ] [MainThread]: 
[0m14:37:20.272797 [info ] [MainThread]: [31mCompleted with 4 errors and 0 warnings:[0m
[0m14:37:20.273290 [info ] [MainThread]: 
[0m14:37:20.273732 [error] [MainThread]:   Database Error in model stg_customers (models/staging/stg_customers.sql)
  002003 (42S02): SQL compilation error:
  Object 'RAW.JAFFLE_SHOP.RAW_CUSTOMERS' does not exist or not authorized.
  compiled code at target/run/jaffle_shop/models/staging/stg_customers.sql
[0m14:37:20.274138 [info ] [MainThread]: 
[0m14:37:20.274839 [error] [MainThread]:   Database Error in model customer_orders (models/customer_orders.sql)
  002003 (42S02): SQL compilation error:
  Object 'RAW.STRIPE.PAYMENT' does not exist or not authorized.
  compiled code at target/run/jaffle_shop/models/customer_orders.sql
[0m14:37:20.275486 [info ] [MainThread]: 
[0m14:37:20.276166 [error] [MainThread]:   Database Error in model stg_orders (models/staging/stg_orders.sql)
  002003 (42S02): SQL compilation error:
  Object 'RAW.JAFFLE_SHOP.RAW_ORDERS' does not exist or not authorized.
  compiled code at target/run/jaffle_shop/models/staging/stg_orders.sql
[0m14:37:20.276620 [info ] [MainThread]: 
[0m14:37:20.277074 [error] [MainThread]:   Database Error in model stg_payments (models/staging/stg_payments.sql)
  002003 (42S02): SQL compilation error:
  Object 'RAW.JAFFLE_SHOP.RAW_PAYMENTS' does not exist or not authorized.
  compiled code at target/run/jaffle_shop/models/staging/stg_payments.sql
[0m14:37:20.277522 [info ] [MainThread]: 
[0m14:37:20.277975 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=4 SKIP=2 TOTAL=7
[0m14:37:20.279508 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 3.8495963, "process_user_time": 2.726625, "process_kernel_time": 0.369701, "process_mem_max_rss": "133128192", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:37:20.280101 [debug] [MainThread]: Command `dbt run` failed at 14:37:20.279998 after 3.85 seconds
[0m14:37:20.280556 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11240ac10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11242e7d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ee24c10>]}
[0m14:37:20.280944 [debug] [MainThread]: Flushing usage events
[0m14:39:04.082422 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cc47b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cc9f950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ccb9390>]}


============================== 14:39:04.088163 | a186102a-ae87-4d59-8644-e4186d9e94ea ==============================
[0m14:39:04.088163 [info ] [MainThread]: Running with dbt=1.8.7
[0m14:39:04.088909 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/ben/Dbt Certification/dbt-tutorial/logs', 'debug': 'False', 'profiles_dir': '/Users/ben/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:39:04.435024 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a186102a-ae87-4d59-8644-e4186d9e94ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d6122d0>]}
[0m14:39:04.490674 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a186102a-ae87-4d59-8644-e4186d9e94ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c70ecd0>]}
[0m14:39:04.491692 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m14:39:04.516066 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m14:39:04.653627 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:39:04.654140 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:39:04.700468 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a186102a-ae87-4d59-8644-e4186d9e94ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cc861d0>]}
[0m14:39:04.801040 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a186102a-ae87-4d59-8644-e4186d9e94ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10db38890>]}
[0m14:39:04.801732 [info ] [MainThread]: Found 7 models, 3 seeds, 11 data tests, 572 macros
[0m14:39:04.802232 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a186102a-ae87-4d59-8644-e4186d9e94ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b0a7a50>]}
[0m14:39:04.804427 [info ] [MainThread]: 
[0m14:39:04.805091 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:39:04.809792 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ANALYTICS'
[0m14:39:04.826221 [debug] [ThreadPool]: Using snowflake connection "list_ANALYTICS"
[0m14:39:04.826755 [debug] [ThreadPool]: On list_ANALYTICS: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_ANALYTICS"} */
show terse schemas in database ANALYTICS
    limit 10000
[0m14:39:04.827104 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:39:05.550849 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.723 seconds
[0m14:39:05.557723 [debug] [ThreadPool]: On list_ANALYTICS: Close
[0m14:39:05.820753 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ANALYTICS, now list_ANALYTICS_JAFFLE_SHOP)
[0m14:39:05.834182 [debug] [ThreadPool]: Using snowflake connection "list_ANALYTICS_JAFFLE_SHOP"
[0m14:39:05.834751 [debug] [ThreadPool]: On list_ANALYTICS_JAFFLE_SHOP: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_ANALYTICS_JAFFLE_SHOP"} */
show objects in ANALYTICS.JAFFLE_SHOP limit 10000
[0m14:39:05.835165 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:39:06.467933 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.633 seconds
[0m14:39:06.472085 [debug] [ThreadPool]: On list_ANALYTICS_JAFFLE_SHOP: Close
[0m14:39:06.649545 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a186102a-ae87-4d59-8644-e4186d9e94ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a7f6bd0>]}
[0m14:39:06.651288 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:39:06.652172 [info ] [MainThread]: 
[0m14:39:06.658409 [debug] [Thread-1 (]: Began running node model.jaffle_shop.customer_orders
[0m14:39:06.659469 [debug] [Thread-2 (]: Began running node model.jaffle_shop.int_orders_test
[0m14:39:06.660268 [debug] [Thread-3 (]: Began running node model.jaffle_shop.stg_customers
[0m14:39:06.662163 [debug] [Thread-4 (]: Began running node model.jaffle_shop.stg_orders
[0m14:39:06.661225 [info ] [Thread-1 (]: 1 of 7 START sql table model JAFFLE_SHOP.customer_orders ....................... [RUN]
[0m14:39:06.663732 [info ] [Thread-2 (]: 2 of 7 START sql view model JAFFLE_SHOP.int_orders_test ........................ [RUN]
[0m14:39:06.665352 [info ] [Thread-3 (]: 3 of 7 START sql view model JAFFLE_SHOP.stg_customers .......................... [RUN]
[0m14:39:06.666598 [info ] [Thread-4 (]: 4 of 7 START sql view model JAFFLE_SHOP.stg_orders ............................. [RUN]
[0m14:39:06.668072 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_ANALYTICS_JAFFLE_SHOP, now model.jaffle_shop.customer_orders)
[0m14:39:06.669297 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.jaffle_shop.int_orders_test'
[0m14:39:06.670871 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.jaffle_shop.stg_customers'
[0m14:39:06.672158 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.jaffle_shop.stg_orders'
[0m14:39:06.672818 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.customer_orders
[0m14:39:06.673397 [debug] [Thread-2 (]: Began compiling node model.jaffle_shop.int_orders_test
[0m14:39:06.673940 [debug] [Thread-3 (]: Began compiling node model.jaffle_shop.stg_customers
[0m14:39:06.674458 [debug] [Thread-4 (]: Began compiling node model.jaffle_shop.stg_orders
[0m14:39:06.684772 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.customer_orders"
[0m14:39:06.701949 [debug] [Thread-2 (]: Using snowflake connection "model.jaffle_shop.int_orders_test"
[0m14:39:06.704836 [debug] [Thread-3 (]: Writing injected SQL for node "model.jaffle_shop.stg_customers"
[0m14:39:06.707557 [debug] [Thread-4 (]: Writing injected SQL for node "model.jaffle_shop.stg_orders"
[0m14:39:06.708263 [debug] [Thread-2 (]: On model.jaffle_shop.int_orders_test: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.int_orders_test"} */
select datediff(
        day,
        cast('2023-01-01' as date),
        cast('2024-01-01' as date)
        )
[0m14:39:06.709285 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.customer_orders
[0m14:39:06.709876 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m14:39:06.710545 [debug] [Thread-4 (]: Began executing node model.jaffle_shop.stg_orders
[0m14:39:06.710975 [debug] [Thread-3 (]: Began executing node model.jaffle_shop.stg_customers
[0m14:39:06.747522 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.customer_orders"
[0m14:39:06.770459 [debug] [Thread-4 (]: Writing runtime sql for node "model.jaffle_shop.stg_orders"
[0m14:39:06.774456 [debug] [Thread-3 (]: Writing runtime sql for node "model.jaffle_shop.stg_customers"
[0m14:39:06.776387 [debug] [Thread-4 (]: Using snowflake connection "model.jaffle_shop.stg_orders"
[0m14:39:06.776876 [debug] [Thread-4 (]: On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */
create or replace   view ANALYTICS.JAFFLE_SHOP.stg_orders
  
   as (
    

select
    id as order_id,
    user_id as customer_id,
    order_date,
    status

from raw.jaffle_shop.raw_orders
  );
[0m14:39:06.777300 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m14:39:06.778711 [debug] [Thread-3 (]: Using snowflake connection "model.jaffle_shop.stg_customers"
[0m14:39:06.779174 [debug] [Thread-3 (]: On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */
create or replace   view ANALYTICS.JAFFLE_SHOP.stg_customers
  
   as (
    -- noinspection SqlNoDataSourceInspectionForFile



select
    id as customer_id,
    first_name,
    last_name

from raw.jaffle_shop.raw_customers
  );
[0m14:39:06.779579 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m14:39:06.783174 [debug] [Thread-1 (]: Using snowflake connection "model.jaffle_shop.customer_orders"
[0m14:39:06.784321 [debug] [Thread-1 (]: On model.jaffle_shop.customer_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.customer_orders"} */
create or replace transient table ANALYTICS.JAFFLE_SHOP.customer_orders
         as
        (WITH paid_orders as (select Orders.ID as order_id,
    Orders.USER_ID	as customer_id,
    Orders.ORDER_DATE AS order_placed_at,
        Orders.STATUS AS order_status,
    p.total_amount_paid,
    p.payment_finalized_date,
    C.FIRST_NAME    as customer_first_name,
        C.LAST_NAME as customer_last_name
FROM raw.jaffle_shop.orders as Orders
left join (select ORDERID as order_id, max(CREATED) as payment_finalized_date, sum(AMOUNT) / 100.0 as total_amount_paid
        from raw.stripe.payment
        where STATUS <> 'fail'
        group by 1) p ON orders.ID = p.order_id
left join raw.jaffle_shop.customers C on orders.USER_ID = C.ID ),

customer_orders 
as (select C.ID as customer_id
    , min(ORDER_DATE) as first_order_date
    , max(ORDER_DATE) as most_recent_order_date
    , count(ORDERS.ID) AS number_of_orders
from raw.jaffle_shop.customers C 
left join raw.jaffle_shop.orders as Orders
on orders.USER_ID = C.ID 
group by 1)

select
p.*,
ROW_NUMBER() OVER (ORDER BY p.order_id) as transaction_seq,
ROW_NUMBER() OVER (PARTITION BY customer_id ORDER BY p.order_id) as customer_sales_seq,
CASE WHEN c.first_order_date = p.order_placed_at
THEN 'new'
ELSE 'return' END as nvsr,
x.clv_bad as customer_lifetime_value,
c.first_order_date as fdos
FROM paid_orders p
left join customer_orders as c USING (customer_id)
LEFT OUTER JOIN 
(
        select
        p.order_id,
        sum(t2.total_amount_paid) as clv_bad
    from paid_orders p
    left join paid_orders t2 on p.customer_id = t2.customer_id and p.order_id >= t2.order_id
    group by 1
    order by p.order_id
) x on x.order_id = p.order_id
ORDER BY order_id
        );
[0m14:39:06.785170 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:39:07.320474 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.610 seconds
[0m14:39:07.347458 [debug] [Thread-2 (]: Writing injected SQL for node "model.jaffle_shop.int_orders_test"
[0m14:39:07.350443 [debug] [Thread-2 (]: Began executing node model.jaffle_shop.int_orders_test
[0m14:39:07.354316 [debug] [Thread-2 (]: Writing runtime sql for node "model.jaffle_shop.int_orders_test"
[0m14:39:07.357745 [debug] [Thread-2 (]: Using snowflake connection "model.jaffle_shop.int_orders_test"
[0m14:39:07.358546 [debug] [Thread-2 (]: On model.jaffle_shop.int_orders_test: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.int_orders_test"} */
create or replace   view ANALYTICS.JAFFLE_SHOP.int_orders_test
  
   as (
    







with rawdata as (

    

    

    with p as (
        select 0 as generated_number union all select 1
    ), unioned as (

    select

    
    p0.generated_number * power(2, 0)
     + 
    
    p1.generated_number * power(2, 1)
     + 
    
    p2.generated_number * power(2, 2)
     + 
    
    p3.generated_number * power(2, 3)
     + 
    
    p4.generated_number * power(2, 4)
     + 
    
    p5.generated_number * power(2, 5)
     + 
    
    p6.generated_number * power(2, 6)
     + 
    
    p7.generated_number * power(2, 7)
     + 
    
    p8.generated_number * power(2, 8)
    
    
    + 1
    as generated_number

    from

    
    p as p0
     cross join 
    
    p as p1
     cross join 
    
    p as p2
     cross join 
    
    p as p3
     cross join 
    
    p as p4
     cross join 
    
    p as p5
     cross join 
    
    p as p6
     cross join 
    
    p as p7
     cross join 
    
    p as p8
    
    

    )

    select *
    from unioned
    where generated_number <= 365
    order by generated_number



),

all_periods as (

    select (
        

    dateadd(
        day,
        row_number() over (order by 1) - 1,
        cast('2023-01-01' as date)
        )


    ) as date_day
    from rawdata

),

filtered as (

    select *
    from all_periods
    where date_day <= cast('2024-01-01' as date)

)

select * from filtered


  );
[0m14:39:07.366262 [debug] [Thread-4 (]: Snowflake adapter: Snowflake query id: 01b7b63f-0000-864f-002a-09030002909a
[0m14:39:07.367265 [debug] [Thread-4 (]: Snowflake adapter: Snowflake error: 002003 (42S02): SQL compilation error:
Object 'RAW.JAFFLE_SHOP.RAW_ORDERS' does not exist or not authorized.
[0m14:39:07.368048 [debug] [Thread-3 (]: Snowflake adapter: Snowflake query id: 01b7b63f-0000-85e7-002a-090300023176
[0m14:39:07.368986 [debug] [Thread-4 (]: On model.jaffle_shop.stg_orders: Close
[0m14:39:07.369852 [debug] [Thread-3 (]: Snowflake adapter: Snowflake error: 002003 (42S02): SQL compilation error:
Object 'RAW.JAFFLE_SHOP.RAW_CUSTOMERS' does not exist or not authorized.
[0m14:39:07.372260 [debug] [Thread-3 (]: On model.jaffle_shop.stg_customers: Close
[0m14:39:07.516900 [debug] [Thread-3 (]: Database Error in model stg_customers (models/staging/stg_customers.sql)
  002003 (42S02): SQL compilation error:
  Object 'RAW.JAFFLE_SHOP.RAW_CUSTOMERS' does not exist or not authorized.
  compiled code at target/run/jaffle_shop/models/staging/stg_customers.sql
[0m14:39:07.520110 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a186102a-ae87-4d59-8644-e4186d9e94ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10da190d0>]}
[0m14:39:07.521377 [error] [Thread-3 (]: 3 of 7 ERROR creating sql view model JAFFLE_SHOP.stg_customers ................. [[31mERROR[0m in 0.85s]
[0m14:39:07.522600 [debug] [Thread-3 (]: Finished running node model.jaffle_shop.stg_customers
[0m14:39:07.523490 [debug] [Thread-3 (]: Began running node model.jaffle_shop.stg_payments
[0m14:39:07.524708 [info ] [Thread-3 (]: 5 of 7 START sql view model JAFFLE_SHOP.stg_payments ........................... [RUN]
[0m14:39:07.527654 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.jaffle_shop.stg_customers, now model.jaffle_shop.stg_payments)
[0m14:39:07.528649 [debug] [Thread-3 (]: Began compiling node model.jaffle_shop.stg_payments
[0m14:39:07.536766 [debug] [Thread-3 (]: Writing injected SQL for node "model.jaffle_shop.stg_payments"
[0m14:39:07.537948 [debug] [Thread-3 (]: Began executing node model.jaffle_shop.stg_payments
[0m14:39:07.544563 [debug] [Thread-3 (]: Writing runtime sql for node "model.jaffle_shop.stg_payments"
[0m14:39:07.547592 [debug] [Thread-4 (]: Database Error in model stg_orders (models/staging/stg_orders.sql)
  002003 (42S02): SQL compilation error:
  Object 'RAW.JAFFLE_SHOP.RAW_ORDERS' does not exist or not authorized.
  compiled code at target/run/jaffle_shop/models/staging/stg_orders.sql
[0m14:39:07.548519 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a186102a-ae87-4d59-8644-e4186d9e94ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e137fd0>]}
[0m14:39:07.549255 [error] [Thread-4 (]: 4 of 7 ERROR creating sql view model JAFFLE_SHOP.stg_orders .................... [[31mERROR[0m in 0.88s]
[0m14:39:07.550041 [debug] [Thread-4 (]: Finished running node model.jaffle_shop.stg_orders
[0m14:39:07.550808 [debug] [Thread-3 (]: Using snowflake connection "model.jaffle_shop.stg_payments"
[0m14:39:07.551531 [debug] [Thread-4 (]: Began running node model.jaffle_shop.customers
[0m14:39:07.551922 [debug] [Thread-3 (]: On model.jaffle_shop.stg_payments: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_payments"} */
create or replace   view ANALYTICS.JAFFLE_SHOP.stg_payments
  
   as (
    

select
    id,
    order_id,
    payment_method,
    round(1.0 * amount / 100, 2) AS amount_usd

from raw.jaffle_shop.raw_payments
  );
[0m14:39:07.552379 [info ] [Thread-4 (]: 6 of 7 SKIP relation JAFFLE_SHOP.customers ..................................... [[33mSKIP[0m]
[0m14:39:07.552855 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:39:07.553289 [debug] [Thread-4 (]: Finished running node model.jaffle_shop.customers
[0m14:39:07.663351 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.304 seconds
[0m14:39:07.700191 [debug] [Thread-2 (]: On model.jaffle_shop.int_orders_test: Close
[0m14:39:07.862384 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a186102a-ae87-4d59-8644-e4186d9e94ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dec3bd0>]}
[0m14:39:07.864353 [info ] [Thread-2 (]: 2 of 7 OK created sql view model JAFFLE_SHOP.int_orders_test ................... [[32mSUCCESS 1[0m in 1.19s]
[0m14:39:07.865888 [debug] [Thread-2 (]: Finished running node model.jaffle_shop.int_orders_test
[0m14:39:08.238106 [debug] [Thread-3 (]: Snowflake adapter: Snowflake query id: 01b7b63f-0000-8615-002a-0903000280e6
[0m14:39:08.239416 [debug] [Thread-3 (]: Snowflake adapter: Snowflake error: 002003 (42S02): SQL compilation error:
Object 'RAW.JAFFLE_SHOP.RAW_PAYMENTS' does not exist or not authorized.
[0m14:39:08.240903 [debug] [Thread-3 (]: On model.jaffle_shop.stg_payments: Close
[0m14:39:08.381626 [debug] [Thread-3 (]: Database Error in model stg_payments (models/staging/stg_payments.sql)
  002003 (42S02): SQL compilation error:
  Object 'RAW.JAFFLE_SHOP.RAW_PAYMENTS' does not exist or not authorized.
  compiled code at target/run/jaffle_shop/models/staging/stg_payments.sql
[0m14:39:08.383038 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a186102a-ae87-4d59-8644-e4186d9e94ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d908850>]}
[0m14:39:08.384469 [error] [Thread-3 (]: 5 of 7 ERROR creating sql view model JAFFLE_SHOP.stg_payments .................. [[31mERROR[0m in 0.86s]
[0m14:39:08.385858 [debug] [Thread-3 (]: Finished running node model.jaffle_shop.stg_payments
[0m14:39:08.387078 [debug] [Thread-4 (]: Began running node model.jaffle_shop.int_orders__pivoted
[0m14:39:08.387972 [info ] [Thread-4 (]: 7 of 7 SKIP relation JAFFLE_SHOP.int_orders__pivoted ........................... [[33mSKIP[0m]
[0m14:39:08.388844 [debug] [Thread-4 (]: Finished running node model.jaffle_shop.int_orders__pivoted
[0m14:39:10.645589 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 3.860 seconds
[0m14:39:10.650418 [debug] [Thread-1 (]: On model.jaffle_shop.customer_orders: Close
[0m14:39:10.791315 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a186102a-ae87-4d59-8644-e4186d9e94ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d7ef190>]}
[0m14:39:10.793217 [info ] [Thread-1 (]: 1 of 7 OK created sql table model JAFFLE_SHOP.customer_orders .................. [[32mSUCCESS 1[0m in 4.12s]
[0m14:39:10.794977 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.customer_orders
[0m14:39:10.798794 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:39:10.799687 [debug] [MainThread]: Connection 'model.jaffle_shop.customer_orders' was properly closed.
[0m14:39:10.800974 [debug] [MainThread]: Connection 'model.jaffle_shop.int_orders_test' was properly closed.
[0m14:39:10.802237 [debug] [MainThread]: Connection 'model.jaffle_shop.stg_payments' was properly closed.
[0m14:39:10.803686 [debug] [MainThread]: Connection 'model.jaffle_shop.stg_orders' was properly closed.
[0m14:39:10.805329 [info ] [MainThread]: 
[0m14:39:10.806321 [info ] [MainThread]: Finished running 6 view models, 1 table model in 0 hours 0 minutes and 6.00 seconds (6.00s).
[0m14:39:10.808812 [debug] [MainThread]: Command end result
[0m14:39:10.849699 [info ] [MainThread]: 
[0m14:39:10.850382 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
[0m14:39:10.850951 [info ] [MainThread]: 
[0m14:39:10.851447 [error] [MainThread]:   Database Error in model stg_customers (models/staging/stg_customers.sql)
  002003 (42S02): SQL compilation error:
  Object 'RAW.JAFFLE_SHOP.RAW_CUSTOMERS' does not exist or not authorized.
  compiled code at target/run/jaffle_shop/models/staging/stg_customers.sql
[0m14:39:10.851870 [info ] [MainThread]: 
[0m14:39:10.852325 [error] [MainThread]:   Database Error in model stg_orders (models/staging/stg_orders.sql)
  002003 (42S02): SQL compilation error:
  Object 'RAW.JAFFLE_SHOP.RAW_ORDERS' does not exist or not authorized.
  compiled code at target/run/jaffle_shop/models/staging/stg_orders.sql
[0m14:39:10.852667 [info ] [MainThread]: 
[0m14:39:10.853316 [error] [MainThread]:   Database Error in model stg_payments (models/staging/stg_payments.sql)
  002003 (42S02): SQL compilation error:
  Object 'RAW.JAFFLE_SHOP.RAW_PAYMENTS' does not exist or not authorized.
  compiled code at target/run/jaffle_shop/models/staging/stg_payments.sql
[0m14:39:10.853895 [info ] [MainThread]: 
[0m14:39:10.854319 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=3 SKIP=2 TOTAL=7
[0m14:39:10.855749 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 6.8441157, "process_user_time": 2.726244, "process_kernel_time": 0.357713, "process_mem_max_rss": "132165632", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:39:10.856323 [debug] [MainThread]: Command `dbt run` failed at 14:39:10.856221 after 6.84 seconds
[0m14:39:10.856755 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cc96310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cc96a50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1096e8d50>]}
[0m14:39:10.857143 [debug] [MainThread]: Flushing usage events
[0m14:41:35.526231 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10864fa50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1086c4590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1086c4ed0>]}


============================== 14:41:35.532078 | 2b004769-fd8e-404e-bdaf-7ba48d600ed8 ==============================
[0m14:41:35.532078 [info ] [MainThread]: Running with dbt=1.8.7
[0m14:41:35.532831 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/ben/Dbt Certification/dbt-tutorial/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/ben/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt seed', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:41:35.886487 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2b004769-fd8e-404e-bdaf-7ba48d600ed8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109095610>]}
[0m14:41:35.941771 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2b004769-fd8e-404e-bdaf-7ba48d600ed8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108106b50>]}
[0m14:41:35.942801 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m14:41:35.968438 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m14:41:36.107007 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:41:36.107528 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:41:36.158941 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2b004769-fd8e-404e-bdaf-7ba48d600ed8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1095e9a90>]}
[0m14:41:36.265987 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2b004769-fd8e-404e-bdaf-7ba48d600ed8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109385390>]}
[0m14:41:36.266577 [info ] [MainThread]: Found 7 models, 3 seeds, 11 data tests, 572 macros
[0m14:41:36.267001 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2b004769-fd8e-404e-bdaf-7ba48d600ed8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b1a390>]}
[0m14:41:36.269307 [info ] [MainThread]: 
[0m14:41:36.269994 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:41:36.274333 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ANALYTICS'
[0m14:41:36.292678 [debug] [ThreadPool]: Using snowflake connection "list_ANALYTICS"
[0m14:41:36.293195 [debug] [ThreadPool]: On list_ANALYTICS: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_ANALYTICS"} */
show terse schemas in database ANALYTICS
    limit 10000
[0m14:41:36.293551 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:41:37.315348 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.022 seconds
[0m14:41:37.319896 [debug] [ThreadPool]: On list_ANALYTICS: Close
[0m14:41:37.467750 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ANALYTICS, now list_ANALYTICS_JAFFLE_SHOP)
[0m14:41:37.485268 [debug] [ThreadPool]: Using snowflake connection "list_ANALYTICS_JAFFLE_SHOP"
[0m14:41:37.485989 [debug] [ThreadPool]: On list_ANALYTICS_JAFFLE_SHOP: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_ANALYTICS_JAFFLE_SHOP"} */
show objects in ANALYTICS.JAFFLE_SHOP limit 10000
[0m14:41:37.486494 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:41:38.140868 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.654 seconds
[0m14:41:38.145880 [debug] [ThreadPool]: On list_ANALYTICS_JAFFLE_SHOP: Close
[0m14:41:38.272258 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2b004769-fd8e-404e-bdaf-7ba48d600ed8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109359790>]}
[0m14:41:38.273323 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:41:38.273968 [info ] [MainThread]: 
[0m14:41:38.277803 [debug] [Thread-1 (]: Began running node seed.jaffle_shop.raw_customers
[0m14:41:38.278624 [debug] [Thread-2 (]: Began running node seed.jaffle_shop.raw_orders
[0m14:41:38.279261 [debug] [Thread-3 (]: Began running node seed.jaffle_shop.raw_payments
[0m14:41:38.280094 [info ] [Thread-1 (]: 1 of 3 START seed file JAFFLE_SHOP.raw_customers ............................... [RUN]
[0m14:41:38.280936 [info ] [Thread-2 (]: 2 of 3 START seed file JAFFLE_SHOP.raw_orders .................................. [RUN]
[0m14:41:38.282059 [info ] [Thread-3 (]: 3 of 3 START seed file JAFFLE_SHOP.raw_payments ................................ [RUN]
[0m14:41:38.283271 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_ANALYTICS_JAFFLE_SHOP, now seed.jaffle_shop.raw_customers)
[0m14:41:38.284355 [debug] [Thread-2 (]: Acquiring new snowflake connection 'seed.jaffle_shop.raw_orders'
[0m14:41:38.285135 [debug] [Thread-3 (]: Acquiring new snowflake connection 'seed.jaffle_shop.raw_payments'
[0m14:41:38.285719 [debug] [Thread-1 (]: Began compiling node seed.jaffle_shop.raw_customers
[0m14:41:38.286447 [debug] [Thread-2 (]: Began compiling node seed.jaffle_shop.raw_orders
[0m14:41:38.287242 [debug] [Thread-3 (]: Began compiling node seed.jaffle_shop.raw_payments
[0m14:41:38.287985 [debug] [Thread-1 (]: Began executing node seed.jaffle_shop.raw_customers
[0m14:41:38.288825 [debug] [Thread-2 (]: Began executing node seed.jaffle_shop.raw_orders
[0m14:41:38.289604 [debug] [Thread-3 (]: Began executing node seed.jaffle_shop.raw_payments
[0m14:41:38.332909 [debug] [Thread-1 (]: Using snowflake connection "seed.jaffle_shop.raw_customers"
[0m14:41:38.337432 [debug] [Thread-2 (]: Using snowflake connection "seed.jaffle_shop.raw_orders"
[0m14:41:38.341557 [debug] [Thread-1 (]: On seed.jaffle_shop.raw_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_customers"} */
create table ANALYTICS.JAFFLE_SHOP.raw_customers (id integer,first_name text,last_name text)
[0m14:41:38.345290 [debug] [Thread-3 (]: Using snowflake connection "seed.jaffle_shop.raw_payments"
[0m14:41:38.345707 [debug] [Thread-2 (]: On seed.jaffle_shop.raw_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_orders"} */
create table ANALYTICS.JAFFLE_SHOP.raw_orders (id integer,user_id integer,order_date date,status text)
[0m14:41:38.346080 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:41:38.346442 [debug] [Thread-3 (]: On seed.jaffle_shop.raw_payments: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_payments"} */
create table ANALYTICS.JAFFLE_SHOP.raw_payments (id integer,order_id integer,payment_method text,amount integer)
[0m14:41:38.346822 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m14:41:38.348090 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m14:41:38.827001 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.479 seconds
[0m14:41:38.857348 [debug] [Thread-3 (]: Using snowflake connection "seed.jaffle_shop.raw_payments"
[0m14:41:38.858667 [debug] [Thread-3 (]: On seed.jaffle_shop.raw_payments: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_payments"} */
BEGIN
[0m14:41:38.859673 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.513 seconds
[0m14:41:38.864119 [debug] [Thread-2 (]: Using snowflake connection "seed.jaffle_shop.raw_orders"
[0m14:41:38.864736 [debug] [Thread-2 (]: On seed.jaffle_shop.raw_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_orders"} */
BEGIN
[0m14:41:38.987266 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.122 seconds
[0m14:41:38.993297 [debug] [Thread-2 (]: Using snowflake connection "seed.jaffle_shop.raw_orders"
[0m14:41:38.994093 [debug] [Thread-2 (]: On seed.jaffle_shop.raw_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_orders"} */
insert into ANALYTICS.JAFFLE_SHOP.raw_orders (id, user_id, order_date, status) values
            (%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%...
[0m14:41:38.995445 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.135 seconds
[0m14:41:39.003595 [debug] [Thread-3 (]: Using snowflake connection "seed.jaffle_shop.raw_payments"
[0m14:41:39.004473 [debug] [Thread-3 (]: On seed.jaffle_shop.raw_payments: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_payments"} */
insert into ANALYTICS.JAFFLE_SHOP.raw_payments (id, order_id, payment_method, amount) values
            (%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s)...
[0m14:41:39.131302 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.785 seconds
[0m14:41:39.138635 [debug] [Thread-1 (]: Using snowflake connection "seed.jaffle_shop.raw_customers"
[0m14:41:39.139571 [debug] [Thread-1 (]: On seed.jaffle_shop.raw_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_customers"} */
BEGIN
[0m14:41:39.257329 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.117 seconds
[0m14:41:39.264708 [debug] [Thread-1 (]: Using snowflake connection "seed.jaffle_shop.raw_customers"
[0m14:41:39.265769 [debug] [Thread-1 (]: On seed.jaffle_shop.raw_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_customers"} */
insert into ANALYTICS.JAFFLE_SHOP.raw_customers (id, first_name, last_name) values
            (%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s)...
[0m14:41:39.737127 [debug] [Thread-3 (]: SQL status: SUCCESS 113 in 0.731 seconds
[0m14:41:39.739521 [debug] [Thread-2 (]: SQL status: SUCCESS 99 in 0.743 seconds
[0m14:41:39.740832 [debug] [Thread-3 (]: Using snowflake connection "seed.jaffle_shop.raw_payments"
[0m14:41:39.741807 [debug] [Thread-2 (]: Using snowflake connection "seed.jaffle_shop.raw_orders"
[0m14:41:39.742634 [debug] [Thread-3 (]: On seed.jaffle_shop.raw_payments: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_payments"} */
COMMIT
[0m14:41:39.743716 [debug] [Thread-2 (]: On seed.jaffle_shop.raw_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_orders"} */
COMMIT
[0m14:41:39.765894 [debug] [Thread-1 (]: SQL status: SUCCESS 100 in 0.499 seconds
[0m14:41:39.767148 [debug] [Thread-1 (]: Using snowflake connection "seed.jaffle_shop.raw_customers"
[0m14:41:39.768045 [debug] [Thread-1 (]: On seed.jaffle_shop.raw_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_customers"} */
COMMIT
[0m14:41:40.047415 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.302 seconds
[0m14:41:40.049563 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.304 seconds
[0m14:41:40.062802 [debug] [Thread-3 (]: Writing runtime SQL for node "seed.jaffle_shop.raw_payments"
[0m14:41:40.064051 [debug] [Thread-2 (]: Writing runtime SQL for node "seed.jaffle_shop.raw_orders"
[0m14:41:40.106510 [debug] [Thread-2 (]: On seed.jaffle_shop.raw_orders: Close
[0m14:41:40.107519 [debug] [Thread-3 (]: On seed.jaffle_shop.raw_payments: Close
[0m14:41:40.108285 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.340 seconds
[0m14:41:40.112320 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.jaffle_shop.raw_customers"
[0m14:41:40.115181 [debug] [Thread-1 (]: On seed.jaffle_shop.raw_customers: Close
[0m14:41:40.257140 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2b004769-fd8e-404e-bdaf-7ba48d600ed8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1094dcb50>]}
[0m14:41:40.258608 [info ] [Thread-3 (]: 3 of 3 OK loaded seed file JAFFLE_SHOP.raw_payments ............................ [[32mINSERT 113[0m in 1.97s]
[0m14:41:40.260209 [debug] [Thread-3 (]: Finished running node seed.jaffle_shop.raw_payments
[0m14:41:40.264690 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2b004769-fd8e-404e-bdaf-7ba48d600ed8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1092ffad0>]}
[0m14:41:40.265839 [info ] [Thread-2 (]: 2 of 3 OK loaded seed file JAFFLE_SHOP.raw_orders .............................. [[32mINSERT 99[0m in 1.98s]
[0m14:41:40.267156 [debug] [Thread-2 (]: Finished running node seed.jaffle_shop.raw_orders
[0m14:41:40.271686 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2b004769-fd8e-404e-bdaf-7ba48d600ed8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1099e0590>]}
[0m14:41:40.272874 [info ] [Thread-1 (]: 1 of 3 OK loaded seed file JAFFLE_SHOP.raw_customers ........................... [[32mINSERT 100[0m in 1.99s]
[0m14:41:40.273997 [debug] [Thread-1 (]: Finished running node seed.jaffle_shop.raw_customers
[0m14:41:40.275984 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:41:40.276544 [debug] [MainThread]: Connection 'seed.jaffle_shop.raw_customers' was properly closed.
[0m14:41:40.277125 [debug] [MainThread]: Connection 'seed.jaffle_shop.raw_orders' was properly closed.
[0m14:41:40.277861 [debug] [MainThread]: Connection 'seed.jaffle_shop.raw_payments' was properly closed.
[0m14:41:40.278471 [info ] [MainThread]: 
[0m14:41:40.279150 [info ] [MainThread]: Finished running 3 seeds in 0 hours 0 minutes and 4.01 seconds (4.01s).
[0m14:41:40.280621 [debug] [MainThread]: Command end result
[0m14:41:40.318319 [info ] [MainThread]: 
[0m14:41:40.319122 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:41:40.319617 [info ] [MainThread]: 
[0m14:41:40.320181 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m14:41:40.321764 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": true, "command_wall_clock_time": 4.8680763, "process_user_time": 2.658631, "process_kernel_time": 0.357866, "process_mem_max_rss": "129593344", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:41:40.322415 [debug] [MainThread]: Command `dbt seed` succeeded at 14:41:40.322308 after 4.87 seconds
[0m14:41:40.322866 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105141390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1098ee3d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105090c50>]}
[0m14:41:40.323256 [debug] [MainThread]: Flushing usage events
[0m14:41:45.566366 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105165490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105188690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105188fd0>]}


============================== 14:41:45.572486 | 5c99629b-7d00-4850-a9e9-cd2a1f52bafa ==============================
[0m14:41:45.572486 [info ] [MainThread]: Running with dbt=1.8.7
[0m14:41:45.573210 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/ben/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/Users/ben/Dbt Certification/dbt-tutorial/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m14:41:45.926230 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5c99629b-7d00-4850-a9e9-cd2a1f52bafa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105165a50>]}
[0m14:41:45.982979 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5c99629b-7d00-4850-a9e9-cd2a1f52bafa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104bdec90>]}
[0m14:41:45.984131 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m14:41:46.010932 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m14:41:46.149876 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:41:46.150454 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:41:46.198721 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5c99629b-7d00-4850-a9e9-cd2a1f52bafa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105cb9ed0>]}
[0m14:41:46.306795 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5c99629b-7d00-4850-a9e9-cd2a1f52bafa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ed1250>]}
[0m14:41:46.307565 [info ] [MainThread]: Found 7 models, 3 seeds, 11 data tests, 572 macros
[0m14:41:46.308010 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5c99629b-7d00-4850-a9e9-cd2a1f52bafa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ebe950>]}
[0m14:41:46.310278 [info ] [MainThread]: 
[0m14:41:46.311001 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:41:46.315574 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ANALYTICS'
[0m14:41:46.333592 [debug] [ThreadPool]: Using snowflake connection "list_ANALYTICS"
[0m14:41:46.334113 [debug] [ThreadPool]: On list_ANALYTICS: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_ANALYTICS"} */
show terse schemas in database ANALYTICS
    limit 10000
[0m14:41:46.334463 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:41:47.045398 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.711 seconds
[0m14:41:47.049322 [debug] [ThreadPool]: On list_ANALYTICS: Close
[0m14:41:47.214241 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ANALYTICS, now list_ANALYTICS_JAFFLE_SHOP)
[0m14:41:47.232580 [debug] [ThreadPool]: Using snowflake connection "list_ANALYTICS_JAFFLE_SHOP"
[0m14:41:47.233359 [debug] [ThreadPool]: On list_ANALYTICS_JAFFLE_SHOP: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_ANALYTICS_JAFFLE_SHOP"} */
show objects in ANALYTICS.JAFFLE_SHOP limit 10000
[0m14:41:47.233862 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:41:48.189659 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.956 seconds
[0m14:41:48.194917 [debug] [ThreadPool]: On list_ANALYTICS_JAFFLE_SHOP: Close
[0m14:41:48.356355 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5c99629b-7d00-4850-a9e9-cd2a1f52bafa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e77790>]}
[0m14:41:48.358234 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:41:48.359159 [info ] [MainThread]: 
[0m14:41:48.364172 [debug] [Thread-1 (]: Began running node model.jaffle_shop.customer_orders
[0m14:41:48.365155 [debug] [Thread-2 (]: Began running node model.jaffle_shop.int_orders_test
[0m14:41:48.366180 [debug] [Thread-3 (]: Began running node model.jaffle_shop.stg_customers
[0m14:41:48.366979 [debug] [Thread-4 (]: Began running node model.jaffle_shop.stg_orders
[0m14:41:48.367892 [info ] [Thread-1 (]: 1 of 7 START sql table model JAFFLE_SHOP.customer_orders ....................... [RUN]
[0m14:41:48.369031 [info ] [Thread-2 (]: 2 of 7 START sql view model JAFFLE_SHOP.int_orders_test ........................ [RUN]
[0m14:41:48.370096 [info ] [Thread-3 (]: 3 of 7 START sql view model JAFFLE_SHOP.stg_customers .......................... [RUN]
[0m14:41:48.371087 [info ] [Thread-4 (]: 4 of 7 START sql view model JAFFLE_SHOP.stg_orders ............................. [RUN]
[0m14:41:48.372008 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_ANALYTICS_JAFFLE_SHOP, now model.jaffle_shop.customer_orders)
[0m14:41:48.372866 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.jaffle_shop.int_orders_test'
[0m14:41:48.373984 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.jaffle_shop.stg_customers'
[0m14:41:48.375084 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.jaffle_shop.stg_orders'
[0m14:41:48.375997 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.customer_orders
[0m14:41:48.376758 [debug] [Thread-2 (]: Began compiling node model.jaffle_shop.int_orders_test
[0m14:41:48.377668 [debug] [Thread-3 (]: Began compiling node model.jaffle_shop.stg_customers
[0m14:41:48.378481 [debug] [Thread-4 (]: Began compiling node model.jaffle_shop.stg_orders
[0m14:41:48.388862 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.customer_orders"
[0m14:41:48.404976 [debug] [Thread-2 (]: Using snowflake connection "model.jaffle_shop.int_orders_test"
[0m14:41:48.407796 [debug] [Thread-3 (]: Writing injected SQL for node "model.jaffle_shop.stg_customers"
[0m14:41:48.410452 [debug] [Thread-4 (]: Writing injected SQL for node "model.jaffle_shop.stg_orders"
[0m14:41:48.411270 [debug] [Thread-2 (]: On model.jaffle_shop.int_orders_test: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.int_orders_test"} */
select datediff(
        day,
        cast('2023-01-01' as date),
        cast('2024-01-01' as date)
        )
[0m14:41:48.412650 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.customer_orders
[0m14:41:48.413021 [debug] [Thread-3 (]: Began executing node model.jaffle_shop.stg_customers
[0m14:41:48.413443 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m14:41:48.413887 [debug] [Thread-4 (]: Began executing node model.jaffle_shop.stg_orders
[0m14:41:48.458417 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.customer_orders"
[0m14:41:48.466846 [debug] [Thread-3 (]: Writing runtime sql for node "model.jaffle_shop.stg_customers"
[0m14:41:48.471395 [debug] [Thread-4 (]: Writing runtime sql for node "model.jaffle_shop.stg_orders"
[0m14:41:48.474795 [debug] [Thread-1 (]: Using snowflake connection "model.jaffle_shop.customer_orders"
[0m14:41:48.475560 [debug] [Thread-3 (]: Using snowflake connection "model.jaffle_shop.stg_customers"
[0m14:41:48.476042 [debug] [Thread-1 (]: On model.jaffle_shop.customer_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.customer_orders"} */
create or replace transient table ANALYTICS.JAFFLE_SHOP.customer_orders
         as
        (WITH paid_orders as (select Orders.ID as order_id,
    Orders.USER_ID	as customer_id,
    Orders.ORDER_DATE AS order_placed_at,
        Orders.STATUS AS order_status,
    p.total_amount_paid,
    p.payment_finalized_date,
    C.FIRST_NAME    as customer_first_name,
        C.LAST_NAME as customer_last_name
FROM raw.jaffle_shop.orders as Orders
left join (select ORDERID as order_id, max(CREATED) as payment_finalized_date, sum(AMOUNT) / 100.0 as total_amount_paid
        from raw.stripe.payment
        where STATUS <> 'fail'
        group by 1) p ON orders.ID = p.order_id
left join raw.jaffle_shop.customers C on orders.USER_ID = C.ID ),

customer_orders 
as (select C.ID as customer_id
    , min(ORDER_DATE) as first_order_date
    , max(ORDER_DATE) as most_recent_order_date
    , count(ORDERS.ID) AS number_of_orders
from raw.jaffle_shop.customers C 
left join raw.jaffle_shop.orders as Orders
on orders.USER_ID = C.ID 
group by 1)

select
p.*,
ROW_NUMBER() OVER (ORDER BY p.order_id) as transaction_seq,
ROW_NUMBER() OVER (PARTITION BY customer_id ORDER BY p.order_id) as customer_sales_seq,
CASE WHEN c.first_order_date = p.order_placed_at
THEN 'new'
ELSE 'return' END as nvsr,
x.clv_bad as customer_lifetime_value,
c.first_order_date as fdos
FROM paid_orders p
left join customer_orders as c USING (customer_id)
LEFT OUTER JOIN 
(
        select
        p.order_id,
        sum(t2.total_amount_paid) as clv_bad
    from paid_orders p
    left join paid_orders t2 on p.customer_id = t2.customer_id and p.order_id >= t2.order_id
    group by 1
    order by p.order_id
) x on x.order_id = p.order_id
ORDER BY order_id
        );
[0m14:41:48.476817 [debug] [Thread-3 (]: On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */
create or replace   view ANALYTICS.JAFFLE_SHOP.stg_customers
  
   as (
    -- noinspection SqlNoDataSourceInspectionForFile



select
    id as customer_id,
    first_name,
    last_name

from raw.jaffle_shop.raw_customers
  );
[0m14:41:48.477617 [debug] [Thread-4 (]: Using snowflake connection "model.jaffle_shop.stg_orders"
[0m14:41:48.478022 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:41:48.479129 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m14:41:48.479713 [debug] [Thread-4 (]: On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */
create or replace   view ANALYTICS.JAFFLE_SHOP.stg_orders
  
   as (
    

select
    id as order_id,
    user_id as customer_id,
    order_date,
    status

from raw.jaffle_shop.raw_orders
  );
[0m14:41:48.483764 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m14:41:49.069986 [debug] [Thread-4 (]: Snowflake adapter: Snowflake query id: 01b7b641-0000-8615-002a-0903000280f2
[0m14:41:49.070940 [debug] [Thread-4 (]: Snowflake adapter: Snowflake error: 002003 (42S02): SQL compilation error:
Object 'RAW.JAFFLE_SHOP.RAW_ORDERS' does not exist or not authorized.
[0m14:41:49.071958 [debug] [Thread-4 (]: On model.jaffle_shop.stg_orders: Close
[0m14:41:49.098077 [debug] [Thread-3 (]: Snowflake adapter: Snowflake query id: 01b7b641-0000-854a-002a-09030001e196
[0m14:41:49.098729 [debug] [Thread-3 (]: Snowflake adapter: Snowflake error: 002003 (42S02): SQL compilation error:
Object 'RAW.JAFFLE_SHOP.RAW_CUSTOMERS' does not exist or not authorized.
[0m14:41:49.099489 [debug] [Thread-3 (]: On model.jaffle_shop.stg_customers: Close
[0m14:41:49.183049 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.769 seconds
[0m14:41:49.208655 [debug] [Thread-2 (]: Writing injected SQL for node "model.jaffle_shop.int_orders_test"
[0m14:41:49.209807 [debug] [Thread-2 (]: Began executing node model.jaffle_shop.int_orders_test
[0m14:41:49.213680 [debug] [Thread-2 (]: Writing runtime sql for node "model.jaffle_shop.int_orders_test"
[0m14:41:49.217137 [debug] [Thread-2 (]: Using snowflake connection "model.jaffle_shop.int_orders_test"
[0m14:41:49.219052 [debug] [Thread-2 (]: On model.jaffle_shop.int_orders_test: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.int_orders_test"} */
create or replace   view ANALYTICS.JAFFLE_SHOP.int_orders_test
  
   as (
    







with rawdata as (

    

    

    with p as (
        select 0 as generated_number union all select 1
    ), unioned as (

    select

    
    p0.generated_number * power(2, 0)
     + 
    
    p1.generated_number * power(2, 1)
     + 
    
    p2.generated_number * power(2, 2)
     + 
    
    p3.generated_number * power(2, 3)
     + 
    
    p4.generated_number * power(2, 4)
     + 
    
    p5.generated_number * power(2, 5)
     + 
    
    p6.generated_number * power(2, 6)
     + 
    
    p7.generated_number * power(2, 7)
     + 
    
    p8.generated_number * power(2, 8)
    
    
    + 1
    as generated_number

    from

    
    p as p0
     cross join 
    
    p as p1
     cross join 
    
    p as p2
     cross join 
    
    p as p3
     cross join 
    
    p as p4
     cross join 
    
    p as p5
     cross join 
    
    p as p6
     cross join 
    
    p as p7
     cross join 
    
    p as p8
    
    

    )

    select *
    from unioned
    where generated_number <= 365
    order by generated_number



),

all_periods as (

    select (
        

    dateadd(
        day,
        row_number() over (order by 1) - 1,
        cast('2023-01-01' as date)
        )


    ) as date_day
    from rawdata

),

filtered as (

    select *
    from all_periods
    where date_day <= cast('2024-01-01' as date)

)

select * from filtered


  );
[0m14:41:49.223564 [debug] [Thread-4 (]: Database Error in model stg_orders (models/staging/stg_orders.sql)
  002003 (42S02): SQL compilation error:
  Object 'RAW.JAFFLE_SHOP.RAW_ORDERS' does not exist or not authorized.
  compiled code at target/run/jaffle_shop/models/staging/stg_orders.sql
[0m14:41:49.225724 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5c99629b-7d00-4850-a9e9-cd2a1f52bafa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106012e10>]}
[0m14:41:49.226875 [error] [Thread-4 (]: 4 of 7 ERROR creating sql view model JAFFLE_SHOP.stg_orders .................... [[31mERROR[0m in 0.85s]
[0m14:41:49.227873 [debug] [Thread-4 (]: Finished running node model.jaffle_shop.stg_orders
[0m14:41:49.228549 [debug] [Thread-4 (]: Began running node model.jaffle_shop.stg_payments
[0m14:41:49.229830 [info ] [Thread-4 (]: 5 of 7 START sql view model JAFFLE_SHOP.stg_payments ........................... [RUN]
[0m14:41:49.230456 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.jaffle_shop.stg_orders, now model.jaffle_shop.stg_payments)
[0m14:41:49.230839 [debug] [Thread-4 (]: Began compiling node model.jaffle_shop.stg_payments
[0m14:41:49.234743 [debug] [Thread-4 (]: Writing injected SQL for node "model.jaffle_shop.stg_payments"
[0m14:41:49.235409 [debug] [Thread-4 (]: Began executing node model.jaffle_shop.stg_payments
[0m14:41:49.238309 [debug] [Thread-4 (]: Writing runtime sql for node "model.jaffle_shop.stg_payments"
[0m14:41:49.239332 [debug] [Thread-4 (]: Using snowflake connection "model.jaffle_shop.stg_payments"
[0m14:41:49.239780 [debug] [Thread-4 (]: On model.jaffle_shop.stg_payments: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_payments"} */
create or replace   view ANALYTICS.JAFFLE_SHOP.stg_payments
  
   as (
    

select
    id,
    order_id,
    payment_method,
    round(1.0 * amount / 100, 2) AS amount_usd

from raw.jaffle_shop.raw_payments
  );
[0m14:41:49.240160 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:41:49.247333 [debug] [Thread-3 (]: Database Error in model stg_customers (models/staging/stg_customers.sql)
  002003 (42S02): SQL compilation error:
  Object 'RAW.JAFFLE_SHOP.RAW_CUSTOMERS' does not exist or not authorized.
  compiled code at target/run/jaffle_shop/models/staging/stg_customers.sql
[0m14:41:49.249113 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5c99629b-7d00-4850-a9e9-cd2a1f52bafa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106331f90>]}
[0m14:41:49.250270 [error] [Thread-3 (]: 3 of 7 ERROR creating sql view model JAFFLE_SHOP.stg_customers ................. [[31mERROR[0m in 0.88s]
[0m14:41:49.250884 [debug] [Thread-3 (]: Finished running node model.jaffle_shop.stg_customers
[0m14:41:49.251909 [debug] [Thread-3 (]: Began running node model.jaffle_shop.customers
[0m14:41:49.252437 [info ] [Thread-3 (]: 6 of 7 SKIP relation JAFFLE_SHOP.customers ..................................... [[33mSKIP[0m]
[0m14:41:49.252914 [debug] [Thread-3 (]: Finished running node model.jaffle_shop.customers
[0m14:41:49.601872 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.382 seconds
[0m14:41:49.642030 [debug] [Thread-2 (]: On model.jaffle_shop.int_orders_test: Close
[0m14:41:49.784403 [debug] [Thread-4 (]: Snowflake adapter: Snowflake query id: 01b7b641-0000-854a-002a-09030001e19a
[0m14:41:49.785048 [debug] [Thread-4 (]: Snowflake adapter: Snowflake error: 002003 (42S02): SQL compilation error:
Object 'RAW.JAFFLE_SHOP.RAW_PAYMENTS' does not exist or not authorized.
[0m14:41:49.785674 [debug] [Thread-4 (]: On model.jaffle_shop.stg_payments: Close
[0m14:41:49.817015 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5c99629b-7d00-4850-a9e9-cd2a1f52bafa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1065c55d0>]}
[0m14:41:49.818387 [info ] [Thread-2 (]: 2 of 7 OK created sql view model JAFFLE_SHOP.int_orders_test ................... [[32mSUCCESS 1[0m in 1.44s]
[0m14:41:49.819805 [debug] [Thread-2 (]: Finished running node model.jaffle_shop.int_orders_test
[0m14:41:50.671936 [debug] [Thread-4 (]: Database Error in model stg_payments (models/staging/stg_payments.sql)
  002003 (42S02): SQL compilation error:
  Object 'RAW.JAFFLE_SHOP.RAW_PAYMENTS' does not exist or not authorized.
  compiled code at target/run/jaffle_shop/models/staging/stg_payments.sql
[0m14:41:50.673190 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5c99629b-7d00-4850-a9e9-cd2a1f52bafa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e28ed0>]}
[0m14:41:50.674644 [error] [Thread-4 (]: 5 of 7 ERROR creating sql view model JAFFLE_SHOP.stg_payments .................. [[31mERROR[0m in 1.44s]
[0m14:41:50.676025 [debug] [Thread-4 (]: Finished running node model.jaffle_shop.stg_payments
[0m14:41:50.678572 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.201 seconds
[0m14:41:50.682348 [debug] [Thread-1 (]: On model.jaffle_shop.customer_orders: Close
[0m14:41:50.684365 [debug] [Thread-3 (]: Began running node model.jaffle_shop.int_orders__pivoted
[0m14:41:50.685279 [info ] [Thread-3 (]: 7 of 7 SKIP relation JAFFLE_SHOP.int_orders__pivoted ........................... [[33mSKIP[0m]
[0m14:41:50.686817 [debug] [Thread-3 (]: Finished running node model.jaffle_shop.int_orders__pivoted
[0m14:41:50.827512 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5c99629b-7d00-4850-a9e9-cd2a1f52bafa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105144550>]}
[0m14:41:50.829011 [info ] [Thread-1 (]: 1 of 7 OK created sql table model JAFFLE_SHOP.customer_orders .................. [[32mSUCCESS 1[0m in 2.46s]
[0m14:41:50.830747 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.customer_orders
[0m14:41:50.833738 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:41:50.834549 [debug] [MainThread]: Connection 'model.jaffle_shop.customer_orders' was properly closed.
[0m14:41:50.835127 [debug] [MainThread]: Connection 'model.jaffle_shop.int_orders_test' was properly closed.
[0m14:41:50.835799 [debug] [MainThread]: Connection 'model.jaffle_shop.stg_customers' was properly closed.
[0m14:41:50.836344 [debug] [MainThread]: Connection 'model.jaffle_shop.stg_payments' was properly closed.
[0m14:41:50.837042 [info ] [MainThread]: 
[0m14:41:50.837665 [info ] [MainThread]: Finished running 6 view models, 1 table model in 0 hours 0 minutes and 4.53 seconds (4.53s).
[0m14:41:50.840094 [debug] [MainThread]: Command end result
[0m14:41:50.879078 [info ] [MainThread]: 
[0m14:41:50.879667 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
[0m14:41:50.880041 [info ] [MainThread]: 
[0m14:41:50.880486 [error] [MainThread]:   Database Error in model stg_orders (models/staging/stg_orders.sql)
  002003 (42S02): SQL compilation error:
  Object 'RAW.JAFFLE_SHOP.RAW_ORDERS' does not exist or not authorized.
  compiled code at target/run/jaffle_shop/models/staging/stg_orders.sql
[0m14:41:50.880833 [info ] [MainThread]: 
[0m14:41:50.881217 [error] [MainThread]:   Database Error in model stg_customers (models/staging/stg_customers.sql)
  002003 (42S02): SQL compilation error:
  Object 'RAW.JAFFLE_SHOP.RAW_CUSTOMERS' does not exist or not authorized.
  compiled code at target/run/jaffle_shop/models/staging/stg_customers.sql
[0m14:41:50.881587 [info ] [MainThread]: 
[0m14:41:50.882278 [error] [MainThread]:   Database Error in model stg_payments (models/staging/stg_payments.sql)
  002003 (42S02): SQL compilation error:
  Object 'RAW.JAFFLE_SHOP.RAW_PAYMENTS' does not exist or not authorized.
  compiled code at target/run/jaffle_shop/models/staging/stg_payments.sql
[0m14:41:50.882902 [info ] [MainThread]: 
[0m14:41:50.883381 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=3 SKIP=2 TOTAL=7
[0m14:41:50.885012 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 5.3917813, "process_user_time": 2.724746, "process_kernel_time": 0.365679, "process_mem_max_rss": "132403200", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:41:50.885795 [debug] [MainThread]: Command `dbt run` failed at 14:41:50.885571 after 5.39 seconds
[0m14:41:50.886297 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x101bb8b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x101bb8c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105189410>]}
[0m14:41:50.886686 [debug] [MainThread]: Flushing usage events
[0m14:42:03.365917 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b757e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b7b7d50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b7b7f90>]}


============================== 14:42:03.373570 | 06f994b8-0bd9-4619-ba5b-8b53ce64efb9 ==============================
[0m14:42:03.373570 [info ] [MainThread]: Running with dbt=1.8.7
[0m14:42:03.374880 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/ben/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/ben/Dbt Certification/dbt-tutorial/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt clean', 'send_anonymous_usage_stats': 'True'}
[0m14:42:03.490777 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '06f994b8-0bd9-4619-ba5b-8b53ce64efb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b833910>]}
[0m14:42:03.534958 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.24273703, "process_user_time": 1.34109, "process_kernel_time": 0.192344, "process_mem_max_rss": "94232576", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:42:03.535658 [debug] [MainThread]: Command `dbt clean` succeeded at 14:42:03.535520 after 0.24 seconds
[0m14:42:03.536112 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b7b7b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b84be10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1082a51d0>]}
[0m14:42:03.536569 [debug] [MainThread]: Flushing usage events
[0m14:42:07.367526 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113596990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1135effd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1136009d0>]}


============================== 14:42:07.373858 | ffbcf5c5-7bd7-4950-aae4-b7869e01297e ==============================
[0m14:42:07.373858 [info ] [MainThread]: Running with dbt=1.8.7
[0m14:42:07.374771 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/ben/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/Users/ben/Dbt Certification/dbt-tutorial/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt deps', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:42:07.488757 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ffbcf5c5-7bd7-4950-aae4-b7869e01297e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1135d5610>]}
[0m14:42:07.506958 [debug] [MainThread]: Set downloads directory='/var/folders/r5/kwzghqz92v73843mkcq0vhp40000gn/T/dbt-downloads-w1nvea0l'
[0m14:42:07.507468 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m14:42:07.685147 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m14:42:07.687444 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m14:42:07.820513 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m14:42:07.831642 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m14:42:08.196489 [info ] [MainThread]: Installed from version 1.3.0
[0m14:42:08.197283 [info ] [MainThread]: Up to date!
[0m14:42:08.198047 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'ffbcf5c5-7bd7-4950-aae4-b7869e01297e', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1121f20d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11225bc10>]}
[0m14:42:08.201213 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.9095322, "process_user_time": 1.451319, "process_kernel_time": 0.284881, "process_mem_max_rss": "96571392", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:42:08.202454 [debug] [MainThread]: Command `dbt deps` succeeded at 14:42:08.202222 after 0.91 seconds
[0m14:42:08.203279 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11367e390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1100e51d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110038350>]}
[0m14:42:08.204008 [debug] [MainThread]: Flushing usage events
[0m14:42:12.467135 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111db7a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111e05750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111e0e910>]}


============================== 14:42:12.473482 | 808401c8-8fb3-4b28-bbac-257aaaf63df9 ==============================
[0m14:42:12.473482 [info ] [MainThread]: Running with dbt=1.8.7
[0m14:42:12.474352 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/ben/Dbt Certification/dbt-tutorial/logs', 'profiles_dir': '/Users/ben/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:42:12.830334 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '808401c8-8fb3-4b28-bbac-257aaaf63df9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112af62d0>]}
[0m14:42:12.885739 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '808401c8-8fb3-4b28-bbac-257aaaf63df9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11186ead0>]}
[0m14:42:12.887050 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m14:42:12.912475 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m14:42:12.913600 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m14:42:12.914079 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '808401c8-8fb3-4b28-bbac-257aaaf63df9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112b45010>]}
[0m14:42:14.363713 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m14:42:14.364414 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '808401c8-8fb3-4b28-bbac-257aaaf63df9', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112ff91d0>]}
[0m14:42:14.597187 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '808401c8-8fb3-4b28-bbac-257aaaf63df9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112da0890>]}
[0m14:42:14.702186 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '808401c8-8fb3-4b28-bbac-257aaaf63df9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1130dcf50>]}
[0m14:42:14.702814 [info ] [MainThread]: Found 7 models, 3 seeds, 11 data tests, 572 macros
[0m14:42:14.703424 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '808401c8-8fb3-4b28-bbac-257aaaf63df9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112f5cfd0>]}
[0m14:42:14.706417 [info ] [MainThread]: 
[0m14:42:14.707331 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:42:14.712313 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ANALYTICS'
[0m14:42:14.721827 [debug] [ThreadPool]: Using snowflake connection "list_ANALYTICS"
[0m14:42:14.722423 [debug] [ThreadPool]: On list_ANALYTICS: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_ANALYTICS"} */
show terse schemas in database ANALYTICS
    limit 10000
[0m14:42:14.722845 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:42:15.421951 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.699 seconds
[0m14:42:15.425169 [debug] [ThreadPool]: On list_ANALYTICS: Close
[0m14:42:15.574405 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ANALYTICS, now list_ANALYTICS_JAFFLE_SHOP)
[0m14:42:15.592589 [debug] [ThreadPool]: Using snowflake connection "list_ANALYTICS_JAFFLE_SHOP"
[0m14:42:15.593348 [debug] [ThreadPool]: On list_ANALYTICS_JAFFLE_SHOP: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_ANALYTICS_JAFFLE_SHOP"} */
show objects in ANALYTICS.JAFFLE_SHOP limit 10000
[0m14:42:15.593936 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:42:16.169285 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.575 seconds
[0m14:42:16.174519 [debug] [ThreadPool]: On list_ANALYTICS_JAFFLE_SHOP: Close
[0m14:42:16.333813 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '808401c8-8fb3-4b28-bbac-257aaaf63df9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112e043d0>]}
[0m14:42:16.336183 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:42:16.337143 [info ] [MainThread]: 
[0m14:42:16.341867 [debug] [Thread-1 (]: Began running node model.jaffle_shop.customer_orders
[0m14:42:16.342911 [debug] [Thread-2 (]: Began running node model.jaffle_shop.int_orders_test
[0m14:42:16.343889 [info ] [Thread-1 (]: 1 of 7 START sql table model JAFFLE_SHOP.customer_orders ....................... [RUN]
[0m14:42:16.345358 [debug] [Thread-3 (]: Began running node model.jaffle_shop.stg_customers
[0m14:42:16.346166 [debug] [Thread-4 (]: Began running node model.jaffle_shop.stg_orders
[0m14:42:16.347050 [info ] [Thread-2 (]: 2 of 7 START sql view model JAFFLE_SHOP.int_orders_test ........................ [RUN]
[0m14:42:16.348045 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_ANALYTICS_JAFFLE_SHOP, now model.jaffle_shop.customer_orders)
[0m14:42:16.348945 [info ] [Thread-3 (]: 3 of 7 START sql view model JAFFLE_SHOP.stg_customers .......................... [RUN]
[0m14:42:16.349967 [info ] [Thread-4 (]: 4 of 7 START sql view model JAFFLE_SHOP.stg_orders ............................. [RUN]
[0m14:42:16.351360 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.jaffle_shop.int_orders_test'
[0m14:42:16.352143 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.customer_orders
[0m14:42:16.353181 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.jaffle_shop.stg_customers'
[0m14:42:16.354090 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.jaffle_shop.stg_orders'
[0m14:42:16.354700 [debug] [Thread-2 (]: Began compiling node model.jaffle_shop.int_orders_test
[0m14:42:16.365003 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.customer_orders"
[0m14:42:16.365633 [debug] [Thread-3 (]: Began compiling node model.jaffle_shop.stg_customers
[0m14:42:16.366129 [debug] [Thread-4 (]: Began compiling node model.jaffle_shop.stg_orders
[0m14:42:16.375663 [debug] [Thread-2 (]: Using snowflake connection "model.jaffle_shop.int_orders_test"
[0m14:42:16.442322 [debug] [Thread-3 (]: Writing injected SQL for node "model.jaffle_shop.stg_customers"
[0m14:42:16.445536 [debug] [Thread-4 (]: Writing injected SQL for node "model.jaffle_shop.stg_orders"
[0m14:42:16.446179 [debug] [Thread-2 (]: On model.jaffle_shop.int_orders_test: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.int_orders_test"} */
select datediff(
        day,
        cast('2023-01-01' as date),
        cast('2024-01-01' as date)
        )
[0m14:42:16.447297 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.customer_orders
[0m14:42:16.448035 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m14:42:16.448786 [debug] [Thread-3 (]: Began executing node model.jaffle_shop.stg_customers
[0m14:42:16.449237 [debug] [Thread-4 (]: Began executing node model.jaffle_shop.stg_orders
[0m14:42:16.481241 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.customer_orders"
[0m14:42:16.511524 [debug] [Thread-4 (]: Writing runtime sql for node "model.jaffle_shop.stg_orders"
[0m14:42:16.514907 [debug] [Thread-3 (]: Writing runtime sql for node "model.jaffle_shop.stg_customers"
[0m14:42:16.518592 [debug] [Thread-1 (]: Using snowflake connection "model.jaffle_shop.customer_orders"
[0m14:42:16.519140 [debug] [Thread-1 (]: On model.jaffle_shop.customer_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.customer_orders"} */
create or replace transient table ANALYTICS.JAFFLE_SHOP.customer_orders
         as
        (WITH paid_orders as (select Orders.ID as order_id,
    Orders.USER_ID	as customer_id,
    Orders.ORDER_DATE AS order_placed_at,
        Orders.STATUS AS order_status,
    p.total_amount_paid,
    p.payment_finalized_date,
    C.FIRST_NAME    as customer_first_name,
        C.LAST_NAME as customer_last_name
FROM raw.jaffle_shop.orders as Orders
left join (select ORDERID as order_id, max(CREATED) as payment_finalized_date, sum(AMOUNT) / 100.0 as total_amount_paid
        from raw.stripe.payment
        where STATUS <> 'fail'
        group by 1) p ON orders.ID = p.order_id
left join raw.jaffle_shop.customers C on orders.USER_ID = C.ID ),

customer_orders 
as (select C.ID as customer_id
    , min(ORDER_DATE) as first_order_date
    , max(ORDER_DATE) as most_recent_order_date
    , count(ORDERS.ID) AS number_of_orders
from raw.jaffle_shop.customers C 
left join raw.jaffle_shop.orders as Orders
on orders.USER_ID = C.ID 
group by 1)

select
p.*,
ROW_NUMBER() OVER (ORDER BY p.order_id) as transaction_seq,
ROW_NUMBER() OVER (PARTITION BY customer_id ORDER BY p.order_id) as customer_sales_seq,
CASE WHEN c.first_order_date = p.order_placed_at
THEN 'new'
ELSE 'return' END as nvsr,
x.clv_bad as customer_lifetime_value,
c.first_order_date as fdos
FROM paid_orders p
left join customer_orders as c USING (customer_id)
LEFT OUTER JOIN 
(
        select
        p.order_id,
        sum(t2.total_amount_paid) as clv_bad
    from paid_orders p
    left join paid_orders t2 on p.customer_id = t2.customer_id and p.order_id >= t2.order_id
    group by 1
    order by p.order_id
) x on x.order_id = p.order_id
ORDER BY order_id
        );
[0m14:42:16.519631 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:42:16.521624 [debug] [Thread-4 (]: Using snowflake connection "model.jaffle_shop.stg_orders"
[0m14:42:16.522135 [debug] [Thread-4 (]: On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */
create or replace   view ANALYTICS.JAFFLE_SHOP.stg_orders
  
   as (
    

select
    id as order_id,
    user_id as customer_id,
    order_date,
    status

from raw.jaffle_shop.raw_orders
  );
[0m14:42:16.522716 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m14:42:16.523516 [debug] [Thread-3 (]: Using snowflake connection "model.jaffle_shop.stg_customers"
[0m14:42:16.525839 [debug] [Thread-3 (]: On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */
create or replace   view ANALYTICS.JAFFLE_SHOP.stg_customers
  
   as (
    -- noinspection SqlNoDataSourceInspectionForFile



select
    id as customer_id,
    first_name,
    last_name

from raw.jaffle_shop.raw_customers
  );
[0m14:42:16.527219 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m14:42:17.193128 [debug] [Thread-3 (]: Snowflake adapter: Snowflake query id: 01b7b642-0000-864f-002a-0903000290b2
[0m14:42:17.195673 [debug] [Thread-3 (]: Snowflake adapter: Snowflake error: 002003 (42S02): SQL compilation error:
Object 'RAW.JAFFLE_SHOP.RAW_CUSTOMERS' does not exist or not authorized.
[0m14:42:17.197137 [debug] [Thread-3 (]: On model.jaffle_shop.stg_customers: Close
[0m14:42:17.200613 [debug] [Thread-4 (]: Snowflake adapter: Snowflake query id: 01b7b642-0000-85ce-002a-09030002512a
[0m14:42:17.202270 [debug] [Thread-4 (]: Snowflake adapter: Snowflake error: 002003 (42S02): SQL compilation error:
Object 'RAW.JAFFLE_SHOP.RAW_ORDERS' does not exist or not authorized.
[0m14:42:17.203400 [debug] [Thread-4 (]: On model.jaffle_shop.stg_orders: Close
[0m14:42:17.208107 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.760 seconds
[0m14:42:17.212135 [debug] [Thread-2 (]: Writing injected SQL for node "model.jaffle_shop.int_orders_test"
[0m14:42:17.214539 [debug] [Thread-2 (]: Began executing node model.jaffle_shop.int_orders_test
[0m14:42:17.219076 [debug] [Thread-2 (]: Writing runtime sql for node "model.jaffle_shop.int_orders_test"
[0m14:42:17.224417 [debug] [Thread-2 (]: Using snowflake connection "model.jaffle_shop.int_orders_test"
[0m14:42:17.225178 [debug] [Thread-2 (]: On model.jaffle_shop.int_orders_test: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.int_orders_test"} */
create or replace   view ANALYTICS.JAFFLE_SHOP.int_orders_test
  
   as (
    







with rawdata as (

    

    

    with p as (
        select 0 as generated_number union all select 1
    ), unioned as (

    select

    
    p0.generated_number * power(2, 0)
     + 
    
    p1.generated_number * power(2, 1)
     + 
    
    p2.generated_number * power(2, 2)
     + 
    
    p3.generated_number * power(2, 3)
     + 
    
    p4.generated_number * power(2, 4)
     + 
    
    p5.generated_number * power(2, 5)
     + 
    
    p6.generated_number * power(2, 6)
     + 
    
    p7.generated_number * power(2, 7)
     + 
    
    p8.generated_number * power(2, 8)
    
    
    + 1
    as generated_number

    from

    
    p as p0
     cross join 
    
    p as p1
     cross join 
    
    p as p2
     cross join 
    
    p as p3
     cross join 
    
    p as p4
     cross join 
    
    p as p5
     cross join 
    
    p as p6
     cross join 
    
    p as p7
     cross join 
    
    p as p8
    
    

    )

    select *
    from unioned
    where generated_number <= 365
    order by generated_number



),

all_periods as (

    select (
        

    dateadd(
        day,
        row_number() over (order by 1) - 1,
        cast('2023-01-01' as date)
        )


    ) as date_day
    from rawdata

),

filtered as (

    select *
    from all_periods
    where date_day <= cast('2024-01-01' as date)

)

select * from filtered


  );
[0m14:42:17.341491 [debug] [Thread-3 (]: Database Error in model stg_customers (models/staging/stg_customers.sql)
  002003 (42S02): SQL compilation error:
  Object 'RAW.JAFFLE_SHOP.RAW_CUSTOMERS' does not exist or not authorized.
  compiled code at target/run/jaffle_shop/models/staging/stg_customers.sql
[0m14:42:17.344983 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '808401c8-8fb3-4b28-bbac-257aaaf63df9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112f33b90>]}
[0m14:42:17.346274 [error] [Thread-3 (]: 3 of 7 ERROR creating sql view model JAFFLE_SHOP.stg_customers ................. [[31mERROR[0m in 0.99s]
[0m14:42:17.347488 [debug] [Thread-3 (]: Finished running node model.jaffle_shop.stg_customers
[0m14:42:17.348358 [debug] [Thread-3 (]: Began running node model.jaffle_shop.stg_payments
[0m14:42:17.350624 [info ] [Thread-3 (]: 5 of 7 START sql view model JAFFLE_SHOP.stg_payments ........................... [RUN]
[0m14:42:17.351578 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.jaffle_shop.stg_customers, now model.jaffle_shop.stg_payments)
[0m14:42:17.352305 [debug] [Thread-3 (]: Began compiling node model.jaffle_shop.stg_payments
[0m14:42:17.357585 [debug] [Thread-3 (]: Writing injected SQL for node "model.jaffle_shop.stg_payments"
[0m14:42:17.358648 [debug] [Thread-3 (]: Began executing node model.jaffle_shop.stg_payments
[0m14:42:17.362635 [debug] [Thread-3 (]: Writing runtime sql for node "model.jaffle_shop.stg_payments"
[0m14:42:17.363951 [debug] [Thread-3 (]: Using snowflake connection "model.jaffle_shop.stg_payments"
[0m14:42:17.364561 [debug] [Thread-3 (]: On model.jaffle_shop.stg_payments: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_payments"} */
create or replace   view ANALYTICS.JAFFLE_SHOP.stg_payments
  
   as (
    

select
    id,
    order_id,
    payment_method,
    round(1.0 * amount / 100, 2) AS amount_usd

from raw.jaffle_shop.raw_payments
  );
[0m14:42:17.365316 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:42:17.374401 [debug] [Thread-4 (]: Database Error in model stg_orders (models/staging/stg_orders.sql)
  002003 (42S02): SQL compilation error:
  Object 'RAW.JAFFLE_SHOP.RAW_ORDERS' does not exist or not authorized.
  compiled code at target/run/jaffle_shop/models/staging/stg_orders.sql
[0m14:42:17.375237 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '808401c8-8fb3-4b28-bbac-257aaaf63df9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11333c5d0>]}
[0m14:42:17.376015 [error] [Thread-4 (]: 4 of 7 ERROR creating sql view model JAFFLE_SHOP.stg_orders .................... [[31mERROR[0m in 1.02s]
[0m14:42:17.376766 [debug] [Thread-4 (]: Finished running node model.jaffle_shop.stg_orders
[0m14:42:17.377731 [debug] [Thread-4 (]: Began running node model.jaffle_shop.customers
[0m14:42:17.378278 [info ] [Thread-4 (]: 6 of 7 SKIP relation JAFFLE_SHOP.customers ..................................... [[33mSKIP[0m]
[0m14:42:17.379122 [debug] [Thread-4 (]: Finished running node model.jaffle_shop.customers
[0m14:42:17.466956 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.241 seconds
[0m14:42:17.509658 [debug] [Thread-2 (]: On model.jaffle_shop.int_orders_test: Close
[0m14:42:17.659204 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '808401c8-8fb3-4b28-bbac-257aaaf63df9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112fa1b50>]}
[0m14:42:17.661178 [info ] [Thread-2 (]: 2 of 7 OK created sql view model JAFFLE_SHOP.int_orders_test ................... [[32mSUCCESS 1[0m in 1.31s]
[0m14:42:17.663176 [debug] [Thread-2 (]: Finished running node model.jaffle_shop.int_orders_test
[0m14:42:17.959697 [debug] [Thread-3 (]: Snowflake adapter: Snowflake query id: 01b7b642-0000-862e-002a-0903000261b2
[0m14:42:17.961062 [debug] [Thread-3 (]: Snowflake adapter: Snowflake error: 002003 (42S02): SQL compilation error:
Object 'RAW.JAFFLE_SHOP.RAW_PAYMENTS' does not exist or not authorized.
[0m14:42:17.962885 [debug] [Thread-3 (]: On model.jaffle_shop.stg_payments: Close
[0m14:42:18.132911 [debug] [Thread-3 (]: Database Error in model stg_payments (models/staging/stg_payments.sql)
  002003 (42S02): SQL compilation error:
  Object 'RAW.JAFFLE_SHOP.RAW_PAYMENTS' does not exist or not authorized.
  compiled code at target/run/jaffle_shop/models/staging/stg_payments.sql
[0m14:42:18.134286 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '808401c8-8fb3-4b28-bbac-257aaaf63df9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112b90390>]}
[0m14:42:18.135732 [error] [Thread-3 (]: 5 of 7 ERROR creating sql view model JAFFLE_SHOP.stg_payments .................. [[31mERROR[0m in 0.78s]
[0m14:42:18.137109 [debug] [Thread-3 (]: Finished running node model.jaffle_shop.stg_payments
[0m14:42:18.138329 [debug] [Thread-4 (]: Began running node model.jaffle_shop.int_orders__pivoted
[0m14:42:18.139252 [info ] [Thread-4 (]: 7 of 7 SKIP relation JAFFLE_SHOP.int_orders__pivoted ........................... [[33mSKIP[0m]
[0m14:42:18.140135 [debug] [Thread-4 (]: Finished running node model.jaffle_shop.int_orders__pivoted
[0m14:42:19.058231 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.538 seconds
[0m14:42:19.063376 [debug] [Thread-1 (]: On model.jaffle_shop.customer_orders: Close
[0m14:42:19.203033 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '808401c8-8fb3-4b28-bbac-257aaaf63df9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1134c3350>]}
[0m14:42:19.204935 [info ] [Thread-1 (]: 1 of 7 OK created sql table model JAFFLE_SHOP.customer_orders .................. [[32mSUCCESS 1[0m in 2.85s]
[0m14:42:19.207437 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.customer_orders
[0m14:42:19.210976 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:42:19.211849 [debug] [MainThread]: Connection 'model.jaffle_shop.customer_orders' was properly closed.
[0m14:42:19.212617 [debug] [MainThread]: Connection 'model.jaffle_shop.int_orders_test' was properly closed.
[0m14:42:19.213349 [debug] [MainThread]: Connection 'model.jaffle_shop.stg_payments' was properly closed.
[0m14:42:19.213955 [debug] [MainThread]: Connection 'model.jaffle_shop.stg_orders' was properly closed.
[0m14:42:19.214747 [info ] [MainThread]: 
[0m14:42:19.215479 [info ] [MainThread]: Finished running 6 view models, 1 table model in 0 hours 0 minutes and 4.51 seconds (4.51s).
[0m14:42:19.218064 [debug] [MainThread]: Command end result
[0m14:42:19.260732 [info ] [MainThread]: 
[0m14:42:19.261327 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
[0m14:42:19.261801 [info ] [MainThread]: 
[0m14:42:19.262274 [error] [MainThread]:   Database Error in model stg_customers (models/staging/stg_customers.sql)
  002003 (42S02): SQL compilation error:
  Object 'RAW.JAFFLE_SHOP.RAW_CUSTOMERS' does not exist or not authorized.
  compiled code at target/run/jaffle_shop/models/staging/stg_customers.sql
[0m14:42:19.262625 [info ] [MainThread]: 
[0m14:42:19.263023 [error] [MainThread]:   Database Error in model stg_orders (models/staging/stg_orders.sql)
  002003 (42S02): SQL compilation error:
  Object 'RAW.JAFFLE_SHOP.RAW_ORDERS' does not exist or not authorized.
  compiled code at target/run/jaffle_shop/models/staging/stg_orders.sql
[0m14:42:19.263346 [info ] [MainThread]: 
[0m14:42:19.263921 [error] [MainThread]:   Database Error in model stg_payments (models/staging/stg_payments.sql)
  002003 (42S02): SQL compilation error:
  Object 'RAW.JAFFLE_SHOP.RAW_PAYMENTS' does not exist or not authorized.
  compiled code at target/run/jaffle_shop/models/staging/stg_payments.sql
[0m14:42:19.264451 [info ] [MainThread]: 
[0m14:42:19.264876 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=3 SKIP=2 TOTAL=7
[0m14:42:19.266571 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 6.8761673, "process_user_time": 4.225028, "process_kernel_time": 0.38193, "process_mem_max_rss": "138366976", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:42:19.267164 [debug] [MainThread]: Command `dbt run` failed at 14:42:19.267062 after 6.88 seconds
[0m14:42:19.267595 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e820c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e820350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110102a10>]}
[0m14:42:19.267972 [debug] [MainThread]: Flushing usage events
[0m14:48:02.814504 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bf2ba90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bf7b6d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bfa0f90>]}


============================== 14:48:02.820610 | d86657a5-25cf-4cf3-9ea6-cbb7a52638c8 ==============================
[0m14:48:02.820610 [info ] [MainThread]: Running with dbt=1.8.7
[0m14:48:02.821377 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/Users/ben/.dbt', 'log_path': '/Users/ben/Dbt Certification/dbt-tutorial/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:48:03.197573 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd86657a5-25cf-4cf3-9ea6-cbb7a52638c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ca3fe10>]}
[0m14:48:03.254113 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd86657a5-25cf-4cf3-9ea6-cbb7a52638c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b9e2ad0>]}
[0m14:48:03.255068 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m14:48:03.281576 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m14:48:03.387885 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m14:48:03.388684 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'd86657a5-25cf-4cf3-9ea6-cbb7a52638c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10abc4910>]}
[0m14:48:04.834838 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m14:48:04.835526 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'd86657a5-25cf-4cf3-9ea6-cbb7a52638c8', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cd73cd0>]}
[0m14:48:05.055292 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd86657a5-25cf-4cf3-9ea6-cbb7a52638c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d05d690>]}
[0m14:48:05.155487 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd86657a5-25cf-4cf3-9ea6-cbb7a52638c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d347e10>]}
[0m14:48:05.156043 [info ] [MainThread]: Found 7 models, 3 seeds, 11 data tests, 572 macros
[0m14:48:05.156471 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd86657a5-25cf-4cf3-9ea6-cbb7a52638c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d298310>]}
[0m14:48:05.158625 [info ] [MainThread]: 
[0m14:48:05.159244 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:48:05.164327 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RAW'
[0m14:48:05.174943 [debug] [ThreadPool]: Using snowflake connection "list_RAW"
[0m14:48:05.175429 [debug] [ThreadPool]: On list_RAW: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_RAW"} */
show terse schemas in database RAW
    limit 10000
[0m14:48:05.175763 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:48:06.032024 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.856 seconds
[0m14:48:06.036755 [debug] [ThreadPool]: On list_RAW: Close
[0m14:48:06.246336 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RAW, now list_RAW_JAFFLE_SHOP)
[0m14:48:06.264001 [debug] [ThreadPool]: Using snowflake connection "list_RAW_JAFFLE_SHOP"
[0m14:48:06.264783 [debug] [ThreadPool]: On list_RAW_JAFFLE_SHOP: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_RAW_JAFFLE_SHOP"} */
show objects in RAW.JAFFLE_SHOP limit 10000
[0m14:48:06.265279 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:48:06.864220 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.599 seconds
[0m14:48:06.869120 [debug] [ThreadPool]: On list_RAW_JAFFLE_SHOP: Close
[0m14:48:07.019550 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd86657a5-25cf-4cf3-9ea6-cbb7a52638c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d0f1b90>]}
[0m14:48:07.020537 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:48:07.021674 [info ] [MainThread]: 
[0m14:48:07.025211 [debug] [Thread-1 (]: Began running node model.jaffle_shop.customer_orders
[0m14:48:07.025959 [debug] [Thread-2 (]: Began running node model.jaffle_shop.int_orders_test
[0m14:48:07.026833 [debug] [Thread-3 (]: Began running node model.jaffle_shop.stg_customers
[0m14:48:07.027583 [debug] [Thread-4 (]: Began running node model.jaffle_shop.stg_orders
[0m14:48:07.028346 [info ] [Thread-1 (]: 1 of 7 START sql table model JAFFLE_SHOP.customer_orders ....................... [RUN]
[0m14:48:07.029242 [info ] [Thread-2 (]: 2 of 7 START sql view model JAFFLE_SHOP.int_orders_test ........................ [RUN]
[0m14:48:07.029972 [info ] [Thread-3 (]: 3 of 7 START sql view model JAFFLE_SHOP.stg_customers .......................... [RUN]
[0m14:48:07.030719 [info ] [Thread-4 (]: 4 of 7 START sql view model JAFFLE_SHOP.stg_orders ............................. [RUN]
[0m14:48:07.032442 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_RAW_JAFFLE_SHOP, now model.jaffle_shop.customer_orders)
[0m14:48:07.035963 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.jaffle_shop.int_orders_test'
[0m14:48:07.036826 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.jaffle_shop.stg_customers'
[0m14:48:07.037440 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.jaffle_shop.stg_orders'
[0m14:48:07.037977 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.customer_orders
[0m14:48:07.038410 [debug] [Thread-2 (]: Began compiling node model.jaffle_shop.int_orders_test
[0m14:48:07.038768 [debug] [Thread-3 (]: Began compiling node model.jaffle_shop.stg_customers
[0m14:48:07.039151 [debug] [Thread-4 (]: Began compiling node model.jaffle_shop.stg_orders
[0m14:48:07.047030 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.customer_orders"
[0m14:48:07.053633 [debug] [Thread-2 (]: Using snowflake connection "model.jaffle_shop.int_orders_test"
[0m14:48:07.057470 [debug] [Thread-3 (]: Writing injected SQL for node "model.jaffle_shop.stg_customers"
[0m14:48:07.061582 [debug] [Thread-4 (]: Writing injected SQL for node "model.jaffle_shop.stg_orders"
[0m14:48:07.062431 [debug] [Thread-2 (]: On model.jaffle_shop.int_orders_test: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.int_orders_test"} */
select datediff(
        day,
        cast('2023-01-01' as date),
        cast('2024-01-01' as date)
        )
[0m14:48:07.063515 [debug] [Thread-3 (]: Began executing node model.jaffle_shop.stg_customers
[0m14:48:07.063958 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m14:48:07.064419 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.customer_orders
[0m14:48:07.071549 [debug] [Thread-4 (]: Began executing node model.jaffle_shop.stg_orders
[0m14:48:07.105529 [debug] [Thread-3 (]: Writing runtime sql for node "model.jaffle_shop.stg_customers"
[0m14:48:07.128778 [debug] [Thread-4 (]: Writing runtime sql for node "model.jaffle_shop.stg_orders"
[0m14:48:07.129522 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.customer_orders"
[0m14:48:07.131360 [debug] [Thread-3 (]: Using snowflake connection "model.jaffle_shop.stg_customers"
[0m14:48:07.131858 [debug] [Thread-3 (]: On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */
create or replace   view RAW.JAFFLE_SHOP.stg_customers
  
   as (
    -- noinspection SqlNoDataSourceInspectionForFile



select
    id as customer_id,
    first_name,
    last_name

from raw.jaffle_shop.raw_customers
  );
[0m14:48:07.132468 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m14:48:07.135471 [debug] [Thread-1 (]: Using snowflake connection "model.jaffle_shop.customer_orders"
[0m14:48:07.136596 [debug] [Thread-1 (]: On model.jaffle_shop.customer_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.customer_orders"} */
create or replace transient table RAW.JAFFLE_SHOP.customer_orders
         as
        (WITH paid_orders as (select Orders.ID as order_id,
    Orders.USER_ID	as customer_id,
    Orders.ORDER_DATE AS order_placed_at,
        Orders.STATUS AS order_status,
    p.total_amount_paid,
    p.payment_finalized_date,
    C.FIRST_NAME    as customer_first_name,
        C.LAST_NAME as customer_last_name
FROM raw.jaffle_shop.orders as Orders
left join (select ORDERID as order_id, max(CREATED) as payment_finalized_date, sum(AMOUNT) / 100.0 as total_amount_paid
        from raw.stripe.payment
        where STATUS <> 'fail'
        group by 1) p ON orders.ID = p.order_id
left join raw.jaffle_shop.customers C on orders.USER_ID = C.ID ),

customer_orders 
as (select C.ID as customer_id
    , min(ORDER_DATE) as first_order_date
    , max(ORDER_DATE) as most_recent_order_date
    , count(ORDERS.ID) AS number_of_orders
from raw.jaffle_shop.customers C 
left join raw.jaffle_shop.orders as Orders
on orders.USER_ID = C.ID 
group by 1)

select
p.*,
ROW_NUMBER() OVER (ORDER BY p.order_id) as transaction_seq,
ROW_NUMBER() OVER (PARTITION BY customer_id ORDER BY p.order_id) as customer_sales_seq,
CASE WHEN c.first_order_date = p.order_placed_at
THEN 'new'
ELSE 'return' END as nvsr,
x.clv_bad as customer_lifetime_value,
c.first_order_date as fdos
FROM paid_orders p
left join customer_orders as c USING (customer_id)
LEFT OUTER JOIN 
(
        select
        p.order_id,
        sum(t2.total_amount_paid) as clv_bad
    from paid_orders p
    left join paid_orders t2 on p.customer_id = t2.customer_id and p.order_id >= t2.order_id
    group by 1
    order by p.order_id
) x on x.order_id = p.order_id
ORDER BY order_id
        );
[0m14:48:07.137243 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:48:07.138074 [debug] [Thread-4 (]: Using snowflake connection "model.jaffle_shop.stg_orders"
[0m14:48:07.140964 [debug] [Thread-4 (]: On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */
create or replace   view RAW.JAFFLE_SHOP.stg_orders
  
   as (
    

select
    id as order_id,
    user_id as customer_id,
    order_date,
    status

from raw.jaffle_shop.raw_orders
  );
[0m14:48:07.141651 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m14:48:07.617090 [debug] [Thread-3 (]: Snowflake adapter: Snowflake query id: 01b7b648-0000-85ce-002a-090300025182
[0m14:48:07.618740 [debug] [Thread-3 (]: Snowflake adapter: Snowflake error: 002003 (42S02): SQL compilation error:
Object 'RAW.JAFFLE_SHOP.RAW_CUSTOMERS' does not exist or not authorized.
[0m14:48:07.621093 [debug] [Thread-3 (]: On model.jaffle_shop.stg_customers: Close
[0m14:48:07.692344 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.628 seconds
[0m14:48:07.698851 [debug] [Thread-2 (]: Writing injected SQL for node "model.jaffle_shop.int_orders_test"
[0m14:48:07.701648 [debug] [Thread-2 (]: Began executing node model.jaffle_shop.int_orders_test
[0m14:48:07.707619 [debug] [Thread-2 (]: Writing runtime sql for node "model.jaffle_shop.int_orders_test"
[0m14:48:07.712163 [debug] [Thread-2 (]: Using snowflake connection "model.jaffle_shop.int_orders_test"
[0m14:48:07.712967 [debug] [Thread-2 (]: On model.jaffle_shop.int_orders_test: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.int_orders_test"} */
create or replace   view RAW.JAFFLE_SHOP.int_orders_test
  
   as (
    







with rawdata as (

    

    

    with p as (
        select 0 as generated_number union all select 1
    ), unioned as (

    select

    
    p0.generated_number * power(2, 0)
     + 
    
    p1.generated_number * power(2, 1)
     + 
    
    p2.generated_number * power(2, 2)
     + 
    
    p3.generated_number * power(2, 3)
     + 
    
    p4.generated_number * power(2, 4)
     + 
    
    p5.generated_number * power(2, 5)
     + 
    
    p6.generated_number * power(2, 6)
     + 
    
    p7.generated_number * power(2, 7)
     + 
    
    p8.generated_number * power(2, 8)
    
    
    + 1
    as generated_number

    from

    
    p as p0
     cross join 
    
    p as p1
     cross join 
    
    p as p2
     cross join 
    
    p as p3
     cross join 
    
    p as p4
     cross join 
    
    p as p5
     cross join 
    
    p as p6
     cross join 
    
    p as p7
     cross join 
    
    p as p8
    
    

    )

    select *
    from unioned
    where generated_number <= 365
    order by generated_number



),

all_periods as (

    select (
        

    dateadd(
        day,
        row_number() over (order by 1) - 1,
        cast('2023-01-01' as date)
        )


    ) as date_day
    from rawdata

),

filtered as (

    select *
    from all_periods
    where date_day <= cast('2024-01-01' as date)

)

select * from filtered


  );
[0m14:48:07.806972 [debug] [Thread-3 (]: Database Error in model stg_customers (models/staging/stg_customers.sql)
  002003 (42S02): SQL compilation error:
  Object 'RAW.JAFFLE_SHOP.RAW_CUSTOMERS' does not exist or not authorized.
  compiled code at target/run/jaffle_shop/models/staging/stg_customers.sql
[0m14:48:07.810091 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd86657a5-25cf-4cf3-9ea6-cbb7a52638c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cbfa150>]}
[0m14:48:07.811541 [error] [Thread-3 (]: 3 of 7 ERROR creating sql view model JAFFLE_SHOP.stg_customers ................. [[31mERROR[0m in 0.77s]
[0m14:48:07.812859 [debug] [Thread-3 (]: Finished running node model.jaffle_shop.stg_customers
[0m14:48:07.813931 [debug] [Thread-3 (]: Began running node model.jaffle_shop.stg_payments
[0m14:48:07.816070 [info ] [Thread-3 (]: 5 of 7 START sql view model JAFFLE_SHOP.stg_payments ........................... [RUN]
[0m14:48:07.816969 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.jaffle_shop.stg_customers, now model.jaffle_shop.stg_payments)
[0m14:48:07.817637 [debug] [Thread-3 (]: Began compiling node model.jaffle_shop.stg_payments
[0m14:48:07.822669 [debug] [Thread-3 (]: Writing injected SQL for node "model.jaffle_shop.stg_payments"
[0m14:48:07.823681 [debug] [Thread-3 (]: Began executing node model.jaffle_shop.stg_payments
[0m14:48:07.828080 [debug] [Thread-3 (]: Writing runtime sql for node "model.jaffle_shop.stg_payments"
[0m14:48:07.829508 [debug] [Thread-3 (]: Using snowflake connection "model.jaffle_shop.stg_payments"
[0m14:48:07.830254 [debug] [Thread-3 (]: On model.jaffle_shop.stg_payments: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_payments"} */
create or replace   view RAW.JAFFLE_SHOP.stg_payments
  
   as (
    

select
    id,
    order_id,
    payment_method,
    round(1.0 * amount / 100, 2) AS amount_usd

from raw.jaffle_shop.raw_payments
  );
[0m14:48:07.831108 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:48:08.082005 [debug] [Thread-4 (]: Snowflake adapter: Snowflake query id: 01b7b648-0000-8600-002a-09030002717a
[0m14:48:08.083513 [debug] [Thread-4 (]: Snowflake adapter: Snowflake error: 002003 (42S02): SQL compilation error:
Object 'RAW.JAFFLE_SHOP.RAW_ORDERS' does not exist or not authorized.
[0m14:48:08.084843 [debug] [Thread-4 (]: On model.jaffle_shop.stg_orders: Close
[0m14:48:08.223871 [debug] [Thread-4 (]: Database Error in model stg_orders (models/staging/stg_orders.sql)
  002003 (42S02): SQL compilation error:
  Object 'RAW.JAFFLE_SHOP.RAW_ORDERS' does not exist or not authorized.
  compiled code at target/run/jaffle_shop/models/staging/stg_orders.sql
[0m14:48:08.225714 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd86657a5-25cf-4cf3-9ea6-cbb7a52638c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cbf4f10>]}
[0m14:48:08.227618 [error] [Thread-4 (]: 4 of 7 ERROR creating sql view model JAFFLE_SHOP.stg_orders .................... [[31mERROR[0m in 1.19s]
[0m14:48:08.229486 [debug] [Thread-4 (]: Finished running node model.jaffle_shop.stg_orders
[0m14:48:08.231773 [debug] [Thread-4 (]: Began running node model.jaffle_shop.customers
[0m14:48:08.233000 [info ] [Thread-4 (]: 6 of 7 SKIP relation JAFFLE_SHOP.customers ..................................... [[33mSKIP[0m]
[0m14:48:08.234725 [debug] [Thread-4 (]: Finished running node model.jaffle_shop.customers
[0m14:48:08.468574 [debug] [Thread-3 (]: Snowflake adapter: Snowflake query id: 01b7b648-0000-864f-002a-09030002911a
[0m14:48:08.469959 [debug] [Thread-3 (]: Snowflake adapter: Snowflake error: 002003 (42S02): SQL compilation error:
Object 'RAW.JAFFLE_SHOP.RAW_PAYMENTS' does not exist or not authorized.
[0m14:48:08.471540 [debug] [Thread-3 (]: On model.jaffle_shop.stg_payments: Close
[0m14:48:08.518839 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.805 seconds
[0m14:48:08.556035 [debug] [Thread-2 (]: On model.jaffle_shop.int_orders_test: Close
[0m14:48:08.634619 [debug] [Thread-3 (]: Database Error in model stg_payments (models/staging/stg_payments.sql)
  002003 (42S02): SQL compilation error:
  Object 'RAW.JAFFLE_SHOP.RAW_PAYMENTS' does not exist or not authorized.
  compiled code at target/run/jaffle_shop/models/staging/stg_payments.sql
[0m14:48:08.635882 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd86657a5-25cf-4cf3-9ea6-cbb7a52638c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d0748d0>]}
[0m14:48:08.637465 [error] [Thread-3 (]: 5 of 7 ERROR creating sql view model JAFFLE_SHOP.stg_payments .................. [[31mERROR[0m in 0.82s]
[0m14:48:08.638766 [debug] [Thread-3 (]: Finished running node model.jaffle_shop.stg_payments
[0m14:48:08.641584 [debug] [Thread-4 (]: Began running node model.jaffle_shop.int_orders__pivoted
[0m14:48:08.642610 [info ] [Thread-4 (]: 7 of 7 SKIP relation JAFFLE_SHOP.int_orders__pivoted ........................... [[33mSKIP[0m]
[0m14:48:08.643769 [debug] [Thread-4 (]: Finished running node model.jaffle_shop.int_orders__pivoted
[0m14:48:08.712580 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd86657a5-25cf-4cf3-9ea6-cbb7a52638c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b386e50>]}
[0m14:48:08.714533 [info ] [Thread-2 (]: 2 of 7 OK created sql view model JAFFLE_SHOP.int_orders_test ................... [[32mSUCCESS 1[0m in 1.68s]
[0m14:48:08.716584 [debug] [Thread-2 (]: Finished running node model.jaffle_shop.int_orders_test
[0m14:48:08.973003 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.836 seconds
[0m14:48:08.975485 [debug] [Thread-1 (]: On model.jaffle_shop.customer_orders: Close
[0m14:48:09.136761 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd86657a5-25cf-4cf3-9ea6-cbb7a52638c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a34f590>]}
[0m14:48:09.139030 [info ] [Thread-1 (]: 1 of 7 OK created sql table model JAFFLE_SHOP.customer_orders .................. [[32mSUCCESS 1[0m in 2.10s]
[0m14:48:09.141148 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.customer_orders
[0m14:48:09.144873 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:48:09.146236 [debug] [MainThread]: Connection 'model.jaffle_shop.customer_orders' was properly closed.
[0m14:48:09.147076 [debug] [MainThread]: Connection 'model.jaffle_shop.int_orders_test' was properly closed.
[0m14:48:09.147998 [debug] [MainThread]: Connection 'model.jaffle_shop.stg_payments' was properly closed.
[0m14:48:09.148639 [debug] [MainThread]: Connection 'model.jaffle_shop.stg_orders' was properly closed.
[0m14:48:09.149588 [info ] [MainThread]: 
[0m14:48:09.150316 [info ] [MainThread]: Finished running 6 view models, 1 table model in 0 hours 0 minutes and 3.99 seconds (3.99s).
[0m14:48:09.152596 [debug] [MainThread]: Command end result
[0m14:48:09.198181 [info ] [MainThread]: 
[0m14:48:09.198809 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
[0m14:48:09.199314 [info ] [MainThread]: 
[0m14:48:09.199830 [error] [MainThread]:   Database Error in model stg_customers (models/staging/stg_customers.sql)
  002003 (42S02): SQL compilation error:
  Object 'RAW.JAFFLE_SHOP.RAW_CUSTOMERS' does not exist or not authorized.
  compiled code at target/run/jaffle_shop/models/staging/stg_customers.sql
[0m14:48:09.200187 [info ] [MainThread]: 
[0m14:48:09.200589 [error] [MainThread]:   Database Error in model stg_orders (models/staging/stg_orders.sql)
  002003 (42S02): SQL compilation error:
  Object 'RAW.JAFFLE_SHOP.RAW_ORDERS' does not exist or not authorized.
  compiled code at target/run/jaffle_shop/models/staging/stg_orders.sql
[0m14:48:09.201042 [info ] [MainThread]: 
[0m14:48:09.201550 [error] [MainThread]:   Database Error in model stg_payments (models/staging/stg_payments.sql)
  002003 (42S02): SQL compilation error:
  Object 'RAW.JAFFLE_SHOP.RAW_PAYMENTS' does not exist or not authorized.
  compiled code at target/run/jaffle_shop/models/staging/stg_payments.sql
[0m14:48:09.201958 [info ] [MainThread]: 
[0m14:48:09.202827 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=3 SKIP=2 TOTAL=7
[0m14:48:09.204711 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 6.471201, "process_user_time": 4.364761, "process_kernel_time": 0.392935, "process_mem_max_rss": "138108928", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:48:09.205424 [debug] [MainThread]: Command `dbt run` failed at 14:48:09.205315 after 6.47 seconds
[0m14:48:09.206089 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bf80250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bf83f90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d348090>]}
[0m14:48:09.206830 [debug] [MainThread]: Flushing usage events
[0m14:48:20.074911 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b1a7050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b1a75d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b1ff950>]}


============================== 14:48:20.080643 | ea62b783-0d8a-44e0-9613-9601b0a26a1d ==============================
[0m14:48:20.080643 [info ] [MainThread]: Running with dbt=1.8.7
[0m14:48:20.081504 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/ben/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/ben/Dbt Certification/dbt-tutorial/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt seed', 'send_anonymous_usage_stats': 'True'}
[0m14:48:20.441836 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ea62b783-0d8a-44e0-9613-9601b0a26a1d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bef5e10>]}
[0m14:48:20.500412 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ea62b783-0d8a-44e0-9613-9601b0a26a1d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ac5ea10>]}
[0m14:48:20.501448 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m14:48:20.527944 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m14:48:20.672261 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:48:20.672783 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:48:20.722879 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ea62b783-0d8a-44e0-9613-9601b0a26a1d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c054390>]}
[0m14:48:20.824924 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ea62b783-0d8a-44e0-9613-9601b0a26a1d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bedd6d0>]}
[0m14:48:20.825526 [info ] [MainThread]: Found 7 models, 3 seeds, 11 data tests, 572 macros
[0m14:48:20.825971 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ea62b783-0d8a-44e0-9613-9601b0a26a1d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bfc4690>]}
[0m14:48:20.828068 [info ] [MainThread]: 
[0m14:48:20.828727 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:48:20.833118 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RAW'
[0m14:48:20.850180 [debug] [ThreadPool]: Using snowflake connection "list_RAW"
[0m14:48:20.850710 [debug] [ThreadPool]: On list_RAW: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_RAW"} */
show terse schemas in database RAW
    limit 10000
[0m14:48:20.851054 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:48:21.591620 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.740 seconds
[0m14:48:21.596349 [debug] [ThreadPool]: On list_RAW: Close
[0m14:48:21.737794 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RAW, now list_RAW_JAFFLE_SHOP)
[0m14:48:21.756184 [debug] [ThreadPool]: Using snowflake connection "list_RAW_JAFFLE_SHOP"
[0m14:48:21.756940 [debug] [ThreadPool]: On list_RAW_JAFFLE_SHOP: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_RAW_JAFFLE_SHOP"} */
show objects in RAW.JAFFLE_SHOP limit 10000
[0m14:48:21.757501 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:48:22.527213 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.770 seconds
[0m14:48:22.532346 [debug] [ThreadPool]: On list_RAW_JAFFLE_SHOP: Close
[0m14:48:22.708336 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ea62b783-0d8a-44e0-9613-9601b0a26a1d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109e15110>]}
[0m14:48:22.710312 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:48:22.711677 [info ] [MainThread]: 
[0m14:48:22.717636 [debug] [Thread-1 (]: Began running node seed.jaffle_shop.raw_customers
[0m14:48:22.718708 [debug] [Thread-2 (]: Began running node seed.jaffle_shop.raw_orders
[0m14:48:22.720073 [debug] [Thread-3 (]: Began running node seed.jaffle_shop.raw_payments
[0m14:48:22.721113 [info ] [Thread-1 (]: 1 of 3 START seed file JAFFLE_SHOP.raw_customers ............................... [RUN]
[0m14:48:22.722588 [info ] [Thread-2 (]: 2 of 3 START seed file JAFFLE_SHOP.raw_orders .................................. [RUN]
[0m14:48:22.723616 [info ] [Thread-3 (]: 3 of 3 START seed file JAFFLE_SHOP.raw_payments ................................ [RUN]
[0m14:48:22.724882 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_RAW_JAFFLE_SHOP, now seed.jaffle_shop.raw_customers)
[0m14:48:22.725928 [debug] [Thread-2 (]: Acquiring new snowflake connection 'seed.jaffle_shop.raw_orders'
[0m14:48:22.726734 [debug] [Thread-3 (]: Acquiring new snowflake connection 'seed.jaffle_shop.raw_payments'
[0m14:48:22.727632 [debug] [Thread-1 (]: Began compiling node seed.jaffle_shop.raw_customers
[0m14:48:22.728760 [debug] [Thread-2 (]: Began compiling node seed.jaffle_shop.raw_orders
[0m14:48:22.729443 [debug] [Thread-3 (]: Began compiling node seed.jaffle_shop.raw_payments
[0m14:48:22.730232 [debug] [Thread-1 (]: Began executing node seed.jaffle_shop.raw_customers
[0m14:48:22.730917 [debug] [Thread-2 (]: Began executing node seed.jaffle_shop.raw_orders
[0m14:48:22.731463 [debug] [Thread-3 (]: Began executing node seed.jaffle_shop.raw_payments
[0m14:48:22.775836 [debug] [Thread-1 (]: Using snowflake connection "seed.jaffle_shop.raw_customers"
[0m14:48:22.779896 [debug] [Thread-2 (]: Using snowflake connection "seed.jaffle_shop.raw_orders"
[0m14:48:22.787335 [debug] [Thread-3 (]: Using snowflake connection "seed.jaffle_shop.raw_payments"
[0m14:48:22.787840 [debug] [Thread-1 (]: On seed.jaffle_shop.raw_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_customers"} */
create table RAW.JAFFLE_SHOP.raw_customers (id integer,first_name text,last_name text)
[0m14:48:22.788246 [debug] [Thread-2 (]: On seed.jaffle_shop.raw_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_orders"} */
create table RAW.JAFFLE_SHOP.raw_orders (id integer,user_id integer,order_date date,status text)
[0m14:48:22.788617 [debug] [Thread-3 (]: On seed.jaffle_shop.raw_payments: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_payments"} */
create table RAW.JAFFLE_SHOP.raw_payments (id integer,order_id integer,payment_method text,amount integer)
[0m14:48:22.788986 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:48:22.789330 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m14:48:22.789673 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m14:48:23.285755 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.497 seconds
[0m14:48:23.312462 [debug] [Thread-1 (]: Using snowflake connection "seed.jaffle_shop.raw_customers"
[0m14:48:23.313225 [debug] [Thread-1 (]: On seed.jaffle_shop.raw_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_customers"} */
BEGIN
[0m14:48:23.314174 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.524 seconds
[0m14:48:23.318499 [debug] [Thread-3 (]: Using snowflake connection "seed.jaffle_shop.raw_payments"
[0m14:48:23.319063 [debug] [Thread-3 (]: On seed.jaffle_shop.raw_payments: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_payments"} */
BEGIN
[0m14:48:23.422024 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.102 seconds
[0m14:48:23.424075 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.109 seconds
[0m14:48:23.432313 [debug] [Thread-3 (]: Using snowflake connection "seed.jaffle_shop.raw_payments"
[0m14:48:23.436568 [debug] [Thread-1 (]: Using snowflake connection "seed.jaffle_shop.raw_customers"
[0m14:48:23.437410 [debug] [Thread-3 (]: On seed.jaffle_shop.raw_payments: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_payments"} */
insert into RAW.JAFFLE_SHOP.raw_payments (id, order_id, payment_method, amount) values
            (%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%...
[0m14:48:23.438276 [debug] [Thread-1 (]: On seed.jaffle_shop.raw_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_customers"} */
insert into RAW.JAFFLE_SHOP.raw_customers (id, first_name, last_name) values
            (%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%...
[0m14:48:23.448207 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.659 seconds
[0m14:48:23.452747 [debug] [Thread-2 (]: Using snowflake connection "seed.jaffle_shop.raw_orders"
[0m14:48:23.453639 [debug] [Thread-2 (]: On seed.jaffle_shop.raw_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_orders"} */
BEGIN
[0m14:48:23.567329 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.113 seconds
[0m14:48:23.574454 [debug] [Thread-2 (]: Using snowflake connection "seed.jaffle_shop.raw_orders"
[0m14:48:23.575417 [debug] [Thread-2 (]: On seed.jaffle_shop.raw_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_orders"} */
insert into RAW.JAFFLE_SHOP.raw_orders (id, user_id, order_date, status) values
            (%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),...
[0m14:48:24.066275 [debug] [Thread-1 (]: SQL status: SUCCESS 100 in 0.624 seconds
[0m14:48:24.068078 [debug] [Thread-1 (]: Using snowflake connection "seed.jaffle_shop.raw_customers"
[0m14:48:24.069214 [debug] [Thread-1 (]: On seed.jaffle_shop.raw_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_customers"} */
COMMIT
[0m14:48:24.147433 [debug] [Thread-2 (]: SQL status: SUCCESS 99 in 0.571 seconds
[0m14:48:24.148750 [debug] [Thread-2 (]: Using snowflake connection "seed.jaffle_shop.raw_orders"
[0m14:48:24.149667 [debug] [Thread-2 (]: On seed.jaffle_shop.raw_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_orders"} */
COMMIT
[0m14:48:24.261649 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.191 seconds
[0m14:48:24.275894 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.jaffle_shop.raw_customers"
[0m14:48:24.308830 [debug] [Thread-1 (]: On seed.jaffle_shop.raw_customers: Close
[0m14:48:24.347256 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.197 seconds
[0m14:48:24.349291 [debug] [Thread-2 (]: Writing runtime SQL for node "seed.jaffle_shop.raw_orders"
[0m14:48:24.356153 [debug] [Thread-2 (]: On seed.jaffle_shop.raw_orders: Close
[0m14:48:24.454295 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ea62b783-0d8a-44e0-9613-9601b0a26a1d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c273b90>]}
[0m14:48:24.456033 [info ] [Thread-1 (]: 1 of 3 OK loaded seed file JAFFLE_SHOP.raw_customers ........................... [[32mINSERT 100[0m in 1.73s]
[0m14:48:24.457600 [debug] [Thread-1 (]: Finished running node seed.jaffle_shop.raw_customers
[0m14:48:24.492790 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ea62b783-0d8a-44e0-9613-9601b0a26a1d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b1af390>]}
[0m14:48:24.494494 [info ] [Thread-2 (]: 2 of 3 OK loaded seed file JAFFLE_SHOP.raw_orders .............................. [[32mINSERT 99[0m in 1.77s]
[0m14:48:24.495869 [debug] [Thread-2 (]: Finished running node seed.jaffle_shop.raw_orders
[0m14:48:24.858976 [debug] [Thread-3 (]: SQL status: SUCCESS 113 in 1.420 seconds
[0m14:48:24.860546 [debug] [Thread-3 (]: Using snowflake connection "seed.jaffle_shop.raw_payments"
[0m14:48:24.861664 [debug] [Thread-3 (]: On seed.jaffle_shop.raw_payments: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_payments"} */
COMMIT
[0m14:48:25.048809 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.186 seconds
[0m14:48:25.050088 [debug] [Thread-3 (]: Writing runtime SQL for node "seed.jaffle_shop.raw_payments"
[0m14:48:25.053672 [debug] [Thread-3 (]: On seed.jaffle_shop.raw_payments: Close
[0m14:48:25.195105 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ea62b783-0d8a-44e0-9613-9601b0a26a1d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b1b6410>]}
[0m14:48:25.196793 [info ] [Thread-3 (]: 3 of 3 OK loaded seed file JAFFLE_SHOP.raw_payments ............................ [[32mINSERT 113[0m in 2.47s]
[0m14:48:25.198731 [debug] [Thread-3 (]: Finished running node seed.jaffle_shop.raw_payments
[0m14:48:25.202195 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:48:25.203020 [debug] [MainThread]: Connection 'seed.jaffle_shop.raw_customers' was properly closed.
[0m14:48:25.203754 [debug] [MainThread]: Connection 'seed.jaffle_shop.raw_orders' was properly closed.
[0m14:48:25.204442 [debug] [MainThread]: Connection 'seed.jaffle_shop.raw_payments' was properly closed.
[0m14:48:25.205240 [info ] [MainThread]: 
[0m14:48:25.206041 [info ] [MainThread]: Finished running 3 seeds in 0 hours 0 minutes and 4.38 seconds (4.38s).
[0m14:48:25.207873 [debug] [MainThread]: Command end result
[0m14:48:25.251748 [info ] [MainThread]: 
[0m14:48:25.252407 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:48:25.252915 [info ] [MainThread]: 
[0m14:48:25.253310 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m14:48:25.254802 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": true, "command_wall_clock_time": 5.2588186, "process_user_time": 2.71841, "process_kernel_time": 0.376221, "process_mem_max_rss": "129626112", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:48:25.255538 [debug] [MainThread]: Command `dbt seed` succeeded at 14:48:25.255294 after 5.26 seconds
[0m14:48:25.256071 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b219150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107cc1410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c10350>]}
[0m14:48:25.256456 [debug] [MainThread]: Flushing usage events
[0m14:49:32.880984 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1045ab850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1045fa050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104603950>]}


============================== 14:49:32.887116 | eb292951-dfa4-492d-91b0-3e1d31afa668 ==============================
[0m14:49:32.887116 [info ] [MainThread]: Running with dbt=1.8.7
[0m14:49:32.888102 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/ben/Dbt Certification/dbt-tutorial/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/ben/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:49:33.249011 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'eb292951-dfa4-492d-91b0-3e1d31afa668', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1050f9c90>]}
[0m14:49:33.305571 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'eb292951-dfa4-492d-91b0-3e1d31afa668', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104062b50>]}
[0m14:49:33.306650 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m14:49:33.332530 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m14:49:33.468086 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:49:33.468604 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:49:33.517496 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'eb292951-dfa4-492d-91b0-3e1d31afa668', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10404de10>]}
[0m14:49:33.619352 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'eb292951-dfa4-492d-91b0-3e1d31afa668', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1052d2c90>]}
[0m14:49:33.619928 [info ] [MainThread]: Found 7 models, 3 seeds, 11 data tests, 572 macros
[0m14:49:33.620361 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'eb292951-dfa4-492d-91b0-3e1d31afa668', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105385490>]}
[0m14:49:33.622451 [info ] [MainThread]: 
[0m14:49:33.623141 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:49:33.628703 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RAW'
[0m14:49:33.646836 [debug] [ThreadPool]: Using snowflake connection "list_RAW"
[0m14:49:33.647609 [debug] [ThreadPool]: On list_RAW: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_RAW"} */
show terse schemas in database RAW
    limit 10000
[0m14:49:33.648078 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:49:34.500644 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.852 seconds
[0m14:49:34.505983 [debug] [ThreadPool]: On list_RAW: Close
[0m14:49:34.649362 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RAW, now list_RAW_JAFFLE_SHOP)
[0m14:49:34.665493 [debug] [ThreadPool]: Using snowflake connection "list_RAW_JAFFLE_SHOP"
[0m14:49:34.666156 [debug] [ThreadPool]: On list_RAW_JAFFLE_SHOP: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_RAW_JAFFLE_SHOP"} */
show objects in RAW.JAFFLE_SHOP limit 10000
[0m14:49:34.666642 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:49:35.344214 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.677 seconds
[0m14:49:35.349642 [debug] [ThreadPool]: On list_RAW_JAFFLE_SHOP: Close
[0m14:49:35.949781 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'eb292951-dfa4-492d-91b0-3e1d31afa668', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102112e50>]}
[0m14:49:35.951428 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:49:35.952592 [info ] [MainThread]: 
[0m14:49:35.958629 [debug] [Thread-1 (]: Began running node model.jaffle_shop.customer_orders
[0m14:49:35.960076 [debug] [Thread-2 (]: Began running node model.jaffle_shop.int_orders_test
[0m14:49:35.961415 [debug] [Thread-3 (]: Began running node model.jaffle_shop.stg_customers
[0m14:49:35.962253 [debug] [Thread-4 (]: Began running node model.jaffle_shop.stg_orders
[0m14:49:35.963612 [info ] [Thread-1 (]: 1 of 7 START sql table model JAFFLE_SHOP.customer_orders ....................... [RUN]
[0m14:49:35.964749 [info ] [Thread-2 (]: 2 of 7 START sql view model JAFFLE_SHOP.int_orders_test ........................ [RUN]
[0m14:49:35.966105 [info ] [Thread-3 (]: 3 of 7 START sql view model JAFFLE_SHOP.stg_customers .......................... [RUN]
[0m14:49:35.967077 [info ] [Thread-4 (]: 4 of 7 START sql view model JAFFLE_SHOP.stg_orders ............................. [RUN]
[0m14:49:35.968018 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_RAW_JAFFLE_SHOP, now model.jaffle_shop.customer_orders)
[0m14:49:35.969329 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.jaffle_shop.int_orders_test'
[0m14:49:35.970331 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.jaffle_shop.stg_customers'
[0m14:49:35.971191 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.jaffle_shop.stg_orders'
[0m14:49:35.971829 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.customer_orders
[0m14:49:35.972412 [debug] [Thread-2 (]: Began compiling node model.jaffle_shop.int_orders_test
[0m14:49:35.972961 [debug] [Thread-3 (]: Began compiling node model.jaffle_shop.stg_customers
[0m14:49:35.973480 [debug] [Thread-4 (]: Began compiling node model.jaffle_shop.stg_orders
[0m14:49:35.983123 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.customer_orders"
[0m14:49:35.998268 [debug] [Thread-2 (]: Using snowflake connection "model.jaffle_shop.int_orders_test"
[0m14:49:36.001883 [debug] [Thread-3 (]: Writing injected SQL for node "model.jaffle_shop.stg_customers"
[0m14:49:36.005524 [debug] [Thread-4 (]: Writing injected SQL for node "model.jaffle_shop.stg_orders"
[0m14:49:36.006373 [debug] [Thread-2 (]: On model.jaffle_shop.int_orders_test: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.int_orders_test"} */
select datediff(
        day,
        cast('2023-01-01' as date),
        cast('2024-01-01' as date)
        )
[0m14:49:36.006966 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.customer_orders
[0m14:49:36.007545 [debug] [Thread-3 (]: Began executing node model.jaffle_shop.stg_customers
[0m14:49:36.007941 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m14:49:36.019531 [debug] [Thread-4 (]: Began executing node model.jaffle_shop.stg_orders
[0m14:49:36.041582 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.customer_orders"
[0m14:49:36.064389 [debug] [Thread-3 (]: Writing runtime sql for node "model.jaffle_shop.stg_customers"
[0m14:49:36.069217 [debug] [Thread-4 (]: Writing runtime sql for node "model.jaffle_shop.stg_orders"
[0m14:49:36.072927 [debug] [Thread-1 (]: Using snowflake connection "model.jaffle_shop.customer_orders"
[0m14:49:36.073947 [debug] [Thread-3 (]: Using snowflake connection "model.jaffle_shop.stg_customers"
[0m14:49:36.074819 [debug] [Thread-1 (]: On model.jaffle_shop.customer_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.customer_orders"} */
create or replace transient table RAW.JAFFLE_SHOP.customer_orders
         as
        (WITH paid_orders as (select Orders.ID as order_id,
    Orders.USER_ID	as customer_id,
    Orders.ORDER_DATE AS order_placed_at,
        Orders.STATUS AS order_status,
    p.total_amount_paid,
    p.payment_finalized_date,
    C.FIRST_NAME    as customer_first_name,
        C.LAST_NAME as customer_last_name
FROM raw.jaffle_shop.orders as Orders
left join (select ORDERID as order_id, max(CREATED) as payment_finalized_date, sum(AMOUNT) / 100.0 as total_amount_paid
        from raw.stripe.payment
        where STATUS <> 'fail'
        group by 1) p ON orders.ID = p.order_id
left join raw.jaffle_shop.customers C on orders.USER_ID = C.ID ),

customer_orders 
as (select C.ID as customer_id
    , min(ORDER_DATE) as first_order_date
    , max(ORDER_DATE) as most_recent_order_date
    , count(ORDERS.ID) AS number_of_orders
from raw.jaffle_shop.customers C 
left join raw.jaffle_shop.orders as Orders
on orders.USER_ID = C.ID 
group by 1)

select
p.*,
ROW_NUMBER() OVER (ORDER BY p.order_id) as transaction_seq,
ROW_NUMBER() OVER (PARTITION BY customer_id ORDER BY p.order_id) as customer_sales_seq,
CASE WHEN c.first_order_date = p.order_placed_at
THEN 'new'
ELSE 'return' END as nvsr,
x.clv_bad as customer_lifetime_value,
c.first_order_date as fdos
FROM paid_orders p
left join customer_orders as c USING (customer_id)
LEFT OUTER JOIN 
(
        select
        p.order_id,
        sum(t2.total_amount_paid) as clv_bad
    from paid_orders p
    left join paid_orders t2 on p.customer_id = t2.customer_id and p.order_id >= t2.order_id
    group by 1
    order by p.order_id
) x on x.order_id = p.order_id
ORDER BY order_id
        );
[0m14:49:36.075710 [debug] [Thread-4 (]: Using snowflake connection "model.jaffle_shop.stg_orders"
[0m14:49:36.076905 [debug] [Thread-3 (]: On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */
create or replace   view RAW.JAFFLE_SHOP.stg_customers
  
   as (
    -- noinspection SqlNoDataSourceInspectionForFile



select
    id as customer_id,
    first_name,
    last_name

from raw.jaffle_shop.raw_customers
  );
[0m14:49:36.077463 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:49:36.078132 [debug] [Thread-4 (]: On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */
create or replace   view RAW.JAFFLE_SHOP.stg_orders
  
   as (
    

select
    id as order_id,
    user_id as customer_id,
    order_date,
    status

from raw.jaffle_shop.raw_orders
  );
[0m14:49:36.078750 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m14:49:36.080189 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m14:49:36.602188 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.594 seconds
[0m14:49:36.626903 [debug] [Thread-2 (]: Writing injected SQL for node "model.jaffle_shop.int_orders_test"
[0m14:49:36.628096 [debug] [Thread-2 (]: Began executing node model.jaffle_shop.int_orders_test
[0m14:49:36.633485 [debug] [Thread-2 (]: Writing runtime sql for node "model.jaffle_shop.int_orders_test"
[0m14:49:36.636580 [debug] [Thread-2 (]: Using snowflake connection "model.jaffle_shop.int_orders_test"
[0m14:49:36.637243 [debug] [Thread-2 (]: On model.jaffle_shop.int_orders_test: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.int_orders_test"} */
create or replace   view RAW.JAFFLE_SHOP.int_orders_test
  
   as (
    







with rawdata as (

    

    

    with p as (
        select 0 as generated_number union all select 1
    ), unioned as (

    select

    
    p0.generated_number * power(2, 0)
     + 
    
    p1.generated_number * power(2, 1)
     + 
    
    p2.generated_number * power(2, 2)
     + 
    
    p3.generated_number * power(2, 3)
     + 
    
    p4.generated_number * power(2, 4)
     + 
    
    p5.generated_number * power(2, 5)
     + 
    
    p6.generated_number * power(2, 6)
     + 
    
    p7.generated_number * power(2, 7)
     + 
    
    p8.generated_number * power(2, 8)
    
    
    + 1
    as generated_number

    from

    
    p as p0
     cross join 
    
    p as p1
     cross join 
    
    p as p2
     cross join 
    
    p as p3
     cross join 
    
    p as p4
     cross join 
    
    p as p5
     cross join 
    
    p as p6
     cross join 
    
    p as p7
     cross join 
    
    p as p8
    
    

    )

    select *
    from unioned
    where generated_number <= 365
    order by generated_number



),

all_periods as (

    select (
        

    dateadd(
        day,
        row_number() over (order by 1) - 1,
        cast('2023-01-01' as date)
        )


    ) as date_day
    from rawdata

),

filtered as (

    select *
    from all_periods
    where date_day <= cast('2024-01-01' as date)

)

select * from filtered


  );
[0m14:49:36.885129 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.806 seconds
[0m14:49:36.922206 [debug] [Thread-3 (]: On model.jaffle_shop.stg_customers: Close
[0m14:49:36.927366 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.289 seconds
[0m14:49:36.932266 [debug] [Thread-2 (]: On model.jaffle_shop.int_orders_test: Close
[0m14:49:36.985381 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.905 seconds
[0m14:49:36.990958 [debug] [Thread-4 (]: On model.jaffle_shop.stg_orders: Close
[0m14:49:37.068977 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eb292951-dfa4-492d-91b0-3e1d31afa668', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10584ae50>]}
[0m14:49:37.070583 [info ] [Thread-2 (]: 2 of 7 OK created sql view model JAFFLE_SHOP.int_orders_test ................... [[32mSUCCESS 1[0m in 1.10s]
[0m14:49:37.071822 [debug] [Thread-2 (]: Finished running node model.jaffle_shop.int_orders_test
[0m14:49:37.073733 [debug] [Thread-2 (]: Began running node model.jaffle_shop.stg_payments
[0m14:49:37.075532 [info ] [Thread-2 (]: 5 of 7 START sql view model JAFFLE_SHOP.stg_payments ........................... [RUN]
[0m14:49:37.076637 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.jaffle_shop.int_orders_test, now model.jaffle_shop.stg_payments)
[0m14:49:37.077648 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eb292951-dfa4-492d-91b0-3e1d31afa668', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105687dd0>]}
[0m14:49:37.078338 [debug] [Thread-2 (]: Began compiling node model.jaffle_shop.stg_payments
[0m14:49:37.079357 [info ] [Thread-3 (]: 3 of 7 OK created sql view model JAFFLE_SHOP.stg_customers ..................... [[32mSUCCESS 1[0m in 1.11s]
[0m14:49:37.086972 [debug] [Thread-2 (]: Writing injected SQL for node "model.jaffle_shop.stg_payments"
[0m14:49:37.088308 [debug] [Thread-3 (]: Finished running node model.jaffle_shop.stg_customers
[0m14:49:37.089586 [debug] [Thread-2 (]: Began executing node model.jaffle_shop.stg_payments
[0m14:49:37.093500 [debug] [Thread-2 (]: Writing runtime sql for node "model.jaffle_shop.stg_payments"
[0m14:49:37.094926 [debug] [Thread-2 (]: Using snowflake connection "model.jaffle_shop.stg_payments"
[0m14:49:37.095823 [debug] [Thread-2 (]: On model.jaffle_shop.stg_payments: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_payments"} */
create or replace   view RAW.JAFFLE_SHOP.stg_payments
  
   as (
    

select
    id,
    order_id,
    payment_method,
    round(1.0 * amount / 100, 2) AS amount_usd

from raw.jaffle_shop.raw_payments
  );
[0m14:49:37.096463 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:49:37.137134 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eb292951-dfa4-492d-91b0-3e1d31afa668', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105897910>]}
[0m14:49:37.137915 [info ] [Thread-4 (]: 4 of 7 OK created sql view model JAFFLE_SHOP.stg_orders ........................ [[32mSUCCESS 1[0m in 1.17s]
[0m14:49:37.138578 [debug] [Thread-4 (]: Finished running node model.jaffle_shop.stg_orders
[0m14:49:37.139335 [debug] [Thread-3 (]: Began running node model.jaffle_shop.customers
[0m14:49:37.139843 [info ] [Thread-3 (]: 6 of 7 START sql view model JAFFLE_SHOP.customers .............................. [RUN]
[0m14:49:37.140356 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.jaffle_shop.stg_customers, now model.jaffle_shop.customers)
[0m14:49:37.140752 [debug] [Thread-3 (]: Began compiling node model.jaffle_shop.customers
[0m14:49:37.145817 [debug] [Thread-3 (]: Writing injected SQL for node "model.jaffle_shop.customers"
[0m14:49:37.146775 [debug] [Thread-3 (]: Began executing node model.jaffle_shop.customers
[0m14:49:37.154801 [debug] [Thread-3 (]: Dropping relation "RAW"."JAFFLE_SHOP"."CUSTOMERS" because it is of type table
[0m14:49:37.162881 [debug] [Thread-3 (]: Applying DROP to: "RAW"."JAFFLE_SHOP"."CUSTOMERS"
[0m14:49:37.171181 [debug] [Thread-3 (]: Using snowflake connection "model.jaffle_shop.customers"
[0m14:49:37.171765 [debug] [Thread-3 (]: On model.jaffle_shop.customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.customers"} */
drop table if exists "RAW"."JAFFLE_SHOP"."CUSTOMERS" cascade
[0m14:49:37.172301 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:49:37.910333 [debug] [Thread-3 (]: Snowflake adapter: Snowflake query id: 01b7b649-0000-8615-002a-09030002817a
[0m14:49:37.911693 [debug] [Thread-3 (]: Snowflake adapter: Snowflake error: 003001 (42501): SQL access control error:
Insufficient privileges to operate on table 'CUSTOMERS'
[0m14:49:37.913022 [debug] [Thread-3 (]: Snowflake adapter: Error running SQL: macro drop_relation
[0m14:49:37.913924 [debug] [Thread-3 (]: Snowflake adapter: Rolling back transaction.
[0m14:49:37.915220 [debug] [Thread-3 (]: On model.jaffle_shop.customers: Close
[0m14:49:38.079474 [debug] [Thread-3 (]: Database Error in model customers (models/customers.sql)
  003001 (42501): SQL access control error:
  Insufficient privileges to operate on table 'CUSTOMERS'
[0m14:49:38.080727 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eb292951-dfa4-492d-91b0-3e1d31afa668', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1056701d0>]}
[0m14:49:38.082019 [error] [Thread-3 (]: 6 of 7 ERROR creating sql view model JAFFLE_SHOP.customers ..................... [[31mERROR[0m in 0.94s]
[0m14:49:38.083834 [debug] [Thread-3 (]: Finished running node model.jaffle_shop.customers
[0m14:49:38.121947 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.044 seconds
[0m14:49:38.124289 [debug] [Thread-1 (]: On model.jaffle_shop.customer_orders: Close
[0m14:49:38.215203 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.119 seconds
[0m14:49:38.217280 [debug] [Thread-2 (]: On model.jaffle_shop.stg_payments: Close
[0m14:49:38.265115 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eb292951-dfa4-492d-91b0-3e1d31afa668', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105957750>]}
[0m14:49:38.266534 [info ] [Thread-1 (]: 1 of 7 OK created sql table model JAFFLE_SHOP.customer_orders .................. [[32mSUCCESS 1[0m in 2.30s]
[0m14:49:38.267698 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.customer_orders
[0m14:49:38.350555 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eb292951-dfa4-492d-91b0-3e1d31afa668', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10591be90>]}
[0m14:49:38.352557 [info ] [Thread-2 (]: 5 of 7 OK created sql view model JAFFLE_SHOP.stg_payments ...................... [[32mSUCCESS 1[0m in 1.27s]
[0m14:49:38.354680 [debug] [Thread-2 (]: Finished running node model.jaffle_shop.stg_payments
[0m14:49:38.356613 [debug] [Thread-4 (]: Began running node model.jaffle_shop.int_orders__pivoted
[0m14:49:38.357829 [info ] [Thread-4 (]: 7 of 7 START sql view model JAFFLE_SHOP.int_orders__pivoted .................... [RUN]
[0m14:49:38.358945 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.jaffle_shop.stg_orders, now model.jaffle_shop.int_orders__pivoted)
[0m14:49:38.359840 [debug] [Thread-4 (]: Began compiling node model.jaffle_shop.int_orders__pivoted
[0m14:49:38.368776 [debug] [Thread-4 (]: Writing injected SQL for node "model.jaffle_shop.int_orders__pivoted"
[0m14:49:38.370322 [debug] [Thread-4 (]: Began executing node model.jaffle_shop.int_orders__pivoted
[0m14:49:38.376046 [debug] [Thread-4 (]: Writing runtime sql for node "model.jaffle_shop.int_orders__pivoted"
[0m14:49:38.378799 [debug] [Thread-4 (]: Using snowflake connection "model.jaffle_shop.int_orders__pivoted"
[0m14:49:38.379602 [debug] [Thread-4 (]: On model.jaffle_shop.int_orders__pivoted: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.int_orders__pivoted"} */
create or replace   view RAW.JAFFLE_SHOP.int_orders__pivoted
  
   as (
    



WITH payments AS (
    SELECT p.id AS id,
           p.order_id AS order_id,
           p.payment_method AS payment_method,
           p.amount_usd AS amount,
           o.status AS status
    FROM RAW.JAFFLE_SHOP.stg_payments p
    JOIN RAW.JAFFLE_SHOP.stg_orders o
    ON p.order_id = o.order_id
),
pivoted AS (
    SELECT
        order_id,
        SUM(CASE WHEN payment_method = 'bank_transfer' THEN amount ELSE 0 END) AS bank_transfer_amount,
        SUM(CASE WHEN payment_method = 'coupon' THEN amount ELSE 0 END) AS coupon_amount,
        SUM(CASE WHEN payment_method = 'credit_card' THEN amount ELSE 0 END) AS credit_card_amount,
        SUM(CASE WHEN payment_method = 'gift_card' THEN amount ELSE 0 END) AS gift_card_amount
    FROM payments
    WHERE status = 'completed'
    GROUP BY 1
)

SELECT * FROM pivoted
  );
[0m14:49:38.380155 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:49:39.507489 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.127 seconds
[0m14:49:39.512954 [debug] [Thread-4 (]: On model.jaffle_shop.int_orders__pivoted: Close
[0m14:49:39.746675 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eb292951-dfa4-492d-91b0-3e1d31afa668', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1052ed210>]}
[0m14:49:39.748427 [info ] [Thread-4 (]: 7 of 7 OK created sql view model JAFFLE_SHOP.int_orders__pivoted ............... [[32mSUCCESS 1[0m in 1.39s]
[0m14:49:39.750257 [debug] [Thread-4 (]: Finished running node model.jaffle_shop.int_orders__pivoted
[0m14:49:39.755129 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:49:39.756506 [debug] [MainThread]: Connection 'model.jaffle_shop.customer_orders' was properly closed.
[0m14:49:39.757214 [debug] [MainThread]: Connection 'model.jaffle_shop.stg_payments' was properly closed.
[0m14:49:39.757810 [debug] [MainThread]: Connection 'model.jaffle_shop.customers' was properly closed.
[0m14:49:39.758384 [debug] [MainThread]: Connection 'model.jaffle_shop.int_orders__pivoted' was properly closed.
[0m14:49:39.759222 [info ] [MainThread]: 
[0m14:49:39.759911 [info ] [MainThread]: Finished running 6 view models, 1 table model in 0 hours 0 minutes and 6.14 seconds (6.14s).
[0m14:49:39.762667 [debug] [MainThread]: Command end result
[0m14:49:39.805847 [info ] [MainThread]: 
[0m14:49:39.806466 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m14:49:39.807087 [info ] [MainThread]: 
[0m14:49:39.807773 [error] [MainThread]:   Database Error in model customers (models/customers.sql)
  003001 (42501): SQL access control error:
  Insufficient privileges to operate on table 'CUSTOMERS'
[0m14:49:39.808293 [info ] [MainThread]: 
[0m14:49:39.808811 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=1 SKIP=0 TOTAL=7
[0m14:49:39.810826 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 7.002127, "process_user_time": 2.985642, "process_kernel_time": 0.395972, "process_mem_max_rss": "132591616", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:49:39.811919 [debug] [MainThread]: Command `dbt run` failed at 14:49:39.811528 after 7.00 seconds
[0m14:49:39.812488 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10461cf50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10461e650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x101014350>]}
[0m14:49:39.812901 [debug] [MainThread]: Flushing usage events
[0m14:52:40.433779 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f1b8610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f201c90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f229390>]}


============================== 14:52:40.439342 | 3bc7132f-ec59-4243-8a35-81288dc32290 ==============================
[0m14:52:40.439342 [info ] [MainThread]: Running with dbt=1.8.7
[0m14:52:40.440214 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/Users/ben/.dbt', 'log_path': '/Users/ben/Dbt Certification/dbt-tutorial/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run --select customers', 'send_anonymous_usage_stats': 'True'}
[0m14:52:40.793023 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3bc7132f-ec59-4243-8a35-81288dc32290', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fef7850>]}
[0m14:52:40.848544 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3bc7132f-ec59-4243-8a35-81288dc32290', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10de31110>]}
[0m14:52:40.849569 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m14:52:40.874605 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m14:52:41.012287 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:52:41.012795 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:52:41.062474 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3bc7132f-ec59-4243-8a35-81288dc32290', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ff02f90>]}
[0m14:52:41.168371 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3bc7132f-ec59-4243-8a35-81288dc32290', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110060090>]}
[0m14:52:41.169003 [info ] [MainThread]: Found 7 models, 3 seeds, 11 data tests, 572 macros
[0m14:52:41.169452 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3bc7132f-ec59-4243-8a35-81288dc32290', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ffd19d0>]}
[0m14:52:41.171416 [info ] [MainThread]: 
[0m14:52:41.172124 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:52:41.173038 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RAW'
[0m14:52:41.189584 [debug] [ThreadPool]: Using snowflake connection "list_RAW"
[0m14:52:41.190303 [debug] [ThreadPool]: On list_RAW: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_RAW"} */
show terse schemas in database RAW
    limit 10000
[0m14:52:41.190688 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:52:41.951385 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.761 seconds
[0m14:52:41.956221 [debug] [ThreadPool]: On list_RAW: Close
[0m14:52:42.154188 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RAW, now list_RAW_JAFFLE_SHOP)
[0m14:52:42.169669 [debug] [ThreadPool]: Using snowflake connection "list_RAW_JAFFLE_SHOP"
[0m14:52:42.170299 [debug] [ThreadPool]: On list_RAW_JAFFLE_SHOP: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_RAW_JAFFLE_SHOP"} */
show objects in RAW.JAFFLE_SHOP limit 10000
[0m14:52:42.170756 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:52:42.911266 [debug] [ThreadPool]: SQL status: SUCCESS 11 in 0.740 seconds
[0m14:52:42.916912 [debug] [ThreadPool]: On list_RAW_JAFFLE_SHOP: Close
[0m14:52:43.072902 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3bc7132f-ec59-4243-8a35-81288dc32290', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f1f1290>]}
[0m14:52:43.074389 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:52:43.075300 [info ] [MainThread]: 
[0m14:52:43.081446 [debug] [Thread-1 (]: Began running node model.jaffle_shop.customers
[0m14:52:43.083219 [info ] [Thread-1 (]: 1 of 1 START sql view model JAFFLE_SHOP.customers .............................. [RUN]
[0m14:52:43.084361 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_RAW_JAFFLE_SHOP, now model.jaffle_shop.customers)
[0m14:52:43.085362 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.customers
[0m14:52:43.099005 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.customers"
[0m14:52:43.100087 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.customers
[0m14:52:43.128152 [debug] [Thread-1 (]: Dropping relation "RAW"."JAFFLE_SHOP"."CUSTOMERS" because it is of type table
[0m14:52:43.135093 [debug] [Thread-1 (]: Applying DROP to: "RAW"."JAFFLE_SHOP"."CUSTOMERS"
[0m14:52:43.142355 [debug] [Thread-1 (]: Using snowflake connection "model.jaffle_shop.customers"
[0m14:52:43.142897 [debug] [Thread-1 (]: On model.jaffle_shop.customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.customers"} */
drop table if exists "RAW"."JAFFLE_SHOP"."CUSTOMERS" cascade
[0m14:52:43.143295 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:52:43.736147 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b7b64c-0000-8615-002a-0903000281ba
[0m14:52:43.737728 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 003001 (42501): SQL access control error:
Insufficient privileges to operate on table 'CUSTOMERS'
[0m14:52:43.738959 [debug] [Thread-1 (]: Snowflake adapter: Error running SQL: macro drop_relation
[0m14:52:43.739840 [debug] [Thread-1 (]: Snowflake adapter: Rolling back transaction.
[0m14:52:43.740857 [debug] [Thread-1 (]: On model.jaffle_shop.customers: Close
[0m14:52:43.878980 [debug] [Thread-1 (]: Database Error in model customers (models/customers.sql)
  003001 (42501): SQL access control error:
  Insufficient privileges to operate on table 'CUSTOMERS'
[0m14:52:43.881237 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3bc7132f-ec59-4243-8a35-81288dc32290', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fe86350>]}
[0m14:52:43.882265 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model JAFFLE_SHOP.customers ..................... [[31mERROR[0m in 0.80s]
[0m14:52:43.883187 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.customers
[0m14:52:43.885879 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:52:43.886338 [debug] [MainThread]: Connection 'model.jaffle_shop.customers' was properly closed.
[0m14:52:43.886793 [info ] [MainThread]: 
[0m14:52:43.887255 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.71 seconds (2.71s).
[0m14:52:43.888216 [debug] [MainThread]: Command end result
[0m14:52:43.926140 [info ] [MainThread]: 
[0m14:52:43.926777 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m14:52:43.927139 [info ] [MainThread]: 
[0m14:52:43.927556 [error] [MainThread]:   Database Error in model customers (models/customers.sql)
  003001 (42501): SQL access control error:
  Insufficient privileges to operate on table 'CUSTOMERS'
[0m14:52:43.928146 [info ] [MainThread]: 
[0m14:52:43.928821 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m14:52:43.930697 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 3.5685408, "process_user_time": 2.358179, "process_kernel_time": 0.324467, "process_mem_max_rss": "128159744", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:52:43.931322 [debug] [MainThread]: Command `dbt run` failed at 14:52:43.931218 after 3.57 seconds
[0m14:52:43.931791 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f229190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ee5e590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bbf0dd0>]}
[0m14:52:43.932264 [debug] [MainThread]: Flushing usage events
[0m16:41:12.546087 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a6bfd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105aba050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105add690>]}


============================== 16:41:12.554122 | b8aa60de-48fc-458a-84f2-e6de4b5e4302 ==============================
[0m16:41:12.554122 [info ] [MainThread]: Running with dbt=1.8.7
[0m16:41:12.554911 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/ben/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/ben/Dbt Certification/dbt-tutorial/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m16:41:13.153045 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b8aa60de-48fc-458a-84f2-e6de4b5e4302', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106776ed0>]}
[0m16:41:13.210508 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b8aa60de-48fc-458a-84f2-e6de4b5e4302', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105522bd0>]}
[0m16:41:13.212866 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m16:41:13.244710 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m16:41:13.440110 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:41:13.440630 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:41:13.495683 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b8aa60de-48fc-458a-84f2-e6de4b5e4302', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106835e10>]}
[0m16:41:13.621696 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b8aa60de-48fc-458a-84f2-e6de4b5e4302', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067a1ed0>]}
[0m16:41:13.622310 [info ] [MainThread]: Found 7 models, 3 seeds, 11 data tests, 572 macros
[0m16:41:13.622757 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b8aa60de-48fc-458a-84f2-e6de4b5e4302', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106834d10>]}
[0m16:41:13.625164 [info ] [MainThread]: 
[0m16:41:13.625878 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:41:13.630469 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RAW'
[0m16:41:13.650492 [debug] [ThreadPool]: Using snowflake connection "list_RAW"
[0m16:41:13.651091 [debug] [ThreadPool]: On list_RAW: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_RAW"} */
show terse schemas in database RAW
    limit 10000
[0m16:41:13.651439 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:41:14.727014 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.075 seconds
[0m16:41:14.729731 [debug] [ThreadPool]: On list_RAW: Close
[0m16:41:14.908328 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RAW, now list_RAW_JAFFLE_SHOP)
[0m16:41:14.924375 [debug] [ThreadPool]: Using snowflake connection "list_RAW_JAFFLE_SHOP"
[0m16:41:14.925032 [debug] [ThreadPool]: On list_RAW_JAFFLE_SHOP: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_RAW_JAFFLE_SHOP"} */
show objects in RAW.JAFFLE_SHOP limit 10000
[0m16:41:14.925482 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:41:15.715162 [debug] [ThreadPool]: SQL status: SUCCESS 9 in 0.790 seconds
[0m16:41:15.721021 [debug] [ThreadPool]: On list_RAW_JAFFLE_SHOP: Close
[0m16:41:15.869406 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b8aa60de-48fc-458a-84f2-e6de4b5e4302', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104750550>]}
[0m16:41:15.870902 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:41:15.871794 [info ] [MainThread]: 
[0m16:41:15.878077 [debug] [Thread-1 (]: Began running node model.jaffle_shop.customer_orders
[0m16:41:15.879455 [debug] [Thread-2 (]: Began running node model.jaffle_shop.int_orders_test
[0m16:41:15.880454 [debug] [Thread-3 (]: Began running node model.jaffle_shop.stg_customers
[0m16:41:15.881689 [debug] [Thread-4 (]: Began running node model.jaffle_shop.stg_orders
[0m16:41:15.882569 [info ] [Thread-1 (]: 1 of 7 START sql table model JAFFLE_SHOP.customer_orders ....................... [RUN]
[0m16:41:15.883694 [info ] [Thread-2 (]: 2 of 7 START sql view model JAFFLE_SHOP.int_orders_test ........................ [RUN]
[0m16:41:15.885173 [info ] [Thread-3 (]: 3 of 7 START sql view model JAFFLE_SHOP.stg_customers .......................... [RUN]
[0m16:41:15.886355 [info ] [Thread-4 (]: 4 of 7 START sql view model JAFFLE_SHOP.stg_orders ............................. [RUN]
[0m16:41:15.887501 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_RAW_JAFFLE_SHOP, now model.jaffle_shop.customer_orders)
[0m16:41:15.888423 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.jaffle_shop.int_orders_test'
[0m16:41:15.889308 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.jaffle_shop.stg_customers'
[0m16:41:15.890038 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.jaffle_shop.stg_orders'
[0m16:41:15.890711 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.customer_orders
[0m16:41:15.891338 [debug] [Thread-2 (]: Began compiling node model.jaffle_shop.int_orders_test
[0m16:41:15.891961 [debug] [Thread-3 (]: Began compiling node model.jaffle_shop.stg_customers
[0m16:41:15.892695 [debug] [Thread-4 (]: Began compiling node model.jaffle_shop.stg_orders
[0m16:41:15.902239 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.customer_orders"
[0m16:41:15.918263 [debug] [Thread-2 (]: Using snowflake connection "model.jaffle_shop.int_orders_test"
[0m16:41:15.921367 [debug] [Thread-3 (]: Writing injected SQL for node "model.jaffle_shop.stg_customers"
[0m16:41:15.924234 [debug] [Thread-4 (]: Writing injected SQL for node "model.jaffle_shop.stg_orders"
[0m16:41:15.925136 [debug] [Thread-2 (]: On model.jaffle_shop.int_orders_test: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.int_orders_test"} */
select datediff(
        day,
        cast('2023-01-01' as date),
        cast('2024-01-01' as date)
        )
[0m16:41:15.926237 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.customer_orders
[0m16:41:15.926887 [debug] [Thread-3 (]: Began executing node model.jaffle_shop.stg_customers
[0m16:41:15.927409 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m16:41:15.927843 [debug] [Thread-4 (]: Began executing node model.jaffle_shop.stg_orders
[0m16:41:15.967188 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.customer_orders"
[0m16:41:15.982723 [debug] [Thread-3 (]: Writing runtime sql for node "model.jaffle_shop.stg_customers"
[0m16:41:15.987237 [debug] [Thread-4 (]: Writing runtime sql for node "model.jaffle_shop.stg_orders"
[0m16:41:15.990600 [debug] [Thread-1 (]: Using snowflake connection "model.jaffle_shop.customer_orders"
[0m16:41:15.991258 [debug] [Thread-1 (]: On model.jaffle_shop.customer_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.customer_orders"} */
create or replace transient table RAW.JAFFLE_SHOP.customer_orders
         as
        (WITH paid_orders as (select Orders.ID as order_id,
    Orders.USER_ID	as customer_id,
    Orders.ORDER_DATE AS order_placed_at,
        Orders.STATUS AS order_status,
    p.total_amount_paid,
    p.payment_finalized_date,
    C.FIRST_NAME    as customer_first_name,
        C.LAST_NAME as customer_last_name
FROM raw.jaffle_shop.orders as Orders
left join (select ORDERID as order_id, max(CREATED) as payment_finalized_date, sum(AMOUNT) / 100.0 as total_amount_paid
        from raw.stripe.payment
        where STATUS <> 'fail'
        group by 1) p ON orders.ID = p.order_id
left join raw.jaffle_shop.customers C on orders.USER_ID = C.ID ),

customer_orders 
as (select C.ID as customer_id
    , min(ORDER_DATE) as first_order_date
    , max(ORDER_DATE) as most_recent_order_date
    , count(ORDERS.ID) AS number_of_orders
from raw.jaffle_shop.customers C 
left join raw.jaffle_shop.orders as Orders
on orders.USER_ID = C.ID 
group by 1)

select
p.*,
ROW_NUMBER() OVER (ORDER BY p.order_id) as transaction_seq,
ROW_NUMBER() OVER (PARTITION BY customer_id ORDER BY p.order_id) as customer_sales_seq,
CASE WHEN c.first_order_date = p.order_placed_at
THEN 'new'
ELSE 'return' END as nvsr,
x.clv_bad as customer_lifetime_value,
c.first_order_date as fdos
FROM paid_orders p
left join customer_orders as c USING (customer_id)
LEFT OUTER JOIN 
(
        select
        p.order_id,
        sum(t2.total_amount_paid) as clv_bad
    from paid_orders p
    left join paid_orders t2 on p.customer_id = t2.customer_id and p.order_id >= t2.order_id
    group by 1
    order by p.order_id
) x on x.order_id = p.order_id
ORDER BY order_id
        );
[0m16:41:15.992341 [debug] [Thread-4 (]: Using snowflake connection "model.jaffle_shop.stg_orders"
[0m16:41:15.992749 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:41:15.993325 [debug] [Thread-3 (]: Using snowflake connection "model.jaffle_shop.stg_customers"
[0m16:41:15.994584 [debug] [Thread-4 (]: On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */
create or replace   view RAW.JAFFLE_SHOP.stg_orders
  
   as (
    

select
    id as order_id,
    user_id as customer_id,
    order_date,
    status

from raw.jaffle_shop.raw_orders
  );
[0m16:41:15.996889 [debug] [Thread-3 (]: On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */
create or replace   view RAW.JAFFLE_SHOP.stg_customers
  
   as (
    -- noinspection SqlNoDataSourceInspectionForFile



select
    id as customer_id,
    first_name,
    last_name

from raw.jaffle_shop.raw_customers
  );
[0m16:41:15.997607 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m16:41:15.998187 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m16:41:16.722876 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.725 seconds
[0m16:41:16.755646 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.828 seconds
[0m16:41:16.774158 [debug] [Thread-4 (]: On model.jaffle_shop.stg_orders: Close
[0m16:41:16.776356 [debug] [Thread-2 (]: Writing injected SQL for node "model.jaffle_shop.int_orders_test"
[0m16:41:16.778301 [debug] [Thread-2 (]: Began executing node model.jaffle_shop.int_orders_test
[0m16:41:16.781466 [debug] [Thread-2 (]: Writing runtime sql for node "model.jaffle_shop.int_orders_test"
[0m16:41:16.785535 [debug] [Thread-2 (]: Using snowflake connection "model.jaffle_shop.int_orders_test"
[0m16:41:16.786129 [debug] [Thread-2 (]: On model.jaffle_shop.int_orders_test: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.int_orders_test"} */
create or replace   view RAW.JAFFLE_SHOP.int_orders_test
  
   as (
    







with rawdata as (

    

    

    with p as (
        select 0 as generated_number union all select 1
    ), unioned as (

    select

    
    p0.generated_number * power(2, 0)
     + 
    
    p1.generated_number * power(2, 1)
     + 
    
    p2.generated_number * power(2, 2)
     + 
    
    p3.generated_number * power(2, 3)
     + 
    
    p4.generated_number * power(2, 4)
     + 
    
    p5.generated_number * power(2, 5)
     + 
    
    p6.generated_number * power(2, 6)
     + 
    
    p7.generated_number * power(2, 7)
     + 
    
    p8.generated_number * power(2, 8)
    
    
    + 1
    as generated_number

    from

    
    p as p0
     cross join 
    
    p as p1
     cross join 
    
    p as p2
     cross join 
    
    p as p3
     cross join 
    
    p as p4
     cross join 
    
    p as p5
     cross join 
    
    p as p6
     cross join 
    
    p as p7
     cross join 
    
    p as p8
    
    

    )

    select *
    from unioned
    where generated_number <= 365
    order by generated_number



),

all_periods as (

    select (
        

    dateadd(
        day,
        row_number() over (order by 1) - 1,
        cast('2023-01-01' as date)
        )


    ) as date_day
    from rawdata

),

filtered as (

    select *
    from all_periods
    where date_day <= cast('2024-01-01' as date)

)

select * from filtered


  );
[0m16:41:16.794438 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b7b6b9-0000-854a-002a-09030001e34a
[0m16:41:16.795516 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 002003 (42S02): SQL compilation error:
Object 'RAW.JAFFLE_SHOP.ORDERS' does not exist or not authorized.
[0m16:41:16.796137 [debug] [Thread-1 (]: On model.jaffle_shop.customer_orders: Close
[0m16:41:16.919443 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b8aa60de-48fc-458a-84f2-e6de4b5e4302', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e3f250>]}
[0m16:41:16.921257 [info ] [Thread-4 (]: 4 of 7 OK created sql view model JAFFLE_SHOP.stg_orders ........................ [[32mSUCCESS 1[0m in 1.03s]
[0m16:41:16.923059 [debug] [Thread-4 (]: Finished running node model.jaffle_shop.stg_orders
[0m16:41:16.924233 [debug] [Thread-4 (]: Began running node model.jaffle_shop.stg_payments
[0m16:41:16.925649 [info ] [Thread-4 (]: 5 of 7 START sql view model JAFFLE_SHOP.stg_payments ........................... [RUN]
[0m16:41:16.926735 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.jaffle_shop.stg_orders, now model.jaffle_shop.stg_payments)
[0m16:41:16.927580 [debug] [Thread-4 (]: Began compiling node model.jaffle_shop.stg_payments
[0m16:41:16.935361 [debug] [Thread-4 (]: Writing injected SQL for node "model.jaffle_shop.stg_payments"
[0m16:41:16.937728 [debug] [Thread-4 (]: Began executing node model.jaffle_shop.stg_payments
[0m16:41:16.942714 [debug] [Thread-4 (]: Writing runtime sql for node "model.jaffle_shop.stg_payments"
[0m16:41:16.946698 [debug] [Thread-4 (]: Using snowflake connection "model.jaffle_shop.stg_payments"
[0m16:41:16.947615 [debug] [Thread-4 (]: On model.jaffle_shop.stg_payments: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_payments"} */
create or replace   view RAW.JAFFLE_SHOP.stg_payments
  
   as (
    

select
    id,
    order_id,
    payment_method,
    round(1.0 * amount / 100, 2) AS amount_usd

from raw.jaffle_shop.raw_payments
  );
[0m16:41:16.948409 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:41:16.951764 [debug] [Thread-1 (]: Database Error in model customer_orders (models/customer_orders.sql)
  002003 (42S02): SQL compilation error:
  Object 'RAW.JAFFLE_SHOP.ORDERS' does not exist or not authorized.
  compiled code at target/run/jaffle_shop/models/customer_orders.sql
[0m16:41:16.952535 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b8aa60de-48fc-458a-84f2-e6de4b5e4302', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b35210>]}
[0m16:41:16.953899 [error] [Thread-1 (]: 1 of 7 ERROR creating sql table model JAFFLE_SHOP.customer_orders .............. [[31mERROR[0m in 1.07s]
[0m16:41:16.955296 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.customer_orders
[0m16:41:17.072363 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.285 seconds
[0m16:41:17.078405 [debug] [Thread-2 (]: On model.jaffle_shop.int_orders_test: Close
[0m16:41:17.263072 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b8aa60de-48fc-458a-84f2-e6de4b5e4302', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10678ecd0>]}
[0m16:41:17.265002 [info ] [Thread-2 (]: 2 of 7 OK created sql view model JAFFLE_SHOP.int_orders_test ................... [[32mSUCCESS 1[0m in 1.37s]
[0m16:41:17.266528 [debug] [Thread-2 (]: Finished running node model.jaffle_shop.int_orders_test
[0m16:41:17.559082 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.560 seconds
[0m16:41:17.567322 [debug] [Thread-3 (]: On model.jaffle_shop.stg_customers: Close
[0m16:41:17.950767 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b8aa60de-48fc-458a-84f2-e6de4b5e4302', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e17090>]}
[0m16:41:17.953801 [info ] [Thread-3 (]: 3 of 7 OK created sql view model JAFFLE_SHOP.stg_customers ..................... [[32mSUCCESS 1[0m in 2.06s]
[0m16:41:17.956398 [debug] [Thread-3 (]: Finished running node model.jaffle_shop.stg_customers
[0m16:41:17.958992 [debug] [Thread-1 (]: Began running node model.jaffle_shop.customers
[0m16:41:17.960118 [info ] [Thread-1 (]: 6 of 7 START sql view model JAFFLE_SHOP.customers .............................. [RUN]
[0m16:41:17.961273 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.jaffle_shop.customer_orders, now model.jaffle_shop.customers)
[0m16:41:17.963114 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.customers
[0m16:41:17.970036 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.customers"
[0m16:41:17.971311 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.customers
[0m16:41:17.976254 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.customers"
[0m16:41:17.979422 [debug] [Thread-1 (]: Using snowflake connection "model.jaffle_shop.customers"
[0m16:41:17.980063 [debug] [Thread-1 (]: On model.jaffle_shop.customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.customers"} */
create or replace   view RAW.JAFFLE_SHOP.customers
  
   as (
    


with customers as (

    select * from RAW.JAFFLE_SHOP.stg_customers

),

orders as (

    select * from RAW.JAFFLE_SHOP.stg_orders

),

customer_orders as (

    select
        customer_id,

        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders

    from orders

    group by 1

),

final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce(customer_orders.number_of_orders, 0) as number_of_orders

    from customers

    left join customer_orders using (customer_id)

)

select * from final
  );
[0m16:41:17.980612 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:41:18.864549 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.884 seconds
[0m16:41:18.868936 [debug] [Thread-1 (]: On model.jaffle_shop.customers: Close
[0m16:41:19.012272 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b8aa60de-48fc-458a-84f2-e6de4b5e4302', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1058f0ed0>]}
[0m16:41:19.013438 [info ] [Thread-1 (]: 6 of 7 OK created sql view model JAFFLE_SHOP.customers ......................... [[32mSUCCESS 1[0m in 1.05s]
[0m16:41:19.014634 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.customers
[0m16:41:19.710389 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 2.762 seconds
[0m16:41:19.715670 [debug] [Thread-4 (]: On model.jaffle_shop.stg_payments: Close
[0m16:41:19.883410 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b8aa60de-48fc-458a-84f2-e6de4b5e4302', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106cd3a10>]}
[0m16:41:19.884496 [info ] [Thread-4 (]: 5 of 7 OK created sql view model JAFFLE_SHOP.stg_payments ...................... [[32mSUCCESS 1[0m in 2.96s]
[0m16:41:19.885442 [debug] [Thread-4 (]: Finished running node model.jaffle_shop.stg_payments
[0m16:41:19.886770 [debug] [Thread-3 (]: Began running node model.jaffle_shop.int_orders__pivoted
[0m16:41:19.887737 [info ] [Thread-3 (]: 7 of 7 START sql view model JAFFLE_SHOP.int_orders__pivoted .................... [RUN]
[0m16:41:19.888551 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.jaffle_shop.stg_customers, now model.jaffle_shop.int_orders__pivoted)
[0m16:41:19.889174 [debug] [Thread-3 (]: Began compiling node model.jaffle_shop.int_orders__pivoted
[0m16:41:19.895530 [debug] [Thread-3 (]: Writing injected SQL for node "model.jaffle_shop.int_orders__pivoted"
[0m16:41:19.896508 [debug] [Thread-3 (]: Began executing node model.jaffle_shop.int_orders__pivoted
[0m16:41:19.899864 [debug] [Thread-3 (]: Writing runtime sql for node "model.jaffle_shop.int_orders__pivoted"
[0m16:41:19.902216 [debug] [Thread-3 (]: Using snowflake connection "model.jaffle_shop.int_orders__pivoted"
[0m16:41:19.902783 [debug] [Thread-3 (]: On model.jaffle_shop.int_orders__pivoted: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.int_orders__pivoted"} */
create or replace   view RAW.JAFFLE_SHOP.int_orders__pivoted
  
   as (
    



WITH payments AS (
    SELECT p.id AS id,
           p.order_id AS order_id,
           p.payment_method AS payment_method,
           p.amount_usd AS amount,
           o.status AS status
    FROM RAW.JAFFLE_SHOP.stg_payments p
    JOIN RAW.JAFFLE_SHOP.stg_orders o
    ON p.order_id = o.order_id
),
pivoted AS (
    SELECT
        order_id,
        SUM(CASE WHEN payment_method = 'bank_transfer' THEN amount ELSE 0 END) AS bank_transfer_amount,
        SUM(CASE WHEN payment_method = 'coupon' THEN amount ELSE 0 END) AS coupon_amount,
        SUM(CASE WHEN payment_method = 'credit_card' THEN amount ELSE 0 END) AS credit_card_amount,
        SUM(CASE WHEN payment_method = 'gift_card' THEN amount ELSE 0 END) AS gift_card_amount
    FROM payments
    WHERE status = 'completed'
    GROUP BY 1
)

SELECT * FROM pivoted
  );
[0m16:41:19.903231 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:41:21.445643 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.542 seconds
[0m16:41:21.452353 [debug] [Thread-3 (]: On model.jaffle_shop.int_orders__pivoted: Close
[0m16:41:21.592139 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b8aa60de-48fc-458a-84f2-e6de4b5e4302', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106fa3a50>]}
[0m16:41:21.594133 [info ] [Thread-3 (]: 7 of 7 OK created sql view model JAFFLE_SHOP.int_orders__pivoted ............... [[32mSUCCESS 1[0m in 1.70s]
[0m16:41:21.596391 [debug] [Thread-3 (]: Finished running node model.jaffle_shop.int_orders__pivoted
[0m16:41:21.600026 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:41:21.600951 [debug] [MainThread]: Connection 'model.jaffle_shop.customers' was properly closed.
[0m16:41:21.601747 [debug] [MainThread]: Connection 'model.jaffle_shop.int_orders_test' was properly closed.
[0m16:41:21.602469 [debug] [MainThread]: Connection 'model.jaffle_shop.int_orders__pivoted' was properly closed.
[0m16:41:21.603172 [debug] [MainThread]: Connection 'model.jaffle_shop.stg_payments' was properly closed.
[0m16:41:21.603994 [info ] [MainThread]: 
[0m16:41:21.604793 [info ] [MainThread]: Finished running 6 view models, 1 table model in 0 hours 0 minutes and 7.98 seconds (7.98s).
[0m16:41:21.608066 [debug] [MainThread]: Command end result
[0m16:41:21.652292 [info ] [MainThread]: 
[0m16:41:21.652979 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m16:41:21.653420 [info ] [MainThread]: 
[0m16:41:21.653916 [error] [MainThread]:   Database Error in model customer_orders (models/customer_orders.sql)
  002003 (42S02): SQL compilation error:
  Object 'RAW.JAFFLE_SHOP.ORDERS' does not exist or not authorized.
  compiled code at target/run/jaffle_shop/models/customer_orders.sql
[0m16:41:21.654343 [info ] [MainThread]: 
[0m16:41:21.654722 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=1 SKIP=0 TOTAL=7
[0m16:41:21.656774 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 9.197223, "process_user_time": 3.141164, "process_kernel_time": 0.608656, "process_mem_max_rss": "131768320", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m16:41:21.657481 [debug] [MainThread]: Command `dbt run` failed at 16:41:21.657376 after 9.20 seconds
[0m16:41:21.657930 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105abb510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105abbf50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1024d4350>]}
[0m16:41:21.658321 [debug] [MainThread]: Flushing usage events
[0m16:51:23.259959 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107217e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10728c650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10728cf90>]}


============================== 16:51:23.270820 | cdab5cd1-fb73-4d8e-91b2-5252b4a08987 ==============================
[0m16:51:23.270820 [info ] [MainThread]: Running with dbt=1.8.7
[0m16:51:23.271928 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/ben/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/ben/Dbt Certification/dbt-tutorial/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt seed', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m16:51:23.870644 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cdab5cd1-fb73-4d8e-91b2-5252b4a08987', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1079d7f90>]}
[0m16:51:23.936897 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cdab5cd1-fb73-4d8e-91b2-5252b4a08987', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106cceb90>]}
[0m16:51:23.939063 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m16:51:23.973449 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m16:51:24.097029 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m16:51:24.097736 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'cdab5cd1-fb73-4d8e-91b2-5252b4a08987', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ea0790>]}
[0m16:51:25.825571 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m16:51:25.826418 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'cdab5cd1-fb73-4d8e-91b2-5252b4a08987', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108462790>]}
[0m16:51:26.105647 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cdab5cd1-fb73-4d8e-91b2-5252b4a08987', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1084ebd50>]}
[0m16:51:26.245284 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cdab5cd1-fb73-4d8e-91b2-5252b4a08987', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108585bd0>]}
[0m16:51:26.245880 [info ] [MainThread]: Found 7 models, 3 seeds, 11 data tests, 572 macros
[0m16:51:26.246301 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cdab5cd1-fb73-4d8e-91b2-5252b4a08987', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10863ae90>]}
[0m16:51:26.249354 [info ] [MainThread]: 
[0m16:51:26.250567 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:51:26.257429 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ANALYTICS'
[0m16:51:26.269537 [debug] [ThreadPool]: Using snowflake connection "list_ANALYTICS"
[0m16:51:26.270038 [debug] [ThreadPool]: On list_ANALYTICS: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_ANALYTICS"} */
show terse schemas in database ANALYTICS
    limit 10000
[0m16:51:26.270461 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:51:27.140233 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.869 seconds
[0m16:51:27.144070 [debug] [ThreadPool]: On list_ANALYTICS: Close
[0m16:51:27.462683 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ANALYTICS, now list_ANALYTICS_JAFFLE_SHOP)
[0m16:51:27.482602 [debug] [ThreadPool]: Using snowflake connection "list_ANALYTICS_JAFFLE_SHOP"
[0m16:51:27.483294 [debug] [ThreadPool]: On list_ANALYTICS_JAFFLE_SHOP: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_ANALYTICS_JAFFLE_SHOP"} */
show objects in ANALYTICS.JAFFLE_SHOP limit 10000
[0m16:51:27.484353 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:51:28.792065 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.308 seconds
[0m16:51:28.796644 [debug] [ThreadPool]: On list_ANALYTICS_JAFFLE_SHOP: Close
[0m16:51:28.933076 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cdab5cd1-fb73-4d8e-91b2-5252b4a08987', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108321650>]}
[0m16:51:28.934162 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:51:28.934816 [info ] [MainThread]: 
[0m16:51:28.938892 [debug] [Thread-1 (]: Began running node seed.jaffle_shop.raw_customers
[0m16:51:28.939802 [info ] [Thread-1 (]: 1 of 3 START seed file JAFFLE_SHOP.raw_customers ............................... [RUN]
[0m16:51:28.941063 [debug] [Thread-2 (]: Began running node seed.jaffle_shop.raw_orders
[0m16:51:28.941787 [debug] [Thread-3 (]: Began running node seed.jaffle_shop.raw_payments
[0m16:51:28.942560 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_ANALYTICS_JAFFLE_SHOP, now seed.jaffle_shop.raw_customers)
[0m16:51:28.943283 [info ] [Thread-2 (]: 2 of 3 START seed file JAFFLE_SHOP.raw_orders .................................. [RUN]
[0m16:51:28.944090 [info ] [Thread-3 (]: 3 of 3 START seed file JAFFLE_SHOP.raw_payments ................................ [RUN]
[0m16:51:28.945112 [debug] [Thread-1 (]: Began compiling node seed.jaffle_shop.raw_customers
[0m16:51:28.946002 [debug] [Thread-2 (]: Acquiring new snowflake connection 'seed.jaffle_shop.raw_orders'
[0m16:51:28.946602 [debug] [Thread-3 (]: Acquiring new snowflake connection 'seed.jaffle_shop.raw_payments'
[0m16:51:28.947128 [debug] [Thread-1 (]: Began executing node seed.jaffle_shop.raw_customers
[0m16:51:28.947571 [debug] [Thread-2 (]: Began compiling node seed.jaffle_shop.raw_orders
[0m16:51:28.947999 [debug] [Thread-3 (]: Began compiling node seed.jaffle_shop.raw_payments
[0m16:51:28.987640 [debug] [Thread-2 (]: Began executing node seed.jaffle_shop.raw_orders
[0m16:51:29.000482 [debug] [Thread-1 (]: Using snowflake connection "seed.jaffle_shop.raw_customers"
[0m16:51:29.001339 [debug] [Thread-3 (]: Began executing node seed.jaffle_shop.raw_payments
[0m16:51:29.007421 [debug] [Thread-1 (]: On seed.jaffle_shop.raw_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_customers"} */
BEGIN
[0m16:51:29.013740 [debug] [Thread-2 (]: Using snowflake connection "seed.jaffle_shop.raw_orders"
[0m16:51:29.022367 [debug] [Thread-3 (]: Using snowflake connection "seed.jaffle_shop.raw_payments"
[0m16:51:29.022969 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:51:29.023908 [debug] [Thread-2 (]: On seed.jaffle_shop.raw_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_orders"} */
BEGIN
[0m16:51:29.024712 [debug] [Thread-3 (]: On seed.jaffle_shop.raw_payments: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_payments"} */
BEGIN
[0m16:51:29.026343 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m16:51:29.029268 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m16:51:29.790285 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.764 seconds
[0m16:51:29.791946 [debug] [Thread-2 (]: Using snowflake connection "seed.jaffle_shop.raw_orders"
[0m16:51:29.793070 [debug] [Thread-2 (]: On seed.jaffle_shop.raw_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_orders"} */
truncate table "ANALYTICS"."JAFFLE_SHOP"."RAW_ORDERS"
  ;
[0m16:51:30.215985 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.187 seconds
[0m16:51:30.217500 [debug] [Thread-3 (]: Using snowflake connection "seed.jaffle_shop.raw_payments"
[0m16:51:30.219075 [debug] [Thread-3 (]: On seed.jaffle_shop.raw_payments: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_payments"} */
truncate table "ANALYTICS"."JAFFLE_SHOP"."RAW_PAYMENTS"
  ;
[0m16:51:30.644050 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.424 seconds
[0m16:51:30.644852 [debug] [Thread-3 (]: Using snowflake connection "seed.jaffle_shop.raw_payments"
[0m16:51:30.645478 [debug] [Thread-3 (]: On seed.jaffle_shop.raw_payments: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_payments"} */
COMMIT
[0m16:51:30.731111 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.708 seconds
[0m16:51:30.732179 [debug] [Thread-1 (]: Using snowflake connection "seed.jaffle_shop.raw_customers"
[0m16:51:30.732964 [debug] [Thread-1 (]: On seed.jaffle_shop.raw_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_customers"} */
truncate table "ANALYTICS"."JAFFLE_SHOP"."RAW_CUSTOMERS"
  ;
[0m16:51:31.834013 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.188 seconds
[0m16:51:31.868304 [debug] [Thread-3 (]: Using snowflake connection "seed.jaffle_shop.raw_payments"
[0m16:51:31.869348 [debug] [Thread-3 (]: On seed.jaffle_shop.raw_payments: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_payments"} */
BEGIN
[0m16:51:32.076932 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.207 seconds
[0m16:51:32.083225 [debug] [Thread-3 (]: Using snowflake connection "seed.jaffle_shop.raw_payments"
[0m16:51:32.084166 [debug] [Thread-3 (]: On seed.jaffle_shop.raw_payments: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_payments"} */
insert into ANALYTICS.JAFFLE_SHOP.raw_payments (id, order_id, payment_method, amount) values
            (%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s)...
[0m16:51:32.127137 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 2.333 seconds
[0m16:51:32.128170 [debug] [Thread-2 (]: Using snowflake connection "seed.jaffle_shop.raw_orders"
[0m16:51:32.129012 [debug] [Thread-2 (]: On seed.jaffle_shop.raw_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_orders"} */
COMMIT
[0m16:51:32.156358 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.423 seconds
[0m16:51:32.157560 [debug] [Thread-1 (]: Using snowflake connection "seed.jaffle_shop.raw_customers"
[0m16:51:32.158232 [debug] [Thread-1 (]: On seed.jaffle_shop.raw_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_customers"} */
COMMIT
[0m16:51:32.327787 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.198 seconds
[0m16:51:32.333636 [debug] [Thread-2 (]: Using snowflake connection "seed.jaffle_shop.raw_orders"
[0m16:51:32.334945 [debug] [Thread-2 (]: On seed.jaffle_shop.raw_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_orders"} */
BEGIN
[0m16:51:32.654671 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.319 seconds
[0m16:51:32.662423 [debug] [Thread-2 (]: Using snowflake connection "seed.jaffle_shop.raw_orders"
[0m16:51:32.663495 [debug] [Thread-2 (]: On seed.jaffle_shop.raw_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_orders"} */
insert into ANALYTICS.JAFFLE_SHOP.raw_orders (id, user_id, order_date, status) values
            (%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%...
[0m16:51:32.815280 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.656 seconds
[0m16:51:32.818794 [debug] [Thread-1 (]: Using snowflake connection "seed.jaffle_shop.raw_customers"
[0m16:51:32.819341 [debug] [Thread-1 (]: On seed.jaffle_shop.raw_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_customers"} */
BEGIN
[0m16:51:32.999504 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.179 seconds
[0m16:51:33.009072 [debug] [Thread-1 (]: Using snowflake connection "seed.jaffle_shop.raw_customers"
[0m16:51:33.010600 [debug] [Thread-1 (]: On seed.jaffle_shop.raw_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_customers"} */
insert into ANALYTICS.JAFFLE_SHOP.raw_customers (id, first_name, last_name) values
            (%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s)...
[0m16:51:33.791865 [debug] [Thread-2 (]: SQL status: SUCCESS 99 in 1.127 seconds
[0m16:51:33.793489 [debug] [Thread-2 (]: Using snowflake connection "seed.jaffle_shop.raw_orders"
[0m16:51:33.794794 [debug] [Thread-2 (]: On seed.jaffle_shop.raw_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_orders"} */
COMMIT
[0m16:51:34.302589 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.507 seconds
[0m16:51:34.330006 [debug] [Thread-2 (]: Writing runtime SQL for node "seed.jaffle_shop.raw_orders"
[0m16:51:34.359089 [debug] [Thread-2 (]: On seed.jaffle_shop.raw_orders: Close
[0m16:51:34.564680 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cdab5cd1-fb73-4d8e-91b2-5252b4a08987', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106cbaa10>]}
[0m16:51:34.565720 [info ] [Thread-2 (]: 2 of 3 OK loaded seed file JAFFLE_SHOP.raw_orders .............................. [[32mINSERT 99[0m in 5.62s]
[0m16:51:34.567003 [debug] [Thread-2 (]: Finished running node seed.jaffle_shop.raw_orders
[0m16:51:34.798871 [debug] [Thread-1 (]: SQL status: SUCCESS 100 in 1.787 seconds
[0m16:51:34.804196 [debug] [Thread-1 (]: Using snowflake connection "seed.jaffle_shop.raw_customers"
[0m16:51:34.805204 [debug] [Thread-1 (]: On seed.jaffle_shop.raw_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_customers"} */
COMMIT
[0m16:51:34.886442 [debug] [Thread-3 (]: SQL status: SUCCESS 113 in 2.802 seconds
[0m16:51:34.887888 [debug] [Thread-3 (]: Using snowflake connection "seed.jaffle_shop.raw_payments"
[0m16:51:34.888762 [debug] [Thread-3 (]: On seed.jaffle_shop.raw_payments: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_payments"} */
COMMIT
[0m16:51:35.432983 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.627 seconds
[0m16:51:35.436415 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.jaffle_shop.raw_customers"
[0m16:51:35.441708 [debug] [Thread-1 (]: On seed.jaffle_shop.raw_customers: Close
[0m16:51:35.448504 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.559 seconds
[0m16:51:35.451348 [debug] [Thread-3 (]: Writing runtime SQL for node "seed.jaffle_shop.raw_payments"
[0m16:51:35.456980 [debug] [Thread-3 (]: On seed.jaffle_shop.raw_payments: Close
[0m16:51:35.616995 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cdab5cd1-fb73-4d8e-91b2-5252b4a08987', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10821a250>]}
[0m16:51:35.620343 [info ] [Thread-1 (]: 1 of 3 OK loaded seed file JAFFLE_SHOP.raw_customers ........................... [[32mINSERT 100[0m in 6.67s]
[0m16:51:35.622775 [debug] [Thread-1 (]: Finished running node seed.jaffle_shop.raw_customers
[0m16:51:35.660940 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cdab5cd1-fb73-4d8e-91b2-5252b4a08987', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d6fd10>]}
[0m16:51:35.662534 [info ] [Thread-3 (]: 3 of 3 OK loaded seed file JAFFLE_SHOP.raw_payments ............................ [[32mINSERT 113[0m in 6.71s]
[0m16:51:35.663999 [debug] [Thread-3 (]: Finished running node seed.jaffle_shop.raw_payments
[0m16:51:35.667090 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:51:35.668474 [debug] [MainThread]: Connection 'seed.jaffle_shop.raw_customers' was properly closed.
[0m16:51:35.669726 [debug] [MainThread]: Connection 'seed.jaffle_shop.raw_orders' was properly closed.
[0m16:51:35.670647 [debug] [MainThread]: Connection 'seed.jaffle_shop.raw_payments' was properly closed.
[0m16:51:35.671418 [info ] [MainThread]: 
[0m16:51:35.672093 [info ] [MainThread]: Finished running 3 seeds in 0 hours 0 minutes and 9.42 seconds (9.42s).
[0m16:51:35.673623 [debug] [MainThread]: Command end result
[0m16:51:35.716996 [info ] [MainThread]: 
[0m16:51:35.717731 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:51:35.718594 [info ] [MainThread]: 
[0m16:51:35.719083 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m16:51:35.722694 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": true, "command_wall_clock_time": 12.560843, "process_user_time": 4.850467, "process_kernel_time": 0.663209, "process_mem_max_rss": "136122368", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m16:51:35.723451 [debug] [MainThread]: Command `dbt seed` succeeded at 16:51:35.723313 after 12.56 seconds
[0m16:51:35.724218 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107267d50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107267c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103d09390>]}
[0m16:51:35.725027 [debug] [MainThread]: Flushing usage events
[0m18:08:01.392018 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c6f7550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c746050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c74ffd0>]}


============================== 18:08:01.401537 | e5093964-059b-4c46-a1a8-cbb75ef12456 ==============================
[0m18:08:01.401537 [info ] [MainThread]: Running with dbt=1.8.7
[0m18:08:01.402287 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/ben/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/Users/ben/Dbt Certification/dbt-tutorial/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt seed', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m18:08:01.948109 [error] [MainThread]: Encountered an error:
Runtime Error
  at path []: Additional properties are not allowed ('staging' was unexpected)

Error encountered in /Users/ben/Dbt Certification/dbt-tutorial/dbt_project.yml
[0m18:08:01.951030 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_wall_clock_time": 0.6415063, "process_user_time": 1.656577, "process_kernel_time": 0.40636, "process_mem_max_rss": "110563328", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m18:08:01.951754 [debug] [MainThread]: Command `dbt seed` failed at 18:08:01.951622 after 0.64 seconds
[0m18:08:01.952367 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b477990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109160c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d436650>]}
[0m18:08:01.952911 [debug] [MainThread]: Flushing usage events
[0m18:08:23.761411 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111c68090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111cd46d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111cd5010>]}


============================== 18:08:23.767678 | 30d14e09-58ad-4f34-ba9b-7112e30badfc ==============================
[0m18:08:23.767678 [info ] [MainThread]: Running with dbt=1.8.7
[0m18:08:23.768428 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/ben/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/ben/Dbt Certification/dbt-tutorial/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt seed', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:08:24.147399 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '30d14e09-58ad-4f34-ba9b-7112e30badfc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11296b290>]}
[0m18:08:24.203792 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '30d14e09-58ad-4f34-ba9b-7112e30badfc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11172aa50>]}
[0m18:08:24.205624 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m18:08:24.234661 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m18:08:24.346311 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m18:08:24.347043 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '30d14e09-58ad-4f34-ba9b-7112e30badfc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1109388d0>]}
[0m18:08:25.844613 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m18:08:25.845374 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '30d14e09-58ad-4f34-ba9b-7112e30badfc', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112c64310>]}
[0m18:08:26.062478 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.staging
[0m18:08:26.068825 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '30d14e09-58ad-4f34-ba9b-7112e30badfc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112950d50>]}
[0m18:08:26.191140 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '30d14e09-58ad-4f34-ba9b-7112e30badfc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112f6ded0>]}
[0m18:08:26.191861 [info ] [MainThread]: Found 7 models, 3 seeds, 11 data tests, 572 macros
[0m18:08:26.192377 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '30d14e09-58ad-4f34-ba9b-7112e30badfc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112f80ed0>]}
[0m18:08:26.194709 [info ] [MainThread]: 
[0m18:08:26.195370 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m18:08:26.199822 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_raw'
[0m18:08:26.210558 [debug] [ThreadPool]: Using snowflake connection "list_raw"
[0m18:08:26.211385 [debug] [ThreadPool]: On list_raw: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_raw"} */
show terse schemas in database raw
    limit 10000
[0m18:08:26.211750 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:08:27.133165 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.921 seconds
[0m18:08:27.137546 [debug] [ThreadPool]: On list_raw: Close
[0m18:08:27.333682 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_raw, now create_raw_JAFFLE_SHOP_jaffle_shop)
[0m18:08:27.335341 [debug] [ThreadPool]: Creating schema "database: "raw"
schema: "JAFFLE_SHOP_jaffle_shop"
"
[0m18:08:27.345823 [debug] [ThreadPool]: Using snowflake connection "create_raw_JAFFLE_SHOP_jaffle_shop"
[0m18:08:27.346641 [debug] [ThreadPool]: On create_raw_JAFFLE_SHOP_jaffle_shop: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "create_raw_JAFFLE_SHOP_jaffle_shop"} */
create schema if not exists raw.JAFFLE_SHOP_jaffle_shop
[0m18:08:27.347298 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:08:28.253487 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.906 seconds
[0m18:08:28.256566 [debug] [ThreadPool]: On create_raw_JAFFLE_SHOP_jaffle_shop: Close
[0m18:08:28.407264 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_raw_JAFFLE_SHOP_jaffle_shop, now list_ANALYTICS_JAFFLE_SHOP)
[0m18:08:28.409032 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_raw_JAFFLE_SHOP_jaffle_shop'
[0m18:08:28.427519 [debug] [ThreadPool]: Using snowflake connection "list_ANALYTICS_JAFFLE_SHOP"
[0m18:08:28.430900 [debug] [ThreadPool]: Using snowflake connection "list_raw_JAFFLE_SHOP_jaffle_shop"
[0m18:08:28.431568 [debug] [ThreadPool]: On list_ANALYTICS_JAFFLE_SHOP: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_ANALYTICS_JAFFLE_SHOP"} */
show objects in ANALYTICS.JAFFLE_SHOP limit 10000
[0m18:08:28.432143 [debug] [ThreadPool]: On list_raw_JAFFLE_SHOP_jaffle_shop: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_raw_JAFFLE_SHOP_jaffle_shop"} */
show objects in raw.JAFFLE_SHOP_jaffle_shop limit 10000
[0m18:08:28.432635 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:08:28.433053 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:08:29.578417 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 1.145 seconds
[0m18:08:29.581708 [debug] [ThreadPool]: On list_raw_JAFFLE_SHOP_jaffle_shop: Close
[0m18:08:32.039900 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 3.607 seconds
[0m18:08:32.044335 [debug] [ThreadPool]: On list_ANALYTICS_JAFFLE_SHOP: Close
[0m18:08:32.187000 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '30d14e09-58ad-4f34-ba9b-7112e30badfc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112d48750>]}
[0m18:08:32.188798 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:08:32.189929 [info ] [MainThread]: 
[0m18:08:32.196463 [debug] [Thread-1 (]: Began running node seed.jaffle_shop.raw_customers
[0m18:08:32.197655 [debug] [Thread-2 (]: Began running node seed.jaffle_shop.raw_orders
[0m18:08:32.198925 [debug] [Thread-3 (]: Began running node seed.jaffle_shop.raw_payments
[0m18:08:32.200347 [info ] [Thread-1 (]: 1 of 3 START seed file raw.JAFFLE_SHOP_jaffle_shop.raw_customers ............... [RUN]
[0m18:08:32.201811 [info ] [Thread-2 (]: 2 of 3 START seed file raw.JAFFLE_SHOP_jaffle_shop.raw_orders .................. [RUN]
[0m18:08:32.202865 [info ] [Thread-3 (]: 3 of 3 START seed file raw.JAFFLE_SHOP_jaffle_shop.raw_payments ................ [RUN]
[0m18:08:32.203740 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_ANALYTICS_JAFFLE_SHOP, now seed.jaffle_shop.raw_customers)
[0m18:08:32.204589 [debug] [Thread-2 (]: Acquiring new snowflake connection 'seed.jaffle_shop.raw_orders'
[0m18:08:32.206253 [debug] [Thread-3 (]: Acquiring new snowflake connection 'seed.jaffle_shop.raw_payments'
[0m18:08:32.206989 [debug] [Thread-1 (]: Began compiling node seed.jaffle_shop.raw_customers
[0m18:08:32.207945 [debug] [Thread-2 (]: Began compiling node seed.jaffle_shop.raw_orders
[0m18:08:32.208806 [debug] [Thread-3 (]: Began compiling node seed.jaffle_shop.raw_payments
[0m18:08:32.209477 [debug] [Thread-1 (]: Began executing node seed.jaffle_shop.raw_customers
[0m18:08:32.210063 [debug] [Thread-2 (]: Began executing node seed.jaffle_shop.raw_orders
[0m18:08:32.210617 [debug] [Thread-3 (]: Began executing node seed.jaffle_shop.raw_payments
[0m18:08:32.264464 [debug] [Thread-2 (]: Using snowflake connection "seed.jaffle_shop.raw_orders"
[0m18:08:32.265144 [debug] [Thread-1 (]: Using snowflake connection "seed.jaffle_shop.raw_customers"
[0m18:08:32.268863 [debug] [Thread-2 (]: On seed.jaffle_shop.raw_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_orders"} */
create table raw.JAFFLE_SHOP_jaffle_shop.raw_orders (id integer,user_id integer,order_date date,status text)
[0m18:08:32.272707 [debug] [Thread-3 (]: Using snowflake connection "seed.jaffle_shop.raw_payments"
[0m18:08:32.273169 [debug] [Thread-1 (]: On seed.jaffle_shop.raw_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_customers"} */
create table raw.JAFFLE_SHOP_jaffle_shop.raw_customers (id integer,first_name text,last_name text)
[0m18:08:32.273554 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m18:08:32.273947 [debug] [Thread-3 (]: On seed.jaffle_shop.raw_payments: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_payments"} */
create table raw.JAFFLE_SHOP_jaffle_shop.raw_payments (id integer,order_id integer,payment_method text,amount integer)
[0m18:08:32.274518 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:08:32.275140 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m18:08:32.923344 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.648 seconds
[0m18:08:32.954055 [debug] [Thread-3 (]: Using snowflake connection "seed.jaffle_shop.raw_payments"
[0m18:08:32.954713 [debug] [Thread-3 (]: On seed.jaffle_shop.raw_payments: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_payments"} */
BEGIN
[0m18:08:33.063277 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.108 seconds
[0m18:08:33.072062 [debug] [Thread-3 (]: Using snowflake connection "seed.jaffle_shop.raw_payments"
[0m18:08:33.073221 [debug] [Thread-3 (]: On seed.jaffle_shop.raw_payments: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_payments"} */
insert into raw.JAFFLE_SHOP_jaffle_shop.raw_payments (id, order_id, payment_method, amount) values
            (%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,...
[0m18:08:33.218473 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.944 seconds
[0m18:08:33.226219 [debug] [Thread-2 (]: Using snowflake connection "seed.jaffle_shop.raw_orders"
[0m18:08:33.230251 [debug] [Thread-2 (]: On seed.jaffle_shop.raw_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_orders"} */
BEGIN
[0m18:08:33.354850 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.123 seconds
[0m18:08:33.362469 [debug] [Thread-2 (]: Using snowflake connection "seed.jaffle_shop.raw_orders"
[0m18:08:33.363424 [debug] [Thread-2 (]: On seed.jaffle_shop.raw_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_orders"} */
insert into raw.JAFFLE_SHOP_jaffle_shop.raw_orders (id, user_id, order_date, status) values
            (%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%...
[0m18:08:33.476326 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.201 seconds
[0m18:08:33.483788 [debug] [Thread-1 (]: Using snowflake connection "seed.jaffle_shop.raw_customers"
[0m18:08:33.484753 [debug] [Thread-1 (]: On seed.jaffle_shop.raw_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_customers"} */
BEGIN
[0m18:08:33.594375 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.109 seconds
[0m18:08:33.598166 [debug] [Thread-1 (]: Using snowflake connection "seed.jaffle_shop.raw_customers"
[0m18:08:33.598856 [debug] [Thread-1 (]: On seed.jaffle_shop.raw_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_customers"} */
insert into raw.JAFFLE_SHOP_jaffle_shop.raw_customers (id, first_name, last_name) values
            (%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,...
[0m18:08:34.704593 [debug] [Thread-3 (]: SQL status: SUCCESS 113 in 1.630 seconds
[0m18:08:34.706993 [debug] [Thread-3 (]: Using snowflake connection "seed.jaffle_shop.raw_payments"
[0m18:08:34.708731 [debug] [Thread-3 (]: On seed.jaffle_shop.raw_payments: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_payments"} */
COMMIT
[0m18:08:34.797223 [debug] [Thread-2 (]: SQL status: SUCCESS 99 in 1.433 seconds
[0m18:08:34.798988 [debug] [Thread-2 (]: Using snowflake connection "seed.jaffle_shop.raw_orders"
[0m18:08:34.800117 [debug] [Thread-2 (]: On seed.jaffle_shop.raw_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_orders"} */
COMMIT
[0m18:08:35.015542 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.214 seconds
[0m18:08:35.030987 [debug] [Thread-2 (]: Writing runtime SQL for node "seed.jaffle_shop.raw_orders"
[0m18:08:35.063913 [debug] [Thread-2 (]: On seed.jaffle_shop.raw_orders: Close
[0m18:08:35.277874 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.567 seconds
[0m18:08:35.280072 [debug] [Thread-3 (]: Writing runtime SQL for node "seed.jaffle_shop.raw_payments"
[0m18:08:35.286283 [debug] [Thread-3 (]: On seed.jaffle_shop.raw_payments: Close
[0m18:08:35.300812 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '30d14e09-58ad-4f34-ba9b-7112e30badfc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112d6ead0>]}
[0m18:08:35.302015 [info ] [Thread-2 (]: 2 of 3 OK loaded seed file JAFFLE_SHOP_jaffle_shop.raw_orders .................. [[32mINSERT 99[0m in 3.09s]
[0m18:08:35.303241 [debug] [Thread-2 (]: Finished running node seed.jaffle_shop.raw_orders
[0m18:08:35.543479 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '30d14e09-58ad-4f34-ba9b-7112e30badfc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112aa7010>]}
[0m18:08:35.545503 [info ] [Thread-3 (]: 3 of 3 OK loaded seed file JAFFLE_SHOP_jaffle_shop.raw_payments ................ [[32mINSERT 113[0m in 3.34s]
[0m18:08:35.547829 [debug] [Thread-3 (]: Finished running node seed.jaffle_shop.raw_payments
[0m18:08:36.002743 [debug] [Thread-1 (]: SQL status: SUCCESS 100 in 2.403 seconds
[0m18:08:36.004486 [debug] [Thread-1 (]: Using snowflake connection "seed.jaffle_shop.raw_customers"
[0m18:08:36.006081 [debug] [Thread-1 (]: On seed.jaffle_shop.raw_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_customers"} */
COMMIT
[0m18:08:37.104101 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.097 seconds
[0m18:08:37.106118 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.jaffle_shop.raw_customers"
[0m18:08:37.113695 [debug] [Thread-1 (]: On seed.jaffle_shop.raw_customers: Close
[0m18:08:37.572922 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '30d14e09-58ad-4f34-ba9b-7112e30badfc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112983490>]}
[0m18:08:37.574691 [info ] [Thread-1 (]: 1 of 3 OK loaded seed file JAFFLE_SHOP_jaffle_shop.raw_customers ............... [[32mINSERT 100[0m in 5.37s]
[0m18:08:37.576471 [debug] [Thread-1 (]: Finished running node seed.jaffle_shop.raw_customers
[0m18:08:37.580031 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:08:37.581392 [debug] [MainThread]: Connection 'seed.jaffle_shop.raw_customers' was properly closed.
[0m18:08:37.582607 [debug] [MainThread]: Connection 'list_raw_JAFFLE_SHOP_jaffle_shop' was properly closed.
[0m18:08:37.583482 [debug] [MainThread]: Connection 'seed.jaffle_shop.raw_orders' was properly closed.
[0m18:08:37.584095 [debug] [MainThread]: Connection 'seed.jaffle_shop.raw_payments' was properly closed.
[0m18:08:37.584826 [info ] [MainThread]: 
[0m18:08:37.585617 [info ] [MainThread]: Finished running 3 seeds in 0 hours 0 minutes and 11.39 seconds (11.39s).
[0m18:08:37.589057 [debug] [MainThread]: Command end result
[0m18:08:37.631484 [info ] [MainThread]: 
[0m18:08:37.632192 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:08:37.632652 [info ] [MainThread]: 
[0m18:08:37.633038 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m18:08:37.634785 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": true, "command_wall_clock_time": 13.948258, "process_user_time": 4.433878, "process_kernel_time": 0.421403, "process_mem_max_rss": "137109504", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m18:08:37.635464 [debug] [MainThread]: Command `dbt seed` succeeded at 18:08:37.635355 after 13.95 seconds
[0m18:08:37.636223 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e7b11d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e704310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e704b10>]}
[0m18:08:37.636763 [debug] [MainThread]: Flushing usage events
[0m18:15:34.768910 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bb0d710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bb7c790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bb7d0d0>]}


============================== 18:15:34.778998 | 3345f880-b1c1-45ed-a7d2-57780c2183c3 ==============================
[0m18:15:34.778998 [info ] [MainThread]: Running with dbt=1.8.7
[0m18:15:34.780013 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/ben/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/Users/ben/Dbt Certification/dbt-tutorial/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt seed', 'send_anonymous_usage_stats': 'True'}
[0m18:15:35.327400 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3345f880-b1c1-45ed-a7d2-57780c2183c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c79df90>]}
[0m18:15:35.383850 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3345f880-b1c1-45ed-a7d2-57780c2183c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b5beb10>]}
[0m18:15:35.385858 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m18:15:35.414546 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m18:15:35.522802 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m18:15:35.523553 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '3345f880-b1c1-45ed-a7d2-57780c2183c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a7909d0>]}
[0m18:15:37.015360 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m18:15:37.016041 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '3345f880-b1c1-45ed-a7d2-57780c2183c3', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cc4ab50>]}
[0m18:15:37.232944 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.staging
- seeds.stripe
- seeds.stripe.raw_payments
[0m18:15:37.239144 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3345f880-b1c1-45ed-a7d2-57780c2183c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cc3b450>]}
[0m18:15:37.361377 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3345f880-b1c1-45ed-a7d2-57780c2183c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ce44e10>]}
[0m18:15:37.361944 [info ] [MainThread]: Found 7 models, 3 seeds, 11 data tests, 572 macros
[0m18:15:37.362386 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3345f880-b1c1-45ed-a7d2-57780c2183c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ce7aed0>]}
[0m18:15:37.364459 [info ] [MainThread]: 
[0m18:15:37.365239 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m18:15:37.370226 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_raw'
[0m18:15:37.371194 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_raw'
[0m18:15:37.381527 [debug] [ThreadPool]: Using snowflake connection "list_raw"
[0m18:15:37.384128 [debug] [ThreadPool]: Using snowflake connection "list_raw"
[0m18:15:37.384553 [debug] [ThreadPool]: On list_raw: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_raw"} */
show terse schemas in database raw
    limit 10000
[0m18:15:37.384907 [debug] [ThreadPool]: On list_raw: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_raw"} */
show terse schemas in database raw
    limit 10000
[0m18:15:37.385235 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:15:37.385555 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:15:38.646986 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 1.261 seconds
[0m18:15:38.648615 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 1.263 seconds
[0m18:15:38.652168 [debug] [ThreadPool]: On list_raw: Close
[0m18:15:38.655241 [debug] [ThreadPool]: On list_raw: Close
[0m18:15:39.267113 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_raw, now create_raw_JAFFLE_SHOP_jaffle_shop)
[0m18:15:39.268274 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_raw, now create_raw_JAFFLE_SHOP)
[0m18:15:39.269567 [debug] [ThreadPool]: Creating schema "database: "raw"
schema: "JAFFLE_SHOP_jaffle_shop"
"
[0m18:15:39.270644 [debug] [ThreadPool]: Creating schema "database: "raw"
schema: "JAFFLE_SHOP"
"
[0m18:15:39.285882 [debug] [ThreadPool]: Using snowflake connection "create_raw_JAFFLE_SHOP_jaffle_shop"
[0m18:15:39.285249 [debug] [ThreadPool]: Using snowflake connection "create_raw_JAFFLE_SHOP"
[0m18:15:39.287250 [debug] [ThreadPool]: On create_raw_JAFFLE_SHOP_jaffle_shop: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "create_raw_JAFFLE_SHOP_jaffle_shop"} */
create schema if not exists raw.JAFFLE_SHOP_jaffle_shop
[0m18:15:39.287843 [debug] [ThreadPool]: On create_raw_JAFFLE_SHOP: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "create_raw_JAFFLE_SHOP"} */
create schema if not exists raw.JAFFLE_SHOP
[0m18:15:39.288342 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:15:39.288810 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:15:40.483988 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.195 seconds
[0m18:15:40.487044 [debug] [ThreadPool]: On create_raw_JAFFLE_SHOP_jaffle_shop: Close
[0m18:15:40.646672 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.358 seconds
[0m18:15:40.649424 [debug] [ThreadPool]: On create_raw_JAFFLE_SHOP: Close
[0m18:15:40.838890 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_raw_JAFFLE_SHOP, now list_raw_JAFFLE_SHOP_jaffle_shop)
[0m18:15:40.840564 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_raw_JAFFLE_SHOP_jaffle_shop, now list_ANALYTICS_JAFFLE_SHOP)
[0m18:15:40.843808 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_raw_JAFFLE_SHOP'
[0m18:15:40.865419 [debug] [ThreadPool]: Using snowflake connection "list_raw_JAFFLE_SHOP_jaffle_shop"
[0m18:15:40.871833 [debug] [ThreadPool]: Using snowflake connection "list_ANALYTICS_JAFFLE_SHOP"
[0m18:15:40.874979 [debug] [ThreadPool]: Using snowflake connection "list_raw_JAFFLE_SHOP"
[0m18:15:40.875523 [debug] [ThreadPool]: On list_raw_JAFFLE_SHOP_jaffle_shop: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_raw_JAFFLE_SHOP_jaffle_shop"} */
show objects in raw.JAFFLE_SHOP_jaffle_shop limit 10000
[0m18:15:40.875993 [debug] [ThreadPool]: On list_ANALYTICS_JAFFLE_SHOP: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_ANALYTICS_JAFFLE_SHOP"} */
show objects in ANALYTICS.JAFFLE_SHOP limit 10000
[0m18:15:40.876437 [debug] [ThreadPool]: On list_raw_JAFFLE_SHOP: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_raw_JAFFLE_SHOP"} */
show objects in raw.JAFFLE_SHOP limit 10000
[0m18:15:40.877009 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:15:40.877533 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:15:40.877942 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:15:41.837724 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.960 seconds
[0m18:15:41.842375 [debug] [ThreadPool]: On list_ANALYTICS_JAFFLE_SHOP: Close
[0m18:15:41.950673 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 1.073 seconds
[0m18:15:41.954134 [debug] [ThreadPool]: On list_raw_JAFFLE_SHOP: Close
[0m18:15:41.955556 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 1.079 seconds
[0m18:15:41.959630 [debug] [ThreadPool]: On list_raw_JAFFLE_SHOP_jaffle_shop: Close
[0m18:15:42.123151 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3345f880-b1c1-45ed-a7d2-57780c2183c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cdce050>]}
[0m18:15:42.124952 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:15:42.126055 [info ] [MainThread]: 
[0m18:15:42.132304 [debug] [Thread-1 (]: Began running node seed.jaffle_shop.raw_customers
[0m18:15:42.133717 [debug] [Thread-2 (]: Began running node seed.jaffle_shop.raw_orders
[0m18:15:42.134809 [info ] [Thread-1 (]: 1 of 3 START seed file raw.JAFFLE_SHOP_jaffle_shop.raw_customers ............... [RUN]
[0m18:15:42.136291 [debug] [Thread-3 (]: Began running node seed.jaffle_shop.raw_payments
[0m18:15:42.137643 [info ] [Thread-2 (]: 2 of 3 START seed file raw.JAFFLE_SHOP_jaffle_shop.raw_orders .................. [RUN]
[0m18:15:42.139181 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_raw_JAFFLE_SHOP_jaffle_shop, now seed.jaffle_shop.raw_customers)
[0m18:15:42.140214 [info ] [Thread-3 (]: 3 of 3 START seed file raw.JAFFLE_SHOP.raw_payments ............................ [RUN]
[0m18:15:42.141170 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_ANALYTICS_JAFFLE_SHOP, now seed.jaffle_shop.raw_orders)
[0m18:15:42.141910 [debug] [Thread-1 (]: Began compiling node seed.jaffle_shop.raw_customers
[0m18:15:42.142635 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_raw_JAFFLE_SHOP, now seed.jaffle_shop.raw_payments)
[0m18:15:42.143404 [debug] [Thread-2 (]: Began compiling node seed.jaffle_shop.raw_orders
[0m18:15:42.144077 [debug] [Thread-1 (]: Began executing node seed.jaffle_shop.raw_customers
[0m18:15:42.144664 [debug] [Thread-3 (]: Began compiling node seed.jaffle_shop.raw_payments
[0m18:15:42.145271 [debug] [Thread-2 (]: Began executing node seed.jaffle_shop.raw_orders
[0m18:15:42.162968 [debug] [Thread-3 (]: Began executing node seed.jaffle_shop.raw_payments
[0m18:15:42.202222 [debug] [Thread-1 (]: Using snowflake connection "seed.jaffle_shop.raw_customers"
[0m18:15:42.203324 [debug] [Thread-2 (]: Using snowflake connection "seed.jaffle_shop.raw_orders"
[0m18:15:42.206686 [debug] [Thread-3 (]: Using snowflake connection "seed.jaffle_shop.raw_payments"
[0m18:15:42.207105 [debug] [Thread-1 (]: On seed.jaffle_shop.raw_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_customers"} */
create table raw.JAFFLE_SHOP_jaffle_shop.raw_customers (id integer,first_name text,last_name text)
[0m18:15:42.207776 [debug] [Thread-2 (]: On seed.jaffle_shop.raw_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_orders"} */
create table raw.JAFFLE_SHOP_jaffle_shop.raw_orders (id integer,user_id integer,order_date date,status text)
[0m18:15:42.208198 [debug] [Thread-3 (]: On seed.jaffle_shop.raw_payments: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_payments"} */
create table raw.JAFFLE_SHOP.raw_payments (id integer,order_id integer,payment_method text,amount integer)
[0m18:15:42.208632 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:15:42.209032 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:15:42.209399 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m18:15:44.378215 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 2.168 seconds
[0m18:15:44.381596 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.173 seconds
[0m18:15:44.424315 [debug] [Thread-2 (]: Using snowflake connection "seed.jaffle_shop.raw_orders"
[0m18:15:44.427531 [debug] [Thread-1 (]: Using snowflake connection "seed.jaffle_shop.raw_customers"
[0m18:15:44.428098 [debug] [Thread-2 (]: On seed.jaffle_shop.raw_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_orders"} */
BEGIN
[0m18:15:44.428485 [debug] [Thread-1 (]: On seed.jaffle_shop.raw_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_customers"} */
BEGIN
[0m18:15:44.462772 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 2.253 seconds
[0m18:15:44.470456 [debug] [Thread-3 (]: Using snowflake connection "seed.jaffle_shop.raw_payments"
[0m18:15:44.471409 [debug] [Thread-3 (]: On seed.jaffle_shop.raw_payments: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_payments"} */
BEGIN
[0m18:15:44.551750 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.121 seconds
[0m18:15:44.558586 [debug] [Thread-1 (]: Using snowflake connection "seed.jaffle_shop.raw_customers"
[0m18:15:44.559551 [debug] [Thread-1 (]: On seed.jaffle_shop.raw_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_customers"} */
insert into raw.JAFFLE_SHOP_jaffle_shop.raw_customers (id, first_name, last_name) values
            (%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,...
[0m18:15:44.606108 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.133 seconds
[0m18:15:44.614253 [debug] [Thread-3 (]: Using snowflake connection "seed.jaffle_shop.raw_payments"
[0m18:15:44.615208 [debug] [Thread-3 (]: On seed.jaffle_shop.raw_payments: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_payments"} */
insert into raw.JAFFLE_SHOP.raw_payments (id, order_id, payment_method, amount) values
            (%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%...
[0m18:15:45.502132 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.073 seconds
[0m18:15:45.512807 [debug] [Thread-2 (]: Using snowflake connection "seed.jaffle_shop.raw_orders"
[0m18:15:45.514208 [debug] [Thread-2 (]: On seed.jaffle_shop.raw_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_orders"} */
insert into raw.JAFFLE_SHOP_jaffle_shop.raw_orders (id, user_id, order_date, status) values
            (%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%...
[0m18:15:45.766467 [debug] [Thread-3 (]: SQL status: SUCCESS 113 in 1.150 seconds
[0m18:15:45.768683 [debug] [Thread-3 (]: Using snowflake connection "seed.jaffle_shop.raw_payments"
[0m18:15:45.769837 [debug] [Thread-3 (]: On seed.jaffle_shop.raw_payments: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_payments"} */
COMMIT
[0m18:15:46.286197 [debug] [Thread-1 (]: SQL status: SUCCESS 100 in 1.726 seconds
[0m18:15:46.286928 [debug] [Thread-1 (]: Using snowflake connection "seed.jaffle_shop.raw_customers"
[0m18:15:46.287412 [debug] [Thread-1 (]: On seed.jaffle_shop.raw_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_customers"} */
COMMIT
[0m18:15:46.409858 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.639 seconds
[0m18:15:46.424591 [debug] [Thread-3 (]: Writing runtime SQL for node "seed.jaffle_shop.raw_payments"
[0m18:15:46.458414 [debug] [Thread-3 (]: On seed.jaffle_shop.raw_payments: Close
[0m18:15:46.558410 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.270 seconds
[0m18:15:46.560550 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.jaffle_shop.raw_customers"
[0m18:15:46.565971 [debug] [Thread-1 (]: On seed.jaffle_shop.raw_customers: Close
[0m18:15:46.672475 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3345f880-b1c1-45ed-a7d2-57780c2183c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ca96ed0>]}
[0m18:15:46.674348 [info ] [Thread-3 (]: 3 of 3 OK loaded seed file JAFFLE_SHOP.raw_payments ............................ [[32mINSERT 113[0m in 4.53s]
[0m18:15:46.676329 [debug] [Thread-3 (]: Finished running node seed.jaffle_shop.raw_payments
[0m18:15:46.739732 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3345f880-b1c1-45ed-a7d2-57780c2183c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ccb8e10>]}
[0m18:15:46.741635 [info ] [Thread-1 (]: 1 of 3 OK loaded seed file JAFFLE_SHOP_jaffle_shop.raw_customers ............... [[32mINSERT 100[0m in 4.60s]
[0m18:15:46.743385 [debug] [Thread-1 (]: Finished running node seed.jaffle_shop.raw_customers
[0m18:15:47.968364 [debug] [Thread-2 (]: SQL status: SUCCESS 99 in 2.453 seconds
[0m18:15:47.970100 [debug] [Thread-2 (]: Using snowflake connection "seed.jaffle_shop.raw_orders"
[0m18:15:47.971268 [debug] [Thread-2 (]: On seed.jaffle_shop.raw_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_orders"} */
COMMIT
[0m18:15:54.207167 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 6.235 seconds
[0m18:15:54.209406 [debug] [Thread-2 (]: Writing runtime SQL for node "seed.jaffle_shop.raw_orders"
[0m18:15:54.215816 [debug] [Thread-2 (]: On seed.jaffle_shop.raw_orders: Close
[0m18:15:55.025546 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3345f880-b1c1-45ed-a7d2-57780c2183c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10caeaad0>]}
[0m18:15:55.026971 [info ] [Thread-2 (]: 2 of 3 OK loaded seed file JAFFLE_SHOP_jaffle_shop.raw_orders .................. [[32mINSERT 99[0m in 12.88s]
[0m18:15:55.028407 [debug] [Thread-2 (]: Finished running node seed.jaffle_shop.raw_orders
[0m18:15:55.031510 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:15:55.032254 [debug] [MainThread]: Connection 'seed.jaffle_shop.raw_customers' was properly closed.
[0m18:15:55.032899 [debug] [MainThread]: Connection 'seed.jaffle_shop.raw_orders' was properly closed.
[0m18:15:55.033508 [debug] [MainThread]: Connection 'seed.jaffle_shop.raw_payments' was properly closed.
[0m18:15:55.034225 [info ] [MainThread]: 
[0m18:15:55.034953 [info ] [MainThread]: Finished running 3 seeds in 0 hours 0 minutes and 17.67 seconds (17.67s).
[0m18:15:55.036698 [debug] [MainThread]: Command end result
[0m18:15:55.078591 [info ] [MainThread]: 
[0m18:15:55.079225 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:15:55.079622 [info ] [MainThread]: 
[0m18:15:55.080064 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m18:15:55.081974 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": true, "command_wall_clock_time": 20.401249, "process_user_time": 4.876133, "process_kernel_time": 0.620193, "process_mem_max_rss": "137428992", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m18:15:55.082696 [debug] [MainThread]: Command `dbt seed` succeeded at 18:15:55.082587 after 20.40 seconds
[0m18:15:55.083203 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1085f9390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108548350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108548c50>]}
[0m18:15:55.083640 [debug] [MainThread]: Flushing usage events
[0m18:24:09.467339 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d2d750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d98450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d98d90>]}


============================== 18:24:09.476495 | 7c48377a-1b4c-442d-a28e-43f434b26808 ==============================
[0m18:24:09.476495 [info ] [MainThread]: Running with dbt=1.8.7
[0m18:24:09.477400 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/ben/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/ben/Dbt Certification/dbt-tutorial/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt seed', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:24:10.017274 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7c48377a-1b4c-442d-a28e-43f434b26808', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c51910>]}
[0m18:24:10.075608 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7c48377a-1b4c-442d-a28e-43f434b26808', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067eeb50>]}
[0m18:24:10.077386 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m18:24:10.106306 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m18:24:10.218522 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m18:24:10.219230 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '7c48377a-1b4c-442d-a28e-43f434b26808', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a00790>]}
[0m18:24:11.756547 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m18:24:11.757418 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '7c48377a-1b4c-442d-a28e-43f434b26808', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107bf3d10>]}
[0m18:24:11.977980 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.staging
[0m18:24:11.984867 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7c48377a-1b4c-442d-a28e-43f434b26808', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107fbbc90>]}
[0m18:24:12.115873 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7c48377a-1b4c-442d-a28e-43f434b26808', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107fba990>]}
[0m18:24:12.116850 [info ] [MainThread]: Found 7 models, 3 seeds, 11 data tests, 572 macros
[0m18:24:12.117333 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7c48377a-1b4c-442d-a28e-43f434b26808', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f9ffd0>]}
[0m18:24:12.119440 [info ] [MainThread]: 
[0m18:24:12.120144 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m18:24:12.125084 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_raw'
[0m18:24:12.132598 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_raw'
[0m18:24:12.136548 [debug] [ThreadPool]: Using snowflake connection "list_raw"
[0m18:24:12.140212 [debug] [ThreadPool]: Using snowflake connection "list_raw"
[0m18:24:12.140737 [debug] [ThreadPool]: On list_raw: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_raw"} */
show terse schemas in database raw
    limit 10000
[0m18:24:12.141264 [debug] [ThreadPool]: On list_raw: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_raw"} */
show terse schemas in database raw
    limit 10000
[0m18:24:12.141653 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:24:12.142044 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:24:15.966572 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 3.824 seconds
[0m18:24:15.970828 [debug] [ThreadPool]: On list_raw: Close
[0m18:24:16.315005 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 4.173 seconds
[0m18:24:16.319310 [debug] [ThreadPool]: On list_raw: Close
[0m18:24:16.664867 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_raw, now create_raw_JAFFLE_SHOP_jaffle_shop)
[0m18:24:16.666278 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_raw, now create_raw_JAFFLE_SHOP_stripe)
[0m18:24:16.668042 [debug] [ThreadPool]: Creating schema "database: "raw"
schema: "JAFFLE_SHOP_jaffle_shop"
"
[0m18:24:16.669395 [debug] [ThreadPool]: Creating schema "database: "raw"
schema: "JAFFLE_SHOP_stripe"
"
[0m18:24:16.688365 [debug] [ThreadPool]: Using snowflake connection "create_raw_JAFFLE_SHOP_stripe"
[0m18:24:16.689444 [debug] [ThreadPool]: Using snowflake connection "create_raw_JAFFLE_SHOP_jaffle_shop"
[0m18:24:16.689949 [debug] [ThreadPool]: On create_raw_JAFFLE_SHOP_stripe: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "create_raw_JAFFLE_SHOP_stripe"} */
create schema if not exists raw.JAFFLE_SHOP_stripe
[0m18:24:16.690731 [debug] [ThreadPool]: On create_raw_JAFFLE_SHOP_jaffle_shop: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "create_raw_JAFFLE_SHOP_jaffle_shop"} */
create schema if not exists raw.JAFFLE_SHOP_jaffle_shop
[0m18:24:16.691397 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:24:16.691886 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:24:17.223708 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.532 seconds
[0m18:24:17.226672 [debug] [ThreadPool]: On create_raw_JAFFLE_SHOP_jaffle_shop: Close
[0m18:24:17.974008 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.282 seconds
[0m18:24:17.977105 [debug] [ThreadPool]: On create_raw_JAFFLE_SHOP_stripe: Close
[0m18:24:18.149058 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_raw_JAFFLE_SHOP_jaffle_shop, now list_ANALYTICS_JAFFLE_SHOP)
[0m18:24:18.150824 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_raw_JAFFLE_SHOP_stripe, now list_raw_JAFFLE_SHOP_jaffle_shop)
[0m18:24:18.154215 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_raw_JAFFLE_SHOP_stripe'
[0m18:24:18.179762 [debug] [ThreadPool]: Using snowflake connection "list_raw_JAFFLE_SHOP_jaffle_shop"
[0m18:24:18.182895 [debug] [ThreadPool]: Using snowflake connection "list_ANALYTICS_JAFFLE_SHOP"
[0m18:24:18.186995 [debug] [ThreadPool]: Using snowflake connection "list_raw_JAFFLE_SHOP_stripe"
[0m18:24:18.188087 [debug] [ThreadPool]: On list_raw_JAFFLE_SHOP_jaffle_shop: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_raw_JAFFLE_SHOP_jaffle_shop"} */
show objects in raw.JAFFLE_SHOP_jaffle_shop limit 10000
[0m18:24:18.188622 [debug] [ThreadPool]: On list_ANALYTICS_JAFFLE_SHOP: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_ANALYTICS_JAFFLE_SHOP"} */
show objects in ANALYTICS.JAFFLE_SHOP limit 10000
[0m18:24:18.189080 [debug] [ThreadPool]: On list_raw_JAFFLE_SHOP_stripe: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_raw_JAFFLE_SHOP_stripe"} */
show objects in raw.JAFFLE_SHOP_stripe limit 10000
[0m18:24:18.189781 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:24:18.190184 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:24:18.190568 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:24:21.083997 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 2.893 seconds
[0m18:24:21.088347 [debug] [ThreadPool]: On list_raw_JAFFLE_SHOP_stripe: Close
[0m18:24:22.870828 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 4.680 seconds
[0m18:24:22.875668 [debug] [ThreadPool]: On list_ANALYTICS_JAFFLE_SHOP: Close
[0m18:24:23.641425 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 5.452 seconds
[0m18:24:23.643690 [debug] [ThreadPool]: On list_raw_JAFFLE_SHOP_jaffle_shop: Close
[0m18:24:23.814986 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7c48377a-1b4c-442d-a28e-43f434b26808', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107fca910>]}
[0m18:24:23.816415 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:24:23.816939 [info ] [MainThread]: 
[0m18:24:23.823421 [debug] [Thread-1 (]: Began running node seed.jaffle_shop.raw_customers
[0m18:24:23.824270 [debug] [Thread-2 (]: Began running node seed.jaffle_shop.raw_orders
[0m18:24:23.824784 [debug] [Thread-3 (]: Began running node seed.jaffle_shop.raw_payments
[0m18:24:23.825745 [info ] [Thread-1 (]: 1 of 3 START seed file raw.JAFFLE_SHOP_jaffle_shop.raw_customers ............... [RUN]
[0m18:24:23.826613 [info ] [Thread-2 (]: 2 of 3 START seed file raw.JAFFLE_SHOP_jaffle_shop.raw_orders .................. [RUN]
[0m18:24:23.827639 [info ] [Thread-3 (]: 3 of 3 START seed file raw.JAFFLE_SHOP_stripe.raw_payments ..................... [RUN]
[0m18:24:23.828341 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_ANALYTICS_JAFFLE_SHOP, now seed.jaffle_shop.raw_customers)
[0m18:24:23.829062 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_raw_JAFFLE_SHOP_jaffle_shop, now seed.jaffle_shop.raw_orders)
[0m18:24:23.830039 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_raw_JAFFLE_SHOP_stripe, now seed.jaffle_shop.raw_payments)
[0m18:24:23.830795 [debug] [Thread-1 (]: Began compiling node seed.jaffle_shop.raw_customers
[0m18:24:23.831260 [debug] [Thread-2 (]: Began compiling node seed.jaffle_shop.raw_orders
[0m18:24:23.831660 [debug] [Thread-3 (]: Began compiling node seed.jaffle_shop.raw_payments
[0m18:24:23.832073 [debug] [Thread-1 (]: Began executing node seed.jaffle_shop.raw_customers
[0m18:24:23.832559 [debug] [Thread-2 (]: Began executing node seed.jaffle_shop.raw_orders
[0m18:24:23.833021 [debug] [Thread-3 (]: Began executing node seed.jaffle_shop.raw_payments
[0m18:24:23.933513 [debug] [Thread-2 (]: Using snowflake connection "seed.jaffle_shop.raw_orders"
[0m18:24:23.935875 [debug] [Thread-3 (]: Using snowflake connection "seed.jaffle_shop.raw_payments"
[0m18:24:23.936626 [debug] [Thread-2 (]: On seed.jaffle_shop.raw_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_orders"} */
create table raw.JAFFLE_SHOP_jaffle_shop.raw_orders (id integer,user_id integer,order_date date,status text)
[0m18:24:23.941287 [debug] [Thread-1 (]: Using snowflake connection "seed.jaffle_shop.raw_customers"
[0m18:24:23.941953 [debug] [Thread-3 (]: On seed.jaffle_shop.raw_payments: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_payments"} */
create table raw.JAFFLE_SHOP_stripe.raw_payments (id integer,order_id integer,payment_method text,amount integer)
[0m18:24:23.942455 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:24:23.942858 [debug] [Thread-1 (]: On seed.jaffle_shop.raw_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_customers"} */
create table raw.JAFFLE_SHOP_jaffle_shop.raw_customers (id integer,first_name text,last_name text)
[0m18:24:23.943331 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m18:24:23.945053 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:24:24.870170 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.927 seconds
[0m18:24:24.900763 [debug] [Thread-2 (]: Using snowflake connection "seed.jaffle_shop.raw_orders"
[0m18:24:24.901489 [debug] [Thread-2 (]: On seed.jaffle_shop.raw_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_orders"} */
BEGIN
[0m18:24:25.135884 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.234 seconds
[0m18:24:25.157431 [debug] [Thread-2 (]: Using snowflake connection "seed.jaffle_shop.raw_orders"
[0m18:24:25.158335 [debug] [Thread-2 (]: On seed.jaffle_shop.raw_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_orders"} */
insert into raw.JAFFLE_SHOP_jaffle_shop.raw_orders (id, user_id, order_date, status) values
            (%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%...
[0m18:24:26.199703 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 2.256 seconds
[0m18:24:26.208021 [debug] [Thread-3 (]: Using snowflake connection "seed.jaffle_shop.raw_payments"
[0m18:24:26.209118 [debug] [Thread-3 (]: On seed.jaffle_shop.raw_payments: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_payments"} */
BEGIN
[0m18:24:26.457548 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.247 seconds
[0m18:24:26.465896 [debug] [Thread-3 (]: Using snowflake connection "seed.jaffle_shop.raw_payments"
[0m18:24:26.467018 [debug] [Thread-3 (]: On seed.jaffle_shop.raw_payments: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_payments"} */
insert into raw.JAFFLE_SHOP_stripe.raw_payments (id, order_id, payment_method, amount) values
            (%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s...
[0m18:24:27.737799 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 3.793 seconds
[0m18:24:27.741736 [debug] [Thread-1 (]: Using snowflake connection "seed.jaffle_shop.raw_customers"
[0m18:24:27.742348 [debug] [Thread-1 (]: On seed.jaffle_shop.raw_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_customers"} */
BEGIN
[0m18:24:27.941690 [debug] [Thread-2 (]: SQL status: SUCCESS 99 in 2.782 seconds
[0m18:24:27.943689 [debug] [Thread-2 (]: Using snowflake connection "seed.jaffle_shop.raw_orders"
[0m18:24:27.944959 [debug] [Thread-2 (]: On seed.jaffle_shop.raw_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_orders"} */
COMMIT
[0m18:24:28.114584 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.372 seconds
[0m18:24:28.120821 [debug] [Thread-1 (]: Using snowflake connection "seed.jaffle_shop.raw_customers"
[0m18:24:28.121866 [debug] [Thread-1 (]: On seed.jaffle_shop.raw_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_customers"} */
insert into raw.JAFFLE_SHOP_jaffle_shop.raw_customers (id, first_name, last_name) values
            (%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,...
[0m18:24:28.866615 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.920 seconds
[0m18:24:28.880604 [debug] [Thread-2 (]: Writing runtime SQL for node "seed.jaffle_shop.raw_orders"
[0m18:24:28.913766 [debug] [Thread-2 (]: On seed.jaffle_shop.raw_orders: Close
[0m18:24:28.971448 [debug] [Thread-3 (]: SQL status: SUCCESS 113 in 2.503 seconds
[0m18:24:28.973037 [debug] [Thread-3 (]: Using snowflake connection "seed.jaffle_shop.raw_payments"
[0m18:24:28.974162 [debug] [Thread-3 (]: On seed.jaffle_shop.raw_payments: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_payments"} */
COMMIT
[0m18:24:29.085173 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7c48377a-1b4c-442d-a28e-43f434b26808', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a33590>]}
[0m18:24:29.086779 [info ] [Thread-2 (]: 2 of 3 OK loaded seed file JAFFLE_SHOP_jaffle_shop.raw_orders .................. [[32mINSERT 99[0m in 5.25s]
[0m18:24:29.088317 [debug] [Thread-2 (]: Finished running node seed.jaffle_shop.raw_orders
[0m18:24:29.170598 [debug] [Thread-1 (]: SQL status: SUCCESS 100 in 1.048 seconds
[0m18:24:29.172324 [debug] [Thread-1 (]: Using snowflake connection "seed.jaffle_shop.raw_customers"
[0m18:24:29.173482 [debug] [Thread-1 (]: On seed.jaffle_shop.raw_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_customers"} */
COMMIT
[0m18:24:29.686032 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.711 seconds
[0m18:24:29.688023 [debug] [Thread-3 (]: Writing runtime SQL for node "seed.jaffle_shop.raw_payments"
[0m18:24:29.693364 [debug] [Thread-3 (]: On seed.jaffle_shop.raw_payments: Close
[0m18:24:29.820549 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.646 seconds
[0m18:24:29.822542 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.jaffle_shop.raw_customers"
[0m18:24:29.827799 [debug] [Thread-1 (]: On seed.jaffle_shop.raw_customers: Close
[0m18:24:29.916124 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7c48377a-1b4c-442d-a28e-43f434b26808', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c7d890>]}
[0m18:24:29.917901 [info ] [Thread-3 (]: 3 of 3 OK loaded seed file JAFFLE_SHOP_stripe.raw_payments ..................... [[32mINSERT 113[0m in 6.09s]
[0m18:24:29.919812 [debug] [Thread-3 (]: Finished running node seed.jaffle_shop.raw_payments
[0m18:24:29.992972 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7c48377a-1b4c-442d-a28e-43f434b26808', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1080203d0>]}
[0m18:24:29.995052 [info ] [Thread-1 (]: 1 of 3 OK loaded seed file JAFFLE_SHOP_jaffle_shop.raw_customers ............... [[32mINSERT 100[0m in 6.16s]
[0m18:24:29.997575 [debug] [Thread-1 (]: Finished running node seed.jaffle_shop.raw_customers
[0m18:24:30.001127 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:24:30.002392 [debug] [MainThread]: Connection 'seed.jaffle_shop.raw_customers' was properly closed.
[0m18:24:30.003561 [debug] [MainThread]: Connection 'seed.jaffle_shop.raw_orders' was properly closed.
[0m18:24:30.004314 [debug] [MainThread]: Connection 'seed.jaffle_shop.raw_payments' was properly closed.
[0m18:24:30.005304 [info ] [MainThread]: 
[0m18:24:30.006386 [info ] [MainThread]: Finished running 3 seeds in 0 hours 0 minutes and 17.89 seconds (17.89s).
[0m18:24:30.008714 [debug] [MainThread]: Command end result
[0m18:24:30.052532 [info ] [MainThread]: 
[0m18:24:30.053262 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:24:30.053833 [info ] [MainThread]: 
[0m18:24:30.054264 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m18:24:30.057074 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": true, "command_wall_clock_time": 20.67101, "process_user_time": 4.897521, "process_kernel_time": 0.635211, "process_mem_max_rss": "135573504", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m18:24:30.057968 [debug] [MainThread]: Command `dbt seed` succeeded at 18:24:30.057853 after 20.67 seconds
[0m18:24:30.058394 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d77950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103875250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1037c8c10>]}
[0m18:24:30.058775 [debug] [MainThread]: Flushing usage events
[0m18:40:33.847583 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1040b4a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1040fe050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1040ff8d0>]}


============================== 18:40:33.854709 | ccd09f3d-c187-4f81-bf22-4c46208ce99c ==============================
[0m18:40:33.854709 [info ] [MainThread]: Running with dbt=1.8.7
[0m18:40:33.855517 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/ben/Dbt Certification/dbt-tutorial/logs', 'debug': 'False', 'profiles_dir': '/Users/ben/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt seed', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m18:40:34.224905 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ccd09f3d-c187-4f81-bf22-4c46208ce99c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104be1010>]}
[0m18:40:34.281827 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ccd09f3d-c187-4f81-bf22-4c46208ce99c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103b66a90>]}
[0m18:40:34.282991 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m18:40:34.309488 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m18:40:34.425089 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m18:40:34.426281 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'ccd09f3d-c187-4f81-bf22-4c46208ce99c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e9d2d0>]}
[0m18:40:35.895449 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m18:40:35.896178 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'ccd09f3d-c187-4f81-bf22-4c46208ce99c', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104fa1310>]}
[0m18:40:36.158899 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.staging
[0m18:40:36.164941 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ccd09f3d-c187-4f81-bf22-4c46208ce99c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10536b510>]}
[0m18:40:36.272511 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ccd09f3d-c187-4f81-bf22-4c46208ce99c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10558b9d0>]}
[0m18:40:36.273221 [info ] [MainThread]: Found 7 models, 3 seeds, 11 data tests, 572 macros
[0m18:40:36.273728 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ccd09f3d-c187-4f81-bf22-4c46208ce99c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1053ffb90>]}
[0m18:40:36.276147 [info ] [MainThread]: 
[0m18:40:36.276831 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m18:40:36.281414 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_raw'
[0m18:40:36.288382 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_raw'
[0m18:40:36.292519 [debug] [ThreadPool]: Using snowflake connection "list_raw"
[0m18:40:36.295915 [debug] [ThreadPool]: Using snowflake connection "list_raw"
[0m18:40:36.296491 [debug] [ThreadPool]: On list_raw: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_raw"} */
show terse schemas in database raw
    limit 10000
[0m18:40:36.297025 [debug] [ThreadPool]: On list_raw: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_raw"} */
show terse schemas in database raw
    limit 10000
[0m18:40:36.297359 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:40:36.297669 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:40:37.436402 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 1.139 seconds
[0m18:40:37.439961 [debug] [ThreadPool]: On list_raw: Close
[0m18:40:37.846859 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 1.549 seconds
[0m18:40:37.850974 [debug] [ThreadPool]: On list_raw: Close
[0m18:40:38.274106 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_raw, now create_raw_JAFFLE_SHOP_jaffle_shop)
[0m18:40:38.275472 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_raw, now create_raw_JAFFLE_SHOP_stripe)
[0m18:40:38.277007 [debug] [ThreadPool]: Creating schema "database: "raw"
schema: "JAFFLE_SHOP_jaffle_shop"
"
[0m18:40:38.278185 [debug] [ThreadPool]: Creating schema "database: "raw"
schema: "JAFFLE_SHOP_stripe"
"
[0m18:40:38.288737 [debug] [ThreadPool]: Using snowflake connection "create_raw_JAFFLE_SHOP_jaffle_shop"
[0m18:40:38.292458 [debug] [ThreadPool]: Using snowflake connection "create_raw_JAFFLE_SHOP_stripe"
[0m18:40:38.293091 [debug] [ThreadPool]: On create_raw_JAFFLE_SHOP_jaffle_shop: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "create_raw_JAFFLE_SHOP_jaffle_shop"} */
create schema if not exists raw.JAFFLE_SHOP_jaffle_shop
[0m18:40:38.293678 [debug] [ThreadPool]: On create_raw_JAFFLE_SHOP_stripe: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "create_raw_JAFFLE_SHOP_stripe"} */
create schema if not exists raw.JAFFLE_SHOP_stripe
[0m18:40:38.294223 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:40:38.294747 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:40:38.862591 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.568 seconds
[0m18:40:38.865580 [debug] [ThreadPool]: On create_raw_JAFFLE_SHOP_jaffle_shop: Close
[0m18:40:40.061481 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.767 seconds
[0m18:40:40.064642 [debug] [ThreadPool]: On create_raw_JAFFLE_SHOP_stripe: Close
[0m18:40:40.390734 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_raw_JAFFLE_SHOP_stripe, now list_ANALYTICS_JAFFLE_SHOP)
[0m18:40:40.392103 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_raw_JAFFLE_SHOP_jaffle_shop, now list_raw_JAFFLE_SHOP_jaffle_shop)
[0m18:40:40.393720 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_raw_JAFFLE_SHOP_stripe'
[0m18:40:40.423299 [debug] [ThreadPool]: Using snowflake connection "list_ANALYTICS_JAFFLE_SHOP"
[0m18:40:40.424385 [debug] [ThreadPool]: Using snowflake connection "list_raw_JAFFLE_SHOP_jaffle_shop"
[0m18:40:40.427185 [debug] [ThreadPool]: Using snowflake connection "list_raw_JAFFLE_SHOP_stripe"
[0m18:40:40.427638 [debug] [ThreadPool]: On list_ANALYTICS_JAFFLE_SHOP: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_ANALYTICS_JAFFLE_SHOP"} */
show objects in ANALYTICS.JAFFLE_SHOP limit 10000
[0m18:40:40.428060 [debug] [ThreadPool]: On list_raw_JAFFLE_SHOP_jaffle_shop: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_raw_JAFFLE_SHOP_jaffle_shop"} */
show objects in raw.JAFFLE_SHOP_jaffle_shop limit 10000
[0m18:40:40.428558 [debug] [ThreadPool]: On list_raw_JAFFLE_SHOP_stripe: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_raw_JAFFLE_SHOP_stripe"} */
show objects in raw.JAFFLE_SHOP_stripe limit 10000
[0m18:40:40.428904 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:40:40.429271 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:40:40.429642 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:40:40.942538 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.513 seconds
[0m18:40:40.948008 [debug] [ThreadPool]: On list_ANALYTICS_JAFFLE_SHOP: Close
[0m18:40:41.015600 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.586 seconds
[0m18:40:41.019549 [debug] [ThreadPool]: On list_raw_JAFFLE_SHOP_jaffle_shop: Close
[0m18:40:44.297858 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 3.868 seconds
[0m18:40:44.302453 [debug] [ThreadPool]: On list_raw_JAFFLE_SHOP_stripe: Close
[0m18:40:44.512490 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ccd09f3d-c187-4f81-bf22-4c46208ce99c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1051bd050>]}
[0m18:40:44.514252 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:40:44.515392 [info ] [MainThread]: 
[0m18:40:44.520073 [debug] [Thread-1 (]: Began running node seed.jaffle_shop.raw_customers
[0m18:40:44.521320 [info ] [Thread-1 (]: 1 of 3 START seed file raw.JAFFLE_SHOP_jaffle_shop.raw_customers ............... [RUN]
[0m18:40:44.522382 [debug] [Thread-2 (]: Began running node seed.jaffle_shop.raw_orders
[0m18:40:44.523164 [debug] [Thread-3 (]: Began running node seed.jaffle_shop.raw_payments
[0m18:40:44.523969 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_ANALYTICS_JAFFLE_SHOP, now seed.jaffle_shop.raw_customers)
[0m18:40:44.524950 [info ] [Thread-2 (]: 2 of 3 START seed file raw.JAFFLE_SHOP_jaffle_shop.raw_orders .................. [RUN]
[0m18:40:44.525936 [info ] [Thread-3 (]: 3 of 3 START seed file raw.JAFFLE_SHOP_stripe.raw_payments ..................... [RUN]
[0m18:40:44.526613 [debug] [Thread-1 (]: Began compiling node seed.jaffle_shop.raw_customers
[0m18:40:44.527325 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_raw_JAFFLE_SHOP_jaffle_shop, now seed.jaffle_shop.raw_orders)
[0m18:40:44.528158 [debug] [Thread-3 (]: Acquiring new snowflake connection 'seed.jaffle_shop.raw_payments'
[0m18:40:44.528899 [debug] [Thread-1 (]: Began executing node seed.jaffle_shop.raw_customers
[0m18:40:44.529823 [debug] [Thread-2 (]: Began compiling node seed.jaffle_shop.raw_orders
[0m18:40:44.530738 [debug] [Thread-3 (]: Began compiling node seed.jaffle_shop.raw_payments
[0m18:40:44.556646 [debug] [Thread-2 (]: Began executing node seed.jaffle_shop.raw_orders
[0m18:40:44.562825 [debug] [Thread-3 (]: Began executing node seed.jaffle_shop.raw_payments
[0m18:40:44.576254 [debug] [Thread-1 (]: Using snowflake connection "seed.jaffle_shop.raw_customers"
[0m18:40:44.586931 [debug] [Thread-2 (]: Using snowflake connection "seed.jaffle_shop.raw_orders"
[0m18:40:44.587624 [debug] [Thread-1 (]: On seed.jaffle_shop.raw_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_customers"} */
create table raw.JAFFLE_SHOP_jaffle_shop.raw_customers (id integer,first_name text,last_name text)
[0m18:40:44.591033 [debug] [Thread-3 (]: Using snowflake connection "seed.jaffle_shop.raw_payments"
[0m18:40:44.591497 [debug] [Thread-2 (]: On seed.jaffle_shop.raw_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_orders"} */
create table raw.JAFFLE_SHOP_jaffle_shop.raw_orders (id integer,user_id integer,order_date date,status text)
[0m18:40:44.592016 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:40:44.592610 [debug] [Thread-3 (]: On seed.jaffle_shop.raw_payments: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_payments"} */
create table raw.JAFFLE_SHOP_stripe.raw_payments (id integer,order_id integer,payment_method text,amount integer)
[0m18:40:44.593013 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:40:44.594513 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m18:40:45.282737 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.690 seconds
[0m18:40:45.311903 [debug] [Thread-1 (]: Using snowflake connection "seed.jaffle_shop.raw_customers"
[0m18:40:45.313026 [debug] [Thread-1 (]: On seed.jaffle_shop.raw_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_customers"} */
BEGIN
[0m18:40:45.415941 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.102 seconds
[0m18:40:45.422514 [debug] [Thread-1 (]: Using snowflake connection "seed.jaffle_shop.raw_customers"
[0m18:40:45.423494 [debug] [Thread-1 (]: On seed.jaffle_shop.raw_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_customers"} */
insert into raw.JAFFLE_SHOP_jaffle_shop.raw_customers (id, first_name, last_name) values
            (%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,...
[0m18:40:45.832912 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.238 seconds
[0m18:40:45.840841 [debug] [Thread-3 (]: Using snowflake connection "seed.jaffle_shop.raw_payments"
[0m18:40:45.841834 [debug] [Thread-3 (]: On seed.jaffle_shop.raw_payments: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_payments"} */
BEGIN
[0m18:40:46.568870 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.726 seconds
[0m18:40:46.577661 [debug] [Thread-3 (]: Using snowflake connection "seed.jaffle_shop.raw_payments"
[0m18:40:46.578739 [debug] [Thread-3 (]: On seed.jaffle_shop.raw_payments: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_payments"} */
insert into raw.JAFFLE_SHOP_stripe.raw_payments (id, order_id, payment_method, amount) values
            (%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s...
[0m18:40:47.165700 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 2.572 seconds
[0m18:40:47.173389 [debug] [Thread-2 (]: Using snowflake connection "seed.jaffle_shop.raw_orders"
[0m18:40:47.174345 [debug] [Thread-2 (]: On seed.jaffle_shop.raw_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_orders"} */
BEGIN
[0m18:40:47.284797 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.109 seconds
[0m18:40:47.292478 [debug] [Thread-2 (]: Using snowflake connection "seed.jaffle_shop.raw_orders"
[0m18:40:47.293452 [debug] [Thread-2 (]: On seed.jaffle_shop.raw_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_orders"} */
insert into raw.JAFFLE_SHOP_jaffle_shop.raw_orders (id, user_id, order_date, status) values
            (%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%...
[0m18:40:47.780920 [debug] [Thread-3 (]: SQL status: SUCCESS 113 in 1.201 seconds
[0m18:40:47.782669 [debug] [Thread-3 (]: Using snowflake connection "seed.jaffle_shop.raw_payments"
[0m18:40:47.783852 [debug] [Thread-3 (]: On seed.jaffle_shop.raw_payments: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_payments"} */
COMMIT
[0m18:40:47.802732 [debug] [Thread-1 (]: SQL status: SUCCESS 100 in 2.378 seconds
[0m18:40:47.804283 [debug] [Thread-1 (]: Using snowflake connection "seed.jaffle_shop.raw_customers"
[0m18:40:47.805849 [debug] [Thread-1 (]: On seed.jaffle_shop.raw_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_customers"} */
COMMIT
[0m18:40:48.601147 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.816 seconds
[0m18:40:48.603221 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.796 seconds
[0m18:40:48.618032 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.jaffle_shop.raw_customers"
[0m18:40:48.620617 [debug] [Thread-3 (]: Writing runtime SQL for node "seed.jaffle_shop.raw_payments"
[0m18:40:48.659363 [debug] [Thread-3 (]: On seed.jaffle_shop.raw_payments: Close
[0m18:40:48.659686 [debug] [Thread-1 (]: On seed.jaffle_shop.raw_customers: Close
[0m18:40:48.860877 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ccd09f3d-c187-4f81-bf22-4c46208ce99c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10358d550>]}
[0m18:40:48.862569 [info ] [Thread-1 (]: 1 of 3 OK loaded seed file JAFFLE_SHOP_jaffle_shop.raw_customers ............... [[32mINSERT 100[0m in 4.33s]
[0m18:40:48.864505 [debug] [Thread-1 (]: Finished running node seed.jaffle_shop.raw_customers
[0m18:40:48.897447 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ccd09f3d-c187-4f81-bf22-4c46208ce99c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e8b150>]}
[0m18:40:48.898586 [info ] [Thread-3 (]: 3 of 3 OK loaded seed file JAFFLE_SHOP_stripe.raw_payments ..................... [[32mINSERT 113[0m in 4.37s]
[0m18:40:48.899865 [debug] [Thread-3 (]: Finished running node seed.jaffle_shop.raw_payments
[0m18:40:49.095093 [debug] [Thread-2 (]: SQL status: SUCCESS 99 in 1.801 seconds
[0m18:40:49.096083 [debug] [Thread-2 (]: Using snowflake connection "seed.jaffle_shop.raw_orders"
[0m18:40:49.096759 [debug] [Thread-2 (]: On seed.jaffle_shop.raw_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_orders"} */
COMMIT
[0m18:40:49.885877 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.788 seconds
[0m18:40:49.886711 [debug] [Thread-2 (]: Writing runtime SQL for node "seed.jaffle_shop.raw_orders"
[0m18:40:49.889114 [debug] [Thread-2 (]: On seed.jaffle_shop.raw_orders: Close
[0m18:40:50.257427 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ccd09f3d-c187-4f81-bf22-4c46208ce99c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1050cef90>]}
[0m18:40:50.259085 [info ] [Thread-2 (]: 2 of 3 OK loaded seed file JAFFLE_SHOP_jaffle_shop.raw_orders .................. [[32mINSERT 99[0m in 5.73s]
[0m18:40:50.260759 [debug] [Thread-2 (]: Finished running node seed.jaffle_shop.raw_orders
[0m18:40:50.263880 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:40:50.264941 [debug] [MainThread]: Connection 'seed.jaffle_shop.raw_customers' was properly closed.
[0m18:40:50.265662 [debug] [MainThread]: Connection 'seed.jaffle_shop.raw_orders' was properly closed.
[0m18:40:50.267005 [debug] [MainThread]: Connection 'list_raw_JAFFLE_SHOP_stripe' was properly closed.
[0m18:40:50.268014 [debug] [MainThread]: Connection 'seed.jaffle_shop.raw_payments' was properly closed.
[0m18:40:50.269168 [info ] [MainThread]: 
[0m18:40:50.270411 [info ] [MainThread]: Finished running 3 seeds in 0 hours 0 minutes and 13.99 seconds (13.99s).
[0m18:40:50.272452 [debug] [MainThread]: Command end result
[0m18:40:50.316181 [info ] [MainThread]: 
[0m18:40:50.316816 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:40:50.317266 [info ] [MainThread]: 
[0m18:40:50.317645 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m18:40:50.319106 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": true, "command_wall_clock_time": 16.546118, "process_user_time": 4.68497, "process_kernel_time": 0.446704, "process_mem_max_rss": "136073216", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m18:40:50.319865 [debug] [MainThread]: Command `dbt seed` succeeded at 18:40:50.319753 after 16.55 seconds
[0m18:40:50.320328 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104104450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104107a50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x100bc9410>]}
[0m18:40:50.320742 [debug] [MainThread]: Flushing usage events
[0m18:42:37.310709 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108b7b190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108bcbb10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108bd7ed0>]}


============================== 18:42:37.317605 | e16000c0-2e61-47f9-800d-8e18da7823be ==============================
[0m18:42:37.317605 [info ] [MainThread]: Running with dbt=1.8.7
[0m18:42:37.318356 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/ben/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/ben/Dbt Certification/dbt-tutorial/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt seed', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:42:37.688314 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e16000c0-2e61-47f9-800d-8e18da7823be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1098cb010>]}
[0m18:42:37.746239 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e16000c0-2e61-47f9-800d-8e18da7823be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108632a50>]}
[0m18:42:37.747285 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m18:42:37.775133 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m18:42:37.883175 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m18:42:37.883986 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'e16000c0-2e61-47f9-800d-8e18da7823be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10781c8d0>]}
[0m18:42:39.381424 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m18:42:39.382157 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'e16000c0-2e61-47f9-800d-8e18da7823be', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109956b90>]}
[0m18:42:39.602681 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.staging
[0m18:42:39.609129 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e16000c0-2e61-47f9-800d-8e18da7823be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109b7f510>]}
[0m18:42:39.717962 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e16000c0-2e61-47f9-800d-8e18da7823be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a04ad10>]}
[0m18:42:39.718525 [info ] [MainThread]: Found 7 models, 3 seeds, 11 data tests, 572 macros
[0m18:42:39.718964 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e16000c0-2e61-47f9-800d-8e18da7823be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109eb5850>]}
[0m18:42:39.721054 [info ] [MainThread]: 
[0m18:42:39.721672 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m18:42:39.726786 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_raw'
[0m18:42:39.727716 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_raw'
[0m18:42:39.738582 [debug] [ThreadPool]: Using snowflake connection "list_raw"
[0m18:42:39.741327 [debug] [ThreadPool]: Using snowflake connection "list_raw"
[0m18:42:39.741904 [debug] [ThreadPool]: On list_raw: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_raw"} */
show terse schemas in database raw
    limit 10000
[0m18:42:39.742259 [debug] [ThreadPool]: On list_raw: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_raw"} */
show terse schemas in database raw
    limit 10000
[0m18:42:39.742644 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:42:39.742966 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:42:40.532021 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.789 seconds
[0m18:42:40.536411 [debug] [ThreadPool]: On list_raw: Close
[0m18:42:44.033637 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 4.291 seconds
[0m18:42:44.037085 [debug] [ThreadPool]: On list_raw: Close
[0m18:42:44.186755 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_raw, now create_raw_JAFFLE_SHOP_jaffle_shop)
[0m18:42:44.188157 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_raw, now create_raw_JAFFLE_SHOP_stripe)
[0m18:42:44.189708 [debug] [ThreadPool]: Creating schema "database: "raw"
schema: "JAFFLE_SHOP_jaffle_shop"
"
[0m18:42:44.190835 [debug] [ThreadPool]: Creating schema "database: "raw"
schema: "JAFFLE_SHOP_stripe"
"
[0m18:42:44.207174 [debug] [ThreadPool]: Using snowflake connection "create_raw_JAFFLE_SHOP_jaffle_shop"
[0m18:42:44.207850 [debug] [ThreadPool]: Using snowflake connection "create_raw_JAFFLE_SHOP_stripe"
[0m18:42:44.208548 [debug] [ThreadPool]: On create_raw_JAFFLE_SHOP_jaffle_shop: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "create_raw_JAFFLE_SHOP_jaffle_shop"} */
create schema if not exists raw.JAFFLE_SHOP_jaffle_shop
[0m18:42:44.209160 [debug] [ThreadPool]: On create_raw_JAFFLE_SHOP_stripe: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "create_raw_JAFFLE_SHOP_stripe"} */
create schema if not exists raw.JAFFLE_SHOP_stripe
[0m18:42:44.209774 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:42:44.210406 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:42:44.829550 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.620 seconds
[0m18:42:44.832710 [debug] [ThreadPool]: On create_raw_JAFFLE_SHOP_jaffle_shop: Close
[0m18:42:45.949212 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.739 seconds
[0m18:42:45.952117 [debug] [ThreadPool]: On create_raw_JAFFLE_SHOP_stripe: Close
[0m18:42:46.711495 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_raw_JAFFLE_SHOP_stripe, now list_raw_JAFFLE_SHOP_jaffle_shop)
[0m18:42:46.712880 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_raw_JAFFLE_SHOP_jaffle_shop, now list_ANALYTICS_JAFFLE_SHOP)
[0m18:42:46.714391 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_raw_JAFFLE_SHOP_stripe'
[0m18:42:46.736588 [debug] [ThreadPool]: Using snowflake connection "list_raw_JAFFLE_SHOP_jaffle_shop"
[0m18:42:46.741388 [debug] [ThreadPool]: Using snowflake connection "list_ANALYTICS_JAFFLE_SHOP"
[0m18:42:46.744131 [debug] [ThreadPool]: Using snowflake connection "list_raw_JAFFLE_SHOP_stripe"
[0m18:42:46.744555 [debug] [ThreadPool]: On list_raw_JAFFLE_SHOP_jaffle_shop: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_raw_JAFFLE_SHOP_jaffle_shop"} */
show objects in raw.JAFFLE_SHOP_jaffle_shop limit 10000
[0m18:42:46.744931 [debug] [ThreadPool]: On list_ANALYTICS_JAFFLE_SHOP: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_ANALYTICS_JAFFLE_SHOP"} */
show objects in ANALYTICS.JAFFLE_SHOP limit 10000
[0m18:42:46.745340 [debug] [ThreadPool]: On list_raw_JAFFLE_SHOP_stripe: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_raw_JAFFLE_SHOP_stripe"} */
show objects in raw.JAFFLE_SHOP_stripe limit 10000
[0m18:42:46.745686 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:42:46.746028 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:42:46.746351 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:42:47.236122 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.490 seconds
[0m18:42:47.241050 [debug] [ThreadPool]: On list_ANALYTICS_JAFFLE_SHOP: Close
[0m18:42:47.379457 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.634 seconds
[0m18:42:47.383767 [debug] [ThreadPool]: On list_raw_JAFFLE_SHOP_jaffle_shop: Close
[0m18:42:47.402108 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.656 seconds
[0m18:42:47.405258 [debug] [ThreadPool]: On list_raw_JAFFLE_SHOP_stripe: Close
[0m18:42:47.594165 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e16000c0-2e61-47f9-800d-8e18da7823be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109c4e750>]}
[0m18:42:47.596252 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:42:47.597604 [info ] [MainThread]: 
[0m18:42:47.602531 [debug] [Thread-1 (]: Began running node seed.jaffle_shop.raw_customers
[0m18:42:47.603935 [info ] [Thread-1 (]: 1 of 3 START seed file raw.JAFFLE_SHOP_jaffle_shop.raw_customers ............... [RUN]
[0m18:42:47.605079 [debug] [Thread-2 (]: Began running node seed.jaffle_shop.raw_orders
[0m18:42:47.606029 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_raw_JAFFLE_SHOP_jaffle_shop, now seed.jaffle_shop.raw_customers)
[0m18:42:47.606975 [debug] [Thread-3 (]: Began running node seed.jaffle_shop.raw_payments
[0m18:42:47.608056 [info ] [Thread-2 (]: 2 of 3 START seed file raw.JAFFLE_SHOP_jaffle_shop.raw_orders .................. [RUN]
[0m18:42:47.608951 [debug] [Thread-1 (]: Began compiling node seed.jaffle_shop.raw_customers
[0m18:42:47.609994 [info ] [Thread-3 (]: 3 of 3 START seed file raw.JAFFLE_SHOP_stripe.raw_payments ..................... [RUN]
[0m18:42:47.611063 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_ANALYTICS_JAFFLE_SHOP, now seed.jaffle_shop.raw_orders)
[0m18:42:47.612165 [debug] [Thread-1 (]: Began executing node seed.jaffle_shop.raw_customers
[0m18:42:47.613137 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_raw_JAFFLE_SHOP_stripe, now seed.jaffle_shop.raw_payments)
[0m18:42:47.614007 [debug] [Thread-2 (]: Began compiling node seed.jaffle_shop.raw_orders
[0m18:42:47.616276 [debug] [Thread-3 (]: Began compiling node seed.jaffle_shop.raw_payments
[0m18:42:47.642584 [debug] [Thread-2 (]: Began executing node seed.jaffle_shop.raw_orders
[0m18:42:47.659622 [debug] [Thread-1 (]: Using snowflake connection "seed.jaffle_shop.raw_customers"
[0m18:42:47.660343 [debug] [Thread-3 (]: Began executing node seed.jaffle_shop.raw_payments
[0m18:42:47.664440 [debug] [Thread-1 (]: On seed.jaffle_shop.raw_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_customers"} */
create table raw.JAFFLE_SHOP_jaffle_shop.raw_customers (id integer,first_name text,last_name text)
[0m18:42:47.669366 [debug] [Thread-2 (]: Using snowflake connection "seed.jaffle_shop.raw_orders"
[0m18:42:47.676878 [debug] [Thread-3 (]: Using snowflake connection "seed.jaffle_shop.raw_payments"
[0m18:42:47.677360 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:42:47.677766 [debug] [Thread-2 (]: On seed.jaffle_shop.raw_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_orders"} */
create table raw.JAFFLE_SHOP_jaffle_shop.raw_orders (id integer,user_id integer,order_date date,status text)
[0m18:42:47.678193 [debug] [Thread-3 (]: On seed.jaffle_shop.raw_payments: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_payments"} */
create table raw.JAFFLE_SHOP_stripe.raw_payments (id integer,order_id integer,payment_method text,amount integer)
[0m18:42:47.679523 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:42:47.680546 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m18:42:48.280114 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.602 seconds
[0m18:42:48.310094 [debug] [Thread-1 (]: Using snowflake connection "seed.jaffle_shop.raw_customers"
[0m18:42:48.310853 [debug] [Thread-1 (]: On seed.jaffle_shop.raw_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_customers"} */
BEGIN
[0m18:42:48.349626 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.669 seconds
[0m18:42:48.357565 [debug] [Thread-3 (]: Using snowflake connection "seed.jaffle_shop.raw_payments"
[0m18:42:48.358582 [debug] [Thread-3 (]: On seed.jaffle_shop.raw_payments: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_payments"} */
BEGIN
[0m18:42:48.412156 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.732 seconds
[0m18:42:48.419812 [debug] [Thread-2 (]: Using snowflake connection "seed.jaffle_shop.raw_orders"
[0m18:42:48.420890 [debug] [Thread-2 (]: On seed.jaffle_shop.raw_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_orders"} */
BEGIN
[0m18:42:48.578930 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.157 seconds
[0m18:42:48.586299 [debug] [Thread-2 (]: Using snowflake connection "seed.jaffle_shop.raw_orders"
[0m18:42:48.587356 [debug] [Thread-2 (]: On seed.jaffle_shop.raw_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_orders"} */
insert into raw.JAFFLE_SHOP_jaffle_shop.raw_orders (id, user_id, order_date, status) values
            (%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%...
[0m18:42:48.694016 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.383 seconds
[0m18:42:48.698158 [debug] [Thread-1 (]: Using snowflake connection "seed.jaffle_shop.raw_customers"
[0m18:42:48.698913 [debug] [Thread-1 (]: On seed.jaffle_shop.raw_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_customers"} */
insert into raw.JAFFLE_SHOP_jaffle_shop.raw_customers (id, first_name, last_name) values
            (%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,...
[0m18:42:48.893956 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.534 seconds
[0m18:42:48.902491 [debug] [Thread-3 (]: Using snowflake connection "seed.jaffle_shop.raw_payments"
[0m18:42:48.903694 [debug] [Thread-3 (]: On seed.jaffle_shop.raw_payments: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_payments"} */
insert into raw.JAFFLE_SHOP_stripe.raw_payments (id, order_id, payment_method, amount) values
            (%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s...
[0m18:42:49.429107 [debug] [Thread-3 (]: SQL status: SUCCESS 113 in 0.524 seconds
[0m18:42:49.430888 [debug] [Thread-3 (]: Using snowflake connection "seed.jaffle_shop.raw_payments"
[0m18:42:49.432197 [debug] [Thread-3 (]: On seed.jaffle_shop.raw_payments: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_payments"} */
COMMIT
[0m18:42:49.736736 [debug] [Thread-2 (]: SQL status: SUCCESS 99 in 1.148 seconds
[0m18:42:49.738368 [debug] [Thread-2 (]: Using snowflake connection "seed.jaffle_shop.raw_orders"
[0m18:42:49.739773 [debug] [Thread-2 (]: On seed.jaffle_shop.raw_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_orders"} */
COMMIT
[0m18:42:50.658175 [debug] [Thread-1 (]: SQL status: SUCCESS 100 in 1.958 seconds
[0m18:42:50.660058 [debug] [Thread-1 (]: Using snowflake connection "seed.jaffle_shop.raw_customers"
[0m18:42:50.661716 [debug] [Thread-1 (]: On seed.jaffle_shop.raw_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_customers"} */
COMMIT
[0m18:42:50.878998 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.446 seconds
[0m18:42:50.881233 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.140 seconds
[0m18:42:50.890115 [debug] [Thread-3 (]: Writing runtime SQL for node "seed.jaffle_shop.raw_payments"
[0m18:42:50.891089 [debug] [Thread-2 (]: Writing runtime SQL for node "seed.jaffle_shop.raw_orders"
[0m18:42:50.931393 [debug] [Thread-2 (]: On seed.jaffle_shop.raw_orders: Close
[0m18:42:50.932098 [debug] [Thread-3 (]: On seed.jaffle_shop.raw_payments: Close
[0m18:42:51.224320 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e16000c0-2e61-47f9-800d-8e18da7823be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109938950>]}
[0m18:42:51.226063 [info ] [Thread-3 (]: 3 of 3 OK loaded seed file JAFFLE_SHOP_stripe.raw_payments ..................... [[32mINSERT 113[0m in 3.61s]
[0m18:42:51.227534 [debug] [Thread-3 (]: Finished running node seed.jaffle_shop.raw_payments
[0m18:42:51.587398 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e16000c0-2e61-47f9-800d-8e18da7823be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1080143d0>]}
[0m18:42:51.589265 [info ] [Thread-2 (]: 2 of 3 OK loaded seed file JAFFLE_SHOP_jaffle_shop.raw_orders .................. [[32mINSERT 99[0m in 3.98s]
[0m18:42:51.591425 [debug] [Thread-2 (]: Finished running node seed.jaffle_shop.raw_orders
[0m18:42:52.194928 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.532 seconds
[0m18:42:52.196250 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.jaffle_shop.raw_customers"
[0m18:42:52.200562 [debug] [Thread-1 (]: On seed.jaffle_shop.raw_customers: Close
[0m18:42:52.328026 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e16000c0-2e61-47f9-800d-8e18da7823be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109d8ad90>]}
[0m18:42:52.328969 [info ] [Thread-1 (]: 1 of 3 OK loaded seed file JAFFLE_SHOP_jaffle_shop.raw_customers ............... [[32mINSERT 100[0m in 4.72s]
[0m18:42:52.330006 [debug] [Thread-1 (]: Finished running node seed.jaffle_shop.raw_customers
[0m18:42:52.332083 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:42:52.332692 [debug] [MainThread]: Connection 'seed.jaffle_shop.raw_customers' was properly closed.
[0m18:42:52.333149 [debug] [MainThread]: Connection 'seed.jaffle_shop.raw_orders' was properly closed.
[0m18:42:52.333559 [debug] [MainThread]: Connection 'seed.jaffle_shop.raw_payments' was properly closed.
[0m18:42:52.334043 [info ] [MainThread]: 
[0m18:42:52.334516 [info ] [MainThread]: Finished running 3 seeds in 0 hours 0 minutes and 12.61 seconds (12.61s).
[0m18:42:52.335698 [debug] [MainThread]: Command end result
[0m18:42:52.374268 [info ] [MainThread]: 
[0m18:42:52.374906 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:42:52.375348 [info ] [MainThread]: 
[0m18:42:52.375764 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m18:42:52.377163 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": true, "command_wall_clock_time": 15.143511, "process_user_time": 4.712179, "process_kernel_time": 0.45403, "process_mem_max_rss": "137170944", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m18:42:52.377785 [debug] [MainThread]: Command `dbt seed` succeeded at 18:42:52.377686 after 15.14 seconds
[0m18:42:52.378475 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108721c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105669310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1055b8290>]}
[0m18:42:52.379021 [debug] [MainThread]: Flushing usage events
[0m18:47:15.953483 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104013f90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104084590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104084ed0>]}


============================== 18:47:15.959544 | 13c660f6-9824-4de6-addd-dc6eccd9c19c ==============================
[0m18:47:15.959544 [info ] [MainThread]: Running with dbt=1.8.7
[0m18:47:15.960478 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/ben/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/Users/ben/Dbt Certification/dbt-tutorial/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt seed', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:47:16.323919 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '13c660f6-9824-4de6-addd-dc6eccd9c19c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d09310>]}
[0m18:47:16.384792 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '13c660f6-9824-4de6-addd-dc6eccd9c19c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103adac10>]}
[0m18:47:16.385763 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m18:47:16.411965 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m18:47:16.522098 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m18:47:16.522851 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '13c660f6-9824-4de6-addd-dc6eccd9c19c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102cf8a10>]}
[0m18:47:18.019889 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m18:47:18.020614 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '13c660f6-9824-4de6-addd-dc6eccd9c19c', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104ec3350>]}
[0m18:47:18.238338 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.staging
[0m18:47:18.244015 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '13c660f6-9824-4de6-addd-dc6eccd9c19c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f04550>]}
[0m18:47:18.349576 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '13c660f6-9824-4de6-addd-dc6eccd9c19c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10548c350>]}
[0m18:47:18.350181 [info ] [MainThread]: Found 7 models, 3 seeds, 11 data tests, 572 macros
[0m18:47:18.350664 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '13c660f6-9824-4de6-addd-dc6eccd9c19c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10532d790>]}
[0m18:47:18.352949 [info ] [MainThread]: 
[0m18:47:18.353685 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m18:47:18.358985 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ANALYTICS'
[0m18:47:18.365209 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ANALYTICS'
[0m18:47:18.370462 [debug] [ThreadPool]: Using snowflake connection "list_ANALYTICS"
[0m18:47:18.374563 [debug] [ThreadPool]: Using snowflake connection "list_ANALYTICS"
[0m18:47:18.375070 [debug] [ThreadPool]: On list_ANALYTICS: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_ANALYTICS"} */
show terse schemas in database ANALYTICS
    limit 10000
[0m18:47:18.375522 [debug] [ThreadPool]: On list_ANALYTICS: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_ANALYTICS"} */
show terse schemas in database ANALYTICS
    limit 10000
[0m18:47:18.375958 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:47:18.376457 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:47:19.186632 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.810 seconds
[0m18:47:19.191098 [debug] [ThreadPool]: On list_ANALYTICS: Close
[0m18:47:19.342039 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.966 seconds
[0m18:47:19.346420 [debug] [ThreadPool]: On list_ANALYTICS: Close
[0m18:47:19.489697 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ANALYTICS, now create_ANALYTICS_JAFFLE_SHOP_jaffle_shop)
[0m18:47:19.491203 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ANALYTICS, now create_ANALYTICS_JAFFLE_SHOP_stripe)
[0m18:47:19.492939 [debug] [ThreadPool]: Creating schema "database: "ANALYTICS"
schema: "JAFFLE_SHOP_jaffle_shop"
"
[0m18:47:19.494291 [debug] [ThreadPool]: Creating schema "database: "ANALYTICS"
schema: "JAFFLE_SHOP_stripe"
"
[0m18:47:19.508862 [debug] [ThreadPool]: Using snowflake connection "create_ANALYTICS_JAFFLE_SHOP_jaffle_shop"
[0m18:47:19.511440 [debug] [ThreadPool]: Using snowflake connection "create_ANALYTICS_JAFFLE_SHOP_stripe"
[0m18:47:19.512228 [debug] [ThreadPool]: On create_ANALYTICS_JAFFLE_SHOP_jaffle_shop: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "create_ANALYTICS_JAFFLE_SHOP_jaffle_shop"} */
create schema if not exists ANALYTICS.JAFFLE_SHOP_jaffle_shop
[0m18:47:19.512926 [debug] [ThreadPool]: On create_ANALYTICS_JAFFLE_SHOP_stripe: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "create_ANALYTICS_JAFFLE_SHOP_stripe"} */
create schema if not exists ANALYTICS.JAFFLE_SHOP_stripe
[0m18:47:19.513508 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:47:19.514041 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:47:20.026786 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.513 seconds
[0m18:47:20.029077 [debug] [ThreadPool]: On create_ANALYTICS_JAFFLE_SHOP_jaffle_shop: Close
[0m18:47:21.608291 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 2.094 seconds
[0m18:47:21.611450 [debug] [ThreadPool]: On create_ANALYTICS_JAFFLE_SHOP_stripe: Close
[0m18:47:21.860222 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_ANALYTICS_JAFFLE_SHOP_stripe, now list_ANALYTICS_JAFFLE_SHOP_jaffle_shop)
[0m18:47:21.861723 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_ANALYTICS_JAFFLE_SHOP_jaffle_shop, now list_ANALYTICS_JAFFLE_SHOP)
[0m18:47:21.863024 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ANALYTICS_JAFFLE_SHOP_stripe'
[0m18:47:21.884191 [debug] [ThreadPool]: Using snowflake connection "list_ANALYTICS_JAFFLE_SHOP_jaffle_shop"
[0m18:47:21.889503 [debug] [ThreadPool]: Using snowflake connection "list_ANALYTICS_JAFFLE_SHOP"
[0m18:47:21.892238 [debug] [ThreadPool]: Using snowflake connection "list_ANALYTICS_JAFFLE_SHOP_stripe"
[0m18:47:21.892859 [debug] [ThreadPool]: On list_ANALYTICS_JAFFLE_SHOP_jaffle_shop: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_ANALYTICS_JAFFLE_SHOP_jaffle_shop"} */
show objects in ANALYTICS.JAFFLE_SHOP_jaffle_shop limit 10000
[0m18:47:21.893280 [debug] [ThreadPool]: On list_ANALYTICS_JAFFLE_SHOP: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_ANALYTICS_JAFFLE_SHOP"} */
show objects in ANALYTICS.JAFFLE_SHOP limit 10000
[0m18:47:21.893632 [debug] [ThreadPool]: On list_ANALYTICS_JAFFLE_SHOP_stripe: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_ANALYTICS_JAFFLE_SHOP_stripe"} */
show objects in ANALYTICS.JAFFLE_SHOP_stripe limit 10000
[0m18:47:21.893958 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:47:21.894271 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:47:21.894574 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:47:22.972623 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 1.078 seconds
[0m18:47:22.978017 [debug] [ThreadPool]: On list_ANALYTICS_JAFFLE_SHOP_jaffle_shop: Close
[0m18:47:23.185971 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 1.292 seconds
[0m18:47:23.190023 [debug] [ThreadPool]: On list_ANALYTICS_JAFFLE_SHOP: Close
[0m18:47:23.608005 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 1.713 seconds
[0m18:47:23.611930 [debug] [ThreadPool]: On list_ANALYTICS_JAFFLE_SHOP_stripe: Close
[0m18:47:24.201262 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '13c660f6-9824-4de6-addd-dc6eccd9c19c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1050c9750>]}
[0m18:47:24.219404 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:47:24.220130 [info ] [MainThread]: 
[0m18:47:24.223925 [debug] [Thread-1 (]: Began running node seed.jaffle_shop.raw_customers
[0m18:47:24.224613 [debug] [Thread-2 (]: Began running node seed.jaffle_shop.raw_orders
[0m18:47:24.225181 [info ] [Thread-1 (]: 1 of 3 START seed file JAFFLE_SHOP_jaffle_shop.raw_customers ................... [RUN]
[0m18:47:24.225773 [debug] [Thread-3 (]: Began running node seed.jaffle_shop.raw_payments
[0m18:47:24.226513 [info ] [Thread-2 (]: 2 of 3 START seed file JAFFLE_SHOP_jaffle_shop.raw_orders ...................... [RUN]
[0m18:47:24.227428 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_ANALYTICS_JAFFLE_SHOP_jaffle_shop, now seed.jaffle_shop.raw_customers)
[0m18:47:24.228230 [info ] [Thread-3 (]: 3 of 3 START seed file JAFFLE_SHOP_stripe.raw_payments ......................... [RUN]
[0m18:47:24.229177 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_ANALYTICS_JAFFLE_SHOP, now seed.jaffle_shop.raw_orders)
[0m18:47:24.229821 [debug] [Thread-1 (]: Began compiling node seed.jaffle_shop.raw_customers
[0m18:47:24.230617 [debug] [Thread-3 (]: Acquiring new snowflake connection 'seed.jaffle_shop.raw_payments'
[0m18:47:24.231153 [debug] [Thread-2 (]: Began compiling node seed.jaffle_shop.raw_orders
[0m18:47:24.232164 [debug] [Thread-1 (]: Began executing node seed.jaffle_shop.raw_customers
[0m18:47:24.232851 [debug] [Thread-3 (]: Began compiling node seed.jaffle_shop.raw_payments
[0m18:47:24.233479 [debug] [Thread-2 (]: Began executing node seed.jaffle_shop.raw_orders
[0m18:47:24.235181 [debug] [Thread-3 (]: Began executing node seed.jaffle_shop.raw_payments
[0m18:47:24.300341 [debug] [Thread-2 (]: Using snowflake connection "seed.jaffle_shop.raw_orders"
[0m18:47:24.300987 [debug] [Thread-2 (]: On seed.jaffle_shop.raw_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_orders"} */
create table ANALYTICS.JAFFLE_SHOP_jaffle_shop.raw_orders (id integer,user_id integer,order_date date,status text)
[0m18:47:24.301692 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:47:24.305849 [debug] [Thread-3 (]: Using snowflake connection "seed.jaffle_shop.raw_payments"
[0m18:47:24.309027 [debug] [Thread-1 (]: Using snowflake connection "seed.jaffle_shop.raw_customers"
[0m18:47:24.310435 [debug] [Thread-3 (]: On seed.jaffle_shop.raw_payments: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_payments"} */
create table ANALYTICS.JAFFLE_SHOP_stripe.raw_payments (id integer,order_id integer,payment_method text,amount integer)
[0m18:47:24.311501 [debug] [Thread-1 (]: On seed.jaffle_shop.raw_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_customers"} */
create table ANALYTICS.JAFFLE_SHOP_jaffle_shop.raw_customers (id integer,first_name text,last_name text)
[0m18:47:24.312121 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m18:47:24.312656 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:47:25.424286 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.111 seconds
[0m18:47:25.449618 [debug] [Thread-1 (]: Using snowflake connection "seed.jaffle_shop.raw_customers"
[0m18:47:25.450259 [debug] [Thread-1 (]: On seed.jaffle_shop.raw_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_customers"} */
BEGIN
[0m18:47:25.499849 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.198 seconds
[0m18:47:25.507504 [debug] [Thread-2 (]: Using snowflake connection "seed.jaffle_shop.raw_orders"
[0m18:47:25.508518 [debug] [Thread-2 (]: On seed.jaffle_shop.raw_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_orders"} */
BEGIN
[0m18:47:25.531196 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.219 seconds
[0m18:47:25.539025 [debug] [Thread-3 (]: Using snowflake connection "seed.jaffle_shop.raw_payments"
[0m18:47:25.540043 [debug] [Thread-3 (]: On seed.jaffle_shop.raw_payments: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_payments"} */
BEGIN
[0m18:47:25.637165 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.096 seconds
[0m18:47:25.645899 [debug] [Thread-3 (]: Using snowflake connection "seed.jaffle_shop.raw_payments"
[0m18:47:25.647030 [debug] [Thread-3 (]: On seed.jaffle_shop.raw_payments: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_payments"} */
insert into ANALYTICS.JAFFLE_SHOP_stripe.raw_payments (id, order_id, payment_method, amount) values
            (%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s...
[0m18:47:25.694341 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.243 seconds
[0m18:47:25.700887 [debug] [Thread-1 (]: Using snowflake connection "seed.jaffle_shop.raw_customers"
[0m18:47:25.702161 [debug] [Thread-1 (]: On seed.jaffle_shop.raw_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_customers"} */
insert into ANALYTICS.JAFFLE_SHOP_jaffle_shop.raw_customers (id, first_name, last_name) values
            (%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s...
[0m18:47:25.788940 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.279 seconds
[0m18:47:25.794990 [debug] [Thread-2 (]: Using snowflake connection "seed.jaffle_shop.raw_orders"
[0m18:47:25.795885 [debug] [Thread-2 (]: On seed.jaffle_shop.raw_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_orders"} */
insert into ANALYTICS.JAFFLE_SHOP_jaffle_shop.raw_orders (id, user_id, order_date, status) values
            (%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,...
[0m18:47:26.316904 [debug] [Thread-3 (]: SQL status: SUCCESS 113 in 0.669 seconds
[0m18:47:26.318193 [debug] [Thread-3 (]: Using snowflake connection "seed.jaffle_shop.raw_payments"
[0m18:47:26.319100 [debug] [Thread-3 (]: On seed.jaffle_shop.raw_payments: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_payments"} */
COMMIT
[0m18:47:26.402529 [debug] [Thread-1 (]: SQL status: SUCCESS 100 in 0.699 seconds
[0m18:47:26.404060 [debug] [Thread-1 (]: Using snowflake connection "seed.jaffle_shop.raw_customers"
[0m18:47:26.405077 [debug] [Thread-1 (]: On seed.jaffle_shop.raw_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_customers"} */
COMMIT
[0m18:47:26.778302 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.372 seconds
[0m18:47:26.792713 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.jaffle_shop.raw_customers"
[0m18:47:26.829742 [debug] [Thread-1 (]: On seed.jaffle_shop.raw_customers: Close
[0m18:47:26.974772 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '13c660f6-9824-4de6-addd-dc6eccd9c19c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105131190>]}
[0m18:47:26.976698 [info ] [Thread-1 (]: 1 of 3 OK loaded seed file JAFFLE_SHOP_jaffle_shop.raw_customers ............... [[32mINSERT 100[0m in 2.74s]
[0m18:47:26.978197 [debug] [Thread-1 (]: Finished running node seed.jaffle_shop.raw_customers
[0m18:47:27.108049 [debug] [Thread-2 (]: SQL status: SUCCESS 99 in 1.311 seconds
[0m18:47:27.109819 [debug] [Thread-2 (]: Using snowflake connection "seed.jaffle_shop.raw_orders"
[0m18:47:27.110983 [debug] [Thread-2 (]: On seed.jaffle_shop.raw_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_orders"} */
COMMIT
[0m18:47:28.095687 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.775 seconds
[0m18:47:28.097810 [debug] [Thread-3 (]: Writing runtime SQL for node "seed.jaffle_shop.raw_payments"
[0m18:47:28.103475 [debug] [Thread-3 (]: On seed.jaffle_shop.raw_payments: Close
[0m18:47:28.279641 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '13c660f6-9824-4de6-addd-dc6eccd9c19c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105195410>]}
[0m18:47:28.281406 [info ] [Thread-3 (]: 3 of 3 OK loaded seed file JAFFLE_SHOP_stripe.raw_payments ..................... [[32mINSERT 113[0m in 4.05s]
[0m18:47:28.283146 [debug] [Thread-3 (]: Finished running node seed.jaffle_shop.raw_payments
[0m18:47:29.053196 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.941 seconds
[0m18:47:29.055270 [debug] [Thread-2 (]: Writing runtime SQL for node "seed.jaffle_shop.raw_orders"
[0m18:47:29.061159 [debug] [Thread-2 (]: On seed.jaffle_shop.raw_orders: Close
[0m18:47:29.205387 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '13c660f6-9824-4de6-addd-dc6eccd9c19c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102c596d0>]}
[0m18:47:29.206824 [info ] [Thread-2 (]: 2 of 3 OK loaded seed file JAFFLE_SHOP_jaffle_shop.raw_orders .................. [[32mINSERT 99[0m in 4.98s]
[0m18:47:29.208425 [debug] [Thread-2 (]: Finished running node seed.jaffle_shop.raw_orders
[0m18:47:29.212150 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:47:29.213219 [debug] [MainThread]: Connection 'seed.jaffle_shop.raw_customers' was properly closed.
[0m18:47:29.214417 [debug] [MainThread]: Connection 'seed.jaffle_shop.raw_orders' was properly closed.
[0m18:47:29.215527 [debug] [MainThread]: Connection 'list_ANALYTICS_JAFFLE_SHOP_stripe' was properly closed.
[0m18:47:29.216645 [debug] [MainThread]: Connection 'seed.jaffle_shop.raw_payments' was properly closed.
[0m18:47:29.217719 [info ] [MainThread]: 
[0m18:47:29.219156 [info ] [MainThread]: Finished running 3 seeds in 0 hours 0 minutes and 10.86 seconds (10.86s).
[0m18:47:29.221623 [debug] [MainThread]: Command end result
[0m18:47:29.264130 [info ] [MainThread]: 
[0m18:47:29.264861 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:47:29.265308 [info ] [MainThread]: 
[0m18:47:29.265707 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m18:47:29.267175 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": true, "command_wall_clock_time": 13.389503, "process_user_time": 4.752482, "process_kernel_time": 0.442845, "process_mem_max_rss": "137306112", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m18:47:29.268147 [debug] [MainThread]: Command `dbt seed` succeeded at 18:47:29.268022 after 13.39 seconds
[0m18:47:29.268617 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103bc5d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x100b61250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x100ab4c10>]}
[0m18:47:29.269056 [debug] [MainThread]: Flushing usage events
[0m18:49:29.310534 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ae52950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aec43d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aec4d10>]}


============================== 18:49:29.316702 | e6a18867-247d-420a-b60c-0a054735299a ==============================
[0m18:49:29.316702 [info ] [MainThread]: Running with dbt=1.8.7
[0m18:49:29.317461 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/ben/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/Users/ben/Dbt Certification/dbt-tutorial/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt seed', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:49:29.685826 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e6a18867-247d-420a-b60c-0a054735299a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bb2c4d0>]}
[0m18:49:29.742744 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e6a18867-247d-420a-b60c-0a054735299a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a91ab90>]}
[0m18:49:29.743855 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m18:49:29.770509 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m18:49:29.916234 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m18:49:29.917487 [debug] [MainThread]: Partial parsing: updated file: jaffle_shop://seeds/jaffle_shop/properties.yml
[0m18:49:29.917994 [debug] [MainThread]: Partial parsing: updated file: jaffle_shop://seeds/stripe/properties.yml
[0m18:49:30.236985 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.staging
[0m18:49:30.243205 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e6a18867-247d-420a-b60c-0a054735299a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bccbc90>]}
[0m18:49:30.348718 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e6a18867-247d-420a-b60c-0a054735299a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bba78d0>]}
[0m18:49:30.349305 [info ] [MainThread]: Found 7 models, 11 data tests, 3 seeds, 572 macros
[0m18:49:30.349792 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e6a18867-247d-420a-b60c-0a054735299a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bbad610>]}
[0m18:49:30.351837 [info ] [MainThread]: 
[0m18:49:30.352455 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m18:49:30.357332 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_raw'
[0m18:49:30.358624 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_raw'
[0m18:49:30.374771 [debug] [ThreadPool]: Using snowflake connection "list_raw"
[0m18:49:30.377496 [debug] [ThreadPool]: Using snowflake connection "list_raw"
[0m18:49:30.378233 [debug] [ThreadPool]: On list_raw: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_raw"} */
show terse schemas in database raw
    limit 10000
[0m18:49:30.378854 [debug] [ThreadPool]: On list_raw: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_raw"} */
show terse schemas in database raw
    limit 10000
[0m18:49:30.379390 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:49:30.379833 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:49:31.059316 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.679 seconds
[0m18:49:31.064107 [debug] [ThreadPool]: On list_raw: Close
[0m18:49:31.345951 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.966 seconds
[0m18:49:31.350227 [debug] [ThreadPool]: On list_raw: Close
[0m18:49:31.544172 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_raw, now create_raw_JAFFLE_SHOP_stripe)
[0m18:49:31.545584 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_raw, now create_raw_JAFFLE_SHOP_jaffle_shop)
[0m18:49:31.547253 [debug] [ThreadPool]: Creating schema "database: "raw"
schema: "JAFFLE_SHOP_stripe"
"
[0m18:49:31.548899 [debug] [ThreadPool]: Creating schema "database: "raw"
schema: "JAFFLE_SHOP_jaffle_shop"
"
[0m18:49:31.566573 [debug] [ThreadPool]: Using snowflake connection "create_raw_JAFFLE_SHOP_stripe"
[0m18:49:31.567335 [debug] [ThreadPool]: On create_raw_JAFFLE_SHOP_stripe: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "create_raw_JAFFLE_SHOP_stripe"} */
create schema if not exists raw.JAFFLE_SHOP_stripe
[0m18:49:31.568355 [debug] [ThreadPool]: Using snowflake connection "create_raw_JAFFLE_SHOP_jaffle_shop"
[0m18:49:31.568878 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:49:31.569463 [debug] [ThreadPool]: On create_raw_JAFFLE_SHOP_jaffle_shop: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "create_raw_JAFFLE_SHOP_jaffle_shop"} */
create schema if not exists raw.JAFFLE_SHOP_jaffle_shop
[0m18:49:31.571851 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:49:32.369683 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.798 seconds
[0m18:49:32.372524 [debug] [ThreadPool]: On create_raw_JAFFLE_SHOP_jaffle_shop: Close
[0m18:49:33.563677 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.995 seconds
[0m18:49:33.566711 [debug] [ThreadPool]: On create_raw_JAFFLE_SHOP_stripe: Close
[0m18:49:33.750085 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_raw_JAFFLE_SHOP_jaffle_shop, now list_raw_JAFFLE_SHOP_stripe)
[0m18:49:33.750973 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_raw_JAFFLE_SHOP_stripe, now list_raw_JAFFLE_SHOP_jaffle_shop)
[0m18:49:33.752020 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ANALYTICS_JAFFLE_SHOP'
[0m18:49:33.770802 [debug] [ThreadPool]: Using snowflake connection "list_raw_JAFFLE_SHOP_stripe"
[0m18:49:33.771628 [debug] [ThreadPool]: Using snowflake connection "list_raw_JAFFLE_SHOP_jaffle_shop"
[0m18:49:33.775175 [debug] [ThreadPool]: Using snowflake connection "list_ANALYTICS_JAFFLE_SHOP"
[0m18:49:33.775697 [debug] [ThreadPool]: On list_raw_JAFFLE_SHOP_stripe: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_raw_JAFFLE_SHOP_stripe"} */
show objects in raw.JAFFLE_SHOP_stripe limit 10000
[0m18:49:33.776085 [debug] [ThreadPool]: On list_raw_JAFFLE_SHOP_jaffle_shop: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_raw_JAFFLE_SHOP_jaffle_shop"} */
show objects in raw.JAFFLE_SHOP_jaffle_shop limit 10000
[0m18:49:33.776430 [debug] [ThreadPool]: On list_ANALYTICS_JAFFLE_SHOP: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_ANALYTICS_JAFFLE_SHOP"} */
show objects in ANALYTICS.JAFFLE_SHOP limit 10000
[0m18:49:33.776759 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:49:33.777075 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:49:33.777376 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:49:34.493636 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.716 seconds
[0m18:49:34.498248 [debug] [ThreadPool]: On list_raw_JAFFLE_SHOP_jaffle_shop: Close
[0m18:49:34.712969 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.936 seconds
[0m18:49:34.717031 [debug] [ThreadPool]: On list_raw_JAFFLE_SHOP_stripe: Close
[0m18:49:34.865947 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 1.088 seconds
[0m18:49:34.871201 [debug] [ThreadPool]: On list_ANALYTICS_JAFFLE_SHOP: Close
[0m18:49:35.029444 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e6a18867-247d-420a-b60c-0a054735299a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10be0b9d0>]}
[0m18:49:35.030548 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:49:35.031668 [info ] [MainThread]: 
[0m18:49:35.035900 [debug] [Thread-1 (]: Began running node seed.jaffle_shop.raw_customers
[0m18:49:35.036847 [debug] [Thread-2 (]: Began running node seed.jaffle_shop.raw_orders
[0m18:49:35.037634 [debug] [Thread-3 (]: Began running node seed.jaffle_shop.raw_payments
[0m18:49:35.038391 [info ] [Thread-1 (]: 1 of 3 START seed file raw.JAFFLE_SHOP_jaffle_shop.raw_customers ............... [RUN]
[0m18:49:35.039289 [info ] [Thread-2 (]: 2 of 3 START seed file raw.JAFFLE_SHOP_jaffle_shop.raw_orders .................. [RUN]
[0m18:49:35.040009 [info ] [Thread-3 (]: 3 of 3 START seed file raw.JAFFLE_SHOP_stripe.raw_payments ..................... [RUN]
[0m18:49:35.040650 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_raw_JAFFLE_SHOP_stripe, now seed.jaffle_shop.raw_customers)
[0m18:49:35.041185 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_raw_JAFFLE_SHOP_jaffle_shop, now seed.jaffle_shop.raw_orders)
[0m18:49:35.041862 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_ANALYTICS_JAFFLE_SHOP, now seed.jaffle_shop.raw_payments)
[0m18:49:35.042921 [debug] [Thread-1 (]: Began compiling node seed.jaffle_shop.raw_customers
[0m18:49:35.043905 [debug] [Thread-2 (]: Began compiling node seed.jaffle_shop.raw_orders
[0m18:49:35.044492 [debug] [Thread-3 (]: Began compiling node seed.jaffle_shop.raw_payments
[0m18:49:35.045353 [debug] [Thread-1 (]: Began executing node seed.jaffle_shop.raw_customers
[0m18:49:35.046233 [debug] [Thread-2 (]: Began executing node seed.jaffle_shop.raw_orders
[0m18:49:35.046975 [debug] [Thread-3 (]: Began executing node seed.jaffle_shop.raw_payments
[0m18:49:35.126521 [debug] [Thread-2 (]: Using snowflake connection "seed.jaffle_shop.raw_orders"
[0m18:49:35.127189 [debug] [Thread-2 (]: On seed.jaffle_shop.raw_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_orders"} */
create table raw.JAFFLE_SHOP_jaffle_shop.raw_orders (id integer,user_id integer,order_date date,status text)
[0m18:49:35.130575 [debug] [Thread-3 (]: Using snowflake connection "seed.jaffle_shop.raw_payments"
[0m18:49:35.130989 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:49:35.131729 [debug] [Thread-1 (]: Using snowflake connection "seed.jaffle_shop.raw_customers"
[0m18:49:35.132147 [debug] [Thread-3 (]: On seed.jaffle_shop.raw_payments: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_payments"} */
create table raw.JAFFLE_SHOP_stripe.raw_payments (id integer,order_id integer,payment_method text,amount integer)
[0m18:49:35.133827 [debug] [Thread-1 (]: On seed.jaffle_shop.raw_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_customers"} */
create table raw.JAFFLE_SHOP_jaffle_shop.raw_customers (id integer,first_name text,last_name text)
[0m18:49:35.134450 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m18:49:35.135016 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:49:35.679393 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.548 seconds
[0m18:49:35.708961 [debug] [Thread-2 (]: Using snowflake connection "seed.jaffle_shop.raw_orders"
[0m18:49:35.709669 [debug] [Thread-2 (]: On seed.jaffle_shop.raw_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_orders"} */
BEGIN
[0m18:49:35.769958 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.635 seconds
[0m18:49:35.776174 [debug] [Thread-1 (]: Using snowflake connection "seed.jaffle_shop.raw_customers"
[0m18:49:35.777218 [debug] [Thread-1 (]: On seed.jaffle_shop.raw_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_customers"} */
BEGIN
[0m18:49:35.806625 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.096 seconds
[0m18:49:35.812967 [debug] [Thread-2 (]: Using snowflake connection "seed.jaffle_shop.raw_orders"
[0m18:49:35.813898 [debug] [Thread-2 (]: On seed.jaffle_shop.raw_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_orders"} */
insert into raw.JAFFLE_SHOP_jaffle_shop.raw_orders (id, user_id, order_date, status) values
            (%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%...
[0m18:49:35.915615 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.137 seconds
[0m18:49:35.920702 [debug] [Thread-1 (]: Using snowflake connection "seed.jaffle_shop.raw_customers"
[0m18:49:35.922832 [debug] [Thread-1 (]: On seed.jaffle_shop.raw_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_customers"} */
insert into raw.JAFFLE_SHOP_jaffle_shop.raw_customers (id, first_name, last_name) values
            (%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,...
[0m18:49:35.924806 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.790 seconds
[0m18:49:35.932186 [debug] [Thread-3 (]: Using snowflake connection "seed.jaffle_shop.raw_payments"
[0m18:49:35.933399 [debug] [Thread-3 (]: On seed.jaffle_shop.raw_payments: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_payments"} */
BEGIN
[0m18:49:36.042515 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.107 seconds
[0m18:49:36.051984 [debug] [Thread-3 (]: Using snowflake connection "seed.jaffle_shop.raw_payments"
[0m18:49:36.053860 [debug] [Thread-3 (]: On seed.jaffle_shop.raw_payments: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_payments"} */
insert into raw.JAFFLE_SHOP_stripe.raw_payments (id, order_id, payment_method, amount) values
            (%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s...
[0m18:49:36.693168 [debug] [Thread-3 (]: SQL status: SUCCESS 113 in 0.638 seconds
[0m18:49:36.695212 [debug] [Thread-3 (]: Using snowflake connection "seed.jaffle_shop.raw_payments"
[0m18:49:36.696617 [debug] [Thread-3 (]: On seed.jaffle_shop.raw_payments: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_payments"} */
COMMIT
[0m18:49:37.082962 [debug] [Thread-2 (]: SQL status: SUCCESS 99 in 1.268 seconds
[0m18:49:37.084835 [debug] [Thread-2 (]: Using snowflake connection "seed.jaffle_shop.raw_orders"
[0m18:49:37.086575 [debug] [Thread-1 (]: SQL status: SUCCESS 100 in 1.161 seconds
[0m18:49:37.087823 [debug] [Thread-2 (]: On seed.jaffle_shop.raw_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_orders"} */
COMMIT
[0m18:49:37.089570 [debug] [Thread-1 (]: Using snowflake connection "seed.jaffle_shop.raw_customers"
[0m18:49:37.092910 [debug] [Thread-1 (]: On seed.jaffle_shop.raw_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_customers"} */
COMMIT
[0m18:49:37.191077 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.493 seconds
[0m18:49:37.198996 [debug] [Thread-3 (]: Writing runtime SQL for node "seed.jaffle_shop.raw_payments"
[0m18:49:37.226089 [debug] [Thread-3 (]: On seed.jaffle_shop.raw_payments: Close
[0m18:49:37.318277 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.227 seconds
[0m18:49:37.319963 [debug] [Thread-2 (]: Writing runtime SQL for node "seed.jaffle_shop.raw_orders"
[0m18:49:37.322697 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.229 seconds
[0m18:49:37.324544 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.jaffle_shop.raw_customers"
[0m18:49:37.328058 [debug] [Thread-2 (]: On seed.jaffle_shop.raw_orders: Close
[0m18:49:37.334064 [debug] [Thread-1 (]: On seed.jaffle_shop.raw_customers: Close
[0m18:49:37.404146 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e6a18867-247d-420a-b60c-0a054735299a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bf89ed0>]}
[0m18:49:37.408941 [info ] [Thread-3 (]: 3 of 3 OK loaded seed file JAFFLE_SHOP_stripe.raw_payments ..................... [[32mINSERT 113[0m in 2.36s]
[0m18:49:37.410604 [debug] [Thread-3 (]: Finished running node seed.jaffle_shop.raw_payments
[0m18:49:37.476608 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e6a18867-247d-420a-b60c-0a054735299a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108845450>]}
[0m18:49:37.478031 [info ] [Thread-2 (]: 2 of 3 OK loaded seed file JAFFLE_SHOP_jaffle_shop.raw_orders .................. [[32mINSERT 99[0m in 2.44s]
[0m18:49:37.479581 [debug] [Thread-2 (]: Finished running node seed.jaffle_shop.raw_orders
[0m18:49:37.495471 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e6a18867-247d-420a-b60c-0a054735299a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bfdb210>]}
[0m18:49:37.496647 [info ] [Thread-1 (]: 1 of 3 OK loaded seed file JAFFLE_SHOP_jaffle_shop.raw_customers ............... [[32mINSERT 100[0m in 2.45s]
[0m18:49:37.498187 [debug] [Thread-1 (]: Finished running node seed.jaffle_shop.raw_customers
[0m18:49:37.500907 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:49:37.501602 [debug] [MainThread]: Connection 'seed.jaffle_shop.raw_customers' was properly closed.
[0m18:49:37.502143 [debug] [MainThread]: Connection 'seed.jaffle_shop.raw_orders' was properly closed.
[0m18:49:37.502817 [debug] [MainThread]: Connection 'seed.jaffle_shop.raw_payments' was properly closed.
[0m18:49:37.503596 [info ] [MainThread]: 
[0m18:49:37.504567 [info ] [MainThread]: Finished running 3 seeds in 0 hours 0 minutes and 7.15 seconds (7.15s).
[0m18:49:37.506931 [debug] [MainThread]: Command end result
[0m18:49:37.545374 [info ] [MainThread]: 
[0m18:49:37.546068 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:49:37.546504 [info ] [MainThread]: 
[0m18:49:37.546908 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m18:49:37.548283 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": true, "command_wall_clock_time": 8.315567, "process_user_time": 3.245765, "process_kernel_time": 0.42933, "process_mem_max_rss": "134352896", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m18:49:37.548854 [debug] [MainThread]: Command `dbt seed` succeeded at 18:49:37.548755 after 8.32 seconds
[0m18:49:37.549283 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1079a11d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1078f4310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ae58a90>]}
[0m18:49:37.549833 [debug] [MainThread]: Flushing usage events
[0m18:59:39.822049 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113c0b6d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113c5aa50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113c7d2d0>]}


============================== 18:59:39.828176 | db2d8245-8b1b-40c8-994c-2ba1704f6a41 ==============================
[0m18:59:39.828176 [info ] [MainThread]: Running with dbt=1.8.7
[0m18:59:39.829013 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/ben/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/ben/Dbt Certification/dbt-tutorial/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt seed', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:59:40.245261 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'db2d8245-8b1b-40c8-994c-2ba1704f6a41', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113c0b890>]}
[0m18:59:40.300448 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'db2d8245-8b1b-40c8-994c-2ba1704f6a41', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1136d2b50>]}
[0m18:59:40.301419 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m18:59:40.326378 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m18:59:40.475349 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m18:59:40.476265 [debug] [MainThread]: Partial parsing: updated file: jaffle_shop://seeds/jaffle_shop/properties.yml
[0m18:59:40.476758 [debug] [MainThread]: Partial parsing: updated file: jaffle_shop://seeds/stripe/properties.yml
[0m18:59:40.784430 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.staging
[0m18:59:40.789968 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'db2d8245-8b1b-40c8-994c-2ba1704f6a41', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111824790>]}
[0m18:59:40.901145 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'db2d8245-8b1b-40c8-994c-2ba1704f6a41', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1149df990>]}
[0m18:59:40.901724 [info ] [MainThread]: Found 7 models, 11 data tests, 3 seeds, 572 macros
[0m18:59:40.902231 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'db2d8245-8b1b-40c8-994c-2ba1704f6a41', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1147a4490>]}
[0m18:59:40.904358 [info ] [MainThread]: 
[0m18:59:40.904978 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m18:59:40.912321 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_raw'
[0m18:59:40.927376 [debug] [ThreadPool]: Using snowflake connection "list_raw"
[0m18:59:40.927876 [debug] [ThreadPool]: On list_raw: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_raw"} */
show terse schemas in database raw
    limit 10000
[0m18:59:40.928227 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:59:41.650801 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.722 seconds
[0m18:59:41.654475 [debug] [ThreadPool]: On list_raw: Close
[0m18:59:41.813308 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_raw, now create_raw_JAFFLE_SHOP)
[0m18:59:41.815260 [debug] [ThreadPool]: Creating schema "database: "raw"
schema: "JAFFLE_SHOP"
"
[0m18:59:41.825916 [debug] [ThreadPool]: Using snowflake connection "create_raw_JAFFLE_SHOP"
[0m18:59:41.826683 [debug] [ThreadPool]: On create_raw_JAFFLE_SHOP: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "create_raw_JAFFLE_SHOP"} */
create schema if not exists raw.JAFFLE_SHOP
[0m18:59:41.827317 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:59:42.315674 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.488 seconds
[0m18:59:42.318774 [debug] [ThreadPool]: On create_raw_JAFFLE_SHOP: Close
[0m18:59:42.469369 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_raw_JAFFLE_SHOP, now list_ANALYTICS_JAFFLE_SHOP)
[0m18:59:42.478098 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_raw_JAFFLE_SHOP'
[0m18:59:42.489062 [debug] [ThreadPool]: Using snowflake connection "list_ANALYTICS_JAFFLE_SHOP"
[0m18:59:42.492555 [debug] [ThreadPool]: Using snowflake connection "list_raw_JAFFLE_SHOP"
[0m18:59:42.493324 [debug] [ThreadPool]: On list_ANALYTICS_JAFFLE_SHOP: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_ANALYTICS_JAFFLE_SHOP"} */
show objects in ANALYTICS.JAFFLE_SHOP limit 10000
[0m18:59:42.493918 [debug] [ThreadPool]: On list_raw_JAFFLE_SHOP: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_raw_JAFFLE_SHOP"} */
show objects in raw.JAFFLE_SHOP limit 10000
[0m18:59:42.494408 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:59:42.494874 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:59:43.060410 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.565 seconds
[0m18:59:43.064069 [debug] [ThreadPool]: On list_raw_JAFFLE_SHOP: Close
[0m18:59:43.227116 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.733 seconds
[0m18:59:43.232009 [debug] [ThreadPool]: On list_ANALYTICS_JAFFLE_SHOP: Close
[0m18:59:43.371176 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'db2d8245-8b1b-40c8-994c-2ba1704f6a41', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1149ab250>]}
[0m18:59:43.373066 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:59:43.374196 [info ] [MainThread]: 
[0m18:59:43.379621 [debug] [Thread-1 (]: Began running node seed.jaffle_shop.raw_customers
[0m18:59:43.381081 [info ] [Thread-1 (]: 1 of 3 START seed file raw.JAFFLE_SHOP.raw_customers ........................... [RUN]
[0m18:59:43.382782 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_ANALYTICS_JAFFLE_SHOP, now seed.jaffle_shop.raw_customers)
[0m18:59:43.383819 [debug] [Thread-2 (]: Began running node seed.jaffle_shop.raw_orders
[0m18:59:43.384779 [debug] [Thread-3 (]: Began running node seed.jaffle_shop.raw_payments
[0m18:59:43.385604 [debug] [Thread-1 (]: Began compiling node seed.jaffle_shop.raw_customers
[0m18:59:43.386615 [info ] [Thread-2 (]: 2 of 3 START seed file raw.JAFFLE_SHOP.raw_orders .............................. [RUN]
[0m18:59:43.387780 [info ] [Thread-3 (]: 3 of 3 START seed file raw.JAFFLE_SHOP.raw_payments ............................ [RUN]
[0m18:59:43.389125 [debug] [Thread-1 (]: Began executing node seed.jaffle_shop.raw_customers
[0m18:59:43.390862 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_raw_JAFFLE_SHOP, now seed.jaffle_shop.raw_orders)
[0m18:59:43.392142 [debug] [Thread-3 (]: Acquiring new snowflake connection 'seed.jaffle_shop.raw_payments'
[0m18:59:43.418002 [debug] [Thread-2 (]: Began compiling node seed.jaffle_shop.raw_orders
[0m18:59:43.421792 [debug] [Thread-3 (]: Began compiling node seed.jaffle_shop.raw_payments
[0m18:59:43.435035 [debug] [Thread-1 (]: Using snowflake connection "seed.jaffle_shop.raw_customers"
[0m18:59:43.435615 [debug] [Thread-2 (]: Began executing node seed.jaffle_shop.raw_orders
[0m18:59:43.436055 [debug] [Thread-3 (]: Began executing node seed.jaffle_shop.raw_payments
[0m18:59:43.436458 [debug] [Thread-1 (]: On seed.jaffle_shop.raw_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_customers"} */
create table raw.JAFFLE_SHOP.raw_customers (id integer,first_name text,last_name text)
[0m18:59:43.445229 [debug] [Thread-2 (]: Using snowflake connection "seed.jaffle_shop.raw_orders"
[0m18:59:43.451883 [debug] [Thread-3 (]: Using snowflake connection "seed.jaffle_shop.raw_payments"
[0m18:59:43.452424 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:59:43.452866 [debug] [Thread-2 (]: On seed.jaffle_shop.raw_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_orders"} */
create table raw.JAFFLE_SHOP.raw_orders (id integer,user_id integer,order_date date,status text)
[0m18:59:43.453262 [debug] [Thread-3 (]: On seed.jaffle_shop.raw_payments: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_payments"} */
create table raw.JAFFLE_SHOP.raw_payments (id integer,order_id integer,payment_method text,amount integer)
[0m18:59:43.454376 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:59:43.455300 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m18:59:43.998129 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.543 seconds
[0m18:59:44.006178 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.552 seconds
[0m18:59:44.042250 [debug] [Thread-3 (]: Using snowflake connection "seed.jaffle_shop.raw_payments"
[0m18:59:44.045066 [debug] [Thread-2 (]: Using snowflake connection "seed.jaffle_shop.raw_orders"
[0m18:59:44.045626 [debug] [Thread-3 (]: On seed.jaffle_shop.raw_payments: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_payments"} */
BEGIN
[0m18:59:44.046146 [debug] [Thread-2 (]: On seed.jaffle_shop.raw_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_orders"} */
BEGIN
[0m18:59:44.115926 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.663 seconds
[0m18:59:44.123359 [debug] [Thread-1 (]: Using snowflake connection "seed.jaffle_shop.raw_customers"
[0m18:59:44.124297 [debug] [Thread-1 (]: On seed.jaffle_shop.raw_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_customers"} */
BEGIN
[0m18:59:44.150402 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.104 seconds
[0m18:59:44.159650 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.112 seconds
[0m18:59:44.165077 [debug] [Thread-2 (]: Using snowflake connection "seed.jaffle_shop.raw_orders"
[0m18:59:44.165959 [debug] [Thread-2 (]: On seed.jaffle_shop.raw_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_orders"} */
insert into raw.JAFFLE_SHOP.raw_orders (id, user_id, order_date, status) values
            (%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),...
[0m18:59:44.166775 [debug] [Thread-3 (]: Using snowflake connection "seed.jaffle_shop.raw_payments"
[0m18:59:44.169693 [debug] [Thread-3 (]: On seed.jaffle_shop.raw_payments: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_payments"} */
insert into raw.JAFFLE_SHOP.raw_payments (id, order_id, payment_method, amount) values
            (%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%...
[0m18:59:44.224980 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.100 seconds
[0m18:59:44.231690 [debug] [Thread-1 (]: Using snowflake connection "seed.jaffle_shop.raw_customers"
[0m18:59:44.232677 [debug] [Thread-1 (]: On seed.jaffle_shop.raw_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_customers"} */
insert into raw.JAFFLE_SHOP.raw_customers (id, first_name, last_name) values
            (%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%...
[0m18:59:45.468609 [debug] [Thread-1 (]: SQL status: SUCCESS 100 in 1.235 seconds
[0m18:59:45.470795 [debug] [Thread-2 (]: SQL status: SUCCESS 99 in 1.303 seconds
[0m18:59:45.472331 [debug] [Thread-1 (]: Using snowflake connection "seed.jaffle_shop.raw_customers"
[0m18:59:45.473700 [debug] [Thread-2 (]: Using snowflake connection "seed.jaffle_shop.raw_orders"
[0m18:59:45.474860 [debug] [Thread-1 (]: On seed.jaffle_shop.raw_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_customers"} */
COMMIT
[0m18:59:45.476330 [debug] [Thread-2 (]: On seed.jaffle_shop.raw_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_orders"} */
COMMIT
[0m18:59:45.637339 [debug] [Thread-3 (]: SQL status: SUCCESS 113 in 1.466 seconds
[0m18:59:45.639096 [debug] [Thread-3 (]: Using snowflake connection "seed.jaffle_shop.raw_payments"
[0m18:59:45.640219 [debug] [Thread-3 (]: On seed.jaffle_shop.raw_payments: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_payments"} */
COMMIT
[0m18:59:45.716622 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.237 seconds
[0m18:59:45.732864 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.255 seconds
[0m18:59:45.734028 [debug] [Thread-2 (]: Writing runtime SQL for node "seed.jaffle_shop.raw_orders"
[0m18:59:45.735138 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.jaffle_shop.raw_customers"
[0m18:59:45.777445 [debug] [Thread-2 (]: On seed.jaffle_shop.raw_orders: Close
[0m18:59:45.778705 [debug] [Thread-1 (]: On seed.jaffle_shop.raw_customers: Close
[0m18:59:45.832492 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.191 seconds
[0m18:59:45.834522 [debug] [Thread-3 (]: Writing runtime SQL for node "seed.jaffle_shop.raw_payments"
[0m18:59:45.839816 [debug] [Thread-3 (]: On seed.jaffle_shop.raw_payments: Close
[0m18:59:45.916823 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'db2d8245-8b1b-40c8-994c-2ba1704f6a41', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114d43bd0>]}
[0m18:59:45.918200 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'db2d8245-8b1b-40c8-994c-2ba1704f6a41', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11473b450>]}
[0m18:59:45.919720 [info ] [Thread-1 (]: 1 of 3 OK loaded seed file JAFFLE_SHOP.raw_customers ........................... [[32mINSERT 100[0m in 2.53s]
[0m18:59:45.921139 [info ] [Thread-2 (]: 2 of 3 OK loaded seed file JAFFLE_SHOP.raw_orders .............................. [[32mINSERT 99[0m in 2.53s]
[0m18:59:45.922460 [debug] [Thread-1 (]: Finished running node seed.jaffle_shop.raw_customers
[0m18:59:45.923515 [debug] [Thread-2 (]: Finished running node seed.jaffle_shop.raw_orders
[0m18:59:45.988945 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'db2d8245-8b1b-40c8-994c-2ba1704f6a41', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113c26ad0>]}
[0m18:59:45.990899 [info ] [Thread-3 (]: 3 of 3 OK loaded seed file JAFFLE_SHOP.raw_payments ............................ [[32mINSERT 113[0m in 2.60s]
[0m18:59:45.993837 [debug] [Thread-3 (]: Finished running node seed.jaffle_shop.raw_payments
[0m18:59:45.996744 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:59:45.997421 [debug] [MainThread]: Connection 'seed.jaffle_shop.raw_customers' was properly closed.
[0m18:59:45.997979 [debug] [MainThread]: Connection 'seed.jaffle_shop.raw_orders' was properly closed.
[0m18:59:45.998465 [debug] [MainThread]: Connection 'seed.jaffle_shop.raw_payments' was properly closed.
[0m18:59:45.999005 [info ] [MainThread]: 
[0m18:59:45.999555 [info ] [MainThread]: Finished running 3 seeds in 0 hours 0 minutes and 5.09 seconds (5.09s).
[0m18:59:46.001639 [debug] [MainThread]: Command end result
[0m18:59:46.042996 [info ] [MainThread]: 
[0m18:59:46.043718 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:59:46.044178 [info ] [MainThread]: 
[0m18:59:46.044618 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m18:59:46.045995 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": true, "command_wall_clock_time": 6.304444, "process_user_time": 3.103446, "process_kernel_time": 0.421005, "process_mem_max_rss": "131190784", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m18:59:46.046577 [debug] [MainThread]: Command `dbt seed` succeeded at 18:59:46.046468 after 6.31 seconds
[0m18:59:46.047276 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110759250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1106ac310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113c10910>]}
[0m18:59:46.047909 [debug] [MainThread]: Flushing usage events
[0m19:01:22.975601 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111f0fc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111f5e050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111f855d0>]}


============================== 19:01:22.981604 | 3e94e914-e502-4c58-8993-5242691ec84a ==============================
[0m19:01:22.981604 [info ] [MainThread]: Running with dbt=1.8.7
[0m19:01:22.982438 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/ben/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/Users/ben/Dbt Certification/dbt-tutorial/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt seed --select stripe', 'send_anonymous_usage_stats': 'True'}
[0m19:01:23.336662 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3e94e914-e502-4c58-8993-5242691ec84a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111f3f150>]}
[0m19:01:23.392562 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3e94e914-e502-4c58-8993-5242691ec84a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1119c6d10>]}
[0m19:01:23.393734 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m19:01:23.419541 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m19:01:23.557635 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m19:01:23.558604 [debug] [MainThread]: Partial parsing: updated file: jaffle_shop://seeds/stripe/properties.yml
[0m19:01:23.860675 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.staging
[0m19:01:23.866747 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3e94e914-e502-4c58-8993-5242691ec84a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fa6e8d0>]}
[0m19:01:23.970960 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3e94e914-e502-4c58-8993-5242691ec84a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112f98710>]}
[0m19:01:23.971548 [info ] [MainThread]: Found 7 models, 11 data tests, 3 seeds, 572 macros
[0m19:01:23.971985 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3e94e914-e502-4c58-8993-5242691ec84a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112688910>]}
[0m19:01:23.973649 [info ] [MainThread]: 
[0m19:01:23.974267 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m19:01:23.975133 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_raw'
[0m19:01:23.990395 [debug] [ThreadPool]: Using snowflake connection "list_raw"
[0m19:01:23.990917 [debug] [ThreadPool]: On list_raw: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_raw"} */
show terse schemas in database raw
    limit 10000
[0m19:01:23.991389 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:01:25.535925 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.544 seconds
[0m19:01:25.540183 [debug] [ThreadPool]: On list_raw: Close
[0m19:01:25.826337 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_raw, now create_raw_JAFFLE_SHOP_stripe)
[0m19:01:25.828328 [debug] [ThreadPool]: Creating schema "database: "raw"
schema: "JAFFLE_SHOP_stripe"
"
[0m19:01:25.838883 [debug] [ThreadPool]: Using snowflake connection "create_raw_JAFFLE_SHOP_stripe"
[0m19:01:25.839843 [debug] [ThreadPool]: On create_raw_JAFFLE_SHOP_stripe: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "create_raw_JAFFLE_SHOP_stripe"} */
create schema if not exists raw.JAFFLE_SHOP_stripe
[0m19:01:25.840585 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:01:27.251611 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.411 seconds
[0m19:01:27.254804 [debug] [ThreadPool]: On create_raw_JAFFLE_SHOP_stripe: Close
[0m19:01:27.923248 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_raw_JAFFLE_SHOP_stripe, now list_raw_JAFFLE_SHOP_stripe)
[0m19:01:27.924460 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_raw_JAFFLE_SHOP'
[0m19:01:27.931976 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ANALYTICS_JAFFLE_SHOP'
[0m19:01:27.939943 [debug] [ThreadPool]: Using snowflake connection "list_raw_JAFFLE_SHOP_stripe"
[0m19:01:27.943191 [debug] [ThreadPool]: Using snowflake connection "list_raw_JAFFLE_SHOP"
[0m19:01:27.945784 [debug] [ThreadPool]: Using snowflake connection "list_ANALYTICS_JAFFLE_SHOP"
[0m19:01:27.946232 [debug] [ThreadPool]: On list_raw_JAFFLE_SHOP_stripe: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_raw_JAFFLE_SHOP_stripe"} */
show objects in raw.JAFFLE_SHOP_stripe limit 10000
[0m19:01:27.946655 [debug] [ThreadPool]: On list_raw_JAFFLE_SHOP: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_raw_JAFFLE_SHOP"} */
show objects in raw.JAFFLE_SHOP limit 10000
[0m19:01:27.947054 [debug] [ThreadPool]: On list_ANALYTICS_JAFFLE_SHOP: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_ANALYTICS_JAFFLE_SHOP"} */
show objects in ANALYTICS.JAFFLE_SHOP limit 10000
[0m19:01:27.947439 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:01:27.947808 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:01:27.948173 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:01:28.740777 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.792 seconds
[0m19:01:28.745787 [debug] [ThreadPool]: On list_ANALYTICS_JAFFLE_SHOP: Close
[0m19:01:29.608438 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 1.660 seconds
[0m19:01:29.613206 [debug] [ThreadPool]: On list_raw_JAFFLE_SHOP: Close
[0m19:01:29.664534 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 1.717 seconds
[0m19:01:29.668314 [debug] [ThreadPool]: On list_raw_JAFFLE_SHOP_stripe: Close
[0m19:01:30.043386 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3e94e914-e502-4c58-8993-5242691ec84a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111382250>]}
[0m19:01:30.045229 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m19:01:30.046355 [info ] [MainThread]: 
[0m19:01:30.051070 [debug] [Thread-1 (]: Began running node seed.jaffle_shop.raw_payments
[0m19:01:30.052505 [info ] [Thread-1 (]: 1 of 1 START seed file raw.JAFFLE_SHOP_stripe.raw_payments ..................... [RUN]
[0m19:01:30.053732 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_raw_JAFFLE_SHOP_stripe, now seed.jaffle_shop.raw_payments)
[0m19:01:30.054569 [debug] [Thread-1 (]: Began compiling node seed.jaffle_shop.raw_payments
[0m19:01:30.055367 [debug] [Thread-1 (]: Began executing node seed.jaffle_shop.raw_payments
[0m19:01:30.102005 [debug] [Thread-1 (]: Using snowflake connection "seed.jaffle_shop.raw_payments"
[0m19:01:30.102629 [debug] [Thread-1 (]: On seed.jaffle_shop.raw_payments: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_payments"} */
create table raw.JAFFLE_SHOP_stripe.raw_payments (id integer,order_id integer,payment_method text,amount integer)
[0m19:01:30.103026 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:01:30.997302 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.894 seconds
[0m19:01:31.028086 [debug] [Thread-1 (]: Using snowflake connection "seed.jaffle_shop.raw_payments"
[0m19:01:31.028760 [debug] [Thread-1 (]: On seed.jaffle_shop.raw_payments: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_payments"} */
BEGIN
[0m19:01:32.273955 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.244 seconds
[0m19:01:32.281784 [debug] [Thread-1 (]: Using snowflake connection "seed.jaffle_shop.raw_payments"
[0m19:01:32.283110 [debug] [Thread-1 (]: On seed.jaffle_shop.raw_payments: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_payments"} */
insert into raw.JAFFLE_SHOP_stripe.raw_payments (id, order_id, payment_method, amount) values
            (%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s...
[0m19:01:33.804844 [debug] [Thread-1 (]: SQL status: SUCCESS 113 in 1.521 seconds
[0m19:01:33.805837 [debug] [Thread-1 (]: Using snowflake connection "seed.jaffle_shop.raw_payments"
[0m19:01:33.806806 [debug] [Thread-1 (]: On seed.jaffle_shop.raw_payments: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_payments"} */
COMMIT
[0m19:01:34.285106 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.477 seconds
[0m19:01:34.299684 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.jaffle_shop.raw_payments"
[0m19:01:34.335501 [debug] [Thread-1 (]: On seed.jaffle_shop.raw_payments: Close
[0m19:01:34.732528 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3e94e914-e502-4c58-8993-5242691ec84a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1132eb490>]}
[0m19:01:34.734318 [info ] [Thread-1 (]: 1 of 1 OK loaded seed file JAFFLE_SHOP_stripe.raw_payments ..................... [[32mINSERT 113[0m in 4.68s]
[0m19:01:34.735787 [debug] [Thread-1 (]: Finished running node seed.jaffle_shop.raw_payments
[0m19:01:34.738954 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:01:34.739830 [debug] [MainThread]: Connection 'seed.jaffle_shop.raw_payments' was properly closed.
[0m19:01:34.740559 [debug] [MainThread]: Connection 'list_raw_JAFFLE_SHOP' was properly closed.
[0m19:01:34.741158 [debug] [MainThread]: Connection 'list_ANALYTICS_JAFFLE_SHOP' was properly closed.
[0m19:01:34.741848 [info ] [MainThread]: 
[0m19:01:34.742576 [info ] [MainThread]: Finished running 1 seed in 0 hours 0 minutes and 10.77 seconds (10.77s).
[0m19:01:34.743820 [debug] [MainThread]: Command end result
[0m19:01:34.785365 [info ] [MainThread]: 
[0m19:01:34.785973 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:01:34.786381 [info ] [MainThread]: 
[0m19:01:34.786793 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m19:01:34.788164 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": true, "command_wall_clock_time": 11.885068, "process_user_time": 2.858539, "process_kernel_time": 0.358874, "process_mem_max_rss": "132116480", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m19:01:34.788743 [debug] [MainThread]: Command `dbt seed` succeeded at 19:01:34.788646 after 11.89 seconds
[0m19:01:34.789325 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111f67c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111f85550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ea01590>]}
[0m19:01:34.789715 [debug] [MainThread]: Flushing usage events
[0m20:17:31.804143 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1077f3210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107864710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107865050>]}


============================== 20:17:31.812276 | 1ab4ad75-95f9-4ecd-b20d-32d87ed3a246 ==============================
[0m20:17:31.812276 [info ] [MainThread]: Running with dbt=1.8.7
[0m20:17:31.813106 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/ben/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/ben/Dbt Certification/dbt-tutorial/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'invocation_command': 'dbt seed', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:17:32.421531 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1ab4ad75-95f9-4ecd-b20d-32d87ed3a246', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1084be810>]}
[0m20:17:32.480340 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1ab4ad75-95f9-4ecd-b20d-32d87ed3a246', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1072bab90>]}
[0m20:17:32.482766 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m20:17:32.513898 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m20:17:32.622285 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m20:17:32.622994 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '1ab4ad75-95f9-4ecd-b20d-32d87ed3a246', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1064c4990>]}
[0m20:17:34.119175 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m20:17:34.119994 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '1ab4ad75-95f9-4ecd-b20d-32d87ed3a246', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10858a690>]}
[0m20:17:34.329287 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.staging
- seeds.stripe
[0m20:17:34.334826 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1ab4ad75-95f9-4ecd-b20d-32d87ed3a246', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108941fd0>]}
[0m20:17:34.457895 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1ab4ad75-95f9-4ecd-b20d-32d87ed3a246', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108a26cd0>]}
[0m20:17:34.458451 [info ] [MainThread]: Found 7 models, 3 seeds, 11 data tests, 572 macros
[0m20:17:34.458863 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1ab4ad75-95f9-4ecd-b20d-32d87ed3a246', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1089cbed0>]}
[0m20:17:34.461058 [info ] [MainThread]: 
[0m20:17:34.461678 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m20:17:34.466013 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_raw'
[0m20:17:34.476316 [debug] [ThreadPool]: Using snowflake connection "list_raw"
[0m20:17:34.477012 [debug] [ThreadPool]: On list_raw: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_raw"} */
show terse schemas in database raw
    limit 10000
[0m20:17:34.477359 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:17:35.555183 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 1.077 seconds
[0m20:17:35.559941 [debug] [ThreadPool]: On list_raw: Close
[0m20:17:35.696131 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_raw, now create_raw_JAFFLE_SHOP_jaffle_shop)
[0m20:17:35.698991 [debug] [ThreadPool]: Creating schema "database: "raw"
schema: "JAFFLE_SHOP_jaffle_shop"
"
[0m20:17:35.709232 [debug] [ThreadPool]: Using snowflake connection "create_raw_JAFFLE_SHOP_jaffle_shop"
[0m20:17:35.710037 [debug] [ThreadPool]: On create_raw_JAFFLE_SHOP_jaffle_shop: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "create_raw_JAFFLE_SHOP_jaffle_shop"} */
create schema if not exists raw.JAFFLE_SHOP_jaffle_shop
[0m20:17:35.710674 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:17:36.214661 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.504 seconds
[0m20:17:36.217719 [debug] [ThreadPool]: On create_raw_JAFFLE_SHOP_jaffle_shop: Close
[0m20:17:36.419172 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_raw_JAFFLE_SHOP_jaffle_shop, now list_raw_JAFFLE_SHOP_jaffle_shop)
[0m20:17:36.421445 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ANALYTICS_JAFFLE_SHOP'
[0m20:17:36.440606 [debug] [ThreadPool]: Using snowflake connection "list_raw_JAFFLE_SHOP_jaffle_shop"
[0m20:17:36.444410 [debug] [ThreadPool]: Using snowflake connection "list_ANALYTICS_JAFFLE_SHOP"
[0m20:17:36.444995 [debug] [ThreadPool]: On list_raw_JAFFLE_SHOP_jaffle_shop: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_raw_JAFFLE_SHOP_jaffle_shop"} */
show objects in raw.JAFFLE_SHOP_jaffle_shop limit 10000
[0m20:17:36.445460 [debug] [ThreadPool]: On list_ANALYTICS_JAFFLE_SHOP: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_ANALYTICS_JAFFLE_SHOP"} */
show objects in ANALYTICS.JAFFLE_SHOP limit 10000
[0m20:17:36.446077 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:17:36.446584 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:17:37.059066 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.612 seconds
[0m20:17:37.063770 [debug] [ThreadPool]: On list_ANALYTICS_JAFFLE_SHOP: Close
[0m20:17:37.207500 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.761 seconds
[0m20:17:37.211779 [debug] [ThreadPool]: On list_raw_JAFFLE_SHOP_jaffle_shop: Close
[0m20:17:39.626179 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1ab4ad75-95f9-4ecd-b20d-32d87ed3a246', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108bc02d0>]}
[0m20:17:39.627121 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:17:39.627657 [info ] [MainThread]: 
[0m20:17:39.631781 [debug] [Thread-1 (]: Began running node seed.jaffle_shop.raw_customers
[0m20:17:39.632544 [debug] [Thread-2 (]: Began running node seed.jaffle_shop.raw_orders
[0m20:17:39.633275 [debug] [Thread-3 (]: Began running node seed.jaffle_shop.raw_payments
[0m20:17:39.633976 [info ] [Thread-1 (]: 1 of 3 START seed file raw.JAFFLE_SHOP_jaffle_shop.raw_customers ............... [RUN]
[0m20:17:39.634687 [info ] [Thread-2 (]: 2 of 3 START seed file raw.JAFFLE_SHOP_jaffle_shop.raw_orders .................. [RUN]
[0m20:17:39.635277 [info ] [Thread-3 (]: 3 of 3 START seed file raw.JAFFLE_SHOP_jaffle_shop.raw_payments ................ [RUN]
[0m20:17:39.635994 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_raw_JAFFLE_SHOP_jaffle_shop, now seed.jaffle_shop.raw_customers)
[0m20:17:39.637198 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_ANALYTICS_JAFFLE_SHOP, now seed.jaffle_shop.raw_orders)
[0m20:17:39.638108 [debug] [Thread-3 (]: Acquiring new snowflake connection 'seed.jaffle_shop.raw_payments'
[0m20:17:39.638720 [debug] [Thread-1 (]: Began compiling node seed.jaffle_shop.raw_customers
[0m20:17:39.639347 [debug] [Thread-2 (]: Began compiling node seed.jaffle_shop.raw_orders
[0m20:17:39.639816 [debug] [Thread-3 (]: Began compiling node seed.jaffle_shop.raw_payments
[0m20:17:39.640400 [debug] [Thread-1 (]: Began executing node seed.jaffle_shop.raw_customers
[0m20:17:39.641105 [debug] [Thread-2 (]: Began executing node seed.jaffle_shop.raw_orders
[0m20:17:39.641715 [debug] [Thread-3 (]: Began executing node seed.jaffle_shop.raw_payments
[0m20:17:39.686491 [debug] [Thread-1 (]: Using snowflake connection "seed.jaffle_shop.raw_customers"
[0m20:17:39.690684 [debug] [Thread-2 (]: Using snowflake connection "seed.jaffle_shop.raw_orders"
[0m20:17:39.691171 [debug] [Thread-1 (]: On seed.jaffle_shop.raw_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_customers"} */
create table raw.JAFFLE_SHOP_jaffle_shop.raw_customers (id integer,first_name text,last_name text)
[0m20:17:39.694506 [debug] [Thread-3 (]: Using snowflake connection "seed.jaffle_shop.raw_payments"
[0m20:17:39.695003 [debug] [Thread-2 (]: On seed.jaffle_shop.raw_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_orders"} */
create table raw.JAFFLE_SHOP_jaffle_shop.raw_orders (id integer,user_id integer,order_date date,status text)
[0m20:17:39.695531 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:17:39.695916 [debug] [Thread-3 (]: On seed.jaffle_shop.raw_payments: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_payments"} */
create table raw.JAFFLE_SHOP_jaffle_shop.raw_payments (id integer,order_id integer,payment_method text,amount integer)
[0m20:17:39.696286 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:17:39.697507 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m20:17:40.435449 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.739 seconds
[0m20:17:40.452512 [debug] [Thread-2 (]: Using snowflake connection "seed.jaffle_shop.raw_orders"
[0m20:17:40.453086 [debug] [Thread-2 (]: On seed.jaffle_shop.raw_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_orders"} */
BEGIN
[0m20:17:40.639906 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.186 seconds
[0m20:17:40.647148 [debug] [Thread-2 (]: Using snowflake connection "seed.jaffle_shop.raw_orders"
[0m20:17:40.648136 [debug] [Thread-2 (]: On seed.jaffle_shop.raw_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_orders"} */
insert into raw.JAFFLE_SHOP_jaffle_shop.raw_orders (id, user_id, order_date, status) values
            (%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%...
[0m20:17:40.978010 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.280 seconds
[0m20:17:40.986828 [debug] [Thread-3 (]: Using snowflake connection "seed.jaffle_shop.raw_payments"
[0m20:17:40.987670 [debug] [Thread-3 (]: On seed.jaffle_shop.raw_payments: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_payments"} */
BEGIN
[0m20:17:41.102512 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.114 seconds
[0m20:17:41.110673 [debug] [Thread-3 (]: Using snowflake connection "seed.jaffle_shop.raw_payments"
[0m20:17:41.111737 [debug] [Thread-3 (]: On seed.jaffle_shop.raw_payments: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_payments"} */
insert into raw.JAFFLE_SHOP_jaffle_shop.raw_payments (id, order_id, payment_method, amount) values
            (%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,...
[0m20:17:41.405479 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.710 seconds
[0m20:17:41.411813 [debug] [Thread-1 (]: Using snowflake connection "seed.jaffle_shop.raw_customers"
[0m20:17:41.412753 [debug] [Thread-1 (]: On seed.jaffle_shop.raw_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_customers"} */
BEGIN
[0m20:17:41.584128 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.170 seconds
[0m20:17:41.590451 [debug] [Thread-1 (]: Using snowflake connection "seed.jaffle_shop.raw_customers"
[0m20:17:41.591436 [debug] [Thread-1 (]: On seed.jaffle_shop.raw_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_customers"} */
insert into raw.JAFFLE_SHOP_jaffle_shop.raw_customers (id, first_name, last_name) values
            (%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,...
[0m20:17:42.692504 [debug] [Thread-1 (]: SQL status: SUCCESS 100 in 1.100 seconds
[0m20:17:42.695974 [debug] [Thread-2 (]: SQL status: SUCCESS 99 in 2.047 seconds
[0m20:17:42.697760 [debug] [Thread-1 (]: Using snowflake connection "seed.jaffle_shop.raw_customers"
[0m20:17:42.699308 [debug] [Thread-3 (]: SQL status: SUCCESS 113 in 1.587 seconds
[0m20:17:42.700435 [debug] [Thread-2 (]: Using snowflake connection "seed.jaffle_shop.raw_orders"
[0m20:17:42.701345 [debug] [Thread-1 (]: On seed.jaffle_shop.raw_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_customers"} */
COMMIT
[0m20:17:42.702489 [debug] [Thread-3 (]: Using snowflake connection "seed.jaffle_shop.raw_payments"
[0m20:17:42.703450 [debug] [Thread-2 (]: On seed.jaffle_shop.raw_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_orders"} */
COMMIT
[0m20:17:42.705905 [debug] [Thread-3 (]: On seed.jaffle_shop.raw_payments: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_payments"} */
COMMIT
[0m20:17:42.910250 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.201 seconds
[0m20:17:42.925137 [debug] [Thread-3 (]: Writing runtime SQL for node "seed.jaffle_shop.raw_payments"
[0m20:17:42.926666 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.222 seconds
[0m20:17:42.928510 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.jaffle_shop.raw_customers"
[0m20:17:42.975282 [debug] [Thread-3 (]: On seed.jaffle_shop.raw_payments: Close
[0m20:17:42.979166 [debug] [Thread-1 (]: On seed.jaffle_shop.raw_customers: Close
[0m20:17:43.414505 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1ab4ad75-95f9-4ecd-b20d-32d87ed3a246', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108728890>]}
[0m20:17:43.417030 [info ] [Thread-3 (]: 3 of 3 OK loaded seed file JAFFLE_SHOP_jaffle_shop.raw_payments ................ [[32mINSERT 113[0m in 3.77s]
[0m20:17:43.419712 [debug] [Thread-3 (]: Finished running node seed.jaffle_shop.raw_payments
[0m20:17:43.496573 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1ab4ad75-95f9-4ecd-b20d-32d87ed3a246', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106cb7b50>]}
[0m20:17:43.498611 [info ] [Thread-1 (]: 1 of 3 OK loaded seed file JAFFLE_SHOP_jaffle_shop.raw_customers ............... [[32mINSERT 100[0m in 3.86s]
[0m20:17:43.500142 [debug] [Thread-1 (]: Finished running node seed.jaffle_shop.raw_customers
[0m20:17:44.102548 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.395 seconds
[0m20:17:44.104715 [debug] [Thread-2 (]: Writing runtime SQL for node "seed.jaffle_shop.raw_orders"
[0m20:17:44.110749 [debug] [Thread-2 (]: On seed.jaffle_shop.raw_orders: Close
[0m20:17:44.329828 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1ab4ad75-95f9-4ecd-b20d-32d87ed3a246', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108717ed0>]}
[0m20:17:44.331498 [info ] [Thread-2 (]: 2 of 3 OK loaded seed file JAFFLE_SHOP_jaffle_shop.raw_orders .................. [[32mINSERT 99[0m in 4.69s]
[0m20:17:44.333241 [debug] [Thread-2 (]: Finished running node seed.jaffle_shop.raw_orders
[0m20:17:44.336369 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:17:44.337201 [debug] [MainThread]: Connection 'seed.jaffle_shop.raw_customers' was properly closed.
[0m20:17:44.337926 [debug] [MainThread]: Connection 'seed.jaffle_shop.raw_orders' was properly closed.
[0m20:17:44.338635 [debug] [MainThread]: Connection 'seed.jaffle_shop.raw_payments' was properly closed.
[0m20:17:44.339690 [info ] [MainThread]: 
[0m20:17:44.340511 [info ] [MainThread]: Finished running 3 seeds in 0 hours 0 minutes and 9.88 seconds (9.88s).
[0m20:17:44.342414 [debug] [MainThread]: Command end result
[0m20:17:44.385840 [info ] [MainThread]: 
[0m20:17:44.386468 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:17:44.386852 [info ] [MainThread]: 
[0m20:17:44.387262 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m20:17:44.390026 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": true, "command_wall_clock_time": 12.676357, "process_user_time": 4.564287, "process_kernel_time": 0.624176, "process_mem_max_rss": "134471680", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m20:17:44.390745 [debug] [MainThread]: Command `dbt seed` succeeded at 20:17:44.390612 after 12.68 seconds
[0m20:17:44.391527 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1043411d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104294310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104294c10>]}
[0m20:17:44.392199 [debug] [MainThread]: Flushing usage events
[0m20:19:53.453768 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10413d0d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104186050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1041a9310>]}


============================== 20:19:53.461698 | 37810916-b302-4ce4-852a-7ea7c377f9da ==============================
[0m20:19:53.461698 [info ] [MainThread]: Running with dbt=1.8.7
[0m20:19:53.462697 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/ben/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/ben/Dbt Certification/dbt-tutorial/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt seed', 'send_anonymous_usage_stats': 'True'}
[0m20:19:54.075324 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '37810916-b302-4ce4-852a-7ea7c377f9da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e42fd0>]}
[0m20:19:54.134963 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '37810916-b302-4ce4-852a-7ea7c377f9da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103beebd0>]}
[0m20:19:54.136504 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m20:19:54.164387 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m20:19:54.277222 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m20:19:54.278009 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '37810916-b302-4ce4-852a-7ea7c377f9da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102dd8710>]}
[0m20:19:55.834202 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m20:19:55.834921 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '37810916-b302-4ce4-852a-7ea7c377f9da', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105319490>]}
[0m20:19:56.060476 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.staging
- seeds.stripe
[0m20:19:56.066742 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '37810916-b302-4ce4-852a-7ea7c377f9da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104fe6e90>]}
[0m20:19:56.191879 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '37810916-b302-4ce4-852a-7ea7c377f9da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10559fe90>]}
[0m20:19:56.192623 [info ] [MainThread]: Found 7 models, 3 seeds, 11 data tests, 572 macros
[0m20:19:56.193163 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '37810916-b302-4ce4-852a-7ea7c377f9da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10548bf50>]}
[0m20:19:56.196524 [info ] [MainThread]: 
[0m20:19:56.197243 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m20:19:56.201734 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_raw'
[0m20:19:56.213095 [debug] [ThreadPool]: Using snowflake connection "list_raw"
[0m20:19:56.213654 [debug] [ThreadPool]: On list_raw: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_raw"} */
show terse schemas in database raw
    limit 10000
[0m20:19:56.214010 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:19:57.266944 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 1.053 seconds
[0m20:19:57.271558 [debug] [ThreadPool]: On list_raw: Close
[0m20:19:57.849347 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_raw, now create_raw_JAFFLE_SHOP_jaffle_shop)
[0m20:19:57.850975 [debug] [ThreadPool]: Creating schema "database: "raw"
schema: "JAFFLE_SHOP_jaffle_shop"
"
[0m20:19:57.861612 [debug] [ThreadPool]: Using snowflake connection "create_raw_JAFFLE_SHOP_jaffle_shop"
[0m20:19:57.862440 [debug] [ThreadPool]: On create_raw_JAFFLE_SHOP_jaffle_shop: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "create_raw_JAFFLE_SHOP_jaffle_shop"} */
create schema if not exists raw.JAFFLE_SHOP_jaffle_shop
[0m20:19:57.863087 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:19:58.446857 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.584 seconds
[0m20:19:58.448173 [debug] [ThreadPool]: On create_raw_JAFFLE_SHOP_jaffle_shop: Close
[0m20:19:58.590152 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_raw_JAFFLE_SHOP_jaffle_shop, now list_ANALYTICS_JAFFLE_SHOP)
[0m20:19:58.591802 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_raw_JAFFLE_SHOP_jaffle_shop'
[0m20:19:58.622773 [debug] [ThreadPool]: Using snowflake connection "list_ANALYTICS_JAFFLE_SHOP"
[0m20:19:58.623656 [debug] [ThreadPool]: Using snowflake connection "list_raw_JAFFLE_SHOP_jaffle_shop"
[0m20:19:58.624135 [debug] [ThreadPool]: On list_ANALYTICS_JAFFLE_SHOP: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_ANALYTICS_JAFFLE_SHOP"} */
show objects in ANALYTICS.JAFFLE_SHOP limit 10000
[0m20:19:58.624736 [debug] [ThreadPool]: On list_raw_JAFFLE_SHOP_jaffle_shop: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_raw_JAFFLE_SHOP_jaffle_shop"} */
show objects in raw.JAFFLE_SHOP_jaffle_shop limit 10000
[0m20:19:58.625171 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:19:58.625561 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:19:59.117106 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.492 seconds
[0m20:19:59.121598 [debug] [ThreadPool]: On list_ANALYTICS_JAFFLE_SHOP: Close
[0m20:19:59.224423 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.599 seconds
[0m20:19:59.227333 [debug] [ThreadPool]: On list_raw_JAFFLE_SHOP_jaffle_shop: Close
[0m20:19:59.473970 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '37810916-b302-4ce4-852a-7ea7c377f9da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105383f50>]}
[0m20:19:59.475794 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:19:59.476914 [info ] [MainThread]: 
[0m20:19:59.483855 [debug] [Thread-1 (]: Began running node seed.jaffle_shop.raw_customers
[0m20:19:59.485498 [debug] [Thread-2 (]: Began running node seed.jaffle_shop.raw_orders
[0m20:19:59.486651 [debug] [Thread-3 (]: Began running node seed.jaffle_shop.raw_payments
[0m20:19:59.487787 [info ] [Thread-1 (]: 1 of 3 START seed file raw.JAFFLE_SHOP_jaffle_shop.raw_customers ............... [RUN]
[0m20:19:59.489280 [info ] [Thread-2 (]: 2 of 3 START seed file raw.JAFFLE_SHOP_jaffle_shop.raw_orders .................. [RUN]
[0m20:19:59.490538 [info ] [Thread-3 (]: 3 of 3 START seed file raw.JAFFLE_SHOP_jaffle_shop.raw_payments ................ [RUN]
[0m20:19:59.491888 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_ANALYTICS_JAFFLE_SHOP, now seed.jaffle_shop.raw_customers)
[0m20:19:59.492838 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_raw_JAFFLE_SHOP_jaffle_shop, now seed.jaffle_shop.raw_orders)
[0m20:19:59.493832 [debug] [Thread-3 (]: Acquiring new snowflake connection 'seed.jaffle_shop.raw_payments'
[0m20:19:59.494805 [debug] [Thread-1 (]: Began compiling node seed.jaffle_shop.raw_customers
[0m20:19:59.495641 [debug] [Thread-2 (]: Began compiling node seed.jaffle_shop.raw_orders
[0m20:19:59.496345 [debug] [Thread-3 (]: Began compiling node seed.jaffle_shop.raw_payments
[0m20:19:59.497006 [debug] [Thread-1 (]: Began executing node seed.jaffle_shop.raw_customers
[0m20:19:59.497925 [debug] [Thread-2 (]: Began executing node seed.jaffle_shop.raw_orders
[0m20:19:59.498539 [debug] [Thread-3 (]: Began executing node seed.jaffle_shop.raw_payments
[0m20:19:59.585113 [debug] [Thread-3 (]: Using snowflake connection "seed.jaffle_shop.raw_payments"
[0m20:19:59.587754 [debug] [Thread-2 (]: Using snowflake connection "seed.jaffle_shop.raw_orders"
[0m20:19:59.588336 [debug] [Thread-3 (]: On seed.jaffle_shop.raw_payments: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_payments"} */
create table raw.JAFFLE_SHOP_jaffle_shop.raw_payments (id integer,order_id integer,payment_method text,amount integer)
[0m20:19:59.588819 [debug] [Thread-1 (]: Using snowflake connection "seed.jaffle_shop.raw_customers"
[0m20:19:59.589533 [debug] [Thread-2 (]: On seed.jaffle_shop.raw_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_orders"} */
create table raw.JAFFLE_SHOP_jaffle_shop.raw_orders (id integer,user_id integer,order_date date,status text)
[0m20:19:59.589989 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m20:19:59.590407 [debug] [Thread-1 (]: On seed.jaffle_shop.raw_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_customers"} */
create table raw.JAFFLE_SHOP_jaffle_shop.raw_customers (id integer,first_name text,last_name text)
[0m20:19:59.590773 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:19:59.592318 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:20:00.603998 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.011 seconds
[0m20:20:00.622435 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.031 seconds
[0m20:20:00.637661 [debug] [Thread-2 (]: Using snowflake connection "seed.jaffle_shop.raw_orders"
[0m20:20:00.639826 [debug] [Thread-1 (]: Using snowflake connection "seed.jaffle_shop.raw_customers"
[0m20:20:00.640293 [debug] [Thread-2 (]: On seed.jaffle_shop.raw_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_orders"} */
BEGIN
[0m20:20:00.640785 [debug] [Thread-1 (]: On seed.jaffle_shop.raw_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_customers"} */
BEGIN
[0m20:20:00.744034 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.101 seconds
[0m20:20:00.747895 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.106 seconds
[0m20:20:00.753334 [debug] [Thread-1 (]: Using snowflake connection "seed.jaffle_shop.raw_customers"
[0m20:20:00.759110 [debug] [Thread-2 (]: Using snowflake connection "seed.jaffle_shop.raw_orders"
[0m20:20:00.760052 [debug] [Thread-1 (]: On seed.jaffle_shop.raw_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_customers"} */
insert into raw.JAFFLE_SHOP_jaffle_shop.raw_customers (id, first_name, last_name) values
            (%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,...
[0m20:20:00.761936 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.172 seconds
[0m20:20:00.762834 [debug] [Thread-2 (]: On seed.jaffle_shop.raw_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_orders"} */
insert into raw.JAFFLE_SHOP_jaffle_shop.raw_orders (id, user_id, order_date, status) values
            (%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%...
[0m20:20:00.769481 [debug] [Thread-3 (]: Using snowflake connection "seed.jaffle_shop.raw_payments"
[0m20:20:00.773662 [debug] [Thread-3 (]: On seed.jaffle_shop.raw_payments: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_payments"} */
BEGIN
[0m20:20:00.978328 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.203 seconds
[0m20:20:00.987331 [debug] [Thread-3 (]: Using snowflake connection "seed.jaffle_shop.raw_payments"
[0m20:20:00.988578 [debug] [Thread-3 (]: On seed.jaffle_shop.raw_payments: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_payments"} */
insert into raw.JAFFLE_SHOP_jaffle_shop.raw_payments (id, order_id, payment_method, amount) values
            (%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,...
[0m20:20:02.262127 [debug] [Thread-3 (]: SQL status: SUCCESS 113 in 1.273 seconds
[0m20:20:02.263866 [debug] [Thread-2 (]: SQL status: SUCCESS 99 in 1.493 seconds
[0m20:20:02.265185 [debug] [Thread-3 (]: Using snowflake connection "seed.jaffle_shop.raw_payments"
[0m20:20:02.266500 [debug] [Thread-2 (]: Using snowflake connection "seed.jaffle_shop.raw_orders"
[0m20:20:02.267429 [debug] [Thread-3 (]: On seed.jaffle_shop.raw_payments: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_payments"} */
COMMIT
[0m20:20:02.268204 [debug] [Thread-2 (]: On seed.jaffle_shop.raw_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_orders"} */
COMMIT
[0m20:20:02.490845 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.220 seconds
[0m20:20:02.505726 [debug] [Thread-2 (]: Writing runtime SQL for node "seed.jaffle_shop.raw_orders"
[0m20:20:02.539910 [debug] [Thread-2 (]: On seed.jaffle_shop.raw_orders: Close
[0m20:20:02.677225 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '37810916-b302-4ce4-852a-7ea7c377f9da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104146b10>]}
[0m20:20:02.678935 [info ] [Thread-2 (]: 2 of 3 OK loaded seed file JAFFLE_SHOP_jaffle_shop.raw_orders .................. [[32mINSERT 99[0m in 3.18s]
[0m20:20:02.680476 [debug] [Thread-2 (]: Finished running node seed.jaffle_shop.raw_orders
[0m20:20:03.183370 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.914 seconds
[0m20:20:03.186193 [debug] [Thread-3 (]: Writing runtime SQL for node "seed.jaffle_shop.raw_payments"
[0m20:20:03.191710 [debug] [Thread-3 (]: On seed.jaffle_shop.raw_payments: Close
[0m20:20:03.333711 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '37810916-b302-4ce4-852a-7ea7c377f9da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f36a50>]}
[0m20:20:03.334645 [info ] [Thread-3 (]: 3 of 3 OK loaded seed file JAFFLE_SHOP_jaffle_shop.raw_payments ................ [[32mINSERT 113[0m in 3.84s]
[0m20:20:03.335779 [debug] [Thread-3 (]: Finished running node seed.jaffle_shop.raw_payments
[0m20:20:03.695013 [debug] [Thread-1 (]: SQL status: SUCCESS 100 in 2.931 seconds
[0m20:20:03.696641 [debug] [Thread-1 (]: Using snowflake connection "seed.jaffle_shop.raw_customers"
[0m20:20:03.697780 [debug] [Thread-1 (]: On seed.jaffle_shop.raw_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_customers"} */
COMMIT
[0m20:20:04.103124 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.404 seconds
[0m20:20:04.105111 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.jaffle_shop.raw_customers"
[0m20:20:04.110183 [debug] [Thread-1 (]: On seed.jaffle_shop.raw_customers: Close
[0m20:20:04.266910 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '37810916-b302-4ce4-852a-7ea7c377f9da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1035b2450>]}
[0m20:20:04.268720 [info ] [Thread-1 (]: 1 of 3 OK loaded seed file JAFFLE_SHOP_jaffle_shop.raw_customers ............... [[32mINSERT 100[0m in 4.78s]
[0m20:20:04.270555 [debug] [Thread-1 (]: Finished running node seed.jaffle_shop.raw_customers
[0m20:20:04.274427 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:20:04.275947 [debug] [MainThread]: Connection 'seed.jaffle_shop.raw_customers' was properly closed.
[0m20:20:04.277015 [debug] [MainThread]: Connection 'seed.jaffle_shop.raw_orders' was properly closed.
[0m20:20:04.277652 [debug] [MainThread]: Connection 'seed.jaffle_shop.raw_payments' was properly closed.
[0m20:20:04.278505 [info ] [MainThread]: 
[0m20:20:04.279649 [info ] [MainThread]: Finished running 3 seeds in 0 hours 0 minutes and 8.08 seconds (8.08s).
[0m20:20:04.282007 [debug] [MainThread]: Command end result
[0m20:20:04.325212 [info ] [MainThread]: 
[0m20:20:04.325791 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:20:04.326169 [info ] [MainThread]: 
[0m20:20:04.326536 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m20:20:04.328365 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": true, "command_wall_clock_time": 10.966737, "process_user_time": 4.839944, "process_kernel_time": 0.596647, "process_mem_max_rss": "134770688", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m20:20:04.328990 [debug] [MainThread]: Command `dbt seed` succeeded at 20:20:04.328885 after 10.97 seconds
[0m20:20:04.329436 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x100c51410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x100ba0310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x100ba0c10>]}
[0m20:20:04.329843 [debug] [MainThread]: Flushing usage events
[0m20:23:44.333420 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a1ec8d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a258310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a258c50>]}


============================== 20:23:44.340887 | 6c2cf7fc-509f-4742-bdc4-eeee91636810 ==============================
[0m20:23:44.340887 [info ] [MainThread]: Running with dbt=1.8.7
[0m20:23:44.341903 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/ben/Dbt Certification/dbt-tutorial/logs', 'profiles_dir': '/Users/ben/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt seed', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:23:44.857011 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6c2cf7fc-509f-4742-bdc4-eeee91636810', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aee0390>]}
[0m20:23:44.909853 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6c2cf7fc-509f-4742-bdc4-eeee91636810', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109c9eb90>]}
[0m20:23:44.911086 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m20:23:44.936551 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m20:23:45.043044 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m20:23:45.043882 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '6c2cf7fc-509f-4742-bdc4-eeee91636810', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108e70850>]}
[0m20:23:46.601479 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m20:23:46.602231 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '6c2cf7fc-509f-4742-bdc4-eeee91636810', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a237e10>]}
[0m20:23:46.819370 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.staging
- seeds.stripe
[0m20:23:46.825747 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6c2cf7fc-509f-4742-bdc4-eeee91636810', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b307a90>]}
[0m20:23:46.928979 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6c2cf7fc-509f-4742-bdc4-eeee91636810', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b533150>]}
[0m20:23:46.929556 [info ] [MainThread]: Found 7 models, 3 seeds, 11 data tests, 572 macros
[0m20:23:46.929996 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6c2cf7fc-509f-4742-bdc4-eeee91636810', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b45f1d0>]}
[0m20:23:46.932517 [info ] [MainThread]: 
[0m20:23:46.933316 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m20:23:46.939010 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_raw'
[0m20:23:46.948805 [debug] [ThreadPool]: Using snowflake connection "list_raw"
[0m20:23:46.949473 [debug] [ThreadPool]: On list_raw: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_raw"} */
show terse schemas in database raw
    limit 10000
[0m20:23:46.949953 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:23:47.692910 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.743 seconds
[0m20:23:47.697250 [debug] [ThreadPool]: On list_raw: Close
[0m20:23:47.832176 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_raw, now create_raw_JAFFLE_SHOP_jaffle_shop)
[0m20:23:47.833808 [debug] [ThreadPool]: Creating schema "database: "raw"
schema: "JAFFLE_SHOP_jaffle_shop"
"
[0m20:23:47.844168 [debug] [ThreadPool]: Using snowflake connection "create_raw_JAFFLE_SHOP_jaffle_shop"
[0m20:23:47.844982 [debug] [ThreadPool]: On create_raw_JAFFLE_SHOP_jaffle_shop: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "create_raw_JAFFLE_SHOP_jaffle_shop"} */
create schema if not exists raw.JAFFLE_SHOP_jaffle_shop
[0m20:23:47.845644 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:23:48.491095 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.645 seconds
[0m20:23:48.494190 [debug] [ThreadPool]: On create_raw_JAFFLE_SHOP_jaffle_shop: Close
[0m20:23:48.629559 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_raw_JAFFLE_SHOP_jaffle_shop, now list_ANALYTICS_JAFFLE_SHOP)
[0m20:23:48.631186 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_raw_JAFFLE_SHOP_jaffle_shop'
[0m20:23:48.649955 [debug] [ThreadPool]: Using snowflake connection "list_ANALYTICS_JAFFLE_SHOP"
[0m20:23:48.653730 [debug] [ThreadPool]: Using snowflake connection "list_raw_JAFFLE_SHOP_jaffle_shop"
[0m20:23:48.654313 [debug] [ThreadPool]: On list_ANALYTICS_JAFFLE_SHOP: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_ANALYTICS_JAFFLE_SHOP"} */
show objects in ANALYTICS.JAFFLE_SHOP limit 10000
[0m20:23:48.654838 [debug] [ThreadPool]: On list_raw_JAFFLE_SHOP_jaffle_shop: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_raw_JAFFLE_SHOP_jaffle_shop"} */
show objects in raw.JAFFLE_SHOP_jaffle_shop limit 10000
[0m20:23:48.655322 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:23:48.655789 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:23:49.237736 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.582 seconds
[0m20:23:49.242051 [debug] [ThreadPool]: On list_raw_JAFFLE_SHOP_jaffle_shop: Close
[0m20:23:49.256032 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.601 seconds
[0m20:23:49.259779 [debug] [ThreadPool]: On list_ANALYTICS_JAFFLE_SHOP: Close
[0m20:23:49.417792 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6c2cf7fc-509f-4742-bdc4-eeee91636810', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b3762d0>]}
[0m20:23:49.419604 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:23:49.420764 [info ] [MainThread]: 
[0m20:23:49.427005 [debug] [Thread-1 (]: Began running node seed.jaffle_shop.raw_customers
[0m20:23:49.428130 [debug] [Thread-2 (]: Began running node seed.jaffle_shop.raw_orders
[0m20:23:49.428946 [debug] [Thread-3 (]: Began running node seed.jaffle_shop.raw_payments
[0m20:23:49.430223 [info ] [Thread-1 (]: 1 of 3 START seed file raw.JAFFLE_SHOP_jaffle_shop.raw_customers ............... [RUN]
[0m20:23:49.431643 [info ] [Thread-2 (]: 2 of 3 START seed file raw.JAFFLE_SHOP_jaffle_shop.raw_orders .................. [RUN]
[0m20:23:49.432850 [info ] [Thread-3 (]: 3 of 3 START seed file raw.JAFFLE_SHOP_jaffle_shop.raw_payments ................ [RUN]
[0m20:23:49.433735 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_ANALYTICS_JAFFLE_SHOP, now seed.jaffle_shop.raw_customers)
[0m20:23:49.435506 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_raw_JAFFLE_SHOP_jaffle_shop, now seed.jaffle_shop.raw_orders)
[0m20:23:49.436504 [debug] [Thread-3 (]: Acquiring new snowflake connection 'seed.jaffle_shop.raw_payments'
[0m20:23:49.437242 [debug] [Thread-1 (]: Began compiling node seed.jaffle_shop.raw_customers
[0m20:23:49.437926 [debug] [Thread-2 (]: Began compiling node seed.jaffle_shop.raw_orders
[0m20:23:49.438587 [debug] [Thread-3 (]: Began compiling node seed.jaffle_shop.raw_payments
[0m20:23:49.439250 [debug] [Thread-1 (]: Began executing node seed.jaffle_shop.raw_customers
[0m20:23:49.439798 [debug] [Thread-2 (]: Began executing node seed.jaffle_shop.raw_orders
[0m20:23:49.440345 [debug] [Thread-3 (]: Began executing node seed.jaffle_shop.raw_payments
[0m20:23:49.508245 [debug] [Thread-2 (]: Using snowflake connection "seed.jaffle_shop.raw_orders"
[0m20:23:49.508765 [debug] [Thread-1 (]: Using snowflake connection "seed.jaffle_shop.raw_customers"
[0m20:23:49.512412 [debug] [Thread-3 (]: Using snowflake connection "seed.jaffle_shop.raw_payments"
[0m20:23:49.512851 [debug] [Thread-2 (]: On seed.jaffle_shop.raw_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_orders"} */
create table raw.JAFFLE_SHOP_jaffle_shop.raw_orders (id integer,user_id integer,order_date date,status text)
[0m20:23:49.513270 [debug] [Thread-1 (]: On seed.jaffle_shop.raw_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_customers"} */
create table raw.JAFFLE_SHOP_jaffle_shop.raw_customers (id integer,first_name text,last_name text)
[0m20:23:49.513669 [debug] [Thread-3 (]: On seed.jaffle_shop.raw_payments: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_payments"} */
create table raw.JAFFLE_SHOP_jaffle_shop.raw_payments (id integer,order_id integer,payment_method text,amount integer)
[0m20:23:49.514152 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:23:49.514512 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:23:49.514909 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m20:23:50.036384 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.521 seconds
[0m20:23:50.039457 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.524 seconds
[0m20:23:50.060569 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.546 seconds
[0m20:23:50.076363 [debug] [Thread-3 (]: Using snowflake connection "seed.jaffle_shop.raw_payments"
[0m20:23:50.079621 [debug] [Thread-1 (]: Using snowflake connection "seed.jaffle_shop.raw_customers"
[0m20:23:50.082758 [debug] [Thread-2 (]: Using snowflake connection "seed.jaffle_shop.raw_orders"
[0m20:23:50.083342 [debug] [Thread-3 (]: On seed.jaffle_shop.raw_payments: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_payments"} */
BEGIN
[0m20:23:50.083782 [debug] [Thread-1 (]: On seed.jaffle_shop.raw_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_customers"} */
BEGIN
[0m20:23:50.084180 [debug] [Thread-2 (]: On seed.jaffle_shop.raw_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_orders"} */
BEGIN
[0m20:23:50.183211 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.097 seconds
[0m20:23:50.186591 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.102 seconds
[0m20:23:50.189465 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.102 seconds
[0m20:23:50.195078 [debug] [Thread-1 (]: Using snowflake connection "seed.jaffle_shop.raw_customers"
[0m20:23:50.201017 [debug] [Thread-3 (]: Using snowflake connection "seed.jaffle_shop.raw_payments"
[0m20:23:50.206133 [debug] [Thread-2 (]: Using snowflake connection "seed.jaffle_shop.raw_orders"
[0m20:23:50.206937 [debug] [Thread-1 (]: On seed.jaffle_shop.raw_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_customers"} */
insert into raw.JAFFLE_SHOP_jaffle_shop.raw_customers (id, first_name, last_name) values
            (%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,...
[0m20:23:50.207686 [debug] [Thread-3 (]: On seed.jaffle_shop.raw_payments: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_payments"} */
insert into raw.JAFFLE_SHOP_jaffle_shop.raw_payments (id, order_id, payment_method, amount) values
            (%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,...
[0m20:23:50.208400 [debug] [Thread-2 (]: On seed.jaffle_shop.raw_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_orders"} */
insert into raw.JAFFLE_SHOP_jaffle_shop.raw_orders (id, user_id, order_date, status) values
            (%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%...
[0m20:23:50.774392 [debug] [Thread-2 (]: SQL status: SUCCESS 99 in 0.560 seconds
[0m20:23:50.776300 [debug] [Thread-2 (]: Using snowflake connection "seed.jaffle_shop.raw_orders"
[0m20:23:50.777522 [debug] [Thread-2 (]: On seed.jaffle_shop.raw_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_orders"} */
COMMIT
[0m20:23:50.783762 [debug] [Thread-3 (]: SQL status: SUCCESS 113 in 0.573 seconds
[0m20:23:50.785847 [debug] [Thread-3 (]: Using snowflake connection "seed.jaffle_shop.raw_payments"
[0m20:23:50.787648 [debug] [Thread-3 (]: On seed.jaffle_shop.raw_payments: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_payments"} */
COMMIT
[0m20:23:50.979601 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.190 seconds
[0m20:23:50.981826 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.203 seconds
[0m20:23:50.998960 [debug] [Thread-3 (]: Writing runtime SQL for node "seed.jaffle_shop.raw_payments"
[0m20:23:50.999982 [debug] [Thread-2 (]: Writing runtime SQL for node "seed.jaffle_shop.raw_orders"
[0m20:23:51.045003 [debug] [Thread-3 (]: On seed.jaffle_shop.raw_payments: Close
[0m20:23:51.045526 [debug] [Thread-2 (]: On seed.jaffle_shop.raw_orders: Close
[0m20:23:51.200418 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6c2cf7fc-509f-4742-bdc4-eeee91636810', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a1ede10>]}
[0m20:23:51.201996 [info ] [Thread-3 (]: 3 of 3 OK loaded seed file JAFFLE_SHOP_jaffle_shop.raw_payments ................ [[32mINSERT 113[0m in 1.76s]
[0m20:23:51.203482 [debug] [Thread-3 (]: Finished running node seed.jaffle_shop.raw_payments
[0m20:23:51.274217 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6c2cf7fc-509f-4742-bdc4-eeee91636810', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10af0e9d0>]}
[0m20:23:51.275991 [info ] [Thread-2 (]: 2 of 3 OK loaded seed file JAFFLE_SHOP_jaffle_shop.raw_orders .................. [[32mINSERT 99[0m in 1.84s]
[0m20:23:51.277785 [debug] [Thread-2 (]: Finished running node seed.jaffle_shop.raw_orders
[0m20:23:51.400581 [debug] [Thread-1 (]: SQL status: SUCCESS 100 in 1.191 seconds
[0m20:23:51.402247 [debug] [Thread-1 (]: Using snowflake connection "seed.jaffle_shop.raw_customers"
[0m20:23:51.403391 [debug] [Thread-1 (]: On seed.jaffle_shop.raw_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_customers"} */
COMMIT
[0m20:23:51.597595 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.193 seconds
[0m20:23:51.599749 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.jaffle_shop.raw_customers"
[0m20:23:51.605592 [debug] [Thread-1 (]: On seed.jaffle_shop.raw_customers: Close
[0m20:23:51.740123 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6c2cf7fc-509f-4742-bdc4-eeee91636810', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b05ab90>]}
[0m20:23:51.741304 [info ] [Thread-1 (]: 1 of 3 OK loaded seed file JAFFLE_SHOP_jaffle_shop.raw_customers ............... [[32mINSERT 100[0m in 2.31s]
[0m20:23:51.742478 [debug] [Thread-1 (]: Finished running node seed.jaffle_shop.raw_customers
[0m20:23:51.744803 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:23:51.745411 [debug] [MainThread]: Connection 'seed.jaffle_shop.raw_customers' was properly closed.
[0m20:23:51.745930 [debug] [MainThread]: Connection 'seed.jaffle_shop.raw_orders' was properly closed.
[0m20:23:51.746423 [debug] [MainThread]: Connection 'seed.jaffle_shop.raw_payments' was properly closed.
[0m20:23:51.747023 [info ] [MainThread]: 
[0m20:23:51.747549 [info ] [MainThread]: Finished running 3 seeds in 0 hours 0 minutes and 4.81 seconds (4.81s).
[0m20:23:51.748865 [debug] [MainThread]: Command end result
[0m20:23:51.788136 [info ] [MainThread]: 
[0m20:23:51.788711 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:23:51.789187 [info ] [MainThread]: 
[0m20:23:51.789570 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m20:23:51.790969 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": true, "command_wall_clock_time": 7.5319963, "process_user_time": 4.416386, "process_kernel_time": 0.395834, "process_mem_max_rss": "137261056", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m20:23:51.791567 [debug] [MainThread]: Command `dbt seed` succeeded at 20:23:51.791462 after 7.53 seconds
[0m20:23:51.791994 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a23fed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c50350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c50d50>]}
[0m20:23:51.792378 [debug] [MainThread]: Flushing usage events
[0m20:25:40.501681 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1083ef1d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1083ef850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108447950>]}


============================== 20:25:40.507689 | 5d5a5210-8c5b-423b-a3be-3d6e1aec94b6 ==============================
[0m20:25:40.507689 [info ] [MainThread]: Running with dbt=1.8.7
[0m20:25:40.508436 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/ben/Dbt Certification/dbt-tutorial/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/ben/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt seed', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:25:40.854420 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5d5a5210-8c5b-423b-a3be-3d6e1aec94b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1091275d0>]}
[0m20:25:40.908026 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5d5a5210-8c5b-423b-a3be-3d6e1aec94b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ea6b50>]}
[0m20:25:40.909442 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m20:25:40.936558 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m20:25:41.048100 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m20:25:41.048850 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '5d5a5210-8c5b-423b-a3be-3d6e1aec94b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107090990>]}
[0m20:25:42.473640 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m20:25:42.474255 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '5d5a5210-8c5b-423b-a3be-3d6e1aec94b6', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109292b10>]}
[0m20:25:42.689602 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.staging
[0m20:25:42.695288 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5d5a5210-8c5b-423b-a3be-3d6e1aec94b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1092c67d0>]}
[0m20:25:42.800058 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5d5a5210-8c5b-423b-a3be-3d6e1aec94b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1098a9750>]}
[0m20:25:42.800823 [info ] [MainThread]: Found 7 models, 3 seeds, 11 data tests, 572 macros
[0m20:25:42.801315 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5d5a5210-8c5b-423b-a3be-3d6e1aec94b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1095dabd0>]}
[0m20:25:42.803351 [info ] [MainThread]: 
[0m20:25:42.803968 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m20:25:42.808382 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_raw'
[0m20:25:42.809229 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_raw'
[0m20:25:42.819182 [debug] [ThreadPool]: Using snowflake connection "list_raw"
[0m20:25:42.822378 [debug] [ThreadPool]: Using snowflake connection "list_raw"
[0m20:25:42.822934 [debug] [ThreadPool]: On list_raw: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_raw"} */
show terse schemas in database raw
    limit 10000
[0m20:25:42.823517 [debug] [ThreadPool]: On list_raw: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_raw"} */
show terse schemas in database raw
    limit 10000
[0m20:25:42.823980 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:25:42.824423 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:25:43.569610 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.745 seconds
[0m20:25:43.574296 [debug] [ThreadPool]: On list_raw: Close
[0m20:25:43.885330 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 1.061 seconds
[0m20:25:43.889443 [debug] [ThreadPool]: On list_raw: Close
[0m20:25:44.053465 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_raw, now create_raw_JAFFLE_SHOP)
[0m20:25:44.054790 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_raw, now create_raw_JAFFLE_SHOP_stripe)
[0m20:25:44.056286 [debug] [ThreadPool]: Creating schema "database: "raw"
schema: "JAFFLE_SHOP"
"
[0m20:25:44.057593 [debug] [ThreadPool]: Creating schema "database: "raw"
schema: "JAFFLE_SHOP_stripe"
"
[0m20:25:44.070060 [debug] [ThreadPool]: Using snowflake connection "create_raw_JAFFLE_SHOP"
[0m20:25:44.074287 [debug] [ThreadPool]: Using snowflake connection "create_raw_JAFFLE_SHOP_stripe"
[0m20:25:44.075111 [debug] [ThreadPool]: On create_raw_JAFFLE_SHOP: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "create_raw_JAFFLE_SHOP"} */
create schema if not exists raw.JAFFLE_SHOP
[0m20:25:44.075854 [debug] [ThreadPool]: On create_raw_JAFFLE_SHOP_stripe: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "create_raw_JAFFLE_SHOP_stripe"} */
create schema if not exists raw.JAFFLE_SHOP_stripe
[0m20:25:44.076502 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:25:44.077122 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:25:44.871879 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.795 seconds
[0m20:25:44.875003 [debug] [ThreadPool]: On create_raw_JAFFLE_SHOP: Close
[0m20:25:45.100544 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.023 seconds
[0m20:25:45.103508 [debug] [ThreadPool]: On create_raw_JAFFLE_SHOP_stripe: Close
[0m20:25:45.274695 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_raw_JAFFLE_SHOP_stripe, now list_ANALYTICS_JAFFLE_SHOP)
[0m20:25:45.276155 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_raw_JAFFLE_SHOP, now list_raw_JAFFLE_SHOP)
[0m20:25:45.277896 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_raw_JAFFLE_SHOP_stripe'
[0m20:25:45.294076 [debug] [ThreadPool]: Using snowflake connection "list_ANALYTICS_JAFFLE_SHOP"
[0m20:25:45.297348 [debug] [ThreadPool]: Using snowflake connection "list_raw_JAFFLE_SHOP"
[0m20:25:45.300389 [debug] [ThreadPool]: Using snowflake connection "list_raw_JAFFLE_SHOP_stripe"
[0m20:25:45.300921 [debug] [ThreadPool]: On list_ANALYTICS_JAFFLE_SHOP: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_ANALYTICS_JAFFLE_SHOP"} */
show objects in ANALYTICS.JAFFLE_SHOP limit 10000
[0m20:25:45.301388 [debug] [ThreadPool]: On list_raw_JAFFLE_SHOP: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_raw_JAFFLE_SHOP"} */
show objects in raw.JAFFLE_SHOP limit 10000
[0m20:25:45.301833 [debug] [ThreadPool]: On list_raw_JAFFLE_SHOP_stripe: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_raw_JAFFLE_SHOP_stripe"} */
show objects in raw.JAFFLE_SHOP_stripe limit 10000
[0m20:25:45.302269 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:25:45.302646 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:25:45.303017 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:25:45.735214 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.432 seconds
[0m20:25:45.739499 [debug] [ThreadPool]: On list_raw_JAFFLE_SHOP: Close
[0m20:25:45.782117 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.479 seconds
[0m20:25:45.786403 [debug] [ThreadPool]: On list_raw_JAFFLE_SHOP_stripe: Close
[0m20:25:45.995845 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.693 seconds
[0m20:25:46.001176 [debug] [ThreadPool]: On list_ANALYTICS_JAFFLE_SHOP: Close
[0m20:25:46.171570 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5d5a5210-8c5b-423b-a3be-3d6e1aec94b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109581b90>]}
[0m20:25:46.173302 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:25:46.174478 [info ] [MainThread]: 
[0m20:25:46.179274 [debug] [Thread-1 (]: Began running node seed.jaffle_shop.raw_customers
[0m20:25:46.180438 [debug] [Thread-2 (]: Began running node seed.jaffle_shop.raw_orders
[0m20:25:46.181431 [debug] [Thread-3 (]: Began running node seed.jaffle_shop.raw_payments
[0m20:25:46.182367 [info ] [Thread-1 (]: 1 of 3 START seed file raw.JAFFLE_SHOP.raw_customers ........................... [RUN]
[0m20:25:46.183506 [info ] [Thread-2 (]: 2 of 3 START seed file raw.JAFFLE_SHOP.raw_orders .............................. [RUN]
[0m20:25:46.184553 [info ] [Thread-3 (]: 3 of 3 START seed file raw.JAFFLE_SHOP_stripe.raw_payments ..................... [RUN]
[0m20:25:46.185718 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_ANALYTICS_JAFFLE_SHOP, now seed.jaffle_shop.raw_customers)
[0m20:25:46.186899 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_raw_JAFFLE_SHOP, now seed.jaffle_shop.raw_orders)
[0m20:25:46.187654 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_raw_JAFFLE_SHOP_stripe, now seed.jaffle_shop.raw_payments)
[0m20:25:46.188589 [debug] [Thread-1 (]: Began compiling node seed.jaffle_shop.raw_customers
[0m20:25:46.189318 [debug] [Thread-2 (]: Began compiling node seed.jaffle_shop.raw_orders
[0m20:25:46.190720 [debug] [Thread-3 (]: Began compiling node seed.jaffle_shop.raw_payments
[0m20:25:46.191808 [debug] [Thread-1 (]: Began executing node seed.jaffle_shop.raw_customers
[0m20:25:46.192643 [debug] [Thread-2 (]: Began executing node seed.jaffle_shop.raw_orders
[0m20:25:46.193297 [debug] [Thread-3 (]: Began executing node seed.jaffle_shop.raw_payments
[0m20:25:46.274439 [debug] [Thread-2 (]: Using snowflake connection "seed.jaffle_shop.raw_orders"
[0m20:25:46.275047 [debug] [Thread-1 (]: Using snowflake connection "seed.jaffle_shop.raw_customers"
[0m20:25:46.277713 [debug] [Thread-3 (]: Using snowflake connection "seed.jaffle_shop.raw_payments"
[0m20:25:46.278119 [debug] [Thread-2 (]: On seed.jaffle_shop.raw_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_orders"} */
create table raw.JAFFLE_SHOP.raw_orders (id integer,user_id integer,order_date date,status text)
[0m20:25:46.278522 [debug] [Thread-1 (]: On seed.jaffle_shop.raw_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_customers"} */
create table raw.JAFFLE_SHOP.raw_customers (id integer,first_name text,last_name text)
[0m20:25:46.278904 [debug] [Thread-3 (]: On seed.jaffle_shop.raw_payments: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_payments"} */
create table raw.JAFFLE_SHOP_stripe.raw_payments (id integer,order_id integer,payment_method text,amount integer)
[0m20:25:46.279275 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:25:46.279625 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:25:46.279971 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:25:46.804664 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.525 seconds
[0m20:25:46.836017 [debug] [Thread-2 (]: Using snowflake connection "seed.jaffle_shop.raw_orders"
[0m20:25:46.836696 [debug] [Thread-2 (]: On seed.jaffle_shop.raw_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_orders"} */
BEGIN
[0m20:25:46.925060 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.645 seconds
[0m20:25:46.933537 [debug] [Thread-3 (]: Using snowflake connection "seed.jaffle_shop.raw_payments"
[0m20:25:46.936244 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.099 seconds
[0m20:25:46.937207 [debug] [Thread-3 (]: On seed.jaffle_shop.raw_payments: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_payments"} */
BEGIN
[0m20:25:46.943592 [debug] [Thread-2 (]: Using snowflake connection "seed.jaffle_shop.raw_orders"
[0m20:25:46.946376 [debug] [Thread-2 (]: On seed.jaffle_shop.raw_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_orders"} */
insert into raw.JAFFLE_SHOP.raw_orders (id, user_id, order_date, status) values
            (%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),...
[0m20:25:46.964608 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.685 seconds
[0m20:25:46.968431 [debug] [Thread-1 (]: Using snowflake connection "seed.jaffle_shop.raw_customers"
[0m20:25:46.969062 [debug] [Thread-1 (]: On seed.jaffle_shop.raw_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_customers"} */
BEGIN
[0m20:25:47.048237 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.104 seconds
[0m20:25:47.056867 [debug] [Thread-3 (]: Using snowflake connection "seed.jaffle_shop.raw_payments"
[0m20:25:47.057937 [debug] [Thread-3 (]: On seed.jaffle_shop.raw_payments: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_payments"} */
insert into raw.JAFFLE_SHOP_stripe.raw_payments (id, order_id, payment_method, amount) values
            (%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s...
[0m20:25:47.072816 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.103 seconds
[0m20:25:47.078110 [debug] [Thread-1 (]: Using snowflake connection "seed.jaffle_shop.raw_customers"
[0m20:25:47.078902 [debug] [Thread-1 (]: On seed.jaffle_shop.raw_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_customers"} */
insert into raw.JAFFLE_SHOP.raw_customers (id, first_name, last_name) values
            (%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%...
[0m20:25:47.704477 [debug] [Thread-1 (]: SQL status: SUCCESS 100 in 0.624 seconds
[0m20:25:47.706296 [debug] [Thread-1 (]: Using snowflake connection "seed.jaffle_shop.raw_customers"
[0m20:25:47.707417 [debug] [Thread-1 (]: On seed.jaffle_shop.raw_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_customers"} */
COMMIT
[0m20:25:47.943706 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.235 seconds
[0m20:25:47.958113 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.jaffle_shop.raw_customers"
[0m20:25:47.991587 [debug] [Thread-1 (]: On seed.jaffle_shop.raw_customers: Close
[0m20:25:48.133236 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5d5a5210-8c5b-423b-a3be-3d6e1aec94b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1093f7790>]}
[0m20:25:48.134994 [info ] [Thread-1 (]: 1 of 3 OK loaded seed file JAFFLE_SHOP.raw_customers ........................... [[32mINSERT 100[0m in 1.95s]
[0m20:25:48.136681 [debug] [Thread-1 (]: Finished running node seed.jaffle_shop.raw_customers
[0m20:25:48.322093 [debug] [Thread-2 (]: SQL status: SUCCESS 99 in 1.374 seconds
[0m20:25:48.325564 [debug] [Thread-3 (]: SQL status: SUCCESS 113 in 1.267 seconds
[0m20:25:48.326930 [debug] [Thread-2 (]: Using snowflake connection "seed.jaffle_shop.raw_orders"
[0m20:25:48.328328 [debug] [Thread-3 (]: Using snowflake connection "seed.jaffle_shop.raw_payments"
[0m20:25:48.329296 [debug] [Thread-2 (]: On seed.jaffle_shop.raw_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_orders"} */
COMMIT
[0m20:25:48.330205 [debug] [Thread-3 (]: On seed.jaffle_shop.raw_payments: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_payments"} */
COMMIT
[0m20:25:48.530799 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.200 seconds
[0m20:25:48.531578 [debug] [Thread-2 (]: Writing runtime SQL for node "seed.jaffle_shop.raw_orders"
[0m20:25:48.533872 [debug] [Thread-2 (]: On seed.jaffle_shop.raw_orders: Close
[0m20:25:48.596723 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.265 seconds
[0m20:25:48.597496 [debug] [Thread-3 (]: Writing runtime SQL for node "seed.jaffle_shop.raw_payments"
[0m20:25:48.599920 [debug] [Thread-3 (]: On seed.jaffle_shop.raw_payments: Close
[0m20:25:48.713801 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5d5a5210-8c5b-423b-a3be-3d6e1aec94b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109242210>]}
[0m20:25:48.715905 [info ] [Thread-2 (]: 2 of 3 OK loaded seed file JAFFLE_SHOP.raw_orders .............................. [[32mINSERT 99[0m in 2.53s]
[0m20:25:48.717667 [debug] [Thread-2 (]: Finished running node seed.jaffle_shop.raw_orders
[0m20:25:48.735485 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5d5a5210-8c5b-423b-a3be-3d6e1aec94b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10922cc10>]}
[0m20:25:48.736597 [info ] [Thread-3 (]: 3 of 3 OK loaded seed file JAFFLE_SHOP_stripe.raw_payments ..................... [[32mINSERT 113[0m in 2.55s]
[0m20:25:48.737625 [debug] [Thread-3 (]: Finished running node seed.jaffle_shop.raw_payments
[0m20:25:48.739968 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:25:48.740575 [debug] [MainThread]: Connection 'seed.jaffle_shop.raw_customers' was properly closed.
[0m20:25:48.741128 [debug] [MainThread]: Connection 'seed.jaffle_shop.raw_orders' was properly closed.
[0m20:25:48.741634 [debug] [MainThread]: Connection 'seed.jaffle_shop.raw_payments' was properly closed.
[0m20:25:48.742317 [info ] [MainThread]: 
[0m20:25:48.743750 [info ] [MainThread]: Finished running 3 seeds in 0 hours 0 minutes and 5.94 seconds (5.94s).
[0m20:25:48.745400 [debug] [MainThread]: Command end result
[0m20:25:48.786072 [info ] [MainThread]: 
[0m20:25:48.786701 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:25:48.787145 [info ] [MainThread]: 
[0m20:25:48.787613 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m20:25:48.789248 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": true, "command_wall_clock_time": 8.363503, "process_user_time": 4.60804, "process_kernel_time": 0.415319, "process_mem_max_rss": "135852032", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m20:25:48.789981 [debug] [MainThread]: Command `dbt seed` succeeded at 20:25:48.789873 after 8.36 seconds
[0m20:25:48.790439 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f09410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e58310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e58c10>]}
[0m20:25:48.790850 [debug] [MainThread]: Flushing usage events
[0m20:31:53.108728 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10759b010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10760c850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10760d190>]}


============================== 20:31:53.119720 | 183d0450-3cc5-4c73-a4b3-e026fac24f79 ==============================
[0m20:31:53.119720 [info ] [MainThread]: Running with dbt=1.8.7
[0m20:31:53.120763 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/ben/Dbt Certification/dbt-tutorial/logs', 'profiles_dir': '/Users/ben/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt seed', 'send_anonymous_usage_stats': 'True'}
[0m20:31:53.667012 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '183d0450-3cc5-4c73-a4b3-e026fac24f79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108277ad0>]}
[0m20:31:53.722413 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '183d0450-3cc5-4c73-a4b3-e026fac24f79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107062b10>]}
[0m20:31:53.724237 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m20:31:53.752803 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m20:31:53.862058 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m20:31:53.862784 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '183d0450-3cc5-4c73-a4b3-e026fac24f79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1062887d0>]}
[0m20:31:55.365210 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m20:31:55.365896 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '183d0450-3cc5-4c73-a4b3-e026fac24f79', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1085658d0>]}
[0m20:31:55.583327 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.staging
- seeds.stripe
[0m20:31:55.589429 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '183d0450-3cc5-4c73-a4b3-e026fac24f79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1087bc3d0>]}
[0m20:31:55.712706 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '183d0450-3cc5-4c73-a4b3-e026fac24f79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1088a2350>]}
[0m20:31:55.713323 [info ] [MainThread]: Found 7 models, 3 seeds, 11 data tests, 572 macros
[0m20:31:55.713782 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '183d0450-3cc5-4c73-a4b3-e026fac24f79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10891b250>]}
[0m20:31:55.716085 [info ] [MainThread]: 
[0m20:31:55.717048 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m20:31:55.722730 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_raw'
[0m20:31:55.731820 [debug] [ThreadPool]: Using snowflake connection "list_raw"
[0m20:31:55.732515 [debug] [ThreadPool]: On list_raw: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_raw"} */
show terse schemas in database raw
    limit 10000
[0m20:31:55.733061 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:31:56.579656 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.846 seconds
[0m20:31:56.598329 [debug] [ThreadPool]: On list_raw: Close
[0m20:31:56.747023 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_raw, now create_raw_JAFFLE_SHOP)
[0m20:31:56.748672 [debug] [ThreadPool]: Creating schema "database: "raw"
schema: "JAFFLE_SHOP"
"
[0m20:31:56.759394 [debug] [ThreadPool]: Using snowflake connection "create_raw_JAFFLE_SHOP"
[0m20:31:56.760163 [debug] [ThreadPool]: On create_raw_JAFFLE_SHOP: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "create_raw_JAFFLE_SHOP"} */
create schema if not exists raw.JAFFLE_SHOP
[0m20:31:56.760821 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:31:57.257845 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.497 seconds
[0m20:31:57.260841 [debug] [ThreadPool]: On create_raw_JAFFLE_SHOP: Close
[0m20:31:57.415302 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_raw_JAFFLE_SHOP, now list_raw_JAFFLE_SHOP)
[0m20:31:57.416965 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ANALYTICS_JAFFLE_SHOP'
[0m20:31:57.435904 [debug] [ThreadPool]: Using snowflake connection "list_raw_JAFFLE_SHOP"
[0m20:31:57.439269 [debug] [ThreadPool]: Using snowflake connection "list_ANALYTICS_JAFFLE_SHOP"
[0m20:31:57.439876 [debug] [ThreadPool]: On list_raw_JAFFLE_SHOP: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_raw_JAFFLE_SHOP"} */
show objects in raw.JAFFLE_SHOP limit 10000
[0m20:31:57.440406 [debug] [ThreadPool]: On list_ANALYTICS_JAFFLE_SHOP: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_ANALYTICS_JAFFLE_SHOP"} */
show objects in ANALYTICS.JAFFLE_SHOP limit 10000
[0m20:31:57.440877 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:31:57.441299 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:31:57.866179 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.425 seconds
[0m20:31:57.870395 [debug] [ThreadPool]: On list_raw_JAFFLE_SHOP: Close
[0m20:31:58.035901 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.594 seconds
[0m20:31:58.040583 [debug] [ThreadPool]: On list_ANALYTICS_JAFFLE_SHOP: Close
[0m20:31:58.180501 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '183d0450-3cc5-4c73-a4b3-e026fac24f79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108656990>]}
[0m20:31:58.182244 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:31:58.183358 [info ] [MainThread]: 
[0m20:31:58.189434 [debug] [Thread-1 (]: Began running node seed.jaffle_shop.raw_customers
[0m20:31:58.190673 [info ] [Thread-1 (]: 1 of 3 START seed file raw.JAFFLE_SHOP.raw_customers ........................... [RUN]
[0m20:31:58.192075 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_raw_JAFFLE_SHOP, now seed.jaffle_shop.raw_customers)
[0m20:31:58.193328 [debug] [Thread-2 (]: Began running node seed.jaffle_shop.raw_orders
[0m20:31:58.194121 [debug] [Thread-3 (]: Began running node seed.jaffle_shop.raw_payments
[0m20:31:58.195176 [debug] [Thread-1 (]: Began compiling node seed.jaffle_shop.raw_customers
[0m20:31:58.196219 [info ] [Thread-2 (]: 2 of 3 START seed file raw.JAFFLE_SHOP.raw_orders .............................. [RUN]
[0m20:31:58.197384 [info ] [Thread-3 (]: 3 of 3 START seed file raw.JAFFLE_SHOP.raw_payments ............................ [RUN]
[0m20:31:58.198375 [debug] [Thread-1 (]: Began executing node seed.jaffle_shop.raw_customers
[0m20:31:58.200229 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_ANALYTICS_JAFFLE_SHOP, now seed.jaffle_shop.raw_orders)
[0m20:31:58.201085 [debug] [Thread-3 (]: Acquiring new snowflake connection 'seed.jaffle_shop.raw_payments'
[0m20:31:58.213450 [debug] [Thread-2 (]: Began compiling node seed.jaffle_shop.raw_orders
[0m20:31:58.246644 [debug] [Thread-3 (]: Began compiling node seed.jaffle_shop.raw_payments
[0m20:31:58.246196 [debug] [Thread-1 (]: Using snowflake connection "seed.jaffle_shop.raw_customers"
[0m20:31:58.247207 [debug] [Thread-2 (]: Began executing node seed.jaffle_shop.raw_orders
[0m20:31:58.247651 [debug] [Thread-3 (]: Began executing node seed.jaffle_shop.raw_payments
[0m20:31:58.248050 [debug] [Thread-1 (]: On seed.jaffle_shop.raw_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_customers"} */
create table raw.JAFFLE_SHOP.raw_customers (id integer,first_name text,last_name text)
[0m20:31:58.256247 [debug] [Thread-2 (]: Using snowflake connection "seed.jaffle_shop.raw_orders"
[0m20:31:58.262716 [debug] [Thread-3 (]: Using snowflake connection "seed.jaffle_shop.raw_payments"
[0m20:31:58.263229 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:31:58.263711 [debug] [Thread-2 (]: On seed.jaffle_shop.raw_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_orders"} */
create table raw.JAFFLE_SHOP.raw_orders (id integer,user_id integer,order_date date,status text)
[0m20:31:58.264088 [debug] [Thread-3 (]: On seed.jaffle_shop.raw_payments: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_payments"} */
create table raw.JAFFLE_SHOP.raw_payments (id integer,order_id integer,payment_method text,amount integer)
[0m20:31:58.265775 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:31:58.266540 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m20:31:58.775663 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.510 seconds
[0m20:31:58.800282 [debug] [Thread-2 (]: Using snowflake connection "seed.jaffle_shop.raw_orders"
[0m20:31:58.801046 [debug] [Thread-2 (]: On seed.jaffle_shop.raw_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_orders"} */
BEGIN
[0m20:31:58.899204 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.097 seconds
[0m20:31:58.906830 [debug] [Thread-2 (]: Using snowflake connection "seed.jaffle_shop.raw_orders"
[0m20:31:58.907785 [debug] [Thread-2 (]: On seed.jaffle_shop.raw_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_orders"} */
insert into raw.JAFFLE_SHOP.raw_orders (id, user_id, order_date, status) values
            (%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),...
[0m20:31:58.913603 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.650 seconds
[0m20:31:58.916391 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.650 seconds
[0m20:31:58.921112 [debug] [Thread-1 (]: Using snowflake connection "seed.jaffle_shop.raw_customers"
[0m20:31:58.926051 [debug] [Thread-3 (]: Using snowflake connection "seed.jaffle_shop.raw_payments"
[0m20:31:58.927268 [debug] [Thread-1 (]: On seed.jaffle_shop.raw_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_customers"} */
BEGIN
[0m20:31:58.928168 [debug] [Thread-3 (]: On seed.jaffle_shop.raw_payments: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_payments"} */
BEGIN
[0m20:31:59.035769 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.106 seconds
[0m20:31:59.038013 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.108 seconds
[0m20:31:59.044034 [debug] [Thread-1 (]: Using snowflake connection "seed.jaffle_shop.raw_customers"
[0m20:31:59.050581 [debug] [Thread-3 (]: Using snowflake connection "seed.jaffle_shop.raw_payments"
[0m20:31:59.051463 [debug] [Thread-1 (]: On seed.jaffle_shop.raw_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_customers"} */
insert into raw.JAFFLE_SHOP.raw_customers (id, first_name, last_name) values
            (%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%...
[0m20:31:59.052294 [debug] [Thread-3 (]: On seed.jaffle_shop.raw_payments: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_payments"} */
insert into raw.JAFFLE_SHOP.raw_payments (id, order_id, payment_method, amount) values
            (%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%...
[0m20:31:59.573131 [debug] [Thread-2 (]: SQL status: SUCCESS 99 in 0.664 seconds
[0m20:31:59.575154 [debug] [Thread-1 (]: SQL status: SUCCESS 100 in 0.522 seconds
[0m20:31:59.576629 [debug] [Thread-2 (]: Using snowflake connection "seed.jaffle_shop.raw_orders"
[0m20:31:59.577966 [debug] [Thread-1 (]: Using snowflake connection "seed.jaffle_shop.raw_customers"
[0m20:31:59.579157 [debug] [Thread-2 (]: On seed.jaffle_shop.raw_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_orders"} */
COMMIT
[0m20:31:59.580183 [debug] [Thread-1 (]: On seed.jaffle_shop.raw_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_customers"} */
COMMIT
[0m20:31:59.628869 [debug] [Thread-3 (]: SQL status: SUCCESS 113 in 0.573 seconds
[0m20:31:59.630469 [debug] [Thread-3 (]: Using snowflake connection "seed.jaffle_shop.raw_payments"
[0m20:31:59.631622 [debug] [Thread-3 (]: On seed.jaffle_shop.raw_payments: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_payments"} */
COMMIT
[0m20:31:59.783368 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.202 seconds
[0m20:31:59.797236 [debug] [Thread-2 (]: Writing runtime SQL for node "seed.jaffle_shop.raw_orders"
[0m20:31:59.830068 [debug] [Thread-2 (]: On seed.jaffle_shop.raw_orders: Close
[0m20:31:59.846488 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.214 seconds
[0m20:31:59.847542 [debug] [Thread-3 (]: Writing runtime SQL for node "seed.jaffle_shop.raw_payments"
[0m20:31:59.850207 [debug] [Thread-3 (]: On seed.jaffle_shop.raw_payments: Close
[0m20:31:59.996800 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '183d0450-3cc5-4c73-a4b3-e026fac24f79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108438b10>]}
[0m20:31:59.998607 [info ] [Thread-2 (]: 2 of 3 OK loaded seed file JAFFLE_SHOP.raw_orders .............................. [[32mINSERT 99[0m in 1.79s]
[0m20:32:00.000069 [debug] [Thread-2 (]: Finished running node seed.jaffle_shop.raw_orders
[0m20:32:00.211536 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '183d0450-3cc5-4c73-a4b3-e026fac24f79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1085f1850>]}
[0m20:32:00.213381 [info ] [Thread-3 (]: 3 of 3 OK loaded seed file JAFFLE_SHOP.raw_payments ............................ [[32mINSERT 113[0m in 2.01s]
[0m20:32:00.215321 [debug] [Thread-3 (]: Finished running node seed.jaffle_shop.raw_payments
[0m20:32:00.405259 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.822 seconds
[0m20:32:00.407334 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.jaffle_shop.raw_customers"
[0m20:32:00.412523 [debug] [Thread-1 (]: On seed.jaffle_shop.raw_customers: Close
[0m20:32:00.540449 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '183d0450-3cc5-4c73-a4b3-e026fac24f79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1083a35d0>]}
[0m20:32:00.541235 [info ] [Thread-1 (]: 1 of 3 OK loaded seed file JAFFLE_SHOP.raw_customers ........................... [[32mINSERT 100[0m in 2.35s]
[0m20:32:00.542074 [debug] [Thread-1 (]: Finished running node seed.jaffle_shop.raw_customers
[0m20:32:00.543829 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:32:00.544216 [debug] [MainThread]: Connection 'seed.jaffle_shop.raw_customers' was properly closed.
[0m20:32:00.544553 [debug] [MainThread]: Connection 'seed.jaffle_shop.raw_orders' was properly closed.
[0m20:32:00.544874 [debug] [MainThread]: Connection 'seed.jaffle_shop.raw_payments' was properly closed.
[0m20:32:00.545248 [info ] [MainThread]: 
[0m20:32:00.545685 [info ] [MainThread]: Finished running 3 seeds in 0 hours 0 minutes and 4.83 seconds (4.83s).
[0m20:32:00.546680 [debug] [MainThread]: Command end result
[0m20:32:00.582231 [info ] [MainThread]: 
[0m20:32:00.583138 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:32:00.583581 [info ] [MainThread]: 
[0m20:32:00.583961 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m20:32:00.586012 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": true, "command_wall_clock_time": 7.564052, "process_user_time": 4.568847, "process_kernel_time": 0.562405, "process_mem_max_rss": "135577600", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m20:32:00.586626 [debug] [MainThread]: Command `dbt seed` succeeded at 20:32:00.586522 after 7.56 seconds
[0m20:32:00.587067 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1040e91d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10403c310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10403cc10>]}
[0m20:32:00.587466 [debug] [MainThread]: Flushing usage events
[0m20:33:40.917849 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dff3d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f2e4a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f2e53d0>]}


============================== 20:33:40.926411 | 40128d5d-2634-4ace-ac05-1ebd56afc3a9 ==============================
[0m20:33:40.926411 [info ] [MainThread]: Running with dbt=1.8.7
[0m20:33:40.927302 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/ben/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/ben/Dbt Certification/dbt-tutorial/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt seed', 'send_anonymous_usage_stats': 'True'}
[0m20:33:41.452381 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '40128d5d-2634-4ace-ac05-1ebd56afc3a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f199990>]}
[0m20:33:41.505182 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '40128d5d-2634-4ace-ac05-1ebd56afc3a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ed2ab50>]}
[0m20:33:41.506838 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m20:33:41.535195 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m20:33:41.642962 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m20:33:41.643839 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '40128d5d-2634-4ace-ac05-1ebd56afc3a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10df14a10>]}
[0m20:33:43.133306 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m20:33:43.134126 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '40128d5d-2634-4ace-ac05-1ebd56afc3a9', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110090310>]}
[0m20:33:43.351030 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.staging
- seeds.raw_payments
[0m20:33:43.356781 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '40128d5d-2634-4ace-ac05-1ebd56afc3a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1104467d0>]}
[0m20:33:43.477085 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '40128d5d-2634-4ace-ac05-1ebd56afc3a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1105b9b90>]}
[0m20:33:43.477655 [info ] [MainThread]: Found 7 models, 3 seeds, 11 data tests, 572 macros
[0m20:33:43.478046 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '40128d5d-2634-4ace-ac05-1ebd56afc3a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110575810>]}
[0m20:33:43.480075 [info ] [MainThread]: 
[0m20:33:43.480829 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m20:33:43.485151 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_raw'
[0m20:33:43.496391 [debug] [ThreadPool]: Using snowflake connection "list_raw"
[0m20:33:43.497285 [debug] [ThreadPool]: On list_raw: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_raw"} */
show terse schemas in database raw
    limit 10000
[0m20:33:43.498141 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:33:44.293466 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.795 seconds
[0m20:33:44.298512 [debug] [ThreadPool]: On list_raw: Close
[0m20:33:44.441221 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_raw, now create_raw_JAFFLE_SHOP)
[0m20:33:44.444024 [debug] [ThreadPool]: Creating schema "database: "raw"
schema: "JAFFLE_SHOP"
"
[0m20:33:44.454488 [debug] [ThreadPool]: Using snowflake connection "create_raw_JAFFLE_SHOP"
[0m20:33:44.455260 [debug] [ThreadPool]: On create_raw_JAFFLE_SHOP: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "create_raw_JAFFLE_SHOP"} */
create schema if not exists raw.JAFFLE_SHOP
[0m20:33:44.455898 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:33:44.932649 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.477 seconds
[0m20:33:44.935660 [debug] [ThreadPool]: On create_raw_JAFFLE_SHOP: Close
[0m20:33:45.090823 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_raw_JAFFLE_SHOP, now list_ANALYTICS_JAFFLE_SHOP)
[0m20:33:45.092539 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_raw_JAFFLE_SHOP'
[0m20:33:45.111175 [debug] [ThreadPool]: Using snowflake connection "list_ANALYTICS_JAFFLE_SHOP"
[0m20:33:45.114399 [debug] [ThreadPool]: Using snowflake connection "list_raw_JAFFLE_SHOP"
[0m20:33:45.114984 [debug] [ThreadPool]: On list_ANALYTICS_JAFFLE_SHOP: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_ANALYTICS_JAFFLE_SHOP"} */
show objects in ANALYTICS.JAFFLE_SHOP limit 10000
[0m20:33:45.115575 [debug] [ThreadPool]: On list_raw_JAFFLE_SHOP: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_raw_JAFFLE_SHOP"} */
show objects in raw.JAFFLE_SHOP limit 10000
[0m20:33:45.116235 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:33:45.116699 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:33:45.701847 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.585 seconds
[0m20:33:45.706061 [debug] [ThreadPool]: On list_raw_JAFFLE_SHOP: Close
[0m20:33:45.713045 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.597 seconds
[0m20:33:45.716705 [debug] [ThreadPool]: On list_ANALYTICS_JAFFLE_SHOP: Close
[0m20:33:45.875145 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '40128d5d-2634-4ace-ac05-1ebd56afc3a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1105b9b10>]}
[0m20:33:45.876937 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:33:45.878223 [info ] [MainThread]: 
[0m20:33:45.884450 [debug] [Thread-1 (]: Began running node seed.jaffle_shop.raw_customers
[0m20:33:45.885769 [debug] [Thread-2 (]: Began running node seed.jaffle_shop.raw_orders
[0m20:33:45.886883 [info ] [Thread-1 (]: 1 of 3 START seed file raw.JAFFLE_SHOP.raw_customers ........................... [RUN]
[0m20:33:45.888197 [debug] [Thread-3 (]: Began running node seed.jaffle_shop.raw_payments
[0m20:33:45.889426 [info ] [Thread-2 (]: 2 of 3 START seed file raw.JAFFLE_SHOP.raw_orders .............................. [RUN]
[0m20:33:45.890795 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_ANALYTICS_JAFFLE_SHOP, now seed.jaffle_shop.raw_customers)
[0m20:33:45.892139 [info ] [Thread-3 (]: 3 of 3 START seed file raw.JAFFLE_SHOP.raw_payments ............................ [RUN]
[0m20:33:45.894082 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_raw_JAFFLE_SHOP, now seed.jaffle_shop.raw_orders)
[0m20:33:45.894878 [debug] [Thread-1 (]: Began compiling node seed.jaffle_shop.raw_customers
[0m20:33:45.895794 [debug] [Thread-3 (]: Acquiring new snowflake connection 'seed.jaffle_shop.raw_payments'
[0m20:33:45.896643 [debug] [Thread-2 (]: Began compiling node seed.jaffle_shop.raw_orders
[0m20:33:45.897248 [debug] [Thread-1 (]: Began executing node seed.jaffle_shop.raw_customers
[0m20:33:45.897803 [debug] [Thread-3 (]: Began compiling node seed.jaffle_shop.raw_payments
[0m20:33:45.898346 [debug] [Thread-2 (]: Began executing node seed.jaffle_shop.raw_orders
[0m20:33:45.910831 [debug] [Thread-3 (]: Began executing node seed.jaffle_shop.raw_payments
[0m20:33:45.947314 [debug] [Thread-2 (]: Using snowflake connection "seed.jaffle_shop.raw_orders"
[0m20:33:45.950902 [debug] [Thread-1 (]: Using snowflake connection "seed.jaffle_shop.raw_customers"
[0m20:33:45.951495 [debug] [Thread-2 (]: On seed.jaffle_shop.raw_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_orders"} */
create table raw.JAFFLE_SHOP.raw_orders (id integer,user_id integer,order_date date,status text)
[0m20:33:45.955461 [debug] [Thread-3 (]: Using snowflake connection "seed.jaffle_shop.raw_payments"
[0m20:33:45.956025 [debug] [Thread-1 (]: On seed.jaffle_shop.raw_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_customers"} */
create table raw.JAFFLE_SHOP.raw_customers (id integer,first_name text,last_name text)
[0m20:33:45.956609 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:33:45.957034 [debug] [Thread-3 (]: On seed.jaffle_shop.raw_payments: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_payments"} */
create table raw.JAFFLE_SHOP.raw_payments (id integer,order_id integer,payment_method text,amount integer)
[0m20:33:45.957531 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:33:45.959464 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m20:33:46.490917 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.534 seconds
[0m20:33:46.521317 [debug] [Thread-2 (]: Using snowflake connection "seed.jaffle_shop.raw_orders"
[0m20:33:46.522083 [debug] [Thread-2 (]: On seed.jaffle_shop.raw_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_orders"} */
BEGIN
[0m20:33:46.610789 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.651 seconds
[0m20:33:46.618717 [debug] [Thread-3 (]: Using snowflake connection "seed.jaffle_shop.raw_payments"
[0m20:33:46.619647 [debug] [Thread-3 (]: On seed.jaffle_shop.raw_payments: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_payments"} */
BEGIN
[0m20:33:46.629591 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.107 seconds
[0m20:33:46.633917 [debug] [Thread-2 (]: Using snowflake connection "seed.jaffle_shop.raw_orders"
[0m20:33:46.634615 [debug] [Thread-2 (]: On seed.jaffle_shop.raw_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_orders"} */
insert into raw.JAFFLE_SHOP.raw_orders (id, user_id, order_date, status) values
            (%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),...
[0m20:33:46.732912 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.112 seconds
[0m20:33:46.740873 [debug] [Thread-3 (]: Using snowflake connection "seed.jaffle_shop.raw_payments"
[0m20:33:46.741829 [debug] [Thread-3 (]: On seed.jaffle_shop.raw_payments: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_payments"} */
insert into raw.JAFFLE_SHOP.raw_payments (id, order_id, payment_method, amount) values
            (%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%...
[0m20:33:46.973175 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.015 seconds
[0m20:33:46.978795 [debug] [Thread-1 (]: Using snowflake connection "seed.jaffle_shop.raw_customers"
[0m20:33:46.979600 [debug] [Thread-1 (]: On seed.jaffle_shop.raw_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_customers"} */
BEGIN
[0m20:33:47.094761 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.114 seconds
[0m20:33:47.101047 [debug] [Thread-1 (]: Using snowflake connection "seed.jaffle_shop.raw_customers"
[0m20:33:47.102014 [debug] [Thread-1 (]: On seed.jaffle_shop.raw_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_customers"} */
insert into raw.JAFFLE_SHOP.raw_customers (id, first_name, last_name) values
            (%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%...
[0m20:33:47.116127 [debug] [Thread-2 (]: SQL status: SUCCESS 99 in 0.481 seconds
[0m20:33:47.117378 [debug] [Thread-2 (]: Using snowflake connection "seed.jaffle_shop.raw_orders"
[0m20:33:47.118267 [debug] [Thread-2 (]: On seed.jaffle_shop.raw_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_orders"} */
COMMIT
[0m20:33:47.395503 [debug] [Thread-3 (]: SQL status: SUCCESS 113 in 0.652 seconds
[0m20:33:47.397079 [debug] [Thread-3 (]: Using snowflake connection "seed.jaffle_shop.raw_payments"
[0m20:33:47.398198 [debug] [Thread-3 (]: On seed.jaffle_shop.raw_payments: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_payments"} */
COMMIT
[0m20:33:47.670360 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.551 seconds
[0m20:33:47.685823 [debug] [Thread-2 (]: Writing runtime SQL for node "seed.jaffle_shop.raw_orders"
[0m20:33:47.717675 [debug] [Thread-2 (]: On seed.jaffle_shop.raw_orders: Close
[0m20:33:47.728353 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.329 seconds
[0m20:33:47.729205 [debug] [Thread-3 (]: Writing runtime SQL for node "seed.jaffle_shop.raw_payments"
[0m20:33:47.731674 [debug] [Thread-3 (]: On seed.jaffle_shop.raw_payments: Close
[0m20:33:47.884184 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '40128d5d-2634-4ace-ac05-1ebd56afc3a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1105be850>]}
[0m20:33:47.886033 [info ] [Thread-3 (]: 3 of 3 OK loaded seed file JAFFLE_SHOP.raw_payments ............................ [[32mINSERT 113[0m in 1.99s]
[0m20:33:47.887499 [debug] [Thread-3 (]: Finished running node seed.jaffle_shop.raw_payments
[0m20:33:48.009711 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '40128d5d-2634-4ace-ac05-1ebd56afc3a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dee0810>]}
[0m20:33:48.011329 [info ] [Thread-2 (]: 2 of 3 OK loaded seed file JAFFLE_SHOP.raw_orders .............................. [[32mINSERT 99[0m in 2.12s]
[0m20:33:48.012749 [debug] [Thread-2 (]: Finished running node seed.jaffle_shop.raw_orders
[0m20:33:48.243951 [debug] [Thread-1 (]: SQL status: SUCCESS 100 in 1.141 seconds
[0m20:33:48.245533 [debug] [Thread-1 (]: Using snowflake connection "seed.jaffle_shop.raw_customers"
[0m20:33:48.246678 [debug] [Thread-1 (]: On seed.jaffle_shop.raw_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_customers"} */
COMMIT
[0m20:33:48.914324 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.666 seconds
[0m20:33:48.916480 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.jaffle_shop.raw_customers"
[0m20:33:48.921935 [debug] [Thread-1 (]: On seed.jaffle_shop.raw_customers: Close
[0m20:33:49.082950 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '40128d5d-2634-4ace-ac05-1ebd56afc3a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110143850>]}
[0m20:33:49.084648 [info ] [Thread-1 (]: 1 of 3 OK loaded seed file JAFFLE_SHOP.raw_customers ........................... [[32mINSERT 100[0m in 3.19s]
[0m20:33:49.086423 [debug] [Thread-1 (]: Finished running node seed.jaffle_shop.raw_customers
[0m20:33:49.089781 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:33:49.090616 [debug] [MainThread]: Connection 'seed.jaffle_shop.raw_customers' was properly closed.
[0m20:33:49.091389 [debug] [MainThread]: Connection 'seed.jaffle_shop.raw_orders' was properly closed.
[0m20:33:49.092113 [debug] [MainThread]: Connection 'seed.jaffle_shop.raw_payments' was properly closed.
[0m20:33:49.092935 [info ] [MainThread]: 
[0m20:33:49.093716 [info ] [MainThread]: Finished running 3 seeds in 0 hours 0 minutes and 5.61 seconds (5.61s).
[0m20:33:49.095467 [debug] [MainThread]: Command end result
[0m20:33:49.139686 [info ] [MainThread]: 
[0m20:33:49.140241 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:33:49.140710 [info ] [MainThread]: 
[0m20:33:49.141107 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m20:33:49.143004 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": true, "command_wall_clock_time": 8.305029, "process_user_time": 4.584987, "process_kernel_time": 0.561851, "process_mem_max_rss": "135856128", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m20:33:49.143795 [debug] [MainThread]: Command `dbt seed` succeeded at 20:33:49.143672 after 8.31 seconds
[0m20:33:49.144265 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bcdc350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bcdc310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bcdc390>]}
[0m20:33:49.144700 [debug] [MainThread]: Flushing usage events
[0m20:36:00.982863 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1131ce110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112e2e5d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1131f4c50>]}


============================== 20:36:00.988525 | 9f26f438-4145-4454-8acf-a0d83c7252a1 ==============================
[0m20:36:00.988525 [info ] [MainThread]: Running with dbt=1.8.7
[0m20:36:00.989282 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/ben/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/ben/Dbt Certification/dbt-tutorial/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt seed', 'send_anonymous_usage_stats': 'True'}
[0m20:36:01.349740 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9f26f438-4145-4454-8acf-a0d83c7252a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1130933d0>]}
[0m20:36:01.406537 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9f26f438-4145-4454-8acf-a0d83c7252a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1138f9c10>]}
[0m20:36:01.419678 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m20:36:01.448219 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m20:36:01.590599 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 1 files added, 0 files changed.
[0m20:36:01.591430 [debug] [MainThread]: Partial parsing: added file: jaffle_shop://seeds/jaffle_shop/raw_payments.csv
[0m20:36:01.591783 [debug] [MainThread]: Partial parsing: deleted file: jaffle_shop://seeds/stripe/raw_payments.csv
[0m20:36:01.806042 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.staging
- seeds.raw_payments
[0m20:36:01.813560 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9f26f438-4145-4454-8acf-a0d83c7252a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113e70f90>]}
[0m20:36:01.976053 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9f26f438-4145-4454-8acf-a0d83c7252a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1125fa610>]}
[0m20:36:01.976661 [info ] [MainThread]: Found 7 models, 3 seeds, 11 data tests, 572 macros
[0m20:36:01.977109 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9f26f438-4145-4454-8acf-a0d83c7252a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111907150>]}
[0m20:36:01.979319 [info ] [MainThread]: 
[0m20:36:01.980044 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m20:36:01.984426 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_raw'
[0m20:36:01.999783 [debug] [ThreadPool]: Using snowflake connection "list_raw"
[0m20:36:02.000705 [debug] [ThreadPool]: On list_raw: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_raw"} */
show terse schemas in database raw
    limit 10000
[0m20:36:02.001062 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:36:02.731243 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.730 seconds
[0m20:36:02.735716 [debug] [ThreadPool]: On list_raw: Close
[0m20:36:02.922908 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_raw, now create_raw_JAFFLE_SHOP)
[0m20:36:02.924574 [debug] [ThreadPool]: Creating schema "database: "raw"
schema: "JAFFLE_SHOP"
"
[0m20:36:02.935346 [debug] [ThreadPool]: Using snowflake connection "create_raw_JAFFLE_SHOP"
[0m20:36:02.936149 [debug] [ThreadPool]: On create_raw_JAFFLE_SHOP: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "create_raw_JAFFLE_SHOP"} */
create schema if not exists raw.JAFFLE_SHOP
[0m20:36:02.936811 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:36:03.538028 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.601 seconds
[0m20:36:03.541514 [debug] [ThreadPool]: On create_raw_JAFFLE_SHOP: Close
[0m20:36:03.687392 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_raw_JAFFLE_SHOP, now list_raw_JAFFLE_SHOP)
[0m20:36:03.688922 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ANALYTICS_JAFFLE_SHOP'
[0m20:36:03.714648 [debug] [ThreadPool]: Using snowflake connection "list_raw_JAFFLE_SHOP"
[0m20:36:03.719272 [debug] [ThreadPool]: Using snowflake connection "list_ANALYTICS_JAFFLE_SHOP"
[0m20:36:03.719802 [debug] [ThreadPool]: On list_raw_JAFFLE_SHOP: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_raw_JAFFLE_SHOP"} */
show objects in raw.JAFFLE_SHOP limit 10000
[0m20:36:03.720228 [debug] [ThreadPool]: On list_ANALYTICS_JAFFLE_SHOP: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_ANALYTICS_JAFFLE_SHOP"} */
show objects in ANALYTICS.JAFFLE_SHOP limit 10000
[0m20:36:03.720631 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:36:03.721019 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:36:04.398028 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.677 seconds
[0m20:36:04.402317 [debug] [ThreadPool]: On list_raw_JAFFLE_SHOP: Close
[0m20:36:04.470618 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.749 seconds
[0m20:36:04.476095 [debug] [ThreadPool]: On list_ANALYTICS_JAFFLE_SHOP: Close
[0m20:36:04.615251 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9f26f438-4145-4454-8acf-a0d83c7252a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11159a590>]}
[0m20:36:04.617053 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:36:04.618204 [info ] [MainThread]: 
[0m20:36:04.622635 [debug] [Thread-1 (]: Began running node seed.jaffle_shop.raw_customers
[0m20:36:04.623940 [info ] [Thread-1 (]: 1 of 3 START seed file raw.JAFFLE_SHOP.raw_customers ........................... [RUN]
[0m20:36:04.624942 [debug] [Thread-2 (]: Began running node seed.jaffle_shop.raw_orders
[0m20:36:04.625998 [debug] [Thread-3 (]: Began running node seed.jaffle_shop.raw_payments
[0m20:36:04.626860 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_raw_JAFFLE_SHOP, now seed.jaffle_shop.raw_customers)
[0m20:36:04.628156 [info ] [Thread-2 (]: 2 of 3 START seed file raw.JAFFLE_SHOP.raw_orders .............................. [RUN]
[0m20:36:04.629289 [info ] [Thread-3 (]: 3 of 3 START seed file raw.JAFFLE_SHOP.raw_payments ............................ [RUN]
[0m20:36:04.630378 [debug] [Thread-1 (]: Began compiling node seed.jaffle_shop.raw_customers
[0m20:36:04.631316 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_ANALYTICS_JAFFLE_SHOP, now seed.jaffle_shop.raw_orders)
[0m20:36:04.632315 [debug] [Thread-3 (]: Acquiring new snowflake connection 'seed.jaffle_shop.raw_payments'
[0m20:36:04.633226 [debug] [Thread-1 (]: Began executing node seed.jaffle_shop.raw_customers
[0m20:36:04.634015 [debug] [Thread-2 (]: Began compiling node seed.jaffle_shop.raw_orders
[0m20:36:04.634692 [debug] [Thread-3 (]: Began compiling node seed.jaffle_shop.raw_payments
[0m20:36:04.641981 [debug] [Thread-2 (]: Began executing node seed.jaffle_shop.raw_orders
[0m20:36:04.672976 [debug] [Thread-3 (]: Began executing node seed.jaffle_shop.raw_payments
[0m20:36:04.677297 [debug] [Thread-1 (]: Using snowflake connection "seed.jaffle_shop.raw_customers"
[0m20:36:04.685061 [debug] [Thread-2 (]: Using snowflake connection "seed.jaffle_shop.raw_orders"
[0m20:36:04.691749 [debug] [Thread-3 (]: Using snowflake connection "seed.jaffle_shop.raw_payments"
[0m20:36:04.692263 [debug] [Thread-1 (]: On seed.jaffle_shop.raw_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_customers"} */
create table raw.JAFFLE_SHOP.raw_customers (id integer,first_name text,last_name text)
[0m20:36:04.692665 [debug] [Thread-2 (]: On seed.jaffle_shop.raw_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_orders"} */
create table raw.JAFFLE_SHOP.raw_orders (id integer,user_id integer,order_date date,status text)
[0m20:36:04.693066 [debug] [Thread-3 (]: On seed.jaffle_shop.raw_payments: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_payments"} */
create table raw.JAFFLE_SHOP.raw_payments (id integer,order_id integer,payment_method text,amount integer)
[0m20:36:04.693499 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:36:04.693871 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:36:04.694258 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m20:36:05.208482 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.514 seconds
[0m20:36:05.237876 [debug] [Thread-2 (]: Using snowflake connection "seed.jaffle_shop.raw_orders"
[0m20:36:05.238597 [debug] [Thread-2 (]: On seed.jaffle_shop.raw_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_orders"} */
BEGIN
[0m20:36:05.328319 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.634 seconds
[0m20:36:05.335805 [debug] [Thread-1 (]: Using snowflake connection "seed.jaffle_shop.raw_customers"
[0m20:36:05.336763 [debug] [Thread-1 (]: On seed.jaffle_shop.raw_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_customers"} */
BEGIN
[0m20:36:05.344680 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.105 seconds
[0m20:36:05.349979 [debug] [Thread-2 (]: Using snowflake connection "seed.jaffle_shop.raw_orders"
[0m20:36:05.350855 [debug] [Thread-2 (]: On seed.jaffle_shop.raw_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_orders"} */
insert into raw.JAFFLE_SHOP.raw_orders (id, user_id, order_date, status) values
            (%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),...
[0m20:36:05.459360 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.121 seconds
[0m20:36:05.465982 [debug] [Thread-1 (]: Using snowflake connection "seed.jaffle_shop.raw_customers"
[0m20:36:05.466950 [debug] [Thread-1 (]: On seed.jaffle_shop.raw_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_customers"} */
insert into raw.JAFFLE_SHOP.raw_customers (id, first_name, last_name) values
            (%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%...
[0m20:36:06.112820 [debug] [Thread-2 (]: SQL status: SUCCESS 99 in 0.760 seconds
[0m20:36:06.114604 [debug] [Thread-2 (]: Using snowflake connection "seed.jaffle_shop.raw_orders"
[0m20:36:06.115749 [debug] [Thread-2 (]: On seed.jaffle_shop.raw_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_orders"} */
COMMIT
[0m20:36:06.417853 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.301 seconds
[0m20:36:06.431725 [debug] [Thread-2 (]: Writing runtime SQL for node "seed.jaffle_shop.raw_orders"
[0m20:36:06.463815 [debug] [Thread-2 (]: On seed.jaffle_shop.raw_orders: Close
[0m20:36:06.617655 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9f26f438-4145-4454-8acf-a0d83c7252a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1145d9a10>]}
[0m20:36:06.619427 [info ] [Thread-2 (]: 2 of 3 OK loaded seed file JAFFLE_SHOP.raw_orders .............................. [[32mINSERT 99[0m in 1.98s]
[0m20:36:06.620885 [debug] [Thread-2 (]: Finished running node seed.jaffle_shop.raw_orders
[0m20:36:09.081395 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 4.387 seconds
[0m20:36:09.089439 [debug] [Thread-3 (]: Using snowflake connection "seed.jaffle_shop.raw_payments"
[0m20:36:09.090475 [debug] [Thread-3 (]: On seed.jaffle_shop.raw_payments: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_payments"} */
BEGIN
[0m20:36:09.196310 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.105 seconds
[0m20:36:09.204620 [debug] [Thread-3 (]: Using snowflake connection "seed.jaffle_shop.raw_payments"
[0m20:36:09.205705 [debug] [Thread-3 (]: On seed.jaffle_shop.raw_payments: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_payments"} */
insert into raw.JAFFLE_SHOP.raw_payments (id, order_id, payment_method, amount) values
            (%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%...
[0m20:36:10.004326 [debug] [Thread-3 (]: SQL status: SUCCESS 113 in 0.798 seconds
[0m20:36:10.006133 [debug] [Thread-3 (]: Using snowflake connection "seed.jaffle_shop.raw_payments"
[0m20:36:10.007325 [debug] [Thread-3 (]: On seed.jaffle_shop.raw_payments: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_payments"} */
COMMIT
[0m20:36:10.208769 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.200 seconds
[0m20:36:10.211644 [debug] [Thread-3 (]: Writing runtime SQL for node "seed.jaffle_shop.raw_payments"
[0m20:36:10.216752 [debug] [Thread-3 (]: On seed.jaffle_shop.raw_payments: Close
[0m20:36:10.820512 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9f26f438-4145-4454-8acf-a0d83c7252a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1145b7450>]}
[0m20:36:10.822257 [info ] [Thread-3 (]: 3 of 3 OK loaded seed file JAFFLE_SHOP.raw_payments ............................ [[32mINSERT 113[0m in 6.19s]
[0m20:36:10.824257 [debug] [Thread-3 (]: Finished running node seed.jaffle_shop.raw_payments
[0m20:36:11.845552 [debug] [Thread-1 (]: SQL status: SUCCESS 100 in 6.378 seconds
[0m20:36:11.847057 [debug] [Thread-1 (]: Using snowflake connection "seed.jaffle_shop.raw_customers"
[0m20:36:11.848324 [debug] [Thread-1 (]: On seed.jaffle_shop.raw_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_customers"} */
COMMIT
[0m20:36:12.047762 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.198 seconds
[0m20:36:12.049770 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.jaffle_shop.raw_customers"
[0m20:36:12.056434 [debug] [Thread-1 (]: On seed.jaffle_shop.raw_customers: Close
[0m20:36:12.204222 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9f26f438-4145-4454-8acf-a0d83c7252a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114523bd0>]}
[0m20:36:12.206373 [info ] [Thread-1 (]: 1 of 3 OK loaded seed file JAFFLE_SHOP.raw_customers ........................... [[32mINSERT 100[0m in 7.58s]
[0m20:36:12.208416 [debug] [Thread-1 (]: Finished running node seed.jaffle_shop.raw_customers
[0m20:36:12.212921 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:36:12.214405 [debug] [MainThread]: Connection 'seed.jaffle_shop.raw_customers' was properly closed.
[0m20:36:12.215289 [debug] [MainThread]: Connection 'seed.jaffle_shop.raw_orders' was properly closed.
[0m20:36:12.216364 [debug] [MainThread]: Connection 'seed.jaffle_shop.raw_payments' was properly closed.
[0m20:36:12.218296 [info ] [MainThread]: 
[0m20:36:12.220089 [info ] [MainThread]: Finished running 3 seeds in 0 hours 0 minutes and 10.24 seconds (10.24s).
[0m20:36:12.222604 [debug] [MainThread]: Command end result
[0m20:36:12.263914 [info ] [MainThread]: 
[0m20:36:12.264547 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:36:12.265159 [info ] [MainThread]: 
[0m20:36:12.265565 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m20:36:12.267007 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": true, "command_wall_clock_time": 11.357656, "process_user_time": 3.076127, "process_kernel_time": 0.389197, "process_mem_max_rss": "133353472", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m20:36:12.267593 [debug] [MainThread]: Command `dbt seed` succeeded at 20:36:12.267494 after 11.36 seconds
[0m20:36:12.268014 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11319b950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fc6d310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fbbcb50>]}
[0m20:36:12.268487 [debug] [MainThread]: Flushing usage events
[0m20:38:45.394862 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1070bec50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10711bed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1071355d0>]}


============================== 20:38:45.401919 | e49459f1-b729-41b1-aa4c-fca4547580bb ==============================
[0m20:38:45.401919 [info ] [MainThread]: Running with dbt=1.8.7
[0m20:38:45.402659 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/Users/ben/.dbt', 'log_path': '/Users/ben/Dbt Certification/dbt-tutorial/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'invocation_command': 'dbt seed', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:38:45.781146 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e49459f1-b729-41b1-aa4c-fca4547580bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e03950>]}
[0m20:38:45.837008 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e49459f1-b729-41b1-aa4c-fca4547580bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b76c10>]}
[0m20:38:45.838009 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m20:38:45.865180 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m20:38:45.977262 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m20:38:45.978050 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'e49459f1-b729-41b1-aa4c-fca4547580bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d50890>]}
[0m20:38:47.408051 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m20:38:47.408736 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'e49459f1-b729-41b1-aa4c-fca4547580bb', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108167b90>]}
[0m20:38:47.628602 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.staging
- seeds.jaffle_shop.raw_payments
[0m20:38:47.634622 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e49459f1-b729-41b1-aa4c-fca4547580bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e5c7d0>]}
[0m20:38:47.742202 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e49459f1-b729-41b1-aa4c-fca4547580bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108410510>]}
[0m20:38:47.742949 [info ] [MainThread]: Found 7 models, 3 seeds, 11 data tests, 572 macros
[0m20:38:47.743380 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e49459f1-b729-41b1-aa4c-fca4547580bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10843f3d0>]}
[0m20:38:47.745438 [info ] [MainThread]: 
[0m20:38:47.746060 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m20:38:47.750491 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_raw'
[0m20:38:47.760566 [debug] [ThreadPool]: Using snowflake connection "list_raw"
[0m20:38:47.761974 [debug] [ThreadPool]: On list_raw: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_raw"} */
show terse schemas in database raw
    limit 10000
[0m20:38:47.762453 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:38:48.510508 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.748 seconds
[0m20:38:48.512582 [debug] [ThreadPool]: On list_raw: Close
[0m20:38:48.640517 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_raw, now create_raw_JAFFLE_SHOP)
[0m20:38:48.641803 [debug] [ThreadPool]: Creating schema "database: "raw"
schema: "JAFFLE_SHOP"
"
[0m20:38:48.652209 [debug] [ThreadPool]: Using snowflake connection "create_raw_JAFFLE_SHOP"
[0m20:38:48.653029 [debug] [ThreadPool]: On create_raw_JAFFLE_SHOP: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "create_raw_JAFFLE_SHOP"} */
create schema if not exists raw.JAFFLE_SHOP
[0m20:38:48.653628 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:38:49.252103 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.598 seconds
[0m20:38:49.255192 [debug] [ThreadPool]: On create_raw_JAFFLE_SHOP: Close
[0m20:38:49.390089 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_raw_JAFFLE_SHOP, now list_raw_JAFFLE_SHOP)
[0m20:38:49.391923 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ANALYTICS_JAFFLE_SHOP'
[0m20:38:49.420514 [debug] [ThreadPool]: Using snowflake connection "list_ANALYTICS_JAFFLE_SHOP"
[0m20:38:49.421505 [debug] [ThreadPool]: Using snowflake connection "list_raw_JAFFLE_SHOP"
[0m20:38:49.439159 [debug] [ThreadPool]: On list_ANALYTICS_JAFFLE_SHOP: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_ANALYTICS_JAFFLE_SHOP"} */
show objects in ANALYTICS.JAFFLE_SHOP limit 10000
[0m20:38:49.440079 [debug] [ThreadPool]: On list_raw_JAFFLE_SHOP: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_raw_JAFFLE_SHOP"} */
show objects in raw.JAFFLE_SHOP limit 10000
[0m20:38:49.440773 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:38:49.441323 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:38:49.937706 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.497 seconds
[0m20:38:49.942506 [debug] [ThreadPool]: On list_ANALYTICS_JAFFLE_SHOP: Close
[0m20:38:50.019089 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.578 seconds
[0m20:38:50.023541 [debug] [ThreadPool]: On list_raw_JAFFLE_SHOP: Close
[0m20:38:50.159194 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e49459f1-b729-41b1-aa4c-fca4547580bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1081c2190>]}
[0m20:38:50.161140 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:38:50.162475 [info ] [MainThread]: 
[0m20:38:50.169152 [debug] [Thread-1 (]: Began running node seed.jaffle_shop.raw_customers
[0m20:38:50.170480 [debug] [Thread-2 (]: Began running node seed.jaffle_shop.raw_orders
[0m20:38:50.171449 [debug] [Thread-3 (]: Began running node seed.jaffle_shop.raw_payments
[0m20:38:50.173277 [info ] [Thread-1 (]: 1 of 3 START seed file raw.JAFFLE_SHOP.raw_customers ........................... [RUN]
[0m20:38:50.175521 [info ] [Thread-2 (]: 2 of 3 START seed file raw.JAFFLE_SHOP.raw_orders .............................. [RUN]
[0m20:38:50.176476 [info ] [Thread-3 (]: 3 of 3 START seed file raw.JAFFLE_SHOP.raw_payments ............................ [RUN]
[0m20:38:50.177349 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_raw_JAFFLE_SHOP, now seed.jaffle_shop.raw_customers)
[0m20:38:50.178315 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_ANALYTICS_JAFFLE_SHOP, now seed.jaffle_shop.raw_orders)
[0m20:38:50.179207 [debug] [Thread-3 (]: Acquiring new snowflake connection 'seed.jaffle_shop.raw_payments'
[0m20:38:50.180007 [debug] [Thread-1 (]: Began compiling node seed.jaffle_shop.raw_customers
[0m20:38:50.180634 [debug] [Thread-2 (]: Began compiling node seed.jaffle_shop.raw_orders
[0m20:38:50.181201 [debug] [Thread-3 (]: Began compiling node seed.jaffle_shop.raw_payments
[0m20:38:50.181795 [debug] [Thread-1 (]: Began executing node seed.jaffle_shop.raw_customers
[0m20:38:50.182337 [debug] [Thread-2 (]: Began executing node seed.jaffle_shop.raw_orders
[0m20:38:50.183235 [debug] [Thread-3 (]: Began executing node seed.jaffle_shop.raw_payments
[0m20:38:50.240257 [debug] [Thread-3 (]: Using snowflake connection "seed.jaffle_shop.raw_payments"
[0m20:38:50.241698 [debug] [Thread-1 (]: Using snowflake connection "seed.jaffle_shop.raw_customers"
[0m20:38:50.245794 [debug] [Thread-2 (]: Using snowflake connection "seed.jaffle_shop.raw_orders"
[0m20:38:50.246282 [debug] [Thread-3 (]: On seed.jaffle_shop.raw_payments: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_payments"} */
create table raw.JAFFLE_SHOP.raw_payments (id integer,order_id integer,payment_method text,amount integer)
[0m20:38:50.246810 [debug] [Thread-1 (]: On seed.jaffle_shop.raw_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_customers"} */
create table raw.JAFFLE_SHOP.raw_customers (id integer,first_name text,last_name text)
[0m20:38:50.247198 [debug] [Thread-2 (]: On seed.jaffle_shop.raw_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_orders"} */
create table raw.JAFFLE_SHOP.raw_orders (id integer,user_id integer,order_date date,status text)
[0m20:38:50.247567 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m20:38:50.247917 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:38:50.248264 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:38:50.931815 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.683 seconds
[0m20:38:50.962047 [debug] [Thread-2 (]: Using snowflake connection "seed.jaffle_shop.raw_orders"
[0m20:38:50.963073 [debug] [Thread-2 (]: On seed.jaffle_shop.raw_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_orders"} */
BEGIN
[0m20:38:50.979703 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.732 seconds
[0m20:38:50.984222 [debug] [Thread-1 (]: Using snowflake connection "seed.jaffle_shop.raw_customers"
[0m20:38:50.984974 [debug] [Thread-1 (]: On seed.jaffle_shop.raw_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_customers"} */
BEGIN
[0m20:38:50.997521 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.750 seconds
[0m20:38:51.001614 [debug] [Thread-3 (]: Using snowflake connection "seed.jaffle_shop.raw_payments"
[0m20:38:51.002185 [debug] [Thread-3 (]: On seed.jaffle_shop.raw_payments: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_payments"} */
BEGIN
[0m20:38:51.063471 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.099 seconds
[0m20:38:51.071130 [debug] [Thread-2 (]: Using snowflake connection "seed.jaffle_shop.raw_orders"
[0m20:38:51.072253 [debug] [Thread-2 (]: On seed.jaffle_shop.raw_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_orders"} */
insert into raw.JAFFLE_SHOP.raw_orders (id, user_id, order_date, status) values
            (%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),...
[0m20:38:51.102140 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.099 seconds
[0m20:38:51.110082 [debug] [Thread-3 (]: Using snowflake connection "seed.jaffle_shop.raw_payments"
[0m20:38:51.111135 [debug] [Thread-3 (]: On seed.jaffle_shop.raw_payments: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_payments"} */
insert into raw.JAFFLE_SHOP.raw_payments (id, order_id, payment_method, amount) values
            (%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%...
[0m20:38:51.117833 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.132 seconds
[0m20:38:51.122277 [debug] [Thread-1 (]: Using snowflake connection "seed.jaffle_shop.raw_customers"
[0m20:38:51.123117 [debug] [Thread-1 (]: On seed.jaffle_shop.raw_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_customers"} */
insert into raw.JAFFLE_SHOP.raw_customers (id, first_name, last_name) values
            (%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%...
[0m20:38:51.691196 [debug] [Thread-2 (]: SQL status: SUCCESS 99 in 0.618 seconds
[0m20:38:51.692823 [debug] [Thread-2 (]: Using snowflake connection "seed.jaffle_shop.raw_orders"
[0m20:38:51.694022 [debug] [Thread-2 (]: On seed.jaffle_shop.raw_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_orders"} */
COMMIT
[0m20:38:51.852294 [debug] [Thread-3 (]: SQL status: SUCCESS 113 in 0.740 seconds
[0m20:38:51.854060 [debug] [Thread-3 (]: Using snowflake connection "seed.jaffle_shop.raw_payments"
[0m20:38:51.855224 [debug] [Thread-3 (]: On seed.jaffle_shop.raw_payments: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_payments"} */
COMMIT
[0m20:38:51.921306 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.226 seconds
[0m20:38:51.935276 [debug] [Thread-2 (]: Writing runtime SQL for node "seed.jaffle_shop.raw_orders"
[0m20:38:51.968097 [debug] [Thread-2 (]: On seed.jaffle_shop.raw_orders: Close
[0m20:38:52.041413 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.185 seconds
[0m20:38:52.043383 [debug] [Thread-3 (]: Writing runtime SQL for node "seed.jaffle_shop.raw_payments"
[0m20:38:52.048585 [debug] [Thread-3 (]: On seed.jaffle_shop.raw_payments: Close
[0m20:38:52.092881 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e49459f1-b729-41b1-aa4c-fca4547580bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f77b50>]}
[0m20:38:52.094563 [info ] [Thread-2 (]: 2 of 3 OK loaded seed file JAFFLE_SHOP.raw_orders .............................. [[32mINSERT 99[0m in 1.91s]
[0m20:38:52.096084 [debug] [Thread-2 (]: Finished running node seed.jaffle_shop.raw_orders
[0m20:38:52.196432 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e49459f1-b729-41b1-aa4c-fca4547580bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f7cfd0>]}
[0m20:38:52.198172 [info ] [Thread-3 (]: 3 of 3 OK loaded seed file JAFFLE_SHOP.raw_payments ............................ [[32mINSERT 113[0m in 2.02s]
[0m20:38:52.199897 [debug] [Thread-3 (]: Finished running node seed.jaffle_shop.raw_payments
[0m20:38:52.815873 [debug] [Thread-1 (]: SQL status: SUCCESS 100 in 1.692 seconds
[0m20:38:52.816730 [debug] [Thread-1 (]: Using snowflake connection "seed.jaffle_shop.raw_customers"
[0m20:38:52.817326 [debug] [Thread-1 (]: On seed.jaffle_shop.raw_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_customers"} */
COMMIT
[0m20:38:53.014646 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.197 seconds
[0m20:38:53.016809 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.jaffle_shop.raw_customers"
[0m20:38:53.022619 [debug] [Thread-1 (]: On seed.jaffle_shop.raw_customers: Close
[0m20:38:53.158245 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e49459f1-b729-41b1-aa4c-fca4547580bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108357ad0>]}
[0m20:38:53.159484 [info ] [Thread-1 (]: 1 of 3 OK loaded seed file JAFFLE_SHOP.raw_customers ........................... [[32mINSERT 100[0m in 2.98s]
[0m20:38:53.160673 [debug] [Thread-1 (]: Finished running node seed.jaffle_shop.raw_customers
[0m20:38:53.163577 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:38:53.164256 [debug] [MainThread]: Connection 'seed.jaffle_shop.raw_customers' was properly closed.
[0m20:38:53.165067 [debug] [MainThread]: Connection 'seed.jaffle_shop.raw_orders' was properly closed.
[0m20:38:53.165715 [debug] [MainThread]: Connection 'seed.jaffle_shop.raw_payments' was properly closed.
[0m20:38:53.166360 [info ] [MainThread]: 
[0m20:38:53.167095 [info ] [MainThread]: Finished running 3 seeds in 0 hours 0 minutes and 5.42 seconds (5.42s).
[0m20:38:53.169221 [debug] [MainThread]: Command end result
[0m20:38:53.210633 [info ] [MainThread]: 
[0m20:38:53.211239 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:38:53.211619 [info ] [MainThread]: 
[0m20:38:53.212118 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m20:38:53.214392 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": true, "command_wall_clock_time": 7.8990626, "process_user_time": 4.456866, "process_kernel_time": 0.407458, "process_mem_max_rss": "136175616", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m20:38:53.215579 [debug] [MainThread]: Command `dbt seed` succeeded at 20:38:53.215452 after 7.90 seconds
[0m20:38:53.216042 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103bad390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103afc250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103afca50>]}
[0m20:38:53.216428 [debug] [MainThread]: Flushing usage events
[0m20:40:19.751546 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103e9f250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103ef06d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103f055d0>]}


============================== 20:40:19.760342 | 7db8c408-b1fc-4ef8-ab29-10c0fb3546bd ==============================
[0m20:40:19.760342 [info ] [MainThread]: Running with dbt=1.8.7
[0m20:40:19.761136 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/ben/Dbt Certification/dbt-tutorial/logs', 'version_check': 'True', 'profiles_dir': '/Users/ben/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt build', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m20:40:20.296089 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7db8c408-b1fc-4ef8-ab29-10c0fb3546bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103dc5a90>]}
[0m20:40:20.455292 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7db8c408-b1fc-4ef8-ab29-10c0fb3546bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103966990>]}
[0m20:40:20.457014 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m20:40:20.491874 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m20:40:20.631341 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m20:40:20.634648 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '7db8c408-b1fc-4ef8-ab29-10c0fb3546bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102b8c810>]}
[0m20:40:22.163075 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m20:40:22.163734 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '7db8c408-b1fc-4ef8-ab29-10c0fb3546bd', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f00150>]}
[0m20:40:22.373335 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.staging
- seeds.jaffle_shop.raw_payments
[0m20:40:22.379724 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7db8c408-b1fc-4ef8-ab29-10c0fb3546bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10500ff10>]}
[0m20:40:22.687637 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7db8c408-b1fc-4ef8-ab29-10c0fb3546bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10603bdd0>]}
[0m20:40:22.688178 [info ] [MainThread]: Found 7 models, 3 seeds, 11 data tests, 572 macros
[0m20:40:22.691178 [info ] [MainThread]: 
[0m20:40:22.692034 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m20:40:22.696610 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ANALYTICS'
[0m20:40:22.697445 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_raw'
[0m20:40:22.714585 [debug] [ThreadPool]: Using snowflake connection "list_ANALYTICS"
[0m20:40:22.716727 [debug] [ThreadPool]: Using snowflake connection "list_raw"
[0m20:40:22.717087 [debug] [ThreadPool]: On list_ANALYTICS: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_ANALYTICS"} */
show terse schemas in database ANALYTICS
    limit 10000
[0m20:40:22.717643 [debug] [ThreadPool]: On list_raw: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_raw"} */
show terse schemas in database raw
    limit 10000
[0m20:40:22.717974 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:40:22.718283 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:40:23.444417 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.726 seconds
[0m20:40:23.449424 [debug] [ThreadPool]: On list_ANALYTICS: Close
[0m20:40:23.453774 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.735 seconds
[0m20:40:23.456786 [debug] [ThreadPool]: On list_raw: Close
[0m20:40:23.640017 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ANALYTICS, now list_ANALYTICS_JAFFLE_SHOP)
[0m20:40:23.641728 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_raw, now list_raw_JAFFLE_SHOP)
[0m20:40:23.676097 [debug] [ThreadPool]: Using snowflake connection "list_raw_JAFFLE_SHOP"
[0m20:40:23.676972 [debug] [ThreadPool]: Using snowflake connection "list_ANALYTICS_JAFFLE_SHOP"
[0m20:40:23.677419 [debug] [ThreadPool]: On list_raw_JAFFLE_SHOP: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_raw_JAFFLE_SHOP"} */
show objects in raw.JAFFLE_SHOP limit 10000
[0m20:40:23.677890 [debug] [ThreadPool]: On list_ANALYTICS_JAFFLE_SHOP: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_ANALYTICS_JAFFLE_SHOP"} */
show objects in ANALYTICS.JAFFLE_SHOP limit 10000
[0m20:40:23.678324 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:40:23.678789 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:40:24.237730 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.559 seconds
[0m20:40:24.242742 [debug] [ThreadPool]: On list_raw_JAFFLE_SHOP: Close
[0m20:40:24.431548 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.753 seconds
[0m20:40:24.436092 [debug] [ThreadPool]: On list_ANALYTICS_JAFFLE_SHOP: Close
[0m20:40:24.586261 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7db8c408-b1fc-4ef8-ab29-10c0fb3546bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105299950>]}
[0m20:40:24.588060 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:40:24.589173 [info ] [MainThread]: 
[0m20:40:24.595099 [debug] [Thread-1 (]: Began running node model.jaffle_shop.customer_orders
[0m20:40:24.596416 [info ] [Thread-1 (]: 1 of 21 START sql table model JAFFLE_SHOP.customer_orders ...................... [RUN]
[0m20:40:24.597445 [debug] [Thread-2 (]: Began running node model.jaffle_shop.int_orders_test
[0m20:40:24.598194 [debug] [Thread-3 (]: Began running node model.jaffle_shop.stg_customers
[0m20:40:24.598987 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_ANALYTICS_JAFFLE_SHOP, now model.jaffle_shop.customer_orders)
[0m20:40:24.599687 [debug] [Thread-4 (]: Began running node model.jaffle_shop.stg_orders
[0m20:40:24.600740 [info ] [Thread-2 (]: 2 of 21 START sql view model JAFFLE_SHOP.int_orders_test ....................... [RUN]
[0m20:40:24.602400 [info ] [Thread-3 (]: 3 of 21 START sql view model JAFFLE_SHOP.stg_customers ......................... [RUN]
[0m20:40:24.603488 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.customer_orders
[0m20:40:24.604482 [info ] [Thread-4 (]: 4 of 21 START sql view model JAFFLE_SHOP.stg_orders ............................ [RUN]
[0m20:40:24.605356 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_raw_JAFFLE_SHOP, now model.jaffle_shop.int_orders_test)
[0m20:40:24.616925 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.customer_orders"
[0m20:40:24.617794 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.jaffle_shop.stg_orders'
[0m20:40:24.618541 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.jaffle_shop.stg_customers'
[0m20:40:24.619178 [debug] [Thread-2 (]: Began compiling node model.jaffle_shop.int_orders_test
[0m20:40:24.619865 [debug] [Thread-4 (]: Began compiling node model.jaffle_shop.stg_orders
[0m20:40:24.620362 [debug] [Thread-3 (]: Began compiling node model.jaffle_shop.stg_customers
[0m20:40:24.627373 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.customer_orders
[0m20:40:24.630414 [debug] [Thread-4 (]: Writing injected SQL for node "model.jaffle_shop.stg_orders"
[0m20:40:24.632615 [debug] [Thread-2 (]: Using snowflake connection "model.jaffle_shop.int_orders_test"
[0m20:40:24.636855 [debug] [Thread-3 (]: Writing injected SQL for node "model.jaffle_shop.stg_customers"
[0m20:40:24.671099 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.customer_orders"
[0m20:40:24.671706 [debug] [Thread-2 (]: On model.jaffle_shop.int_orders_test: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.int_orders_test"} */
select datediff(
        day,
        cast('2023-01-01' as date),
        cast('2024-01-01' as date)
        )
[0m20:40:24.672136 [debug] [Thread-4 (]: Began executing node model.jaffle_shop.stg_orders
[0m20:40:24.673164 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:40:24.673737 [debug] [Thread-3 (]: Began executing node model.jaffle_shop.stg_customers
[0m20:40:24.681930 [debug] [Thread-1 (]: Using snowflake connection "model.jaffle_shop.customer_orders"
[0m20:40:24.700469 [debug] [Thread-4 (]: Writing runtime sql for node "model.jaffle_shop.stg_orders"
[0m20:40:24.704121 [debug] [Thread-3 (]: Writing runtime sql for node "model.jaffle_shop.stg_customers"
[0m20:40:24.705092 [debug] [Thread-1 (]: On model.jaffle_shop.customer_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.customer_orders"} */
create or replace transient table ANALYTICS.JAFFLE_SHOP.customer_orders
         as
        (WITH paid_orders as (select Orders.ID as order_id,
    Orders.USER_ID	as customer_id,
    Orders.ORDER_DATE AS order_placed_at,
        Orders.STATUS AS order_status,
    p.total_amount_paid,
    p.payment_finalized_date,
    C.FIRST_NAME    as customer_first_name,
        C.LAST_NAME as customer_last_name
FROM raw.jaffle_shop.orders as Orders
left join (select ORDERID as order_id, max(CREATED) as payment_finalized_date, sum(AMOUNT) / 100.0 as total_amount_paid
        from raw.stripe.payment
        where STATUS <> 'fail'
        group by 1) p ON orders.ID = p.order_id
left join raw.jaffle_shop.customers C on orders.USER_ID = C.ID ),

customer_orders 
as (select C.ID as customer_id
    , min(ORDER_DATE) as first_order_date
    , max(ORDER_DATE) as most_recent_order_date
    , count(ORDERS.ID) AS number_of_orders
from raw.jaffle_shop.customers C 
left join raw.jaffle_shop.orders as Orders
on orders.USER_ID = C.ID 
group by 1)

select
p.*,
ROW_NUMBER() OVER (ORDER BY p.order_id) as transaction_seq,
ROW_NUMBER() OVER (PARTITION BY customer_id ORDER BY p.order_id) as customer_sales_seq,
CASE WHEN c.first_order_date = p.order_placed_at
THEN 'new'
ELSE 'return' END as nvsr,
x.clv_bad as customer_lifetime_value,
c.first_order_date as fdos
FROM paid_orders p
left join customer_orders as c USING (customer_id)
LEFT OUTER JOIN 
(
        select
        p.order_id,
        sum(t2.total_amount_paid) as clv_bad
    from paid_orders p
    left join paid_orders t2 on p.customer_id = t2.customer_id and p.order_id >= t2.order_id
    group by 1
    order by p.order_id
) x on x.order_id = p.order_id
ORDER BY order_id
        );
[0m20:40:24.706562 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:40:24.709079 [debug] [Thread-3 (]: Using snowflake connection "model.jaffle_shop.stg_customers"
[0m20:40:24.709941 [debug] [Thread-4 (]: Using snowflake connection "model.jaffle_shop.stg_orders"
[0m20:40:24.710749 [debug] [Thread-3 (]: On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */
create or replace   view ANALYTICS.JAFFLE_SHOP.stg_customers
  
   as (
    -- noinspection SqlNoDataSourceInspectionForFile



select
    id as customer_id,
    first_name,
    last_name

from raw.jaffle_shop.raw_customers
  );
[0m20:40:24.711839 [debug] [Thread-4 (]: On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */
create or replace   view ANALYTICS.JAFFLE_SHOP.stg_orders
  
   as (
    

select
    id as order_id,
    user_id as customer_id,
    order_date,
    status

from raw.jaffle_shop.raw_orders
  );
[0m20:40:24.712378 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m20:40:24.712882 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m20:40:25.168662 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b7b7a8-0000-85ce-002a-090300025f5a
[0m20:40:25.169775 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 002003 (42S02): SQL compilation error:
Object 'RAW.JAFFLE_SHOP.ORDERS' does not exist or not authorized.
[0m20:40:25.171247 [debug] [Thread-1 (]: On model.jaffle_shop.customer_orders: Close
[0m20:40:25.310331 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.637 seconds
[0m20:40:25.318816 [debug] [Thread-2 (]: Writing injected SQL for node "model.jaffle_shop.int_orders_test"
[0m20:40:25.320885 [debug] [Thread-2 (]: Began executing node model.jaffle_shop.int_orders_test
[0m20:40:25.328537 [debug] [Thread-2 (]: Writing runtime sql for node "model.jaffle_shop.int_orders_test"
[0m20:40:25.334567 [debug] [Thread-2 (]: Using snowflake connection "model.jaffle_shop.int_orders_test"
[0m20:40:25.337741 [debug] [Thread-2 (]: On model.jaffle_shop.int_orders_test: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.int_orders_test"} */
create or replace   view ANALYTICS.JAFFLE_SHOP.int_orders_test
  
   as (
    







with rawdata as (

    

    

    with p as (
        select 0 as generated_number union all select 1
    ), unioned as (

    select

    
    p0.generated_number * power(2, 0)
     + 
    
    p1.generated_number * power(2, 1)
     + 
    
    p2.generated_number * power(2, 2)
     + 
    
    p3.generated_number * power(2, 3)
     + 
    
    p4.generated_number * power(2, 4)
     + 
    
    p5.generated_number * power(2, 5)
     + 
    
    p6.generated_number * power(2, 6)
     + 
    
    p7.generated_number * power(2, 7)
     + 
    
    p8.generated_number * power(2, 8)
    
    
    + 1
    as generated_number

    from

    
    p as p0
     cross join 
    
    p as p1
     cross join 
    
    p as p2
     cross join 
    
    p as p3
     cross join 
    
    p as p4
     cross join 
    
    p as p5
     cross join 
    
    p as p6
     cross join 
    
    p as p7
     cross join 
    
    p as p8
    
    

    )

    select *
    from unioned
    where generated_number <= 365
    order by generated_number



),

all_periods as (

    select (
        

    dateadd(
        day,
        row_number() over (order by 1) - 1,
        cast('2023-01-01' as date)
        )


    ) as date_day
    from rawdata

),

filtered as (

    select *
    from all_periods
    where date_day <= cast('2024-01-01' as date)

)

select * from filtered


  );
[0m20:40:25.342652 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.630 seconds
[0m20:40:25.347475 [debug] [Thread-1 (]: Database Error in model customer_orders (models/customer_orders.sql)
  002003 (42S02): SQL compilation error:
  Object 'RAW.JAFFLE_SHOP.ORDERS' does not exist or not authorized.
  compiled code at target/run/jaffle_shop/models/customer_orders.sql
[0m20:40:25.379034 [debug] [Thread-4 (]: On model.jaffle_shop.stg_orders: Close
[0m20:40:25.380864 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7db8c408-b1fc-4ef8-ab29-10c0fb3546bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e8e7d0>]}
[0m20:40:25.383433 [error] [Thread-1 (]: 1 of 21 ERROR creating sql table model JAFFLE_SHOP.customer_orders ............. [[31mERROR[0m in 0.78s]
[0m20:40:25.384943 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.customer_orders
[0m20:40:25.385858 [debug] [Thread-1 (]: Began running node model.jaffle_shop.stg_payments
[0m20:40:25.387377 [info ] [Thread-1 (]: 5 of 21 START sql view model JAFFLE_SHOP.stg_payments .......................... [RUN]
[0m20:40:25.388276 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.jaffle_shop.customer_orders, now model.jaffle_shop.stg_payments)
[0m20:40:25.389190 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.stg_payments
[0m20:40:25.393783 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.stg_payments"
[0m20:40:25.394700 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.stg_payments
[0m20:40:25.397976 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.stg_payments"
[0m20:40:25.399198 [debug] [Thread-1 (]: Using snowflake connection "model.jaffle_shop.stg_payments"
[0m20:40:25.399696 [debug] [Thread-1 (]: On model.jaffle_shop.stg_payments: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_payments"} */
create or replace   view ANALYTICS.JAFFLE_SHOP.stg_payments
  
   as (
    

select
    id,
    order_id,
    payment_method,
    round(1.0 * amount / 100, 2) AS amount_usd

from raw.jaffle_shop.raw_payments
  );
[0m20:40:25.400101 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:40:25.419472 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.707 seconds
[0m20:40:25.422877 [debug] [Thread-3 (]: On model.jaffle_shop.stg_customers: Close
[0m20:40:25.525498 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7db8c408-b1fc-4ef8-ab29-10c0fb3546bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c33950>]}
[0m20:40:25.527799 [info ] [Thread-4 (]: 4 of 21 OK created sql view model JAFFLE_SHOP.stg_orders ....................... [[32mSUCCESS 1[0m in 0.91s]
[0m20:40:25.529778 [debug] [Thread-4 (]: Finished running node model.jaffle_shop.stg_orders
[0m20:40:25.531153 [debug] [Thread-4 (]: Began running node seed.jaffle_shop.raw_customers
[0m20:40:25.532568 [info ] [Thread-4 (]: 6 of 21 START seed file raw.JAFFLE_SHOP.raw_customers .......................... [RUN]
[0m20:40:25.534113 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.jaffle_shop.stg_orders, now seed.jaffle_shop.raw_customers)
[0m20:40:25.535007 [debug] [Thread-4 (]: Began compiling node seed.jaffle_shop.raw_customers
[0m20:40:25.535809 [debug] [Thread-4 (]: Began executing node seed.jaffle_shop.raw_customers
[0m20:40:25.569396 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7db8c408-b1fc-4ef8-ab29-10c0fb3546bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104cd2850>]}
[0m20:40:25.578257 [info ] [Thread-3 (]: 3 of 21 OK created sql view model JAFFLE_SHOP.stg_customers .................... [[32mSUCCESS 1[0m in 0.96s]
[0m20:40:25.584871 [debug] [Thread-4 (]: Using snowflake connection "seed.jaffle_shop.raw_customers"
[0m20:40:25.586047 [debug] [Thread-3 (]: Finished running node model.jaffle_shop.stg_customers
[0m20:40:25.594059 [debug] [Thread-4 (]: On seed.jaffle_shop.raw_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_customers"} */
BEGIN
[0m20:40:25.595233 [debug] [Thread-3 (]: Began running node seed.jaffle_shop.raw_orders
[0m20:40:25.596100 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m20:40:25.596831 [info ] [Thread-3 (]: 7 of 21 START seed file raw.JAFFLE_SHOP.raw_orders ............................. [RUN]
[0m20:40:25.599329 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.jaffle_shop.stg_customers, now seed.jaffle_shop.raw_orders)
[0m20:40:25.599983 [debug] [Thread-3 (]: Began compiling node seed.jaffle_shop.raw_orders
[0m20:40:25.600823 [debug] [Thread-3 (]: Began executing node seed.jaffle_shop.raw_orders
[0m20:40:25.610454 [debug] [Thread-3 (]: Using snowflake connection "seed.jaffle_shop.raw_orders"
[0m20:40:25.611494 [debug] [Thread-3 (]: On seed.jaffle_shop.raw_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_orders"} */
BEGIN
[0m20:40:25.612509 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:40:25.618999 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.280 seconds
[0m20:40:25.623675 [debug] [Thread-2 (]: On model.jaffle_shop.int_orders_test: Close
[0m20:40:25.755130 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7db8c408-b1fc-4ef8-ab29-10c0fb3546bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10648f410>]}
[0m20:40:25.757077 [info ] [Thread-2 (]: 2 of 21 OK created sql view model JAFFLE_SHOP.int_orders_test .................. [[32mSUCCESS 1[0m in 1.15s]
[0m20:40:25.759315 [debug] [Thread-2 (]: Finished running node model.jaffle_shop.int_orders_test
[0m20:40:25.760687 [debug] [Thread-2 (]: Began running node seed.jaffle_shop.raw_payments
[0m20:40:25.762037 [info ] [Thread-2 (]: 8 of 21 START seed file raw.JAFFLE_SHOP.raw_payments ........................... [RUN]
[0m20:40:25.763642 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.jaffle_shop.int_orders_test, now seed.jaffle_shop.raw_payments)
[0m20:40:25.764648 [debug] [Thread-2 (]: Began compiling node seed.jaffle_shop.raw_payments
[0m20:40:25.765552 [debug] [Thread-2 (]: Began executing node seed.jaffle_shop.raw_payments
[0m20:40:25.780477 [debug] [Thread-2 (]: Using snowflake connection "seed.jaffle_shop.raw_payments"
[0m20:40:25.781357 [debug] [Thread-2 (]: On seed.jaffle_shop.raw_payments: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_payments"} */
BEGIN
[0m20:40:25.781982 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:40:25.915100 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.515 seconds
[0m20:40:25.918439 [debug] [Thread-1 (]: On model.jaffle_shop.stg_payments: Close
[0m20:40:26.014715 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.402 seconds
[0m20:40:26.016187 [debug] [Thread-3 (]: Using snowflake connection "seed.jaffle_shop.raw_orders"
[0m20:40:26.017317 [debug] [Thread-3 (]: On seed.jaffle_shop.raw_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_orders"} */
truncate table "RAW"."JAFFLE_SHOP"."RAW_ORDERS"
  ;
[0m20:40:26.058523 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7db8c408-b1fc-4ef8-ab29-10c0fb3546bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d23890>]}
[0m20:40:26.061023 [info ] [Thread-1 (]: 5 of 21 OK created sql view model JAFFLE_SHOP.stg_payments ..................... [[32mSUCCESS 1[0m in 0.67s]
[0m20:40:26.063421 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.stg_payments
[0m20:40:26.064702 [debug] [Thread-1 (]: Began running node test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad
[0m20:40:26.065997 [info ] [Thread-1 (]: 9 of 21 START test accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned  [RUN]
[0m20:40:26.066995 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.jaffle_shop.stg_payments, now test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad)
[0m20:40:26.067727 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad
[0m20:40:26.074601 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad"
[0m20:40:26.076016 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad
[0m20:40:26.103741 [debug] [Thread-1 (]: Writing runtime sql for node "test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad"
[0m20:40:26.109844 [debug] [Thread-1 (]: Using snowflake connection "test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad"
[0m20:40:26.110932 [debug] [Thread-1 (]: On test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        status as value_field,
        count(*) as n_records

    from ANALYTICS.JAFFLE_SHOP.stg_orders
    group by status

)

select *
from all_values
where value_field not in (
    'placed','shipped','completed','return_pending','returned'
)



      
    ) dbt_internal_test
[0m20:40:26.112283 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:40:26.162247 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.566 seconds
[0m20:40:26.163432 [debug] [Thread-4 (]: Using snowflake connection "seed.jaffle_shop.raw_customers"
[0m20:40:26.164371 [debug] [Thread-4 (]: On seed.jaffle_shop.raw_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_customers"} */
truncate table "RAW"."JAFFLE_SHOP"."RAW_CUSTOMERS"
  ;
[0m20:40:26.223013 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.441 seconds
[0m20:40:26.224059 [debug] [Thread-2 (]: Using snowflake connection "seed.jaffle_shop.raw_payments"
[0m20:40:26.224713 [debug] [Thread-2 (]: On seed.jaffle_shop.raw_payments: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_payments"} */
truncate table "RAW"."JAFFLE_SHOP"."RAW_PAYMENTS"
  ;
[0m20:40:26.352958 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.188 seconds
[0m20:40:26.354504 [debug] [Thread-4 (]: Using snowflake connection "seed.jaffle_shop.raw_customers"
[0m20:40:26.355716 [debug] [Thread-4 (]: On seed.jaffle_shop.raw_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_customers"} */
COMMIT
[0m20:40:26.367963 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.349 seconds
[0m20:40:26.369169 [debug] [Thread-3 (]: Using snowflake connection "seed.jaffle_shop.raw_orders"
[0m20:40:26.370113 [debug] [Thread-3 (]: On seed.jaffle_shop.raw_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_orders"} */
COMMIT
[0m20:40:26.421170 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.195 seconds
[0m20:40:26.422747 [debug] [Thread-2 (]: Using snowflake connection "seed.jaffle_shop.raw_payments"
[0m20:40:26.423932 [debug] [Thread-2 (]: On seed.jaffle_shop.raw_payments: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_payments"} */
COMMIT
[0m20:40:26.589494 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.232 seconds
[0m20:40:26.623155 [debug] [Thread-4 (]: Using snowflake connection "seed.jaffle_shop.raw_customers"
[0m20:40:26.623839 [debug] [Thread-4 (]: On seed.jaffle_shop.raw_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_customers"} */
BEGIN
[0m20:40:26.628279 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.257 seconds
[0m20:40:26.632246 [debug] [Thread-3 (]: Using snowflake connection "seed.jaffle_shop.raw_orders"
[0m20:40:26.632739 [debug] [Thread-3 (]: On seed.jaffle_shop.raw_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_orders"} */
BEGIN
[0m20:40:26.679759 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.255 seconds
[0m20:40:26.686634 [debug] [Thread-2 (]: Using snowflake connection "seed.jaffle_shop.raw_payments"
[0m20:40:26.687594 [debug] [Thread-2 (]: On seed.jaffle_shop.raw_payments: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_payments"} */
BEGIN
[0m20:40:26.725932 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.093 seconds
[0m20:40:26.728634 [debug] [Thread-3 (]: Using snowflake connection "seed.jaffle_shop.raw_orders"
[0m20:40:26.729061 [debug] [Thread-3 (]: On seed.jaffle_shop.raw_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_orders"} */
insert into raw.JAFFLE_SHOP.raw_orders (id, user_id, order_date, status) values
            (%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),...
[0m20:40:26.791748 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.103 seconds
[0m20:40:26.800917 [debug] [Thread-2 (]: Using snowflake connection "seed.jaffle_shop.raw_payments"
[0m20:40:26.801956 [debug] [Thread-2 (]: On seed.jaffle_shop.raw_payments: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_payments"} */
insert into raw.JAFFLE_SHOP.raw_payments (id, order_id, payment_method, amount) values
            (%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%...
[0m20:40:26.827267 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.202 seconds
[0m20:40:26.833775 [debug] [Thread-4 (]: Using snowflake connection "seed.jaffle_shop.raw_customers"
[0m20:40:26.834797 [debug] [Thread-4 (]: On seed.jaffle_shop.raw_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_customers"} */
insert into raw.JAFFLE_SHOP.raw_customers (id, first_name, last_name) values
            (%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%...
[0m20:40:27.331316 [debug] [Thread-2 (]: SQL status: SUCCESS 113 in 0.528 seconds
[0m20:40:27.334316 [debug] [Thread-3 (]: SQL status: SUCCESS 99 in 0.605 seconds
[0m20:40:27.338248 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.226 seconds
[0m20:40:27.340976 [debug] [Thread-2 (]: Using snowflake connection "seed.jaffle_shop.raw_payments"
[0m20:40:27.342860 [debug] [Thread-4 (]: SQL status: SUCCESS 100 in 0.507 seconds
[0m20:40:27.343954 [debug] [Thread-3 (]: Using snowflake connection "seed.jaffle_shop.raw_orders"
[0m20:40:27.350052 [debug] [Thread-1 (]: On test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad: Close
[0m20:40:27.350865 [debug] [Thread-2 (]: On seed.jaffle_shop.raw_payments: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_payments"} */
COMMIT
[0m20:40:27.351671 [debug] [Thread-4 (]: Using snowflake connection "seed.jaffle_shop.raw_customers"
[0m20:40:27.352319 [debug] [Thread-3 (]: On seed.jaffle_shop.raw_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_orders"} */
COMMIT
[0m20:40:27.356672 [debug] [Thread-4 (]: On seed.jaffle_shop.raw_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_customers"} */
COMMIT
[0m20:40:27.517821 [info ] [Thread-1 (]: 9 of 21 PASS accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned  [[32mPASS[0m in 1.45s]
[0m20:40:27.519808 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad
[0m20:40:27.521135 [debug] [Thread-1 (]: Began running node test.jaffle_shop.not_null_stg_orders_customer_id.af79d5e4b5
[0m20:40:27.522442 [info ] [Thread-1 (]: 10 of 21 START test not_null_stg_orders_customer_id ............................ [RUN]
[0m20:40:27.523655 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad, now test.jaffle_shop.not_null_stg_orders_customer_id.af79d5e4b5)
[0m20:40:27.524608 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.not_null_stg_orders_customer_id.af79d5e4b5
[0m20:40:27.538757 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.not_null_stg_orders_customer_id.af79d5e4b5"
[0m20:40:27.540678 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.not_null_stg_orders_customer_id.af79d5e4b5
[0m20:40:27.544634 [debug] [Thread-1 (]: Writing runtime sql for node "test.jaffle_shop.not_null_stg_orders_customer_id.af79d5e4b5"
[0m20:40:27.546487 [debug] [Thread-1 (]: Using snowflake connection "test.jaffle_shop.not_null_stg_orders_customer_id.af79d5e4b5"
[0m20:40:27.547130 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_stg_orders_customer_id.af79d5e4b5: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_stg_orders_customer_id.af79d5e4b5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from ANALYTICS.JAFFLE_SHOP.stg_orders
where customer_id is null



      
    ) dbt_internal_test
[0m20:40:27.547655 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:40:27.559235 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.199 seconds
[0m20:40:27.565672 [debug] [Thread-4 (]: Writing runtime SQL for node "seed.jaffle_shop.raw_customers"
[0m20:40:27.568837 [debug] [Thread-4 (]: On seed.jaffle_shop.raw_customers: Close
[0m20:40:27.591454 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.234 seconds
[0m20:40:27.592849 [debug] [Thread-3 (]: Writing runtime SQL for node "seed.jaffle_shop.raw_orders"
[0m20:40:27.596794 [debug] [Thread-3 (]: On seed.jaffle_shop.raw_orders: Close
[0m20:40:27.623840 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.269 seconds
[0m20:40:27.625044 [debug] [Thread-2 (]: Writing runtime SQL for node "seed.jaffle_shop.raw_payments"
[0m20:40:27.628182 [debug] [Thread-2 (]: On seed.jaffle_shop.raw_payments: Close
[0m20:40:27.730569 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7db8c408-b1fc-4ef8-ab29-10c0fb3546bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103d61190>]}
[0m20:40:27.735544 [info ] [Thread-4 (]: 6 of 21 OK loaded seed file JAFFLE_SHOP.raw_customers .......................... [[32mINSERT 100[0m in 2.20s]
[0m20:40:27.738478 [debug] [Thread-4 (]: Finished running node seed.jaffle_shop.raw_customers
[0m20:40:27.739553 [debug] [Thread-4 (]: Began running node test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64
[0m20:40:27.740757 [info ] [Thread-4 (]: 11 of 21 START test not_null_stg_orders_order_id ............................... [RUN]
[0m20:40:27.741750 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly seed.jaffle_shop.raw_customers, now test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64)
[0m20:40:27.742501 [debug] [Thread-4 (]: Began compiling node test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64
[0m20:40:27.749715 [debug] [Thread-4 (]: Writing injected SQL for node "test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64"
[0m20:40:27.752073 [debug] [Thread-4 (]: Began executing node test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64
[0m20:40:27.756910 [debug] [Thread-4 (]: Writing runtime sql for node "test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64"
[0m20:40:27.758492 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7db8c408-b1fc-4ef8-ab29-10c0fb3546bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f06950>]}
[0m20:40:27.759540 [info ] [Thread-3 (]: 7 of 21 OK loaded seed file JAFFLE_SHOP.raw_orders ............................. [[32mINSERT 99[0m in 2.16s]
[0m20:40:27.761250 [debug] [Thread-3 (]: Finished running node seed.jaffle_shop.raw_orders
[0m20:40:27.762004 [debug] [Thread-3 (]: Began running node test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a
[0m20:40:27.762671 [info ] [Thread-3 (]: 12 of 21 START test unique_stg_orders_order_id ................................. [RUN]
[0m20:40:27.763688 [debug] [Thread-4 (]: Using snowflake connection "test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64"
[0m20:40:27.764503 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7db8c408-b1fc-4ef8-ab29-10c0fb3546bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c5d790>]}
[0m20:40:27.765065 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly seed.jaffle_shop.raw_orders, now test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a)
[0m20:40:27.765572 [debug] [Thread-4 (]: On test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select order_id
from ANALYTICS.JAFFLE_SHOP.stg_orders
where order_id is null



      
    ) dbt_internal_test
[0m20:40:27.766196 [info ] [Thread-2 (]: 8 of 21 OK loaded seed file JAFFLE_SHOP.raw_payments ........................... [[32mINSERT 113[0m in 2.00s]
[0m20:40:27.766778 [debug] [Thread-3 (]: Began compiling node test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a
[0m20:40:27.767224 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m20:40:27.767802 [debug] [Thread-2 (]: Finished running node seed.jaffle_shop.raw_payments
[0m20:40:27.775143 [debug] [Thread-3 (]: Writing injected SQL for node "test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a"
[0m20:40:27.777686 [debug] [Thread-2 (]: Began running node test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m20:40:27.778851 [info ] [Thread-2 (]: 13 of 21 START test not_null_stg_customers_customer_id ......................... [RUN]
[0m20:40:27.780091 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly seed.jaffle_shop.raw_payments, now test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa)
[0m20:40:27.781242 [debug] [Thread-2 (]: Began compiling node test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m20:40:27.785722 [debug] [Thread-2 (]: Writing injected SQL for node "test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m20:40:27.786204 [debug] [Thread-3 (]: Began executing node test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a
[0m20:40:27.792340 [debug] [Thread-3 (]: Writing runtime sql for node "test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a"
[0m20:40:27.793296 [debug] [Thread-2 (]: Began executing node test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m20:40:27.796412 [debug] [Thread-2 (]: Writing runtime sql for node "test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m20:40:27.797649 [debug] [Thread-3 (]: Using snowflake connection "test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a"
[0m20:40:27.798150 [debug] [Thread-3 (]: On test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    order_id as unique_field,
    count(*) as n_records

from ANALYTICS.JAFFLE_SHOP.stg_orders
where order_id is not null
group by order_id
having count(*) > 1



      
    ) dbt_internal_test
[0m20:40:27.798583 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:40:27.799872 [debug] [Thread-2 (]: Using snowflake connection "test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m20:40:27.801105 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from ANALYTICS.JAFFLE_SHOP.stg_customers
where customer_id is null



      
    ) dbt_internal_test
[0m20:40:27.801817 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:40:28.269634 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.722 seconds
[0m20:40:28.273776 [debug] [Thread-1 (]: On test.jaffle_shop.not_null_stg_orders_customer_id.af79d5e4b5: Close
[0m20:40:28.422160 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.620 seconds
[0m20:40:28.425986 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa: Close
[0m20:40:28.436450 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.669 seconds
[0m20:40:28.440047 [debug] [Thread-4 (]: On test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64: Close
[0m20:40:28.501117 [info ] [Thread-1 (]: 10 of 21 PASS not_null_stg_orders_customer_id .................................. [[32mPASS[0m in 0.98s]
[0m20:40:28.506039 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.not_null_stg_orders_customer_id.af79d5e4b5
[0m20:40:28.507263 [debug] [Thread-1 (]: Began running node test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m20:40:28.509338 [info ] [Thread-1 (]: 14 of 21 START test relationships_stg_orders_customer_id__customer_id__ref_stg_customers_  [RUN]
[0m20:40:28.510694 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.jaffle_shop.not_null_stg_orders_customer_id.af79d5e4b5, now test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500)
[0m20:40:28.512570 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m20:40:28.522911 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"
[0m20:40:28.525146 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m20:40:28.530462 [debug] [Thread-1 (]: Writing runtime sql for node "test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"
[0m20:40:28.532343 [debug] [Thread-1 (]: Using snowflake connection "test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"
[0m20:40:28.532932 [debug] [Thread-1 (]: On test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select customer_id as from_field
    from ANALYTICS.JAFFLE_SHOP.stg_orders
    where customer_id is not null
),

parent as (
    select customer_id as to_field
    from ANALYTICS.JAFFLE_SHOP.stg_customers
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m20:40:28.533465 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:40:28.585790 [info ] [Thread-4 (]: 11 of 21 PASS not_null_stg_orders_order_id ..................................... [[32mPASS[0m in 0.84s]
[0m20:40:28.587290 [debug] [Thread-4 (]: Finished running node test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64
[0m20:40:28.587896 [debug] [Thread-4 (]: Began running node test.jaffle_shop.unique_stg_customers_customer_id.c7614daada
[0m20:40:28.588510 [info ] [Thread-4 (]: 15 of 21 START test unique_stg_customers_customer_id ........................... [RUN]
[0m20:40:28.589071 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64, now test.jaffle_shop.unique_stg_customers_customer_id.c7614daada)
[0m20:40:28.589776 [info ] [Thread-2 (]: 13 of 21 PASS not_null_stg_customers_customer_id ............................... [[32mPASS[0m in 0.81s]
[0m20:40:28.590228 [debug] [Thread-4 (]: Began compiling node test.jaffle_shop.unique_stg_customers_customer_id.c7614daada
[0m20:40:28.590869 [debug] [Thread-2 (]: Finished running node test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m20:40:28.595210 [debug] [Thread-4 (]: Writing injected SQL for node "test.jaffle_shop.unique_stg_customers_customer_id.c7614daada"
[0m20:40:28.595971 [debug] [Thread-2 (]: Began running node test.jaffle_shop.not_null_stg_payments_id.e8564391ab
[0m20:40:28.596788 [info ] [Thread-2 (]: 16 of 21 START test not_null_stg_payments_id ................................... [RUN]
[0m20:40:28.597409 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa, now test.jaffle_shop.not_null_stg_payments_id.e8564391ab)
[0m20:40:28.597856 [debug] [Thread-2 (]: Began compiling node test.jaffle_shop.not_null_stg_payments_id.e8564391ab
[0m20:40:28.601821 [debug] [Thread-2 (]: Writing injected SQL for node "test.jaffle_shop.not_null_stg_payments_id.e8564391ab"
[0m20:40:28.602480 [debug] [Thread-4 (]: Began executing node test.jaffle_shop.unique_stg_customers_customer_id.c7614daada
[0m20:40:28.605836 [debug] [Thread-4 (]: Writing runtime sql for node "test.jaffle_shop.unique_stg_customers_customer_id.c7614daada"
[0m20:40:28.607250 [debug] [Thread-2 (]: Began executing node test.jaffle_shop.not_null_stg_payments_id.e8564391ab
[0m20:40:28.610939 [debug] [Thread-2 (]: Writing runtime sql for node "test.jaffle_shop.not_null_stg_payments_id.e8564391ab"
[0m20:40:28.612175 [debug] [Thread-4 (]: Using snowflake connection "test.jaffle_shop.unique_stg_customers_customer_id.c7614daada"
[0m20:40:28.612949 [debug] [Thread-4 (]: On test.jaffle_shop.unique_stg_customers_customer_id.c7614daada: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.unique_stg_customers_customer_id.c7614daada"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    customer_id as unique_field,
    count(*) as n_records

from ANALYTICS.JAFFLE_SHOP.stg_customers
where customer_id is not null
group by customer_id
having count(*) > 1



      
    ) dbt_internal_test
[0m20:40:28.613456 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m20:40:28.614832 [debug] [Thread-2 (]: Using snowflake connection "test.jaffle_shop.not_null_stg_payments_id.e8564391ab"
[0m20:40:28.615941 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_stg_payments_id.e8564391ab: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_stg_payments_id.e8564391ab"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from ANALYTICS.JAFFLE_SHOP.stg_payments
where id is null



      
    ) dbt_internal_test
[0m20:40:28.616522 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:40:28.673789 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.875 seconds
[0m20:40:28.677102 [debug] [Thread-3 (]: On test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a: Close
[0m20:40:28.831557 [info ] [Thread-3 (]: 12 of 21 PASS unique_stg_orders_order_id ....................................... [[32mPASS[0m in 1.07s]
[0m20:40:28.832980 [debug] [Thread-3 (]: Finished running node test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a
[0m20:40:28.833669 [debug] [Thread-3 (]: Began running node test.jaffle_shop.unique_stg_payments_id.74793dfa8f
[0m20:40:28.834359 [info ] [Thread-3 (]: 17 of 21 START test unique_stg_payments_id ..................................... [RUN]
[0m20:40:28.835108 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a, now test.jaffle_shop.unique_stg_payments_id.74793dfa8f)
[0m20:40:28.835677 [debug] [Thread-3 (]: Began compiling node test.jaffle_shop.unique_stg_payments_id.74793dfa8f
[0m20:40:28.841411 [debug] [Thread-3 (]: Writing injected SQL for node "test.jaffle_shop.unique_stg_payments_id.74793dfa8f"
[0m20:40:28.842562 [debug] [Thread-3 (]: Began executing node test.jaffle_shop.unique_stg_payments_id.74793dfa8f
[0m20:40:28.849036 [debug] [Thread-3 (]: Writing runtime sql for node "test.jaffle_shop.unique_stg_payments_id.74793dfa8f"
[0m20:40:28.853359 [debug] [Thread-3 (]: Using snowflake connection "test.jaffle_shop.unique_stg_payments_id.74793dfa8f"
[0m20:40:28.854434 [debug] [Thread-3 (]: On test.jaffle_shop.unique_stg_payments_id.74793dfa8f: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.unique_stg_payments_id.74793dfa8f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from ANALYTICS.JAFFLE_SHOP.stg_payments
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m20:40:28.855476 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:40:29.290334 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.756 seconds
[0m20:40:29.295283 [debug] [Thread-1 (]: On test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500: Close
[0m20:40:29.300122 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.683 seconds
[0m20:40:29.304513 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_stg_payments_id.e8564391ab: Close
[0m20:40:29.324003 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.710 seconds
[0m20:40:29.329080 [debug] [Thread-4 (]: On test.jaffle_shop.unique_stg_customers_customer_id.c7614daada: Close
[0m20:40:29.458571 [info ] [Thread-2 (]: 16 of 21 PASS not_null_stg_payments_id ......................................... [[32mPASS[0m in 0.86s]
[0m20:40:29.460307 [info ] [Thread-1 (]: 14 of 21 PASS relationships_stg_orders_customer_id__customer_id__ref_stg_customers_  [[32mPASS[0m in 0.95s]
[0m20:40:29.461765 [debug] [Thread-2 (]: Finished running node test.jaffle_shop.not_null_stg_payments_id.e8564391ab
[0m20:40:29.463345 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m20:40:29.471156 [info ] [Thread-4 (]: 15 of 21 PASS unique_stg_customers_customer_id ................................. [[32mPASS[0m in 0.88s]
[0m20:40:29.472852 [debug] [Thread-4 (]: Finished running node test.jaffle_shop.unique_stg_customers_customer_id.c7614daada
[0m20:40:29.474001 [debug] [Thread-2 (]: Began running node model.jaffle_shop.customers
[0m20:40:29.475196 [info ] [Thread-2 (]: 18 of 21 START sql view model JAFFLE_SHOP.customers ............................ [RUN]
[0m20:40:29.476708 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.jaffle_shop.not_null_stg_payments_id.e8564391ab, now model.jaffle_shop.customers)
[0m20:40:29.477656 [debug] [Thread-2 (]: Began compiling node model.jaffle_shop.customers
[0m20:40:29.485372 [debug] [Thread-2 (]: Writing injected SQL for node "model.jaffle_shop.customers"
[0m20:40:29.486622 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.631 seconds
[0m20:40:29.489393 [debug] [Thread-3 (]: On test.jaffle_shop.unique_stg_payments_id.74793dfa8f: Close
[0m20:40:29.491744 [debug] [Thread-2 (]: Began executing node model.jaffle_shop.customers
[0m20:40:29.497051 [debug] [Thread-2 (]: Writing runtime sql for node "model.jaffle_shop.customers"
[0m20:40:29.499939 [debug] [Thread-2 (]: Using snowflake connection "model.jaffle_shop.customers"
[0m20:40:29.500985 [debug] [Thread-2 (]: On model.jaffle_shop.customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.customers"} */
create or replace   view ANALYTICS.JAFFLE_SHOP.customers
  
   as (
    


with customers as (

    select * from ANALYTICS.JAFFLE_SHOP.stg_customers

),

orders as (

    select * from ANALYTICS.JAFFLE_SHOP.stg_orders

),

customer_orders as (

    select
        customer_id,

        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders

    from orders

    group by 1

),

final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce(customer_orders.number_of_orders, 0) as number_of_orders

    from customers

    left join customer_orders using (customer_id)

)

select * from final
  );
[0m20:40:29.501998 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:40:29.629058 [info ] [Thread-3 (]: 17 of 21 PASS unique_stg_payments_id ........................................... [[32mPASS[0m in 0.79s]
[0m20:40:29.631008 [debug] [Thread-3 (]: Finished running node test.jaffle_shop.unique_stg_payments_id.74793dfa8f
[0m20:40:29.632747 [debug] [Thread-4 (]: Began running node model.jaffle_shop.int_orders__pivoted
[0m20:40:29.634170 [info ] [Thread-4 (]: 19 of 21 START sql view model JAFFLE_SHOP.int_orders__pivoted .................. [RUN]
[0m20:40:29.635343 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.jaffle_shop.unique_stg_customers_customer_id.c7614daada, now model.jaffle_shop.int_orders__pivoted)
[0m20:40:29.636256 [debug] [Thread-4 (]: Began compiling node model.jaffle_shop.int_orders__pivoted
[0m20:40:29.645525 [debug] [Thread-4 (]: Writing injected SQL for node "model.jaffle_shop.int_orders__pivoted"
[0m20:40:29.647205 [debug] [Thread-4 (]: Began executing node model.jaffle_shop.int_orders__pivoted
[0m20:40:29.654422 [debug] [Thread-4 (]: Writing runtime sql for node "model.jaffle_shop.int_orders__pivoted"
[0m20:40:29.657187 [debug] [Thread-4 (]: Using snowflake connection "model.jaffle_shop.int_orders__pivoted"
[0m20:40:29.658036 [debug] [Thread-4 (]: On model.jaffle_shop.int_orders__pivoted: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.int_orders__pivoted"} */
create or replace   view ANALYTICS.JAFFLE_SHOP.int_orders__pivoted
  
   as (
    



WITH payments AS (
    SELECT p.id AS id,
           p.order_id AS order_id,
           p.payment_method AS payment_method,
           p.amount_usd AS amount,
           o.status AS status
    FROM ANALYTICS.JAFFLE_SHOP.stg_payments p
    JOIN ANALYTICS.JAFFLE_SHOP.stg_orders o
    ON p.order_id = o.order_id
),
pivoted AS (
    SELECT
        order_id,
        SUM(CASE WHEN payment_method = 'bank_transfer' THEN amount ELSE 0 END) AS bank_transfer_amount,
        SUM(CASE WHEN payment_method = 'coupon' THEN amount ELSE 0 END) AS coupon_amount,
        SUM(CASE WHEN payment_method = 'credit_card' THEN amount ELSE 0 END) AS credit_card_amount,
        SUM(CASE WHEN payment_method = 'gift_card' THEN amount ELSE 0 END) AS gift_card_amount
    FROM payments
    WHERE status = 'completed'
    GROUP BY 1
)

SELECT * FROM pivoted
  );
[0m20:40:29.658633 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m20:40:30.084581 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.582 seconds
[0m20:40:30.088818 [debug] [Thread-2 (]: On model.jaffle_shop.customers: Close
[0m20:40:30.210957 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7db8c408-b1fc-4ef8-ab29-10c0fb3546bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105440690>]}
[0m20:40:30.212767 [info ] [Thread-2 (]: 18 of 21 OK created sql view model JAFFLE_SHOP.customers ....................... [[32mSUCCESS 1[0m in 0.73s]
[0m20:40:30.214173 [debug] [Thread-2 (]: Finished running node model.jaffle_shop.customers
[0m20:40:30.215627 [debug] [Thread-3 (]: Began running node test.jaffle_shop.not_null_customers_customer_id.5c9bf9911d
[0m20:40:30.216702 [debug] [Thread-1 (]: Began running node test.jaffle_shop.unique_customers_customer_id.c5af1ff4b1
[0m20:40:30.217598 [info ] [Thread-3 (]: 20 of 21 START test not_null_customers_customer_id ............................. [RUN]
[0m20:40:30.218640 [info ] [Thread-1 (]: 21 of 21 START test unique_customers_customer_id ............................... [RUN]
[0m20:40:30.219718 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.jaffle_shop.unique_stg_payments_id.74793dfa8f, now test.jaffle_shop.not_null_customers_customer_id.5c9bf9911d)
[0m20:40:30.220612 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500, now test.jaffle_shop.unique_customers_customer_id.c5af1ff4b1)
[0m20:40:30.221538 [debug] [Thread-3 (]: Began compiling node test.jaffle_shop.not_null_customers_customer_id.5c9bf9911d
[0m20:40:30.222357 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.unique_customers_customer_id.c5af1ff4b1
[0m20:40:30.229974 [debug] [Thread-3 (]: Writing injected SQL for node "test.jaffle_shop.not_null_customers_customer_id.5c9bf9911d"
[0m20:40:30.237300 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.unique_customers_customer_id.c5af1ff4b1"
[0m20:40:30.238400 [debug] [Thread-3 (]: Began executing node test.jaffle_shop.not_null_customers_customer_id.5c9bf9911d
[0m20:40:30.241825 [debug] [Thread-3 (]: Writing runtime sql for node "test.jaffle_shop.not_null_customers_customer_id.5c9bf9911d"
[0m20:40:30.242403 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.unique_customers_customer_id.c5af1ff4b1
[0m20:40:30.245506 [debug] [Thread-1 (]: Writing runtime sql for node "test.jaffle_shop.unique_customers_customer_id.c5af1ff4b1"
[0m20:40:30.246612 [debug] [Thread-3 (]: Using snowflake connection "test.jaffle_shop.not_null_customers_customer_id.5c9bf9911d"
[0m20:40:30.247094 [debug] [Thread-3 (]: On test.jaffle_shop.not_null_customers_customer_id.5c9bf9911d: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_customers_customer_id.5c9bf9911d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from ANALYTICS.JAFFLE_SHOP.customers
where customer_id is null



      
    ) dbt_internal_test
[0m20:40:30.247513 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:40:30.249183 [debug] [Thread-1 (]: Using snowflake connection "test.jaffle_shop.unique_customers_customer_id.c5af1ff4b1"
[0m20:40:30.250300 [debug] [Thread-1 (]: On test.jaffle_shop.unique_customers_customer_id.c5af1ff4b1: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.unique_customers_customer_id.c5af1ff4b1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    customer_id as unique_field,
    count(*) as n_records

from ANALYTICS.JAFFLE_SHOP.customers
where customer_id is not null
group by customer_id
having count(*) > 1



      
    ) dbt_internal_test
[0m20:40:30.251481 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:40:30.305291 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.647 seconds
[0m20:40:30.308828 [debug] [Thread-4 (]: On model.jaffle_shop.int_orders__pivoted: Close
[0m20:40:30.467688 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7db8c408-b1fc-4ef8-ab29-10c0fb3546bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105eca990>]}
[0m20:40:30.468736 [info ] [Thread-4 (]: 19 of 21 OK created sql view model JAFFLE_SHOP.int_orders__pivoted ............. [[32mSUCCESS 1[0m in 0.83s]
[0m20:40:30.469646 [debug] [Thread-4 (]: Finished running node model.jaffle_shop.int_orders__pivoted
[0m20:40:31.324370 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.076 seconds
[0m20:40:31.329111 [debug] [Thread-3 (]: On test.jaffle_shop.not_null_customers_customer_id.5c9bf9911d: Close
[0m20:40:31.358420 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.107 seconds
[0m20:40:31.363268 [debug] [Thread-1 (]: On test.jaffle_shop.unique_customers_customer_id.c5af1ff4b1: Close
[0m20:40:31.466255 [info ] [Thread-3 (]: 20 of 21 PASS not_null_customers_customer_id ................................... [[32mPASS[0m in 1.25s]
[0m20:40:31.468754 [debug] [Thread-3 (]: Finished running node test.jaffle_shop.not_null_customers_customer_id.5c9bf9911d
[0m20:40:31.494029 [info ] [Thread-1 (]: 21 of 21 PASS unique_customers_customer_id ..................................... [[32mPASS[0m in 1.27s]
[0m20:40:31.514037 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.unique_customers_customer_id.c5af1ff4b1
[0m20:40:31.517092 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:40:31.517735 [debug] [MainThread]: Connection 'test.jaffle_shop.unique_customers_customer_id.c5af1ff4b1' was properly closed.
[0m20:40:31.518272 [debug] [MainThread]: Connection 'model.jaffle_shop.customers' was properly closed.
[0m20:40:31.519002 [debug] [MainThread]: Connection 'model.jaffle_shop.int_orders__pivoted' was properly closed.
[0m20:40:31.519570 [debug] [MainThread]: Connection 'test.jaffle_shop.not_null_customers_customer_id.5c9bf9911d' was properly closed.
[0m20:40:31.520325 [info ] [MainThread]: 
[0m20:40:31.520966 [info ] [MainThread]: Finished running 1 table model, 6 view models, 11 data tests, 3 seeds in 0 hours 0 minutes and 8.83 seconds (8.83s).
[0m20:40:31.526564 [debug] [MainThread]: Command end result
[0m20:40:31.565102 [info ] [MainThread]: 
[0m20:40:31.565651 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m20:40:31.566012 [info ] [MainThread]: 
[0m20:40:31.566443 [error] [MainThread]:   Database Error in model customer_orders (models/customer_orders.sql)
  002003 (42S02): SQL compilation error:
  Object 'RAW.JAFFLE_SHOP.ORDERS' does not exist or not authorized.
  compiled code at target/run/jaffle_shop/models/customer_orders.sql
[0m20:40:31.566882 [info ] [MainThread]: 
[0m20:40:31.567407 [info ] [MainThread]: Done. PASS=20 WARN=0 ERROR=1 SKIP=0 TOTAL=21
[0m20:40:31.570170 [debug] [MainThread]: Resource report: {"command_name": "build", "command_wall_clock_time": 11.899762, "process_user_time": 6.438582, "process_kernel_time": 0.767742, "process_mem_max_rss": "174743552", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m20:40:31.571154 [debug] [MainThread]: Command `dbt build` failed at 20:40:31.571036 after 11.90 seconds
[0m20:40:31.571896 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103ee7950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x100940c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1021fed50>]}
[0m20:40:31.572767 [debug] [MainThread]: Flushing usage events
[0m20:40:45.031777 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112c6f1d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112cc6050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1119efb90>]}


============================== 20:40:45.039216 | 6f2fa9d4-9b16-47dd-a9f7-aeb28f2362d7 ==============================
[0m20:40:45.039216 [info ] [MainThread]: Running with dbt=1.8.7
[0m20:40:45.040181 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/ben/Dbt Certification/dbt-tutorial/logs', 'profiles_dir': '/Users/ben/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt clean', 'send_anonymous_usage_stats': 'True'}
[0m20:40:45.154229 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6f2fa9d4-9b16-47dd-a9f7-aeb28f2362d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1118d1610>]}
[0m20:40:45.213142 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.26158372, "process_user_time": 1.336456, "process_kernel_time": 0.227862, "process_mem_max_rss": "92762112", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m20:40:45.213885 [debug] [MainThread]: Command `dbt clean` succeeded at 20:40:45.213765 after 0.26 seconds
[0m20:40:45.214337 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112cc7e90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112cc7c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f761490>]}
[0m20:40:45.214763 [debug] [MainThread]: Flushing usage events
[0m20:40:49.862009 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f25bb10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f2ab050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f2c9450>]}


============================== 20:40:49.868580 | ad81352c-e71b-407b-b578-d5f4f21ba6cb ==============================
[0m20:40:49.868580 [info ] [MainThread]: Running with dbt=1.8.7
[0m20:40:49.869786 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/ben/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/ben/Dbt Certification/dbt-tutorial/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'invocation_command': 'dbt deps', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:40:49.986044 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ad81352c-e71b-407b-b578-d5f4f21ba6cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f300e50>]}
[0m20:40:50.014817 [debug] [MainThread]: Set downloads directory='/var/folders/r5/kwzghqz92v73843mkcq0vhp40000gn/T/dbt-downloads-yhzl852x'
[0m20:40:50.015317 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m20:40:50.256889 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m20:40:50.258911 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m20:40:50.372397 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m20:40:50.386310 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m20:40:50.740010 [info ] [MainThread]: Installed from version 1.3.0
[0m20:40:50.740852 [info ] [MainThread]: Up to date!
[0m20:40:50.741661 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'ad81352c-e71b-407b-b578-d5f4f21ba6cb', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ee6b3d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ded4c10>]}
[0m20:40:50.744822 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.96014994, "process_user_time": 1.455562, "process_kernel_time": 0.287163, "process_mem_max_rss": "95965184", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m20:40:50.746081 [debug] [MainThread]: Command `dbt deps` succeeded at 20:40:50.745808 after 0.96 seconds
[0m20:40:50.746976 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bd49310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f322b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bc98b90>]}
[0m20:40:50.747908 [debug] [MainThread]: Flushing usage events
[0m20:42:28.263750 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e960ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e9b8e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e9af310>]}


============================== 20:42:28.270267 | 534bf876-f951-4e19-8f21-f633c6b01635 ==============================
[0m20:42:28.270267 [info ] [MainThread]: Running with dbt=1.8.7
[0m20:42:28.271100 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/ben/Dbt Certification/dbt-tutorial/logs', 'debug': 'False', 'profiles_dir': '/Users/ben/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt seed', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m20:42:28.801397 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '534bf876-f951-4e19-8f21-f633c6b01635', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e998650>]}
[0m20:42:28.856426 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '534bf876-f951-4e19-8f21-f633c6b01635', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e412a50>]}
[0m20:42:28.857961 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m20:42:28.887175 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m20:42:28.888338 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m20:42:28.888874 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '534bf876-f951-4e19-8f21-f633c6b01635', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10de24890>]}
[0m20:42:30.405580 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m20:42:30.406356 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '534bf876-f951-4e19-8f21-f633c6b01635', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f9b5e50>]}
[0m20:42:30.632602 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.staging
[0m20:42:30.638059 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '534bf876-f951-4e19-8f21-f633c6b01635', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fa5aed0>]}
[0m20:42:30.770723 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '534bf876-f951-4e19-8f21-f633c6b01635', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fc1ff10>]}
[0m20:42:30.771549 [info ] [MainThread]: Found 7 models, 3 seeds, 11 data tests, 572 macros
[0m20:42:30.772176 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '534bf876-f951-4e19-8f21-f633c6b01635', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fc8e1d0>]}
[0m20:42:30.774491 [info ] [MainThread]: 
[0m20:42:30.775217 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m20:42:30.781032 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_raw'
[0m20:42:30.782598 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_raw'
[0m20:42:30.792116 [debug] [ThreadPool]: Using snowflake connection "list_raw"
[0m20:42:30.795118 [debug] [ThreadPool]: Using snowflake connection "list_raw"
[0m20:42:30.795616 [debug] [ThreadPool]: On list_raw: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_raw"} */
show terse schemas in database raw
    limit 10000
[0m20:42:30.795997 [debug] [ThreadPool]: On list_raw: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_raw"} */
show terse schemas in database raw
    limit 10000
[0m20:42:30.796339 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:42:30.796666 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:42:31.526977 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.730 seconds
[0m20:42:31.531951 [debug] [ThreadPool]: On list_raw: Close
[0m20:42:31.538708 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.742 seconds
[0m20:42:31.542287 [debug] [ThreadPool]: On list_raw: Close
[0m20:42:31.681045 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_raw, now create_raw_JAFFLE_SHOP)
[0m20:42:31.682491 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_raw, now create_raw_JAFFLE_SHOP_stripe)
[0m20:42:31.685223 [debug] [ThreadPool]: Creating schema "database: "raw"
schema: "JAFFLE_SHOP"
"
[0m20:42:31.687397 [debug] [ThreadPool]: Creating schema "database: "raw"
schema: "JAFFLE_SHOP_stripe"
"
[0m20:42:31.698840 [debug] [ThreadPool]: Using snowflake connection "create_raw_JAFFLE_SHOP"
[0m20:42:31.702898 [debug] [ThreadPool]: Using snowflake connection "create_raw_JAFFLE_SHOP_stripe"
[0m20:42:31.703653 [debug] [ThreadPool]: On create_raw_JAFFLE_SHOP: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "create_raw_JAFFLE_SHOP"} */
create schema if not exists raw.JAFFLE_SHOP
[0m20:42:31.704328 [debug] [ThreadPool]: On create_raw_JAFFLE_SHOP_stripe: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "create_raw_JAFFLE_SHOP_stripe"} */
create schema if not exists raw.JAFFLE_SHOP_stripe
[0m20:42:31.704887 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:42:31.705631 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:42:32.303036 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.598 seconds
[0m20:42:32.305821 [debug] [ThreadPool]: On create_raw_JAFFLE_SHOP: Close
[0m20:42:32.404851 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.699 seconds
[0m20:42:32.407871 [debug] [ThreadPool]: On create_raw_JAFFLE_SHOP_stripe: Close
[0m20:42:32.579194 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_raw_JAFFLE_SHOP, now list_ANALYTICS_JAFFLE_SHOP)
[0m20:42:32.580791 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_raw_JAFFLE_SHOP_stripe, now list_raw_JAFFLE_SHOP)
[0m20:42:32.582250 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_raw_JAFFLE_SHOP_stripe'
[0m20:42:32.654716 [debug] [ThreadPool]: Using snowflake connection "list_ANALYTICS_JAFFLE_SHOP"
[0m20:42:32.657017 [debug] [ThreadPool]: Using snowflake connection "list_raw_JAFFLE_SHOP"
[0m20:42:32.659303 [debug] [ThreadPool]: Using snowflake connection "list_raw_JAFFLE_SHOP_stripe"
[0m20:42:32.659703 [debug] [ThreadPool]: On list_ANALYTICS_JAFFLE_SHOP: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_ANALYTICS_JAFFLE_SHOP"} */
show objects in ANALYTICS.JAFFLE_SHOP limit 10000
[0m20:42:32.660071 [debug] [ThreadPool]: On list_raw_JAFFLE_SHOP: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_raw_JAFFLE_SHOP"} */
show objects in raw.JAFFLE_SHOP limit 10000
[0m20:42:32.660399 [debug] [ThreadPool]: On list_raw_JAFFLE_SHOP_stripe: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_raw_JAFFLE_SHOP_stripe"} */
show objects in raw.JAFFLE_SHOP_stripe limit 10000
[0m20:42:32.660712 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:42:32.661010 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:42:32.661301 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:42:33.100161 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.439 seconds
[0m20:42:33.108192 [debug] [ThreadPool]: On list_raw_JAFFLE_SHOP_stripe: Close
[0m20:42:33.117661 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.457 seconds
[0m20:42:33.121423 [debug] [ThreadPool]: On list_ANALYTICS_JAFFLE_SHOP: Close
[0m20:42:33.216828 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.556 seconds
[0m20:42:33.220762 [debug] [ThreadPool]: On list_raw_JAFFLE_SHOP: Close
[0m20:42:33.365246 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '534bf876-f951-4e19-8f21-f633c6b01635', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fee3c50>]}
[0m20:42:33.367025 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:42:33.368143 [info ] [MainThread]: 
[0m20:42:33.374347 [debug] [Thread-1 (]: Began running node seed.jaffle_shop.raw_customers
[0m20:42:33.375596 [info ] [Thread-1 (]: 1 of 3 START seed file raw.JAFFLE_SHOP.raw_customers ........................... [RUN]
[0m20:42:33.376521 [debug] [Thread-2 (]: Began running node seed.jaffle_shop.raw_orders
[0m20:42:33.377546 [debug] [Thread-3 (]: Began running node seed.jaffle_shop.raw_payments
[0m20:42:33.378367 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_ANALYTICS_JAFFLE_SHOP, now seed.jaffle_shop.raw_customers)
[0m20:42:33.379292 [info ] [Thread-2 (]: 2 of 3 START seed file raw.JAFFLE_SHOP.raw_orders .............................. [RUN]
[0m20:42:33.380219 [info ] [Thread-3 (]: 3 of 3 START seed file raw.JAFFLE_SHOP_stripe.raw_payments ..................... [RUN]
[0m20:42:33.381000 [debug] [Thread-1 (]: Began compiling node seed.jaffle_shop.raw_customers
[0m20:42:33.381759 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_raw_JAFFLE_SHOP, now seed.jaffle_shop.raw_orders)
[0m20:42:33.382433 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_raw_JAFFLE_SHOP_stripe, now seed.jaffle_shop.raw_payments)
[0m20:42:33.383100 [debug] [Thread-1 (]: Began executing node seed.jaffle_shop.raw_customers
[0m20:42:33.383716 [debug] [Thread-2 (]: Began compiling node seed.jaffle_shop.raw_orders
[0m20:42:33.384342 [debug] [Thread-3 (]: Began compiling node seed.jaffle_shop.raw_payments
[0m20:42:33.385963 [debug] [Thread-2 (]: Began executing node seed.jaffle_shop.raw_orders
[0m20:42:33.393413 [debug] [Thread-3 (]: Began executing node seed.jaffle_shop.raw_payments
[0m20:42:33.440335 [debug] [Thread-1 (]: Using snowflake connection "seed.jaffle_shop.raw_customers"
[0m20:42:33.441940 [debug] [Thread-2 (]: Using snowflake connection "seed.jaffle_shop.raw_orders"
[0m20:42:33.445362 [debug] [Thread-1 (]: On seed.jaffle_shop.raw_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_customers"} */
create table raw.JAFFLE_SHOP.raw_customers (id integer,first_name text,last_name text)
[0m20:42:33.450367 [debug] [Thread-3 (]: Using snowflake connection "seed.jaffle_shop.raw_payments"
[0m20:42:33.450957 [debug] [Thread-2 (]: On seed.jaffle_shop.raw_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_orders"} */
create table raw.JAFFLE_SHOP.raw_orders (id integer,user_id integer,order_date date,status text)
[0m20:42:33.451352 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:42:33.451719 [debug] [Thread-3 (]: On seed.jaffle_shop.raw_payments: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_payments"} */
create table raw.JAFFLE_SHOP_stripe.raw_payments (id integer,order_id integer,payment_method text,amount integer)
[0m20:42:33.452111 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:42:33.453955 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:42:35.837628 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.386 seconds
[0m20:42:35.846878 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 2.395 seconds
[0m20:42:35.874197 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 2.420 seconds
[0m20:42:35.875604 [debug] [Thread-2 (]: Using snowflake connection "seed.jaffle_shop.raw_orders"
[0m20:42:35.877706 [debug] [Thread-1 (]: Using snowflake connection "seed.jaffle_shop.raw_customers"
[0m20:42:35.881156 [debug] [Thread-3 (]: Using snowflake connection "seed.jaffle_shop.raw_payments"
[0m20:42:35.881629 [debug] [Thread-2 (]: On seed.jaffle_shop.raw_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_orders"} */
BEGIN
[0m20:42:35.882073 [debug] [Thread-1 (]: On seed.jaffle_shop.raw_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_customers"} */
BEGIN
[0m20:42:35.882460 [debug] [Thread-3 (]: On seed.jaffle_shop.raw_payments: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_payments"} */
BEGIN
[0m20:42:37.584541 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.699 seconds
[0m20:42:37.587363 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.704 seconds
[0m20:42:37.589396 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.705 seconds
[0m20:42:37.596683 [debug] [Thread-3 (]: Using snowflake connection "seed.jaffle_shop.raw_payments"
[0m20:42:37.601788 [debug] [Thread-2 (]: Using snowflake connection "seed.jaffle_shop.raw_orders"
[0m20:42:37.605786 [debug] [Thread-1 (]: Using snowflake connection "seed.jaffle_shop.raw_customers"
[0m20:42:37.606544 [debug] [Thread-3 (]: On seed.jaffle_shop.raw_payments: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_payments"} */
insert into raw.JAFFLE_SHOP_stripe.raw_payments (id, order_id, payment_method, amount) values
            (%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s...
[0m20:42:37.607246 [debug] [Thread-2 (]: On seed.jaffle_shop.raw_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_orders"} */
insert into raw.JAFFLE_SHOP.raw_orders (id, user_id, order_date, status) values
            (%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),...
[0m20:42:37.607920 [debug] [Thread-1 (]: On seed.jaffle_shop.raw_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_customers"} */
insert into raw.JAFFLE_SHOP.raw_customers (id, first_name, last_name) values
            (%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%...
[0m20:42:40.718309 [debug] [Thread-2 (]: SQL status: SUCCESS 99 in 3.107 seconds
[0m20:42:40.720521 [debug] [Thread-3 (]: SQL status: SUCCESS 113 in 3.112 seconds
[0m20:42:40.722429 [debug] [Thread-1 (]: SQL status: SUCCESS 100 in 3.109 seconds
[0m20:42:40.723879 [debug] [Thread-2 (]: Using snowflake connection "seed.jaffle_shop.raw_orders"
[0m20:42:40.725131 [debug] [Thread-3 (]: Using snowflake connection "seed.jaffle_shop.raw_payments"
[0m20:42:40.726179 [debug] [Thread-1 (]: Using snowflake connection "seed.jaffle_shop.raw_customers"
[0m20:42:40.727135 [debug] [Thread-2 (]: On seed.jaffle_shop.raw_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_orders"} */
COMMIT
[0m20:42:40.728211 [debug] [Thread-3 (]: On seed.jaffle_shop.raw_payments: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_payments"} */
COMMIT
[0m20:42:40.729090 [debug] [Thread-1 (]: On seed.jaffle_shop.raw_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_customers"} */
COMMIT
[0m20:42:41.063739 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.332 seconds
[0m20:42:41.065902 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.332 seconds
[0m20:42:41.068711 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.339 seconds
[0m20:42:41.080236 [debug] [Thread-3 (]: Writing runtime SQL for node "seed.jaffle_shop.raw_payments"
[0m20:42:41.081731 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.jaffle_shop.raw_customers"
[0m20:42:41.103706 [debug] [Thread-2 (]: Writing runtime SQL for node "seed.jaffle_shop.raw_orders"
[0m20:42:41.165023 [debug] [Thread-1 (]: On seed.jaffle_shop.raw_customers: Close
[0m20:42:41.167924 [debug] [Thread-3 (]: On seed.jaffle_shop.raw_payments: Close
[0m20:42:41.169793 [debug] [Thread-2 (]: On seed.jaffle_shop.raw_orders: Close
[0m20:42:41.320692 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '534bf876-f951-4e19-8f21-f633c6b01635', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fb11bd0>]}
[0m20:42:41.322423 [info ] [Thread-2 (]: 2 of 3 OK loaded seed file JAFFLE_SHOP.raw_orders .............................. [[32mINSERT 99[0m in 7.94s]
[0m20:42:41.323889 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '534bf876-f951-4e19-8f21-f633c6b01635', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fc3ca10>]}
[0m20:42:41.325600 [debug] [Thread-2 (]: Finished running node seed.jaffle_shop.raw_orders
[0m20:42:41.327809 [info ] [Thread-1 (]: 1 of 3 OK loaded seed file JAFFLE_SHOP.raw_customers ........................... [[32mINSERT 100[0m in 7.95s]
[0m20:42:41.329997 [debug] [Thread-1 (]: Finished running node seed.jaffle_shop.raw_customers
[0m20:42:41.331443 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '534bf876-f951-4e19-8f21-f633c6b01635', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fae4290>]}
[0m20:42:41.332466 [info ] [Thread-3 (]: 3 of 3 OK loaded seed file JAFFLE_SHOP_stripe.raw_payments ..................... [[32mINSERT 113[0m in 7.95s]
[0m20:42:41.333527 [debug] [Thread-3 (]: Finished running node seed.jaffle_shop.raw_payments
[0m20:42:41.335695 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:42:41.336308 [debug] [MainThread]: Connection 'seed.jaffle_shop.raw_customers' was properly closed.
[0m20:42:41.336836 [debug] [MainThread]: Connection 'seed.jaffle_shop.raw_orders' was properly closed.
[0m20:42:41.337331 [debug] [MainThread]: Connection 'seed.jaffle_shop.raw_payments' was properly closed.
[0m20:42:41.337918 [info ] [MainThread]: 
[0m20:42:41.338527 [info ] [MainThread]: Finished running 3 seeds in 0 hours 0 minutes and 10.56 seconds (10.56s).
[0m20:42:41.339894 [debug] [MainThread]: Command end result
[0m20:42:41.380342 [info ] [MainThread]: 
[0m20:42:41.381042 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:42:41.381836 [info ] [MainThread]: 
[0m20:42:41.382381 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m20:42:41.384432 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": true, "command_wall_clock_time": 13.2001095, "process_user_time": 4.604448, "process_kernel_time": 0.487346, "process_mem_max_rss": "136548352", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m20:42:41.385216 [debug] [MainThread]: Command `dbt seed` succeeded at 20:42:41.385113 after 13.20 seconds
[0m20:42:41.385684 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b449310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b398290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b398b90>]}
[0m20:42:41.386063 [debug] [MainThread]: Flushing usage events
[0m20:44:59.492764 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063bec10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106430710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106431050>]}


============================== 20:44:59.501938 | d780e299-d494-422b-a111-4a5bb877db5a ==============================
[0m20:44:59.501938 [info ] [MainThread]: Running with dbt=1.8.7
[0m20:44:59.502927 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/ben/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/ben/Dbt Certification/dbt-tutorial/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt seed', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:45:00.038706 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd780e299-d494-422b-a111-4a5bb877db5a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f23310>]}
[0m20:45:00.094535 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd780e299-d494-422b-a111-4a5bb877db5a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105084e50>]}
[0m20:45:00.096497 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m20:45:00.125996 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m20:45:00.236168 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m20:45:00.236810 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'd780e299-d494-422b-a111-4a5bb877db5a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1050a8890>]}
[0m20:45:01.738082 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m20:45:01.738826 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'd780e299-d494-422b-a111-4a5bb877db5a', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1075761d0>]}
[0m20:45:01.952701 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.staging
- seeds.raw_payments
[0m20:45:01.958396 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd780e299-d494-422b-a111-4a5bb877db5a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1073b3c50>]}
[0m20:45:02.080420 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd780e299-d494-422b-a111-4a5bb877db5a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10782ad10>]}
[0m20:45:02.081082 [info ] [MainThread]: Found 7 models, 3 seeds, 11 data tests, 572 macros
[0m20:45:02.081585 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd780e299-d494-422b-a111-4a5bb877db5a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1076fe4d0>]}
[0m20:45:02.083625 [info ] [MainThread]: 
[0m20:45:02.084253 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m20:45:02.088609 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_raw'
[0m20:45:02.098260 [debug] [ThreadPool]: Using snowflake connection "list_raw"
[0m20:45:02.098970 [debug] [ThreadPool]: On list_raw: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_raw"} */
show terse schemas in database raw
    limit 10000
[0m20:45:02.099751 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:45:03.020954 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.921 seconds
[0m20:45:03.024488 [debug] [ThreadPool]: On list_raw: Close
[0m20:45:03.804879 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_raw, now create_raw_JAFFLE_SHOP)
[0m20:45:03.806549 [debug] [ThreadPool]: Creating schema "database: "raw"
schema: "JAFFLE_SHOP"
"
[0m20:45:03.816840 [debug] [ThreadPool]: Using snowflake connection "create_raw_JAFFLE_SHOP"
[0m20:45:03.817584 [debug] [ThreadPool]: On create_raw_JAFFLE_SHOP: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "create_raw_JAFFLE_SHOP"} */
create schema if not exists raw.JAFFLE_SHOP
[0m20:45:03.818224 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:45:04.726648 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.908 seconds
[0m20:45:04.729912 [debug] [ThreadPool]: On create_raw_JAFFLE_SHOP: Close
[0m20:45:07.056344 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_raw_JAFFLE_SHOP, now list_ANALYTICS_JAFFLE_SHOP)
[0m20:45:07.057852 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_raw_JAFFLE_SHOP'
[0m20:45:07.082504 [debug] [ThreadPool]: Using snowflake connection "list_ANALYTICS_JAFFLE_SHOP"
[0m20:45:07.086279 [debug] [ThreadPool]: Using snowflake connection "list_raw_JAFFLE_SHOP"
[0m20:45:07.086711 [debug] [ThreadPool]: On list_ANALYTICS_JAFFLE_SHOP: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_ANALYTICS_JAFFLE_SHOP"} */
show objects in ANALYTICS.JAFFLE_SHOP limit 10000
[0m20:45:07.087165 [debug] [ThreadPool]: On list_raw_JAFFLE_SHOP: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_raw_JAFFLE_SHOP"} */
show objects in raw.JAFFLE_SHOP limit 10000
[0m20:45:07.087575 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:45:07.087973 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:45:07.584366 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.496 seconds
[0m20:45:07.588663 [debug] [ThreadPool]: On list_raw_JAFFLE_SHOP: Close
[0m20:45:07.718393 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.631 seconds
[0m20:45:07.723639 [debug] [ThreadPool]: On list_ANALYTICS_JAFFLE_SHOP: Close
[0m20:45:07.888739 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd780e299-d494-422b-a111-4a5bb877db5a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107806f50>]}
[0m20:45:07.890341 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:45:07.891248 [info ] [MainThread]: 
[0m20:45:07.898440 [debug] [Thread-1 (]: Began running node seed.jaffle_shop.raw_customers
[0m20:45:07.901567 [debug] [Thread-3 (]: Began running node seed.jaffle_shop.raw_payments
[0m20:45:07.902897 [debug] [Thread-2 (]: Began running node seed.jaffle_shop.raw_orders
[0m20:45:07.903771 [info ] [Thread-1 (]: 1 of 3 START seed file raw.JAFFLE_SHOP.raw_customers ........................... [RUN]
[0m20:45:07.904806 [info ] [Thread-3 (]: 3 of 3 START seed file raw.JAFFLE_SHOP.raw_payments ............................ [RUN]
[0m20:45:07.905929 [info ] [Thread-2 (]: 2 of 3 START seed file raw.JAFFLE_SHOP.raw_orders .............................. [RUN]
[0m20:45:07.906858 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_ANALYTICS_JAFFLE_SHOP, now seed.jaffle_shop.raw_customers)
[0m20:45:07.907873 [debug] [Thread-3 (]: Acquiring new snowflake connection 'seed.jaffle_shop.raw_payments'
[0m20:45:07.908836 [debug] [Thread-2 (]: Acquiring new snowflake connection 'seed.jaffle_shop.raw_orders'
[0m20:45:07.909462 [debug] [Thread-1 (]: Began compiling node seed.jaffle_shop.raw_customers
[0m20:45:07.910033 [debug] [Thread-3 (]: Began compiling node seed.jaffle_shop.raw_payments
[0m20:45:07.910733 [debug] [Thread-2 (]: Began compiling node seed.jaffle_shop.raw_orders
[0m20:45:07.911322 [debug] [Thread-1 (]: Began executing node seed.jaffle_shop.raw_customers
[0m20:45:07.911871 [debug] [Thread-3 (]: Began executing node seed.jaffle_shop.raw_payments
[0m20:45:07.912394 [debug] [Thread-2 (]: Began executing node seed.jaffle_shop.raw_orders
[0m20:45:07.966396 [debug] [Thread-3 (]: Using snowflake connection "seed.jaffle_shop.raw_payments"
[0m20:45:07.970503 [debug] [Thread-2 (]: Using snowflake connection "seed.jaffle_shop.raw_orders"
[0m20:45:07.971372 [debug] [Thread-1 (]: Using snowflake connection "seed.jaffle_shop.raw_customers"
[0m20:45:07.971766 [debug] [Thread-3 (]: On seed.jaffle_shop.raw_payments: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_payments"} */
create table raw.JAFFLE_SHOP.raw_payments (id integer,order_id integer,payment_method text,amount integer)
[0m20:45:07.972158 [debug] [Thread-2 (]: On seed.jaffle_shop.raw_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_orders"} */
create table raw.JAFFLE_SHOP.raw_orders (id integer,user_id integer,order_date date,status text)
[0m20:45:07.972555 [debug] [Thread-1 (]: On seed.jaffle_shop.raw_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_customers"} */
create table raw.JAFFLE_SHOP.raw_customers (id integer,first_name text,last_name text)
[0m20:45:07.972916 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m20:45:07.973268 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m20:45:07.973606 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:45:08.904362 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.930 seconds
[0m20:45:08.932671 [debug] [Thread-1 (]: Using snowflake connection "seed.jaffle_shop.raw_customers"
[0m20:45:08.933500 [debug] [Thread-1 (]: On seed.jaffle_shop.raw_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_customers"} */
BEGIN
[0m20:45:09.008037 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.035 seconds
[0m20:45:09.015257 [debug] [Thread-3 (]: Using snowflake connection "seed.jaffle_shop.raw_payments"
[0m20:45:09.016223 [debug] [Thread-3 (]: On seed.jaffle_shop.raw_payments: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_payments"} */
BEGIN
[0m20:45:09.117267 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.182 seconds
[0m20:45:09.124208 [debug] [Thread-1 (]: Using snowflake connection "seed.jaffle_shop.raw_customers"
[0m20:45:09.131349 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.114 seconds
[0m20:45:09.135984 [debug] [Thread-1 (]: On seed.jaffle_shop.raw_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_customers"} */
insert into raw.JAFFLE_SHOP.raw_customers (id, first_name, last_name) values
            (%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%...
[0m20:45:09.141186 [debug] [Thread-3 (]: Using snowflake connection "seed.jaffle_shop.raw_payments"
[0m20:45:09.145187 [debug] [Thread-3 (]: On seed.jaffle_shop.raw_payments: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_payments"} */
insert into raw.JAFFLE_SHOP.raw_payments (id, order_id, payment_method, amount) values
            (%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%...
[0m20:45:09.305088 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.332 seconds
[0m20:45:09.313198 [debug] [Thread-2 (]: Using snowflake connection "seed.jaffle_shop.raw_orders"
[0m20:45:09.314280 [debug] [Thread-2 (]: On seed.jaffle_shop.raw_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_orders"} */
BEGIN
[0m20:45:09.545947 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.231 seconds
[0m20:45:09.552644 [debug] [Thread-2 (]: Using snowflake connection "seed.jaffle_shop.raw_orders"
[0m20:45:09.553610 [debug] [Thread-2 (]: On seed.jaffle_shop.raw_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_orders"} */
insert into raw.JAFFLE_SHOP.raw_orders (id, user_id, order_date, status) values
            (%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),...
[0m20:45:09.581279 [debug] [Thread-1 (]: SQL status: SUCCESS 100 in 0.438 seconds
[0m20:45:09.582823 [debug] [Thread-1 (]: Using snowflake connection "seed.jaffle_shop.raw_customers"
[0m20:45:09.583938 [debug] [Thread-1 (]: On seed.jaffle_shop.raw_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_customers"} */
COMMIT
[0m20:45:09.803016 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.218 seconds
[0m20:45:09.816784 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.jaffle_shop.raw_customers"
[0m20:45:09.850796 [debug] [Thread-1 (]: On seed.jaffle_shop.raw_customers: Close
[0m20:45:10.057917 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd780e299-d494-422b-a111-4a5bb877db5a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107242590>]}
[0m20:45:10.059736 [info ] [Thread-1 (]: 1 of 3 OK loaded seed file JAFFLE_SHOP.raw_customers ........................... [[32mINSERT 100[0m in 2.15s]
[0m20:45:10.061340 [debug] [Thread-1 (]: Finished running node seed.jaffle_shop.raw_customers
[0m20:45:10.198073 [debug] [Thread-2 (]: SQL status: SUCCESS 99 in 0.643 seconds
[0m20:45:10.199890 [debug] [Thread-2 (]: Using snowflake connection "seed.jaffle_shop.raw_orders"
[0m20:45:10.201043 [debug] [Thread-2 (]: On seed.jaffle_shop.raw_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_orders"} */
COMMIT
[0m20:45:10.302684 [debug] [Thread-3 (]: SQL status: SUCCESS 113 in 1.157 seconds
[0m20:45:10.304298 [debug] [Thread-3 (]: Using snowflake connection "seed.jaffle_shop.raw_payments"
[0m20:45:10.305928 [debug] [Thread-3 (]: On seed.jaffle_shop.raw_payments: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_payments"} */
COMMIT
[0m20:45:10.487889 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.286 seconds
[0m20:45:10.490094 [debug] [Thread-2 (]: Writing runtime SQL for node "seed.jaffle_shop.raw_orders"
[0m20:45:10.495566 [debug] [Thread-2 (]: On seed.jaffle_shop.raw_orders: Close
[0m20:45:10.624753 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd780e299-d494-422b-a111-4a5bb877db5a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1073cdb10>]}
[0m20:45:10.626505 [info ] [Thread-2 (]: 2 of 3 OK loaded seed file JAFFLE_SHOP.raw_orders .............................. [[32mINSERT 99[0m in 2.72s]
[0m20:45:10.628280 [debug] [Thread-2 (]: Finished running node seed.jaffle_shop.raw_orders
[0m20:45:11.688461 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.381 seconds
[0m20:45:11.690094 [debug] [Thread-3 (]: Writing runtime SQL for node "seed.jaffle_shop.raw_payments"
[0m20:45:11.695202 [debug] [Thread-3 (]: On seed.jaffle_shop.raw_payments: Close
[0m20:45:12.101293 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd780e299-d494-422b-a111-4a5bb877db5a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1075f2f10>]}
[0m20:45:12.103056 [info ] [Thread-3 (]: 3 of 3 OK loaded seed file JAFFLE_SHOP.raw_payments ............................ [[32mINSERT 113[0m in 4.19s]
[0m20:45:12.104815 [debug] [Thread-3 (]: Finished running node seed.jaffle_shop.raw_payments
[0m20:45:12.108058 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:45:12.108919 [debug] [MainThread]: Connection 'seed.jaffle_shop.raw_customers' was properly closed.
[0m20:45:12.109682 [debug] [MainThread]: Connection 'list_raw_JAFFLE_SHOP' was properly closed.
[0m20:45:12.110397 [debug] [MainThread]: Connection 'seed.jaffle_shop.raw_payments' was properly closed.
[0m20:45:12.111108 [debug] [MainThread]: Connection 'seed.jaffle_shop.raw_orders' was properly closed.
[0m20:45:12.111963 [info ] [MainThread]: 
[0m20:45:12.112734 [info ] [MainThread]: Finished running 3 seeds in 0 hours 0 minutes and 10.03 seconds (10.03s).
[0m20:45:12.114508 [debug] [MainThread]: Command end result
[0m20:45:12.158271 [info ] [MainThread]: 
[0m20:45:12.158969 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:45:12.159459 [info ] [MainThread]: 
[0m20:45:12.159897 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m20:45:12.163179 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": true, "command_wall_clock_time": 12.7662945, "process_user_time": 4.705733, "process_kernel_time": 0.594719, "process_mem_max_rss": "135000064", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m20:45:12.163993 [debug] [MainThread]: Command `dbt seed` succeeded at 20:45:12.163878 after 12.77 seconds
[0m20:45:12.164635 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102f0d410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102e60390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102e60b50>]}
[0m20:45:12.165552 [debug] [MainThread]: Flushing usage events
[0m20:46:21.995307 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105cb21d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f3b990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105cb2650>]}


============================== 20:46:22.004040 | 42891411-cfd9-4d4e-8878-9dbb5555191c ==============================
[0m20:46:22.004040 [info ] [MainThread]: Running with dbt=1.8.7
[0m20:46:22.005038 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/ben/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/Users/ben/Dbt Certification/dbt-tutorial/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt seed', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m20:46:22.535459 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '42891411-cfd9-4d4e-8878-9dbb5555191c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e11950>]}
[0m20:46:22.593530 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '42891411-cfd9-4d4e-8878-9dbb5555191c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1059a2bd0>]}
[0m20:46:22.595211 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m20:46:22.622743 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m20:46:22.728797 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m20:46:22.729546 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '42891411-cfd9-4d4e-8878-9dbb5555191c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b8c890>]}
[0m20:46:24.222091 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m20:46:24.222901 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '42891411-cfd9-4d4e-8878-9dbb5555191c', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e919d0>]}
[0m20:46:24.513762 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.staging
[0m20:46:24.524272 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '42891411-cfd9-4d4e-8878-9dbb5555191c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1072150d0>]}
[0m20:46:24.664430 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '42891411-cfd9-4d4e-8878-9dbb5555191c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10723d190>]}
[0m20:46:24.665069 [info ] [MainThread]: Found 7 models, 3 seeds, 11 data tests, 572 macros
[0m20:46:24.665518 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '42891411-cfd9-4d4e-8878-9dbb5555191c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10721e090>]}
[0m20:46:24.667885 [info ] [MainThread]: 
[0m20:46:24.668923 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m20:46:24.678456 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_raw'
[0m20:46:24.679200 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_raw'
[0m20:46:24.690960 [debug] [ThreadPool]: Using snowflake connection "list_raw"
[0m20:46:24.694205 [debug] [ThreadPool]: Using snowflake connection "list_raw"
[0m20:46:24.694807 [debug] [ThreadPool]: On list_raw: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_raw"} */
show terse schemas in database raw
    limit 10000
[0m20:46:24.695238 [debug] [ThreadPool]: On list_raw: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_raw"} */
show terse schemas in database raw
    limit 10000
[0m20:46:24.695608 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:46:24.695941 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:46:25.613713 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.918 seconds
[0m20:46:25.615774 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.920 seconds
[0m20:46:25.619797 [debug] [ThreadPool]: On list_raw: Close
[0m20:46:25.622799 [debug] [ThreadPool]: On list_raw: Close
[0m20:46:25.779024 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_raw, now create_raw_JAFFLE_SHOP_stripe)
[0m20:46:25.779819 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_raw, now create_raw_JAFFLE_SHOP)
[0m20:46:25.780824 [debug] [ThreadPool]: Creating schema "database: "raw"
schema: "JAFFLE_SHOP_stripe"
"
[0m20:46:25.781589 [debug] [ThreadPool]: Creating schema "database: "raw"
schema: "JAFFLE_SHOP"
"
[0m20:46:25.788331 [debug] [ThreadPool]: Using snowflake connection "create_raw_JAFFLE_SHOP_stripe"
[0m20:46:25.791251 [debug] [ThreadPool]: Using snowflake connection "create_raw_JAFFLE_SHOP"
[0m20:46:25.791851 [debug] [ThreadPool]: On create_raw_JAFFLE_SHOP_stripe: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "create_raw_JAFFLE_SHOP_stripe"} */
create schema if not exists raw.JAFFLE_SHOP_stripe
[0m20:46:25.792509 [debug] [ThreadPool]: On create_raw_JAFFLE_SHOP: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "create_raw_JAFFLE_SHOP"} */
create schema if not exists raw.JAFFLE_SHOP
[0m20:46:25.793092 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:46:25.793546 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:46:26.436338 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.643 seconds
[0m20:46:26.440465 [debug] [ThreadPool]: On create_raw_JAFFLE_SHOP_stripe: Close
[0m20:46:26.605333 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.812 seconds
[0m20:46:26.608293 [debug] [ThreadPool]: On create_raw_JAFFLE_SHOP: Close
[0m20:46:26.752446 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_raw_JAFFLE_SHOP_stripe, now list_ANALYTICS_JAFFLE_SHOP)
[0m20:46:26.753864 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_raw_JAFFLE_SHOP, now list_raw_JAFFLE_SHOP_stripe)
[0m20:46:26.755375 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_raw_JAFFLE_SHOP'
[0m20:46:26.783300 [debug] [ThreadPool]: Using snowflake connection "list_ANALYTICS_JAFFLE_SHOP"
[0m20:46:26.780648 [debug] [ThreadPool]: Using snowflake connection "list_raw_JAFFLE_SHOP_stripe"
[0m20:46:26.786286 [debug] [ThreadPool]: Using snowflake connection "list_raw_JAFFLE_SHOP"
[0m20:46:26.786751 [debug] [ThreadPool]: On list_ANALYTICS_JAFFLE_SHOP: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_ANALYTICS_JAFFLE_SHOP"} */
show objects in ANALYTICS.JAFFLE_SHOP limit 10000
[0m20:46:26.787168 [debug] [ThreadPool]: On list_raw_JAFFLE_SHOP_stripe: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_raw_JAFFLE_SHOP_stripe"} */
show objects in raw.JAFFLE_SHOP_stripe limit 10000
[0m20:46:26.787550 [debug] [ThreadPool]: On list_raw_JAFFLE_SHOP: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_raw_JAFFLE_SHOP"} */
show objects in raw.JAFFLE_SHOP limit 10000
[0m20:46:26.787918 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:46:26.788272 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:46:26.788610 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:46:27.243081 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.454 seconds
[0m20:46:27.248144 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.460 seconds
[0m20:46:27.261215 [debug] [ThreadPool]: On list_raw_JAFFLE_SHOP: Close
[0m20:46:27.265059 [debug] [ThreadPool]: On list_raw_JAFFLE_SHOP_stripe: Close
[0m20:46:27.463061 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.675 seconds
[0m20:46:27.467193 [debug] [ThreadPool]: On list_ANALYTICS_JAFFLE_SHOP: Close
[0m20:46:27.607033 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '42891411-cfd9-4d4e-8878-9dbb5555191c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107197f90>]}
[0m20:46:27.608643 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:46:27.609804 [info ] [MainThread]: 
[0m20:46:27.616168 [debug] [Thread-1 (]: Began running node seed.jaffle_shop.raw_customers
[0m20:46:27.617466 [debug] [Thread-2 (]: Began running node seed.jaffle_shop.raw_orders
[0m20:46:27.618281 [debug] [Thread-3 (]: Began running node seed.jaffle_shop.raw_payments
[0m20:46:27.619548 [info ] [Thread-1 (]: 1 of 3 START seed file raw.JAFFLE_SHOP.raw_customers ........................... [RUN]
[0m20:46:27.621235 [info ] [Thread-2 (]: 2 of 3 START seed file raw.JAFFLE_SHOP.raw_orders .............................. [RUN]
[0m20:46:27.622348 [info ] [Thread-3 (]: 3 of 3 START seed file raw.JAFFLE_SHOP_stripe.raw_payments ..................... [RUN]
[0m20:46:27.623605 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_ANALYTICS_JAFFLE_SHOP, now seed.jaffle_shop.raw_customers)
[0m20:46:27.624442 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_raw_JAFFLE_SHOP_stripe, now seed.jaffle_shop.raw_orders)
[0m20:46:27.625238 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_raw_JAFFLE_SHOP, now seed.jaffle_shop.raw_payments)
[0m20:46:27.626805 [debug] [Thread-1 (]: Began compiling node seed.jaffle_shop.raw_customers
[0m20:46:27.627613 [debug] [Thread-2 (]: Began compiling node seed.jaffle_shop.raw_orders
[0m20:46:27.628534 [debug] [Thread-3 (]: Began compiling node seed.jaffle_shop.raw_payments
[0m20:46:27.629386 [debug] [Thread-1 (]: Began executing node seed.jaffle_shop.raw_customers
[0m20:46:27.630030 [debug] [Thread-2 (]: Began executing node seed.jaffle_shop.raw_orders
[0m20:46:27.630587 [debug] [Thread-3 (]: Began executing node seed.jaffle_shop.raw_payments
[0m20:46:27.706651 [debug] [Thread-1 (]: Using snowflake connection "seed.jaffle_shop.raw_customers"
[0m20:46:27.715889 [debug] [Thread-3 (]: Using snowflake connection "seed.jaffle_shop.raw_payments"
[0m20:46:27.716408 [debug] [Thread-1 (]: On seed.jaffle_shop.raw_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_customers"} */
create table raw.JAFFLE_SHOP.raw_customers (id integer,first_name text,last_name text)
[0m20:46:27.719799 [debug] [Thread-2 (]: Using snowflake connection "seed.jaffle_shop.raw_orders"
[0m20:46:27.720249 [debug] [Thread-3 (]: On seed.jaffle_shop.raw_payments: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_payments"} */
create table raw.JAFFLE_SHOP_stripe.raw_payments (id integer,order_id integer,payment_method text,amount integer)
[0m20:46:27.720647 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:46:27.721037 [debug] [Thread-2 (]: On seed.jaffle_shop.raw_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_orders"} */
create table raw.JAFFLE_SHOP.raw_orders (id integer,user_id integer,order_date date,status text)
[0m20:46:27.721407 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:46:27.722618 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:46:28.257467 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.537 seconds
[0m20:46:28.283125 [debug] [Thread-1 (]: Using snowflake connection "seed.jaffle_shop.raw_customers"
[0m20:46:28.283768 [debug] [Thread-1 (]: On seed.jaffle_shop.raw_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_customers"} */
BEGIN
[0m20:46:28.366512 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.644 seconds
[0m20:46:28.374470 [debug] [Thread-2 (]: Using snowflake connection "seed.jaffle_shop.raw_orders"
[0m20:46:28.375449 [debug] [Thread-2 (]: On seed.jaffle_shop.raw_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_orders"} */
BEGIN
[0m20:46:28.381952 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.098 seconds
[0m20:46:28.386763 [debug] [Thread-1 (]: Using snowflake connection "seed.jaffle_shop.raw_customers"
[0m20:46:28.387502 [debug] [Thread-1 (]: On seed.jaffle_shop.raw_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_customers"} */
insert into raw.JAFFLE_SHOP.raw_customers (id, first_name, last_name) values
            (%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%...
[0m20:46:28.392977 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.671 seconds
[0m20:46:28.397496 [debug] [Thread-3 (]: Using snowflake connection "seed.jaffle_shop.raw_payments"
[0m20:46:28.398127 [debug] [Thread-3 (]: On seed.jaffle_shop.raw_payments: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_payments"} */
BEGIN
[0m20:46:28.529028 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.152 seconds
[0m20:46:28.536572 [debug] [Thread-2 (]: Using snowflake connection "seed.jaffle_shop.raw_orders"
[0m20:46:28.537737 [debug] [Thread-2 (]: On seed.jaffle_shop.raw_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_orders"} */
insert into raw.JAFFLE_SHOP.raw_orders (id, user_id, order_date, status) values
            (%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),...
[0m20:46:28.542908 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.144 seconds
[0m20:46:28.548614 [debug] [Thread-3 (]: Using snowflake connection "seed.jaffle_shop.raw_payments"
[0m20:46:28.549852 [debug] [Thread-3 (]: On seed.jaffle_shop.raw_payments: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_payments"} */
insert into raw.JAFFLE_SHOP_stripe.raw_payments (id, order_id, payment_method, amount) values
            (%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s...
[0m20:46:28.898003 [debug] [Thread-1 (]: SQL status: SUCCESS 100 in 0.509 seconds
[0m20:46:28.899636 [debug] [Thread-1 (]: Using snowflake connection "seed.jaffle_shop.raw_customers"
[0m20:46:28.900792 [debug] [Thread-1 (]: On seed.jaffle_shop.raw_customers: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_customers"} */
COMMIT
[0m20:46:29.016146 [debug] [Thread-2 (]: SQL status: SUCCESS 99 in 0.477 seconds
[0m20:46:29.017778 [debug] [Thread-2 (]: Using snowflake connection "seed.jaffle_shop.raw_orders"
[0m20:46:29.018918 [debug] [Thread-2 (]: On seed.jaffle_shop.raw_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_orders"} */
COMMIT
[0m20:46:29.114067 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.212 seconds
[0m20:46:29.128216 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.jaffle_shop.raw_customers"
[0m20:46:29.161352 [debug] [Thread-1 (]: On seed.jaffle_shop.raw_customers: Close
[0m20:46:29.194325 [debug] [Thread-3 (]: SQL status: SUCCESS 113 in 0.643 seconds
[0m20:46:29.195710 [debug] [Thread-3 (]: Using snowflake connection "seed.jaffle_shop.raw_payments"
[0m20:46:29.196668 [debug] [Thread-3 (]: On seed.jaffle_shop.raw_payments: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_payments"} */
COMMIT
[0m20:46:29.215748 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.196 seconds
[0m20:46:29.220817 [debug] [Thread-2 (]: Writing runtime SQL for node "seed.jaffle_shop.raw_orders"
[0m20:46:29.226116 [debug] [Thread-2 (]: On seed.jaffle_shop.raw_orders: Close
[0m20:46:29.299145 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '42891411-cfd9-4d4e-8878-9dbb5555191c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106bde250>]}
[0m20:46:29.301373 [info ] [Thread-1 (]: 1 of 3 OK loaded seed file JAFFLE_SHOP.raw_customers ........................... [[32mINSERT 100[0m in 1.67s]
[0m20:46:29.303448 [debug] [Thread-1 (]: Finished running node seed.jaffle_shop.raw_customers
[0m20:46:29.373547 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '42891411-cfd9-4d4e-8878-9dbb5555191c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d46a10>]}
[0m20:46:29.375103 [info ] [Thread-2 (]: 2 of 3 OK loaded seed file JAFFLE_SHOP.raw_orders .............................. [[32mINSERT 99[0m in 1.75s]
[0m20:46:29.376545 [debug] [Thread-2 (]: Finished running node seed.jaffle_shop.raw_orders
[0m20:46:29.394566 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.197 seconds
[0m20:46:29.396124 [debug] [Thread-3 (]: Writing runtime SQL for node "seed.jaffle_shop.raw_payments"
[0m20:46:29.400096 [debug] [Thread-3 (]: On seed.jaffle_shop.raw_payments: Close
[0m20:46:29.551612 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '42891411-cfd9-4d4e-8878-9dbb5555191c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f18f50>]}
[0m20:46:29.553069 [info ] [Thread-3 (]: 3 of 3 OK loaded seed file JAFFLE_SHOP_stripe.raw_payments ..................... [[32mINSERT 113[0m in 1.93s]
[0m20:46:29.554844 [debug] [Thread-3 (]: Finished running node seed.jaffle_shop.raw_payments
[0m20:46:29.557542 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:46:29.558269 [debug] [MainThread]: Connection 'seed.jaffle_shop.raw_customers' was properly closed.
[0m20:46:29.558893 [debug] [MainThread]: Connection 'seed.jaffle_shop.raw_orders' was properly closed.
[0m20:46:29.559490 [debug] [MainThread]: Connection 'seed.jaffle_shop.raw_payments' was properly closed.
[0m20:46:29.560203 [info ] [MainThread]: 
[0m20:46:29.560952 [info ] [MainThread]: Finished running 3 seeds in 0 hours 0 minutes and 4.89 seconds (4.89s).
[0m20:46:29.562595 [debug] [MainThread]: Command end result
[0m20:46:29.606272 [info ] [MainThread]: 
[0m20:46:29.606881 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:46:29.607312 [info ] [MainThread]: 
[0m20:46:29.607715 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m20:46:29.610007 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": true, "command_wall_clock_time": 7.694202, "process_user_time": 4.857737, "process_kernel_time": 0.602964, "process_mem_max_rss": "135704576", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m20:46:29.610741 [debug] [MainThread]: Command `dbt seed` succeeded at 20:46:29.610576 after 7.69 seconds
[0m20:46:29.611249 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102a055d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102954450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102954490>]}
[0m20:46:29.611643 [debug] [MainThread]: Flushing usage events
[0m20:53:53.374419 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ce38150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ce8fed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ce8f310>]}


============================== 20:53:53.381462 | 797019ee-8533-4c8f-8bfd-fefbaa90417a ==============================
[0m20:53:53.381462 [info ] [MainThread]: Running with dbt=1.8.7
[0m20:53:53.382654 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/ben/Dbt Certification/dbt-tutorial/logs', 'version_check': 'True', 'profiles_dir': '/Users/ben/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --select customer_orders', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:53:53.766266 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '797019ee-8533-4c8f-8bfd-fefbaa90417a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ce61f90>]}
[0m20:53:53.826959 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '797019ee-8533-4c8f-8bfd-fefbaa90417a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bab0f50>]}
[0m20:53:53.828014 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m20:53:53.856316 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m20:53:54.006047 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:53:54.006562 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:53:54.014238 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.staging
[0m20:53:54.062843 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '797019ee-8533-4c8f-8bfd-fefbaa90417a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ddad210>]}
[0m20:53:54.173546 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '797019ee-8533-4c8f-8bfd-fefbaa90417a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dd4ec90>]}
[0m20:53:54.174325 [info ] [MainThread]: Found 7 models, 3 seeds, 11 data tests, 572 macros
[0m20:53:54.175131 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '797019ee-8533-4c8f-8bfd-fefbaa90417a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dc0f9d0>]}
[0m20:53:54.177798 [info ] [MainThread]: 
[0m20:53:54.178789 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m20:53:54.180091 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ANALYTICS'
[0m20:53:54.197143 [debug] [ThreadPool]: Using snowflake connection "list_ANALYTICS"
[0m20:53:54.197729 [debug] [ThreadPool]: On list_ANALYTICS: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_ANALYTICS"} */
show terse schemas in database ANALYTICS
    limit 10000
[0m20:53:54.198101 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:53:55.045415 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.847 seconds
[0m20:53:55.049933 [debug] [ThreadPool]: On list_ANALYTICS: Close
[0m20:53:55.201065 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_ANALYTICS, now list_ANALYTICS_JAFFLE_SHOP)
[0m20:53:55.202175 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_raw_JAFFLE_SHOP_stripe'
[0m20:53:55.203367 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_raw_JAFFLE_SHOP'
[0m20:53:55.222006 [debug] [ThreadPool]: Using snowflake connection "list_ANALYTICS_JAFFLE_SHOP"
[0m20:53:55.225415 [debug] [ThreadPool]: Using snowflake connection "list_raw_JAFFLE_SHOP_stripe"
[0m20:53:55.227644 [debug] [ThreadPool]: Using snowflake connection "list_raw_JAFFLE_SHOP"
[0m20:53:55.228426 [debug] [ThreadPool]: On list_ANALYTICS_JAFFLE_SHOP: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_ANALYTICS_JAFFLE_SHOP"} */
show objects in ANALYTICS.JAFFLE_SHOP limit 10000
[0m20:53:55.228864 [debug] [ThreadPool]: On list_raw_JAFFLE_SHOP_stripe: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_raw_JAFFLE_SHOP_stripe"} */
show objects in raw.JAFFLE_SHOP_stripe limit 10000
[0m20:53:55.229240 [debug] [ThreadPool]: On list_raw_JAFFLE_SHOP: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_raw_JAFFLE_SHOP"} */
show objects in raw.JAFFLE_SHOP limit 10000
[0m20:53:55.229555 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:53:55.229878 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:53:55.230216 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:53:55.675266 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.445 seconds
[0m20:53:55.679699 [debug] [ThreadPool]: On list_raw_JAFFLE_SHOP: Close
[0m20:53:55.813269 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.583 seconds
[0m20:53:55.819751 [debug] [ThreadPool]: On list_ANALYTICS_JAFFLE_SHOP: Close
[0m20:53:55.909496 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01b7b7b5-0000-8615-002a-09030002a566
[0m20:53:55.910333 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m20:53:55.911273 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m20:53:55.911912 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m20:53:55.912653 [debug] [ThreadPool]: On list_raw_JAFFLE_SHOP_stripe: Close
[0m20:53:56.058238 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '797019ee-8533-4c8f-8bfd-fefbaa90417a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a97ee10>]}
[0m20:53:56.060056 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:53:56.061179 [info ] [MainThread]: 
[0m20:53:56.065820 [debug] [Thread-1 (]: Began running node model.jaffle_shop.customer_orders
[0m20:53:56.067171 [info ] [Thread-1 (]: 1 of 1 START sql table model JAFFLE_SHOP.customer_orders ....................... [RUN]
[0m20:53:56.068295 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_ANALYTICS_JAFFLE_SHOP, now model.jaffle_shop.customer_orders)
[0m20:53:56.069065 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.customer_orders
[0m20:53:56.082174 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.customer_orders"
[0m20:53:56.083669 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.customer_orders
[0m20:53:56.116986 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.customer_orders"
[0m20:53:56.120066 [debug] [Thread-1 (]: Using snowflake connection "model.jaffle_shop.customer_orders"
[0m20:53:56.120565 [debug] [Thread-1 (]: On model.jaffle_shop.customer_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.customer_orders"} */
create or replace transient table ANALYTICS.JAFFLE_SHOP.customer_orders
         as
        (WITH paid_orders as (select Orders.ID as order_id,
    Orders.USER_ID	as customer_id,
    Orders.ORDER_DATE AS order_placed_at,
        Orders.STATUS AS order_status,
    p.total_amount_paid,
    p.payment_finalized_date,
    C.FIRST_NAME    as customer_first_name,
        C.LAST_NAME as customer_last_name
FROM raw.jaffle_shop.orders as Orders
left join (select ORDERID as order_id, max(CREATED) as payment_finalized_date, sum(AMOUNT) / 100.0 as total_amount_paid
        from raw.stripe.payment
        where STATUS <> 'fail'
        group by 1) p ON orders.ID = p.order_id
left join raw.jaffle_shop.customers C on orders.USER_ID = C.ID ),

customer_orders 
as (select C.ID as customer_id
    , min(ORDER_DATE) as first_order_date
    , max(ORDER_DATE) as most_recent_order_date
    , count(ORDERS.ID) AS number_of_orders
from raw.jaffle_shop.customers C 
left join raw.jaffle_shop.orders as Orders
on orders.USER_ID = C.ID 
group by 1)

select
p.*,
ROW_NUMBER() OVER (ORDER BY p.order_id) as transaction_seq,
ROW_NUMBER() OVER (PARTITION BY customer_id ORDER BY p.order_id) as customer_sales_seq,
CASE WHEN c.first_order_date = p.order_placed_at
THEN 'new'
ELSE 'return' END as nvsr,
x.clv_bad as customer_lifetime_value,
c.first_order_date as fdos
FROM paid_orders p
left join customer_orders as c USING (customer_id)
LEFT OUTER JOIN 
(
        select
        p.order_id,
        sum(t2.total_amount_paid) as clv_bad
    from paid_orders p
    left join paid_orders t2 on p.customer_id = t2.customer_id and p.order_id >= t2.order_id
    group by 1
    order by p.order_id
) x on x.order_id = p.order_id
ORDER BY order_id
        );
[0m20:53:56.120990 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:53:58.589197 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.468 seconds
[0m20:53:58.616058 [debug] [Thread-1 (]: On model.jaffle_shop.customer_orders: Close
[0m20:53:58.746288 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '797019ee-8533-4c8f-8bfd-fefbaa90417a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e268750>]}
[0m20:53:58.748332 [info ] [Thread-1 (]: 1 of 1 OK created sql table model JAFFLE_SHOP.customer_orders .................. [[32mSUCCESS 1[0m in 2.68s]
[0m20:53:58.749996 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.customer_orders
[0m20:53:58.754092 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:53:58.755005 [debug] [MainThread]: Connection 'model.jaffle_shop.customer_orders' was properly closed.
[0m20:53:58.755642 [debug] [MainThread]: Connection 'list_raw_JAFFLE_SHOP_stripe' was properly closed.
[0m20:53:58.756621 [debug] [MainThread]: Connection 'list_raw_JAFFLE_SHOP' was properly closed.
[0m20:53:58.757579 [info ] [MainThread]: 
[0m20:53:58.758414 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.58 seconds (4.58s).
[0m20:53:58.759974 [debug] [MainThread]: Command end result
[0m20:53:58.800815 [info ] [MainThread]: 
[0m20:53:58.801399 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:53:58.801782 [info ] [MainThread]: 
[0m20:53:58.802149 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m20:53:58.803484 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 5.50549, "process_user_time": 2.570721, "process_kernel_time": 0.368293, "process_mem_max_rss": "130748416", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m20:53:58.804177 [debug] [MainThread]: Command `dbt run` succeeded at 20:53:58.804072 after 5.51 seconds
[0m20:53:58.804618 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109921490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109870490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109870d90>]}
[0m20:53:58.805008 [debug] [MainThread]: Flushing usage events
