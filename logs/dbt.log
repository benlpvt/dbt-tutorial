[0m22:33:45.064151 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106310910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1069007d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e96290>]}


============================== 22:33:45.070558 | 36db5546-7b85-44e3-9c70-7c17d542b170 ==============================
[0m22:33:45.070558 [info ] [MainThread]: Running with dbt=1.7.8
[0m22:33:45.071483 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/Users/ben/.dbt', 'log_path': '/Users/ben/jaffle_shop/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt debug', 'send_anonymous_usage_stats': 'True'}
[0m22:33:45.072386 [info ] [MainThread]: dbt version: 1.7.8
[0m22:33:45.073100 [info ] [MainThread]: python version: 3.11.0
[0m22:33:45.073725 [info ] [MainThread]: python path: /Users/ben/dbt-env/bin/python
[0m22:33:45.074214 [info ] [MainThread]: os info: macOS-14.3.1-x86_64-i386-64bit
[0m22:33:45.468900 [info ] [MainThread]: Using profiles dir at /Users/ben/.dbt
[0m22:33:45.469616 [info ] [MainThread]: Using profiles.yml file at /Users/ben/.dbt/profiles.yml
[0m22:33:45.470104 [info ] [MainThread]: Using dbt_project.yml file at /Users/ben/jaffle_shop/dbt_project.yml
[0m22:33:45.470844 [info ] [MainThread]: adapter type: snowflake
[0m22:33:45.471314 [info ] [MainThread]: adapter version: 1.7.2
[0m22:33:45.679721 [info ] [MainThread]: Configuration:
[0m22:33:45.680578 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m22:33:45.681208 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m22:33:45.681967 [info ] [MainThread]: Required dependencies:
[0m22:33:45.682617 [debug] [MainThread]: Executing "git --help"
[0m22:33:45.719003 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m22:33:45.720524 [debug] [MainThread]: STDERR: "b''"
[0m22:33:45.721170 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m22:33:45.721798 [info ] [MainThread]: Connection:
[0m22:33:45.722694 [info ] [MainThread]:   account: https://eta20809.east-us-2.azure.snowflakecomputing.com
[0m22:33:45.723285 [info ] [MainThread]:   user: DBT_EXECUTOR
[0m22:33:45.723813 [info ] [MainThread]:   database: RAW
[0m22:33:45.724484 [info ] [MainThread]:   warehouse: TRANSFORMING
[0m22:33:45.725283 [info ] [MainThread]:   role: DBT_EXECUTOR
[0m22:33:45.725796 [info ] [MainThread]:   schema: JAFFLE_SHOP
[0m22:33:45.726341 [info ] [MainThread]:   authenticator: None
[0m22:33:45.727392 [info ] [MainThread]:   private_key_path: None
[0m22:33:45.728680 [info ] [MainThread]:   oauth_client_id: None
[0m22:33:45.729323 [info ] [MainThread]:   query_tag: None
[0m22:33:45.729923 [info ] [MainThread]:   client_session_keep_alive: False
[0m22:33:45.730404 [info ] [MainThread]:   host: None
[0m22:33:45.730869 [info ] [MainThread]:   port: None
[0m22:33:45.731319 [info ] [MainThread]:   proxy_host: None
[0m22:33:45.731760 [info ] [MainThread]:   proxy_port: None
[0m22:33:45.732350 [info ] [MainThread]:   protocol: None
[0m22:33:45.733072 [info ] [MainThread]:   connect_retries: 1
[0m22:33:45.733608 [info ] [MainThread]:   connect_timeout: None
[0m22:33:45.734066 [info ] [MainThread]:   retry_on_database_errors: False
[0m22:33:45.734501 [info ] [MainThread]:   retry_all: False
[0m22:33:45.734936 [info ] [MainThread]:   insecure_mode: False
[0m22:33:45.735512 [info ] [MainThread]:   reuse_connections: None
[0m22:33:45.736286 [info ] [MainThread]: Registered adapter: snowflake=1.7.2
[0m22:33:45.770673 [debug] [MainThread]: Acquiring new snowflake connection 'debug'
[0m22:33:45.773496 [debug] [MainThread]: Using snowflake connection "debug"
[0m22:33:45.774075 [debug] [MainThread]: On debug: select 1 as id
[0m22:33:45.774867 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:33:46.995838 [debug] [MainThread]: Snowflake adapter: Error running SQL: select 1 as id
[0m22:33:46.996473 [debug] [MainThread]: Snowflake adapter: Rolling back transaction.
[0m22:33:46.997013 [debug] [MainThread]: On debug: No close available on handle
[0m22:33:46.997569 [info ] [MainThread]:   Connection test: [[31mERROR[0m]

[0m22:33:46.998076 [info ] [MainThread]: [31m1 check failed:[0m
[0m22:33:46.998548 [info ] [MainThread]: dbt was unable to connect to the specified database.
The database returned the following error:

  >Database Error
  250001: Could not connect to Snowflake backend after 2 attempt(s).Aborting

Check your database credentials and try again. For more information, visit:
https://docs.getdbt.com/docs/configure-your-profile


[0m22:33:47.000520 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_wall_clock_time": 2.0295067, "process_user_time": 3.603325, "process_kernel_time": 0.411044, "process_mem_max_rss": "122671104", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m22:33:47.001758 [debug] [MainThread]: Command `dbt debug` failed at 22:33:47.001491 after 2.03 seconds
[0m22:33:47.002576 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m22:33:47.003647 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106854090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106860cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106895d50>]}
[0m22:33:47.004465 [debug] [MainThread]: Flushing usage events
[0m22:35:01.699607 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112f97b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112faaa50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112958fd0>]}


============================== 22:35:01.706209 | c7eeaee9-606c-4690-9f32-b2bd797db1ad ==============================
[0m22:35:01.706209 [info ] [MainThread]: Running with dbt=1.7.8
[0m22:35:01.707289 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/ben/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/ben/jaffle_shop/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt debug', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m22:35:01.708401 [info ] [MainThread]: dbt version: 1.7.8
[0m22:35:01.709734 [info ] [MainThread]: python version: 3.11.0
[0m22:35:01.711039 [info ] [MainThread]: python path: /Users/ben/dbt-env/bin/python
[0m22:35:01.711666 [info ] [MainThread]: os info: macOS-14.3.1-x86_64-i386-64bit
[0m22:35:02.137829 [info ] [MainThread]: Using profiles dir at /Users/ben/.dbt
[0m22:35:02.139205 [info ] [MainThread]: Using profiles.yml file at /Users/ben/.dbt/profiles.yml
[0m22:35:02.140181 [info ] [MainThread]: Using dbt_project.yml file at /Users/ben/jaffle_shop/dbt_project.yml
[0m22:35:02.141272 [info ] [MainThread]: adapter type: snowflake
[0m22:35:02.142500 [info ] [MainThread]: adapter version: 1.7.2
[0m22:35:02.366028 [info ] [MainThread]: Configuration:
[0m22:35:02.366743 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m22:35:02.367315 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m22:35:02.367987 [info ] [MainThread]: Required dependencies:
[0m22:35:02.368549 [debug] [MainThread]: Executing "git --help"
[0m22:35:02.404186 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m22:35:02.406073 [debug] [MainThread]: STDERR: "b''"
[0m22:35:02.407033 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m22:35:02.408574 [info ] [MainThread]: Connection:
[0m22:35:02.410614 [info ] [MainThread]:   account: https://eta20809.east-us-2.azure.snowflakecomputing.com
[0m22:35:02.411617 [info ] [MainThread]:   user: DBT_EXECUTOR
[0m22:35:02.412288 [info ] [MainThread]:   database: RAW
[0m22:35:02.412974 [info ] [MainThread]:   warehouse: TRANSFORMING
[0m22:35:02.413448 [info ] [MainThread]:   role: DBT_EXECUTOR_ROLE
[0m22:35:02.413894 [info ] [MainThread]:   schema: JAFFLE_SHOP
[0m22:35:02.414332 [info ] [MainThread]:   authenticator: None
[0m22:35:02.414764 [info ] [MainThread]:   private_key_path: None
[0m22:35:02.415190 [info ] [MainThread]:   oauth_client_id: None
[0m22:35:02.415621 [info ] [MainThread]:   query_tag: None
[0m22:35:02.416049 [info ] [MainThread]:   client_session_keep_alive: False
[0m22:35:02.416476 [info ] [MainThread]:   host: None
[0m22:35:02.416922 [info ] [MainThread]:   port: None
[0m22:35:02.417351 [info ] [MainThread]:   proxy_host: None
[0m22:35:02.417783 [info ] [MainThread]:   proxy_port: None
[0m22:35:02.418206 [info ] [MainThread]:   protocol: None
[0m22:35:02.418629 [info ] [MainThread]:   connect_retries: 1
[0m22:35:02.419052 [info ] [MainThread]:   connect_timeout: None
[0m22:35:02.419483 [info ] [MainThread]:   retry_on_database_errors: False
[0m22:35:02.419899 [info ] [MainThread]:   retry_all: False
[0m22:35:02.420324 [info ] [MainThread]:   insecure_mode: False
[0m22:35:02.420880 [info ] [MainThread]:   reuse_connections: None
[0m22:35:02.421744 [info ] [MainThread]: Registered adapter: snowflake=1.7.2
[0m22:35:02.433424 [debug] [MainThread]: Acquiring new snowflake connection 'debug'
[0m22:35:02.435650 [debug] [MainThread]: Using snowflake connection "debug"
[0m22:35:02.436227 [debug] [MainThread]: On debug: select 1 as id
[0m22:35:02.436902 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:35:03.579671 [debug] [MainThread]: Snowflake adapter: Error running SQL: select 1 as id
[0m22:35:03.580525 [debug] [MainThread]: Snowflake adapter: Rolling back transaction.
[0m22:35:03.581477 [debug] [MainThread]: On debug: No close available on handle
[0m22:35:03.582275 [info ] [MainThread]:   Connection test: [[31mERROR[0m]

[0m22:35:03.582946 [info ] [MainThread]: [31m1 check failed:[0m
[0m22:35:03.583618 [info ] [MainThread]: dbt was unable to connect to the specified database.
The database returned the following error:

  >Database Error
  250001: Could not connect to Snowflake backend after 2 attempt(s).Aborting

Check your database credentials and try again. For more information, visit:
https://docs.getdbt.com/docs/configure-your-profile


[0m22:35:03.585762 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_wall_clock_time": 1.9812589, "process_user_time": 3.711043, "process_kernel_time": 0.399757, "process_mem_max_rss": "123523072", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m22:35:03.586814 [debug] [MainThread]: Command `dbt debug` failed at 22:35:03.586575 after 1.98 seconds
[0m22:35:03.588062 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m22:35:03.589130 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112938850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112f80290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112bff4d0>]}
[0m22:35:03.590106 [debug] [MainThread]: Flushing usage events
[0m22:36:39.933059 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1101b7350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fb44050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10febccd0>]}


============================== 22:36:39.939212 | 23586b65-eaf3-469d-83eb-4ba11b09fa77 ==============================
[0m22:36:39.939212 [info ] [MainThread]: Running with dbt=1.7.8
[0m22:36:39.940476 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/Users/ben/.dbt', 'log_path': '/Users/ben/jaffle_shop/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt debug', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:36:39.941985 [info ] [MainThread]: dbt version: 1.7.8
[0m22:36:39.943299 [info ] [MainThread]: python version: 3.11.0
[0m22:36:39.944045 [info ] [MainThread]: python path: /Users/ben/dbt-env/bin/python
[0m22:36:39.944849 [info ] [MainThread]: os info: macOS-14.3.1-x86_64-i386-64bit
[0m22:36:40.335526 [info ] [MainThread]: Using profiles dir at /Users/ben/.dbt
[0m22:36:40.336269 [info ] [MainThread]: Using profiles.yml file at /Users/ben/.dbt/profiles.yml
[0m22:36:40.336770 [info ] [MainThread]: Using dbt_project.yml file at /Users/ben/jaffle_shop/dbt_project.yml
[0m22:36:40.337527 [info ] [MainThread]: adapter type: snowflake
[0m22:36:40.338012 [info ] [MainThread]: adapter version: 1.7.2
[0m22:36:40.554658 [info ] [MainThread]: Configuration:
[0m22:36:40.555347 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m22:36:40.555834 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m22:36:40.556312 [info ] [MainThread]: Required dependencies:
[0m22:36:40.556864 [debug] [MainThread]: Executing "git --help"
[0m22:36:40.589053 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m22:36:40.590701 [debug] [MainThread]: STDERR: "b''"
[0m22:36:40.591377 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m22:36:40.593445 [info ] [MainThread]: Connection:
[0m22:36:40.594997 [info ] [MainThread]:   account: https://eta20809.east-us-2.azure.snowflakecomputing.com
[0m22:36:40.595614 [info ] [MainThread]:   user: DBT_EXECUTOR
[0m22:36:40.596097 [info ] [MainThread]:   database: ANALYTICS
[0m22:36:40.596540 [info ] [MainThread]:   warehouse: TRANSFORMING
[0m22:36:40.596975 [info ] [MainThread]:   role: DBT_EXECUTOR_ROLE
[0m22:36:40.597409 [info ] [MainThread]:   schema: JAFFLE_SHOP
[0m22:36:40.597847 [info ] [MainThread]:   authenticator: None
[0m22:36:40.598283 [info ] [MainThread]:   private_key_path: None
[0m22:36:40.598713 [info ] [MainThread]:   oauth_client_id: None
[0m22:36:40.599143 [info ] [MainThread]:   query_tag: None
[0m22:36:40.599580 [info ] [MainThread]:   client_session_keep_alive: False
[0m22:36:40.600105 [info ] [MainThread]:   host: None
[0m22:36:40.600629 [info ] [MainThread]:   port: None
[0m22:36:40.601120 [info ] [MainThread]:   proxy_host: None
[0m22:36:40.602005 [info ] [MainThread]:   proxy_port: None
[0m22:36:40.602565 [info ] [MainThread]:   protocol: None
[0m22:36:40.603024 [info ] [MainThread]:   connect_retries: 1
[0m22:36:40.603493 [info ] [MainThread]:   connect_timeout: None
[0m22:36:40.604063 [info ] [MainThread]:   retry_on_database_errors: False
[0m22:36:40.604673 [info ] [MainThread]:   retry_all: False
[0m22:36:40.605166 [info ] [MainThread]:   insecure_mode: False
[0m22:36:40.605770 [info ] [MainThread]:   reuse_connections: None
[0m22:36:40.606858 [info ] [MainThread]: Registered adapter: snowflake=1.7.2
[0m22:36:40.616698 [debug] [MainThread]: Acquiring new snowflake connection 'debug'
[0m22:36:40.618999 [debug] [MainThread]: Using snowflake connection "debug"
[0m22:36:40.619803 [debug] [MainThread]: On debug: select 1 as id
[0m22:36:40.620359 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:36:41.749394 [debug] [MainThread]: Snowflake adapter: Error running SQL: select 1 as id
[0m22:36:41.750046 [debug] [MainThread]: Snowflake adapter: Rolling back transaction.
[0m22:36:41.750594 [debug] [MainThread]: On debug: No close available on handle
[0m22:36:41.751367 [info ] [MainThread]:   Connection test: [[31mERROR[0m]

[0m22:36:41.751911 [info ] [MainThread]: [31m1 check failed:[0m
[0m22:36:41.752389 [info ] [MainThread]: dbt was unable to connect to the specified database.
The database returned the following error:

  >Database Error
  250001: Could not connect to Snowflake backend after 2 attempt(s).Aborting

Check your database credentials and try again. For more information, visit:
https://docs.getdbt.com/docs/configure-your-profile


[0m22:36:41.754313 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_wall_clock_time": 1.9141219, "process_user_time": 3.620898, "process_kernel_time": 0.387982, "process_mem_max_rss": "122687488", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m22:36:41.755202 [debug] [MainThread]: Command `dbt debug` failed at 22:36:41.754993 after 1.92 seconds
[0m22:36:41.755885 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m22:36:41.756974 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fe1ce10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110a34590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110198150>]}
[0m22:36:41.757877 [debug] [MainThread]: Flushing usage events
[0m22:38:24.460289 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bc5ead0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bc6f150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bc6e190>]}


============================== 22:38:24.467418 | 5cc5dc23-53d1-4253-8d75-c64df1670c85 ==============================
[0m22:38:24.467418 [info ] [MainThread]: Running with dbt=1.7.8
[0m22:38:24.468663 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/ben/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/Users/ben/jaffle_shop/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt debug', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:38:24.469810 [info ] [MainThread]: dbt version: 1.7.8
[0m22:38:24.470407 [info ] [MainThread]: python version: 3.11.0
[0m22:38:24.470933 [info ] [MainThread]: python path: /Users/ben/dbt-env/bin/python
[0m22:38:24.471632 [info ] [MainThread]: os info: macOS-14.3.1-x86_64-i386-64bit
[0m22:38:24.852992 [info ] [MainThread]: Using profiles dir at /Users/ben/.dbt
[0m22:38:24.853734 [info ] [MainThread]: Using profiles.yml file at /Users/ben/.dbt/profiles.yml
[0m22:38:24.854227 [info ] [MainThread]: Using dbt_project.yml file at /Users/ben/jaffle_shop/dbt_project.yml
[0m22:38:24.855162 [info ] [MainThread]: adapter type: snowflake
[0m22:38:24.856214 [info ] [MainThread]: adapter version: 1.7.2
[0m22:38:25.051171 [info ] [MainThread]: Configuration:
[0m22:38:25.051877 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m22:38:25.052421 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m22:38:25.052896 [info ] [MainThread]: Required dependencies:
[0m22:38:25.053440 [debug] [MainThread]: Executing "git --help"
[0m22:38:25.087848 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m22:38:25.091257 [debug] [MainThread]: STDERR: "b''"
[0m22:38:25.092086 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m22:38:25.092723 [info ] [MainThread]: Connection:
[0m22:38:25.093296 [info ] [MainThread]:   account: eta20809.east-us-2.azure
[0m22:38:25.093745 [info ] [MainThread]:   user: DBT_EXECUTOR
[0m22:38:25.094198 [info ] [MainThread]:   database: ANALYTICS
[0m22:38:25.094639 [info ] [MainThread]:   warehouse: TRANSFORMING
[0m22:38:25.095070 [info ] [MainThread]:   role: DBT_EXECUTOR_ROLE
[0m22:38:25.095766 [info ] [MainThread]:   schema: JAFFLE_SHOP
[0m22:38:25.096302 [info ] [MainThread]:   authenticator: None
[0m22:38:25.096891 [info ] [MainThread]:   private_key_path: None
[0m22:38:25.097349 [info ] [MainThread]:   oauth_client_id: None
[0m22:38:25.097801 [info ] [MainThread]:   query_tag: None
[0m22:38:25.098357 [info ] [MainThread]:   client_session_keep_alive: False
[0m22:38:25.098983 [info ] [MainThread]:   host: None
[0m22:38:25.099483 [info ] [MainThread]:   port: None
[0m22:38:25.100055 [info ] [MainThread]:   proxy_host: None
[0m22:38:25.100860 [info ] [MainThread]:   proxy_port: None
[0m22:38:25.101379 [info ] [MainThread]:   protocol: None
[0m22:38:25.101831 [info ] [MainThread]:   connect_retries: 1
[0m22:38:25.102630 [info ] [MainThread]:   connect_timeout: None
[0m22:38:25.103145 [info ] [MainThread]:   retry_on_database_errors: False
[0m22:38:25.103610 [info ] [MainThread]:   retry_all: False
[0m22:38:25.104054 [info ] [MainThread]:   insecure_mode: False
[0m22:38:25.104496 [info ] [MainThread]:   reuse_connections: None
[0m22:38:25.106315 [info ] [MainThread]: Registered adapter: snowflake=1.7.2
[0m22:38:25.116452 [debug] [MainThread]: Acquiring new snowflake connection 'debug'
[0m22:38:25.119110 [debug] [MainThread]: Using snowflake connection "debug"
[0m22:38:25.119708 [debug] [MainThread]: On debug: select 1 as id
[0m22:38:25.120206 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:38:27.178585 [debug] [MainThread]: SQL status: SUCCESS 1 in 2.0 seconds
[0m22:38:27.181982 [debug] [MainThread]: On debug: Close
[0m22:38:27.308063 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m22:38:27.309339 [info ] [MainThread]: [32mAll checks passed![0m
[0m22:38:27.313244 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 2.9447412, "process_user_time": 3.876774, "process_kernel_time": 0.427804, "process_mem_max_rss": "131710976", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m22:38:27.314525 [debug] [MainThread]: Command `dbt debug` succeeded at 22:38:27.314233 after 2.95 seconds
[0m22:38:27.315261 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m22:38:27.316007 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bc5ead0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10be54910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107eb9e10>]}
[0m22:38:27.316845 [debug] [MainThread]: Flushing usage events
[0m22:39:33.987102 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105373490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105399890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10538a610>]}


============================== 22:39:33.992963 | 99e5ad7a-01af-4e43-a3e1-a51cb61b9672 ==============================
[0m22:39:33.992963 [info ] [MainThread]: Running with dbt=1.7.8
[0m22:39:33.994087 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/ben/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/Users/ben/jaffle_shop/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m22:39:34.546866 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '99e5ad7a-01af-4e43-a3e1-a51cb61b9672', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105398510>]}
[0m22:39:34.677004 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '99e5ad7a-01af-4e43-a3e1-a51cb61b9672', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063e7e50>]}
[0m22:39:34.678221 [info ] [MainThread]: Registered adapter: snowflake=1.7.2
[0m22:39:34.701831 [debug] [MainThread]: checksum: 67f0013ca5f0bd43af9a0873dd50792fde83ef69de63b71cacd0b4ac656c52e5, vars: {}, profile: , target: , version: 1.7.8
[0m22:39:34.703125 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m22:39:34.703796 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '99e5ad7a-01af-4e43-a3e1-a51cb61b9672', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10634b150>]}
[0m22:39:36.234745 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '99e5ad7a-01af-4e43-a3e1-a51cb61b9672', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106479510>]}
[0m22:39:36.249290 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '99e5ad7a-01af-4e43-a3e1-a51cb61b9672', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067e43d0>]}
[0m22:39:36.250067 [info ] [MainThread]: Found 2 models, 4 tests, 0 sources, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m22:39:36.250652 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '99e5ad7a-01af-4e43-a3e1-a51cb61b9672', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106459050>]}
[0m22:39:36.253099 [info ] [MainThread]: 
[0m22:39:36.254398 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m22:39:36.256147 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ANALYTICS'
[0m22:39:36.275771 [debug] [ThreadPool]: Using snowflake connection "list_ANALYTICS"
[0m22:39:36.276447 [debug] [ThreadPool]: On list_ANALYTICS: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_ANALYTICS"} */
show terse schemas in database ANALYTICS
    limit 10000
[0m22:39:36.276962 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:39:37.014307 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01b299bb-0000-154d-0000-000bfc03b0ed
[0m22:39:37.015273 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m22:39:37.016166 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_schemas
[0m22:39:37.016794 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m22:39:37.017599 [debug] [ThreadPool]: On list_ANALYTICS: Close
[0m22:39:37.145481 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:39:37.146395 [debug] [MainThread]: Connection 'list_ANALYTICS' was properly closed.
[0m22:39:37.147190 [info ] [MainThread]: 
[0m22:39:37.148322 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.89 seconds (0.89s).
[0m22:39:37.149659 [error] [MainThread]: Encountered an error:
Runtime Error
  Database error while listing schemas in database "ANALYTICS"
  Database Error
    002043 (02000): SQL compilation error:
    Object does not exist, or operation cannot be performed.
[0m22:39:37.152057 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 3.2444746, "process_user_time": 5.07756, "process_kernel_time": 0.36548, "process_mem_max_rss": "137179136", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m22:39:37.153184 [debug] [MainThread]: Command `dbt run` failed at 22:39:37.152910 after 3.25 seconds
[0m22:39:37.154173 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105998890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1065491d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1016bc990>]}
[0m22:39:37.155007 [debug] [MainThread]: Flushing usage events
[0m22:42:33.120444 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10590ccd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105bca5d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105eb8fd0>]}


============================== 22:42:33.127342 | b9f10611-bb5d-4e06-aea0-b0be22fb7665 ==============================
[0m22:42:33.127342 [info ] [MainThread]: Running with dbt=1.7.8
[0m22:42:33.128377 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/ben/jaffle_shop/logs', 'profiles_dir': '/Users/ben/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m22:42:33.671319 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b9f10611-bb5d-4e06-aea0-b0be22fb7665', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f1e850>]}
[0m22:42:33.802100 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b9f10611-bb5d-4e06-aea0-b0be22fb7665', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1065c1910>]}
[0m22:42:33.803340 [info ] [MainThread]: Registered adapter: snowflake=1.7.2
[0m22:42:33.826994 [debug] [MainThread]: checksum: 67f0013ca5f0bd43af9a0873dd50792fde83ef69de63b71cacd0b4ac656c52e5, vars: {}, profile: , target: , version: 1.7.8
[0m22:42:33.842964 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m22:42:33.844075 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'b9f10611-bb5d-4e06-aea0-b0be22fb7665', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105edd4d0>]}
[0m22:42:35.098312 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'experimental_parser', 'label': 'b9f10611-bb5d-4e06-aea0-b0be22fb7665', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10698b990>]}
[0m22:42:35.366654 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b9f10611-bb5d-4e06-aea0-b0be22fb7665', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b94e10>]}
[0m22:42:35.381616 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b9f10611-bb5d-4e06-aea0-b0be22fb7665', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d6aed0>]}
[0m22:42:35.382391 [info ] [MainThread]: Found 2 models, 4 tests, 0 sources, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m22:42:35.382960 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b9f10611-bb5d-4e06-aea0-b0be22fb7665', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ca3ed0>]}
[0m22:42:35.385962 [info ] [MainThread]: 
[0m22:42:35.387489 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m22:42:35.389139 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ANALYTICS'
[0m22:42:35.408486 [debug] [ThreadPool]: Using snowflake connection "list_ANALYTICS"
[0m22:42:35.409133 [debug] [ThreadPool]: On list_ANALYTICS: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_ANALYTICS"} */
show terse schemas in database ANALYTICS
    limit 10000
[0m22:42:35.409627 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:42:36.112647 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01b299be-0000-154c-0000-000bfc03c125
[0m22:42:36.113643 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m22:42:36.114745 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_schemas
[0m22:42:36.115767 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m22:42:36.116776 [debug] [ThreadPool]: On list_ANALYTICS: Close
[0m22:42:36.238562 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:42:36.239696 [debug] [MainThread]: Connection 'list_ANALYTICS' was properly closed.
[0m22:42:36.240498 [info ] [MainThread]: 
[0m22:42:36.241357 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.85 seconds (0.85s).
[0m22:42:36.242467 [error] [MainThread]: Encountered an error:
Runtime Error
  Database error while listing schemas in database "ANALYTICS"
  Database Error
    002043 (02000): SQL compilation error:
    Object does not exist, or operation cannot be performed.
[0m22:42:36.245173 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 3.208129, "process_user_time": 5.084645, "process_kernel_time": 0.357282, "process_mem_max_rss": "136536064", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m22:42:36.246422 [debug] [MainThread]: Command `dbt run` failed at 22:42:36.246147 after 3.21 seconds
[0m22:42:36.247268 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105b59150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ea1710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x101c50e90>]}
[0m22:42:36.248027 [debug] [MainThread]: Flushing usage events
[0m22:43:18.198057 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e3a6d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ae4c90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e4fa50>]}


============================== 22:43:18.203966 | f0e81add-e0d7-40d1-9534-ff3200a850b8 ==============================
[0m22:43:18.203966 [info ] [MainThread]: Running with dbt=1.7.8
[0m22:43:18.205272 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/ben/jaffle_shop/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/ben/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m22:43:18.502104 [error] [MainThread]: Encountered an error:
Runtime Error
  Credentials in profile "jaffle_shop", target "dev" invalid: None is not of type 'string'
[0m22:43:18.504411 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.38884836, "process_user_time": 3.108076, "process_kernel_time": 0.283099, "process_mem_max_rss": "119881728", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m22:43:18.505379 [debug] [MainThread]: Command `dbt run` failed at 22:43:18.505149 after 0.39 seconds
[0m22:43:18.506005 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1058a2e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e42d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066e3450>]}
[0m22:43:18.506623 [debug] [MainThread]: Flushing usage events
[0m22:43:53.929975 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1124b92d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112a7db50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112a3a7d0>]}


============================== 22:43:53.935976 | 3fa156a9-99ba-469a-ab6c-0403d90d1cc4 ==============================
[0m22:43:53.935976 [info ] [MainThread]: Running with dbt=1.7.8
[0m22:43:53.936877 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/ben/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/ben/jaffle_shop/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:43:54.618806 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3fa156a9-99ba-469a-ab6c-0403d90d1cc4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112a91610>]}
[0m22:43:54.753734 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3fa156a9-99ba-469a-ab6c-0403d90d1cc4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112c219d0>]}
[0m22:43:54.754896 [info ] [MainThread]: Registered adapter: snowflake=1.7.2
[0m22:43:54.779903 [debug] [MainThread]: checksum: 67f0013ca5f0bd43af9a0873dd50792fde83ef69de63b71cacd0b4ac656c52e5, vars: {}, profile: , target: , version: 1.7.8
[0m22:43:54.797843 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m22:43:54.798791 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '3fa156a9-99ba-469a-ab6c-0403d90d1cc4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1135ec110>]}
[0m22:43:56.358922 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3fa156a9-99ba-469a-ab6c-0403d90d1cc4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1134c8890>]}
[0m22:43:56.373630 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3fa156a9-99ba-469a-ab6c-0403d90d1cc4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1138c81d0>]}
[0m22:43:56.374375 [info ] [MainThread]: Found 2 models, 4 tests, 0 sources, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m22:43:56.374942 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3fa156a9-99ba-469a-ab6c-0403d90d1cc4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113545690>]}
[0m22:43:56.377358 [info ] [MainThread]: 
[0m22:43:56.378556 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m22:43:56.380188 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ANALYTICS'
[0m22:43:56.400053 [debug] [ThreadPool]: Using snowflake connection "list_ANALYTICS"
[0m22:43:56.400692 [debug] [ThreadPool]: On list_ANALYTICS: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_ANALYTICS"} */
show terse schemas in database ANALYTICS
    limit 10000
[0m22:43:56.401192 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:43:57.053639 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01b299bf-0000-154c-0000-000bfc03c129
[0m22:43:57.054604 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m22:43:57.055666 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_schemas
[0m22:43:57.056430 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m22:43:57.057433 [debug] [ThreadPool]: On list_ANALYTICS: Close
[0m22:43:57.183553 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:43:57.184707 [debug] [MainThread]: Connection 'list_ANALYTICS' was properly closed.
[0m22:43:57.185710 [info ] [MainThread]: 
[0m22:43:57.186651 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.81 seconds (0.81s).
[0m22:43:57.188326 [error] [MainThread]: Encountered an error:
Runtime Error
  Database error while listing schemas in database "ANALYTICS"
  Database Error
    002043 (02000): SQL compilation error:
    Object does not exist, or operation cannot be performed.
[0m22:43:57.191420 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 3.3437428, "process_user_time": 5.15804, "process_kernel_time": 0.37907, "process_mem_max_rss": "137297920", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m22:43:57.192751 [debug] [MainThread]: Command `dbt run` failed at 22:43:57.192459 after 3.35 seconds
[0m22:43:57.193562 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112768b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112a442d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1127ba610>]}
[0m22:43:57.194329 [debug] [MainThread]: Flushing usage events
[0m21:49:03.343241 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110fb3bd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110ff1ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110ff0e90>]}


============================== 21:49:03.351993 | b2322d56-1610-41b0-a4bc-5a6f0a5f77a4 ==============================
[0m21:49:03.351993 [info ] [MainThread]: Running with dbt=1.7.8
[0m21:49:03.353155 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/Users/ben/.dbt', 'log_path': '/Users/ben/jaffle_shop/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt debug', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m21:49:03.354152 [info ] [MainThread]: dbt version: 1.7.8
[0m21:49:03.354752 [info ] [MainThread]: python version: 3.11.0
[0m21:49:03.355319 [info ] [MainThread]: python path: /Users/ben/dbt-env/bin/python
[0m21:49:03.355884 [info ] [MainThread]: os info: macOS-14.3.1-x86_64-i386-64bit
[0m21:49:03.926628 [info ] [MainThread]: Using profiles dir at /Users/ben/.dbt
[0m21:49:03.927485 [info ] [MainThread]: Using profiles.yml file at /Users/ben/.dbt/profiles.yml
[0m21:49:03.928086 [info ] [MainThread]: Using dbt_project.yml file at /Users/ben/jaffle_shop/dbt_project.yml
[0m21:49:03.929705 [info ] [MainThread]: adapter type: snowflake
[0m21:49:03.930347 [info ] [MainThread]: adapter version: 1.7.2
[0m21:49:04.109414 [info ] [MainThread]: Configuration:
[0m21:49:04.110115 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m21:49:04.110641 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m21:49:04.111133 [info ] [MainThread]: Required dependencies:
[0m21:49:04.112033 [debug] [MainThread]: Executing "git --help"
[0m21:49:04.145460 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m21:49:04.146792 [debug] [MainThread]: STDERR: "b''"
[0m21:49:04.147423 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m21:49:04.147986 [info ] [MainThread]: Connection:
[0m21:49:04.148593 [info ] [MainThread]:   account: eta20809.east-us-2.azure
[0m21:49:04.149085 [info ] [MainThread]:   user: DBT_EXECUTOR
[0m21:49:04.149570 [info ] [MainThread]:   database: ANALYTICS
[0m21:49:04.150039 [info ] [MainThread]:   warehouse: TRANSFORMING
[0m21:49:04.150522 [info ] [MainThread]:   role: DBT_EXECUTOR_ROLE
[0m21:49:04.150980 [info ] [MainThread]:   schema: PUBLIC
[0m21:49:04.151679 [info ] [MainThread]:   authenticator: None
[0m21:49:04.152857 [info ] [MainThread]:   private_key_path: None
[0m21:49:04.153769 [info ] [MainThread]:   oauth_client_id: None
[0m21:49:04.154705 [info ] [MainThread]:   query_tag: None
[0m21:49:04.155428 [info ] [MainThread]:   client_session_keep_alive: False
[0m21:49:04.155970 [info ] [MainThread]:   host: None
[0m21:49:04.156520 [info ] [MainThread]:   port: None
[0m21:49:04.157156 [info ] [MainThread]:   proxy_host: None
[0m21:49:04.157695 [info ] [MainThread]:   proxy_port: None
[0m21:49:04.158396 [info ] [MainThread]:   protocol: None
[0m21:49:04.158911 [info ] [MainThread]:   connect_retries: 1
[0m21:49:04.159389 [info ] [MainThread]:   connect_timeout: None
[0m21:49:04.159873 [info ] [MainThread]:   retry_on_database_errors: False
[0m21:49:04.160444 [info ] [MainThread]:   retry_all: False
[0m21:49:04.161044 [info ] [MainThread]:   insecure_mode: False
[0m21:49:04.162036 [info ] [MainThread]:   reuse_connections: None
[0m21:49:04.163105 [info ] [MainThread]: Registered adapter: snowflake=1.7.2
[0m21:49:04.192796 [debug] [MainThread]: Acquiring new snowflake connection 'debug'
[0m21:49:04.196261 [debug] [MainThread]: Using snowflake connection "debug"
[0m21:49:04.197074 [debug] [MainThread]: On debug: select 1 as id
[0m21:49:04.197659 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:49:05.289775 [debug] [MainThread]: SQL status: SUCCESS 1 in 1.0 seconds
[0m21:49:05.293613 [debug] [MainThread]: On debug: Close
[0m21:49:05.456438 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m21:49:05.457879 [info ] [MainThread]: [32mAll checks passed![0m
[0m21:49:05.483050 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 2.222721, "process_user_time": 3.5875, "process_kernel_time": 0.579359, "process_mem_max_rss": "125968384", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m21:49:05.484102 [debug] [MainThread]: Command `dbt debug` succeeded at 21:49:05.483872 after 2.22 seconds
[0m21:49:05.484719 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m21:49:05.485360 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110cecad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cd4bd50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cd50bd0>]}
[0m21:49:05.486186 [debug] [MainThread]: Flushing usage events
[0m21:49:12.371851 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c8f510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10462bed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c50fd0>]}


============================== 21:49:12.377958 | 555b58e5-ae92-4ac0-acbc-cc20e8c951e1 ==============================
[0m21:49:12.377958 [info ] [MainThread]: Running with dbt=1.7.8
[0m21:49:12.378913 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/ben/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/Users/ben/jaffle_shop/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m21:49:12.941803 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '555b58e5-ae92-4ac0-acbc-cc20e8c951e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1046e6490>]}
[0m21:49:13.072328 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '555b58e5-ae92-4ac0-acbc-cc20e8c951e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1050db2d0>]}
[0m21:49:13.073614 [info ] [MainThread]: Registered adapter: snowflake=1.7.2
[0m21:49:13.141773 [debug] [MainThread]: checksum: 67f0013ca5f0bd43af9a0873dd50792fde83ef69de63b71cacd0b4ac656c52e5, vars: {}, profile: , target: , version: 1.7.8
[0m21:49:13.262077 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:49:13.262759 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:49:13.271903 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '555b58e5-ae92-4ac0-acbc-cc20e8c951e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1055f0350>]}
[0m21:49:13.288398 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '555b58e5-ae92-4ac0-acbc-cc20e8c951e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105672d90>]}
[0m21:49:13.289169 [info ] [MainThread]: Found 2 models, 4 tests, 0 sources, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m21:49:13.289826 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '555b58e5-ae92-4ac0-acbc-cc20e8c951e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105627f10>]}
[0m21:49:13.293139 [info ] [MainThread]: 
[0m21:49:13.294576 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m21:49:13.296661 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_ANALYTICS'
[0m21:49:13.320242 [debug] [ThreadPool]: Using snowflake connection "list_ANALYTICS"
[0m21:49:13.320949 [debug] [ThreadPool]: On list_ANALYTICS: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_ANALYTICS"} */
show terse schemas in database ANALYTICS
    limit 10000
[0m21:49:13.321475 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:49:14.015590 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01b29f29-0000-15b8-0000-000bfc03d01d
[0m21:49:14.016261 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m21:49:14.016996 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_schemas
[0m21:49:14.017573 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m21:49:14.018388 [debug] [ThreadPool]: On list_ANALYTICS: Close
[0m21:49:14.144192 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:49:14.144837 [debug] [MainThread]: Connection 'list_ANALYTICS' was properly closed.
[0m21:49:14.145390 [info ] [MainThread]: 
[0m21:49:14.146198 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.85 seconds (0.85s).
[0m21:49:14.147272 [error] [MainThread]: Encountered an error:
Runtime Error
  Database error while listing schemas in database "ANALYTICS"
  Database Error
    002043 (02000): SQL compilation error:
    Object does not exist, or operation cannot be performed.
[0m21:49:14.149163 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 1.8596473, "process_user_time": 3.643542, "process_kernel_time": 0.360445, "process_mem_max_rss": "130658304", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m21:49:14.150076 [debug] [MainThread]: Command `dbt run` failed at 21:49:14.149855 after 1.86 seconds
[0m21:49:14.150728 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c8c190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c9e8d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1046b5a50>]}
[0m21:49:14.151511 [debug] [MainThread]: Flushing usage events
[0m21:55:53.736295 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109a9ced0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10945d690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10945e590>]}


============================== 21:55:53.742084 | 70bfacda-01c4-4aa6-abdc-fe743bbf5a77 ==============================
[0m21:55:53.742084 [info ] [MainThread]: Running with dbt=1.7.8
[0m21:55:53.743017 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/ben/jaffle_shop/logs', 'profiles_dir': '/Users/ben/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m21:55:54.285750 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '70bfacda-01c4-4aa6-abdc-fe743bbf5a77', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a41cc10>]}
[0m21:55:54.415104 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '70bfacda-01c4-4aa6-abdc-fe743bbf5a77', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a443c90>]}
[0m21:55:54.416603 [info ] [MainThread]: Registered adapter: snowflake=1.7.2
[0m21:55:54.442044 [debug] [MainThread]: checksum: 67f0013ca5f0bd43af9a0873dd50792fde83ef69de63b71cacd0b4ac656c52e5, vars: {}, profile: , target: , version: 1.7.8
[0m21:55:54.458343 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m21:55:54.459221 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '70bfacda-01c4-4aa6-abdc-fe743bbf5a77', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a4c5b50>]}
[0m21:55:56.106929 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '70bfacda-01c4-4aa6-abdc-fe743bbf5a77', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a4e6190>]}
[0m21:55:56.122297 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '70bfacda-01c4-4aa6-abdc-fe743bbf5a77', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a916990>]}
[0m21:55:56.123077 [info ] [MainThread]: Found 2 models, 4 tests, 0 sources, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m21:55:56.123673 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '70bfacda-01c4-4aa6-abdc-fe743bbf5a77', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a66ff50>]}
[0m21:55:56.126064 [info ] [MainThread]: 
[0m21:55:56.127363 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m21:55:56.128995 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RAW'
[0m21:55:56.152101 [debug] [ThreadPool]: Using snowflake connection "list_RAW"
[0m21:55:56.153334 [debug] [ThreadPool]: On list_RAW: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_RAW"} */
show terse schemas in database RAW
    limit 10000
[0m21:55:56.154319 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:55:56.959455 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01b29f2f-0000-15b8-0000-000bfc03d095
[0m21:55:56.960474 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m21:55:56.961668 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_schemas
[0m21:55:56.962345 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m21:55:56.963193 [debug] [ThreadPool]: On list_RAW: Close
[0m21:55:57.104524 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:55:57.105377 [debug] [MainThread]: Connection 'list_RAW' was properly closed.
[0m21:55:57.105958 [info ] [MainThread]: 
[0m21:55:57.124098 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.98 seconds (0.98s).
[0m21:55:57.125333 [error] [MainThread]: Encountered an error:
Runtime Error
  Database error while listing schemas in database "RAW"
  Database Error
    002043 (02000): SQL compilation error:
    Object does not exist, or operation cannot be performed.
[0m21:55:57.127192 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 3.4734235, "process_user_time": 5.151867, "process_kernel_time": 0.392785, "process_mem_max_rss": "134979584", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m21:55:57.128068 [debug] [MainThread]: Command `dbt run` failed at 21:55:57.127854 after 3.47 seconds
[0m21:55:57.128716 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109438ad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10973c790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109447950>]}
[0m21:55:57.129320 [debug] [MainThread]: Flushing usage events
[0m22:02:17.458137 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1062cc950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1062dfe10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10659af50>]}


============================== 22:02:17.463970 | c1715b79-caf7-4c2f-a123-ec3362f04e98 ==============================
[0m22:02:17.463970 [info ] [MainThread]: Running with dbt=1.7.8
[0m22:02:17.464914 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/ben/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/ben/jaffle_shop/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m22:02:17.982546 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c1715b79-caf7-4c2f-a123-ec3362f04e98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1072bcad0>]}
[0m22:02:18.106760 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c1715b79-caf7-4c2f-a123-ec3362f04e98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106945d10>]}
[0m22:02:18.107997 [info ] [MainThread]: Registered adapter: snowflake=1.7.2
[0m22:02:18.129567 [debug] [MainThread]: checksum: 67f0013ca5f0bd43af9a0873dd50792fde83ef69de63b71cacd0b4ac656c52e5, vars: {}, profile: , target: , version: 1.7.8
[0m22:02:18.144045 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m22:02:18.145061 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'c1715b79-caf7-4c2f-a123-ec3362f04e98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1073a9610>]}
[0m22:02:19.610320 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c1715b79-caf7-4c2f-a123-ec3362f04e98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1075e4210>]}
[0m22:02:19.624243 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c1715b79-caf7-4c2f-a123-ec3362f04e98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1076eb010>]}
[0m22:02:19.625018 [info ] [MainThread]: Found 2 models, 4 tests, 0 sources, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m22:02:19.625616 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c1715b79-caf7-4c2f-a123-ec3362f04e98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107684e90>]}
[0m22:02:19.628031 [info ] [MainThread]: 
[0m22:02:19.629294 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m22:02:19.630896 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RAW'
[0m22:02:19.653611 [debug] [ThreadPool]: Using snowflake connection "list_RAW"
[0m22:02:19.654781 [debug] [ThreadPool]: On list_RAW: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_RAW"} */
show terse schemas in database RAW
    limit 10000
[0m22:02:19.655508 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:02:20.438193 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01b29f36-0000-15b8-0000-000bfc03d0c5
[0m22:02:20.438909 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m22:02:20.439867 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_schemas
[0m22:02:20.440610 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m22:02:20.441542 [debug] [ThreadPool]: On list_RAW: Close
[0m22:02:20.565811 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:02:20.566985 [debug] [MainThread]: Connection 'list_RAW' was properly closed.
[0m22:02:20.567740 [info ] [MainThread]: 
[0m22:02:20.568522 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.94 seconds (0.94s).
[0m22:02:20.569508 [error] [MainThread]: Encountered an error:
Runtime Error
  Database error while listing schemas in database "RAW"
  Database Error
    002043 (02000): SQL compilation error:
    Object does not exist, or operation cannot be performed.
[0m22:02:20.572075 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 3.189392, "process_user_time": 4.890177, "process_kernel_time": 0.316704, "process_mem_max_rss": "135041024", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m22:02:20.573358 [debug] [MainThread]: Command `dbt run` failed at 22:02:20.573076 after 3.19 seconds
[0m22:02:20.574349 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106922fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1068f5d50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1025bfd90>]}
[0m22:02:20.575421 [debug] [MainThread]: Flushing usage events
[0m22:06:09.557035 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d620990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10de54c90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10de3a6d0>]}


============================== 22:06:09.562832 | 9d45fc88-eb40-46ee-a248-952305d9710c ==============================
[0m22:06:09.562832 [info ] [MainThread]: Running with dbt=1.7.8
[0m22:06:09.564063 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/ben/jaffle_shop/logs', 'debug': 'False', 'profiles_dir': '/Users/ben/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m22:06:10.085940 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9d45fc88-eb40-46ee-a248-952305d9710c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10de381d0>]}
[0m22:06:10.210378 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9d45fc88-eb40-46ee-a248-952305d9710c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dc114d0>]}
[0m22:06:10.211622 [info ] [MainThread]: Registered adapter: snowflake=1.7.2
[0m22:06:10.236523 [debug] [MainThread]: checksum: 67f0013ca5f0bd43af9a0873dd50792fde83ef69de63b71cacd0b4ac656c52e5, vars: {}, profile: , target: , version: 1.7.8
[0m22:06:10.253928 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m22:06:10.254760 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '9d45fc88-eb40-46ee-a248-952305d9710c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ebf0bd0>]}
[0m22:06:11.737434 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9d45fc88-eb40-46ee-a248-952305d9710c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ecc4050>]}
[0m22:06:11.752251 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9d45fc88-eb40-46ee-a248-952305d9710c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10efdab50>]}
[0m22:06:11.753041 [info ] [MainThread]: Found 2 models, 4 tests, 0 sources, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m22:06:11.753654 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9d45fc88-eb40-46ee-a248-952305d9710c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10eca3910>]}
[0m22:06:11.756085 [info ] [MainThread]: 
[0m22:06:11.757407 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m22:06:11.759149 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RAW'
[0m22:06:11.779874 [debug] [ThreadPool]: Using snowflake connection "list_RAW"
[0m22:06:11.780704 [debug] [ThreadPool]: On list_RAW: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_RAW"} */
show terse schemas in database RAW
    limit 10000
[0m22:06:11.781516 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:06:12.939710 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01b29f3a-0000-15b8-0000-000bfc03d0e5
[0m22:06:12.940711 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m22:06:12.941856 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_schemas
[0m22:06:12.942686 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m22:06:12.943953 [debug] [ThreadPool]: On list_RAW: Close
[0m22:06:13.073349 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:06:13.074361 [debug] [MainThread]: Connection 'list_RAW' was properly closed.
[0m22:06:13.075214 [info ] [MainThread]: 
[0m22:06:13.076157 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 1.32 seconds (1.32s).
[0m22:06:13.077340 [error] [MainThread]: Encountered an error:
Runtime Error
  Database error while listing schemas in database "RAW"
  Database Error
    002043 (02000): SQL compilation error:
    Object does not exist, or operation cannot be performed.
[0m22:06:13.080043 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 3.6021152, "process_user_time": 4.979157, "process_kernel_time": 0.334561, "process_mem_max_rss": "136814592", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m22:06:13.081394 [debug] [MainThread]: Command `dbt run` failed at 22:06:13.080985 after 3.60 seconds
[0m22:06:13.082649 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10db78050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10df1e310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ef916d0>]}
[0m22:06:13.083622 [debug] [MainThread]: Flushing usage events
[0m22:24:46.537761 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10470b8d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104471f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104a82950>]}


============================== 22:24:46.543705 | 6b0d59e9-e398-456f-95ab-386bf6e13ad2 ==============================
[0m22:24:46.543705 [info ] [MainThread]: Running with dbt=1.7.8
[0m22:24:46.544636 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/ben/jaffle_shop/logs', 'debug': 'False', 'profiles_dir': '/Users/ben/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt debug', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m22:24:46.545537 [info ] [MainThread]: dbt version: 1.7.8
[0m22:24:46.546116 [info ] [MainThread]: python version: 3.11.0
[0m22:24:46.546674 [info ] [MainThread]: python path: /Users/ben/dbt-env/bin/python
[0m22:24:46.547180 [info ] [MainThread]: os info: macOS-14.3.1-x86_64-i386-64bit
[0m22:24:46.882378 [info ] [MainThread]: Using profiles dir at /Users/ben/.dbt
[0m22:24:46.883185 [info ] [MainThread]: Using profiles.yml file at /Users/ben/.dbt/profiles.yml
[0m22:24:46.883735 [info ] [MainThread]: Using dbt_project.yml file at /Users/ben/jaffle_shop/dbt_project.yml
[0m22:24:46.884537 [info ] [MainThread]: adapter type: snowflake
[0m22:24:46.885035 [info ] [MainThread]: adapter version: 1.7.2
[0m22:24:47.058592 [info ] [MainThread]: Configuration:
[0m22:24:47.059451 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m22:24:47.060058 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m22:24:47.060572 [info ] [MainThread]: Required dependencies:
[0m22:24:47.061141 [debug] [MainThread]: Executing "git --help"
[0m22:24:47.092077 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m22:24:47.093858 [debug] [MainThread]: STDERR: "b''"
[0m22:24:47.094631 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m22:24:47.095208 [info ] [MainThread]: Connection:
[0m22:24:47.095811 [info ] [MainThread]:   account: eta20809.east-us-2.azure
[0m22:24:47.096310 [info ] [MainThread]:   user: DBT_EXECUTOR
[0m22:24:47.096788 [info ] [MainThread]:   database: RAW
[0m22:24:47.097258 [info ] [MainThread]:   warehouse: TRANSFORMING
[0m22:24:47.097722 [info ] [MainThread]:   role: DBT_EXECUTOR_ROLE
[0m22:24:47.098183 [info ] [MainThread]:   schema: JAFFLE_SHOP
[0m22:24:47.098648 [info ] [MainThread]:   authenticator: None
[0m22:24:47.099114 [info ] [MainThread]:   private_key_path: None
[0m22:24:47.099572 [info ] [MainThread]:   oauth_client_id: None
[0m22:24:47.100036 [info ] [MainThread]:   query_tag: None
[0m22:24:47.100574 [info ] [MainThread]:   client_session_keep_alive: False
[0m22:24:47.101048 [info ] [MainThread]:   host: None
[0m22:24:47.101521 [info ] [MainThread]:   port: None
[0m22:24:47.101981 [info ] [MainThread]:   proxy_host: None
[0m22:24:47.102448 [info ] [MainThread]:   proxy_port: None
[0m22:24:47.102910 [info ] [MainThread]:   protocol: None
[0m22:24:47.103365 [info ] [MainThread]:   connect_retries: 1
[0m22:24:47.103822 [info ] [MainThread]:   connect_timeout: None
[0m22:24:47.104281 [info ] [MainThread]:   retry_on_database_errors: False
[0m22:24:47.104734 [info ] [MainThread]:   retry_all: False
[0m22:24:47.105193 [info ] [MainThread]:   insecure_mode: False
[0m22:24:47.105698 [info ] [MainThread]:   reuse_connections: None
[0m22:24:47.106477 [info ] [MainThread]: Registered adapter: snowflake=1.7.2
[0m22:24:47.116685 [debug] [MainThread]: Acquiring new snowflake connection 'debug'
[0m22:24:47.119035 [debug] [MainThread]: Using snowflake connection "debug"
[0m22:24:47.119609 [debug] [MainThread]: On debug: select 1 as id
[0m22:24:47.120195 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:24:47.880436 [debug] [MainThread]: Snowflake adapter: Error running SQL: select 1 as id
[0m22:24:47.881595 [debug] [MainThread]: Snowflake adapter: Rolling back transaction.
[0m22:24:47.882493 [debug] [MainThread]: On debug: No close available on handle
[0m22:24:47.883410 [info ] [MainThread]:   Connection test: [[31mERROR[0m]

[0m22:24:47.884289 [info ] [MainThread]: [31m1 check failed:[0m
[0m22:24:47.885163 [info ] [MainThread]: dbt was unable to connect to the specified database.
The database returned the following error:

  >Database Error
  250001 (08001): Failed to connect to DB: eta20809.east-us-2.azure.snowflakecomputing.com:443. Incorrect username or password was specified.

Check your database credentials and try again. For more information, visit:
https://docs.getdbt.com/docs/configure-your-profile


[0m22:24:47.887933 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_wall_clock_time": 1.4281068, "process_user_time": 3.315565, "process_kernel_time": 0.306811, "process_mem_max_rss": "126730240", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m22:24:47.889130 [debug] [MainThread]: Command `dbt debug` failed at 22:24:47.888837 after 1.43 seconds
[0m22:24:47.890084 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m22:24:47.891309 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104aa0910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1047b53d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1053a3310>]}
[0m22:24:47.892369 [debug] [MainThread]: Flushing usage events
[0m22:26:49.301203 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fe51490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fe5f150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fe5e310>]}


============================== 22:26:49.307053 | f23f452b-a622-414d-bc07-962416cce55a ==============================
[0m22:26:49.307053 [info ] [MainThread]: Running with dbt=1.7.8
[0m22:26:49.308147 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/ben/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/Users/ben/jaffle_shop/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m22:26:49.827663 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f23f452b-a622-414d-bc07-962416cce55a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110e1e0d0>]}
[0m22:26:49.949982 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f23f452b-a622-414d-bc07-962416cce55a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1105a2d50>]}
[0m22:26:49.951237 [info ] [MainThread]: Registered adapter: snowflake=1.7.2
[0m22:26:49.974981 [debug] [MainThread]: checksum: 67f0013ca5f0bd43af9a0873dd50792fde83ef69de63b71cacd0b4ac656c52e5, vars: {}, profile: , target: , version: 1.7.8
[0m22:26:49.991150 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m22:26:49.992388 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'f23f452b-a622-414d-bc07-962416cce55a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110d95110>]}
[0m22:26:51.478557 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f23f452b-a622-414d-bc07-962416cce55a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110f0dad0>]}
[0m22:26:51.493274 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f23f452b-a622-414d-bc07-962416cce55a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111150110>]}
[0m22:26:51.494068 [info ] [MainThread]: Found 2 models, 4 tests, 0 sources, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m22:26:51.494683 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f23f452b-a622-414d-bc07-962416cce55a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111323810>]}
[0m22:26:51.497163 [info ] [MainThread]: 
[0m22:26:51.498427 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m22:26:51.500093 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RAW'
[0m22:26:51.521895 [debug] [ThreadPool]: Using snowflake connection "list_RAW"
[0m22:26:51.522639 [debug] [ThreadPool]: On list_RAW: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_RAW"} */
show terse schemas in database RAW
    limit 10000
[0m22:26:51.523238 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:26:52.568718 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01b29f4e-0000-15b8-0000-000bfc03d235
[0m22:26:52.569744 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m22:26:52.570923 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_schemas
[0m22:26:52.571778 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m22:26:52.572823 [debug] [ThreadPool]: On list_RAW: Close
[0m22:26:52.737527 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:26:52.738684 [debug] [MainThread]: Connection 'list_RAW' was properly closed.
[0m22:26:52.739557 [info ] [MainThread]: 
[0m22:26:52.740564 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 1.24 seconds (1.24s).
[0m22:26:52.741943 [error] [MainThread]: Encountered an error:
Runtime Error
  Database error while listing schemas in database "RAW"
  Database Error
    002043 (02000): SQL compilation error:
    Object does not exist, or operation cannot be performed.
[0m22:26:52.744723 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 3.5200431, "process_user_time": 4.941399, "process_kernel_time": 0.318157, "process_mem_max_rss": "135159808", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m22:26:52.745910 [debug] [MainThread]: Command `dbt run` failed at 22:26:52.745619 after 3.52 seconds
[0m22:26:52.746773 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ff14b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1104a0410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fe5f8d0>]}
[0m22:26:52.747905 [debug] [MainThread]: Flushing usage events
[0m22:38:05.667475 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cbe2210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cbf39d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108f53690>]}


============================== 22:38:05.673797 | 96097220-8a04-4e89-8853-7195ad450083 ==============================
[0m22:38:05.673797 [info ] [MainThread]: Running with dbt=1.7.8
[0m22:38:05.674839 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/ben/jaffle_shop/logs', 'version_check': 'True', 'profiles_dir': '/Users/ben/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m22:38:06.229472 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '96097220-8a04-4e89-8853-7195ad450083', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dbd3010>]}
[0m22:38:06.361845 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '96097220-8a04-4e89-8853-7195ad450083', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d263010>]}
[0m22:38:06.363105 [info ] [MainThread]: Registered adapter: snowflake=1.7.2
[0m22:38:06.389633 [debug] [MainThread]: checksum: 67f0013ca5f0bd43af9a0873dd50792fde83ef69de63b71cacd0b4ac656c52e5, vars: {}, profile: , target: , version: 1.7.8
[0m22:38:06.440994 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:38:06.441720 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:38:06.451011 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '96097220-8a04-4e89-8853-7195ad450083', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ddb3f90>]}
[0m22:38:06.468356 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '96097220-8a04-4e89-8853-7195ad450083', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dce5410>]}
[0m22:38:06.469380 [info ] [MainThread]: Found 2 models, 4 tests, 0 sources, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m22:38:06.470539 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '96097220-8a04-4e89-8853-7195ad450083', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dc9cc10>]}
[0m22:38:06.473706 [info ] [MainThread]: 
[0m22:38:06.475207 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m22:38:06.477372 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RAW'
[0m22:38:06.499027 [debug] [ThreadPool]: Using snowflake connection "list_RAW"
[0m22:38:06.499728 [debug] [ThreadPool]: On list_RAW: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_RAW"} */
show terse schemas in database RAW
    limit 10000
[0m22:38:06.500546 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:38:07.149926 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 1.0 seconds
[0m22:38:07.157914 [debug] [ThreadPool]: On list_RAW: Close
[0m22:38:07.291111 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RAW, now create_RAW_JAFFLE_SHOP)
[0m22:38:07.294411 [debug] [ThreadPool]: Creating schema "database: "RAW"
schema: "JAFFLE_SHOP"
"
[0m22:38:07.303283 [debug] [ThreadPool]: Using snowflake connection "create_RAW_JAFFLE_SHOP"
[0m22:38:07.312520 [debug] [ThreadPool]: On create_RAW_JAFFLE_SHOP: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "create_RAW_JAFFLE_SHOP"} */
create schema if not exists RAW.JAFFLE_SHOP
[0m22:38:07.313219 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:38:07.744194 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.0 seconds
[0m22:38:07.747661 [debug] [ThreadPool]: On create_RAW_JAFFLE_SHOP: Close
[0m22:38:07.889220 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_RAW_JAFFLE_SHOP, now list_RAW_JAFFLE_SHOP)
[0m22:38:07.902195 [debug] [ThreadPool]: Using snowflake connection "list_RAW_JAFFLE_SHOP"
[0m22:38:07.902874 [debug] [ThreadPool]: On list_RAW_JAFFLE_SHOP: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_RAW_JAFFLE_SHOP"} */
show terse objects in RAW.JAFFLE_SHOP limit 10000
[0m22:38:07.903398 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:38:08.489023 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 1.0 seconds
[0m22:38:08.493732 [debug] [ThreadPool]: On list_RAW_JAFFLE_SHOP: Close
[0m22:38:08.622300 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '96097220-8a04-4e89-8853-7195ad450083', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d94ca50>]}
[0m22:38:08.624481 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:38:08.625629 [info ] [MainThread]: 
[0m22:38:08.632906 [debug] [Thread-1 (]: Began running node model.jaffle_shop.my_first_dbt_model
[0m22:38:08.634424 [info ] [Thread-1 (]: 1 of 2 START sql table model JAFFLE_SHOP.my_first_dbt_model .................... [RUN]
[0m22:38:08.636057 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_RAW_JAFFLE_SHOP, now model.jaffle_shop.my_first_dbt_model)
[0m22:38:08.636929 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.my_first_dbt_model
[0m22:38:08.650671 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.my_first_dbt_model"
[0m22:38:08.652581 [debug] [Thread-1 (]: Timing info for model.jaffle_shop.my_first_dbt_model (compile): 22:38:08.637427 => 22:38:08.652032
[0m22:38:08.653320 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.my_first_dbt_model
[0m22:38:08.704255 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.my_first_dbt_model"
[0m22:38:08.706511 [debug] [Thread-1 (]: Using snowflake connection "model.jaffle_shop.my_first_dbt_model"
[0m22:38:08.707326 [debug] [Thread-1 (]: On model.jaffle_shop.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.my_first_dbt_model"} */
create or replace transient table RAW.JAFFLE_SHOP.my_first_dbt_model
         as
        (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
        );
[0m22:38:08.708023 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:38:09.133054 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b29f5a-0000-15b8-0000-000bfc03d2f5
[0m22:38:09.134344 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000606 (57P03): No active warehouse selected in the current session.  Select an active warehouse with the 'use warehouse' command.

[0m22:38:09.136014 [debug] [Thread-1 (]: Timing info for model.jaffle_shop.my_first_dbt_model (execute): 22:38:08.653727 => 22:38:09.135380
[0m22:38:09.137041 [debug] [Thread-1 (]: On model.jaffle_shop.my_first_dbt_model: Close
[0m22:38:09.276923 [debug] [Thread-1 (]: Database Error in model my_first_dbt_model (models/example/my_first_dbt_model.sql)
  000606 (57P03): No active warehouse selected in the current session.  Select an active warehouse with the 'use warehouse' command.
  
  compiled Code at target/run/jaffle_shop/models/example/my_first_dbt_model.sql
[0m22:38:09.278105 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '96097220-8a04-4e89-8853-7195ad450083', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dfe2610>]}
[0m22:38:09.279384 [error] [Thread-1 (]: 1 of 2 ERROR creating sql table model JAFFLE_SHOP.my_first_dbt_model ........... [[31mERROR[0m in 0.64s]
[0m22:38:09.281017 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.my_first_dbt_model
[0m22:38:09.282707 [debug] [Thread-3 (]: Began running node model.jaffle_shop.my_second_dbt_model
[0m22:38:09.283707 [info ] [Thread-3 (]: 2 of 2 SKIP relation JAFFLE_SHOP.my_second_dbt_model ........................... [[33mSKIP[0m]
[0m22:38:09.284566 [debug] [Thread-3 (]: Finished running node model.jaffle_shop.my_second_dbt_model
[0m22:38:09.287535 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:38:09.288270 [debug] [MainThread]: Connection 'model.jaffle_shop.my_first_dbt_model' was properly closed.
[0m22:38:09.289427 [info ] [MainThread]: 
[0m22:38:09.290389 [info ] [MainThread]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 2.81 seconds (2.81s).
[0m22:38:09.292496 [debug] [MainThread]: Command end result
[0m22:38:09.306927 [info ] [MainThread]: 
[0m22:38:09.307640 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m22:38:09.308266 [info ] [MainThread]: 
[0m22:38:09.309018 [error] [MainThread]:   Database Error in model my_first_dbt_model (models/example/my_first_dbt_model.sql)
  000606 (57P03): No active warehouse selected in the current session.  Select an active warehouse with the 'use warehouse' command.
  
  compiled Code at target/run/jaffle_shop/models/example/my_first_dbt_model.sql
[0m22:38:09.309921 [info ] [MainThread]: 
[0m22:38:09.310921 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=1 TOTAL=2
[0m22:38:09.314300 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 3.728751, "process_user_time": 4.044056, "process_kernel_time": 0.408701, "process_mem_max_rss": "135249920", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m22:38:09.315758 [debug] [MainThread]: Command `dbt run` failed at 22:38:09.315392 after 3.73 seconds
[0m22:38:09.317092 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cbd1e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d1f9750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ec47d0>]}
[0m22:38:09.317777 [debug] [MainThread]: Flushing usage events
[0m22:43:05.337030 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111cd2610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1116be410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1116be490>]}


============================== 22:43:05.344230 | 350f3051-e04d-4c82-973c-e95bdc6b32f0 ==============================
[0m22:43:05.344230 [info ] [MainThread]: Running with dbt=1.7.8
[0m22:43:05.345680 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/ben/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/ben/jaffle_shop/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m22:43:05.892227 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '350f3051-e04d-4c82-973c-e95bdc6b32f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1125a2990>]}
[0m22:43:06.019498 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '350f3051-e04d-4c82-973c-e95bdc6b32f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111d06350>]}
[0m22:43:06.020836 [info ] [MainThread]: Registered adapter: snowflake=1.7.2
[0m22:43:06.047130 [debug] [MainThread]: checksum: 67f0013ca5f0bd43af9a0873dd50792fde83ef69de63b71cacd0b4ac656c52e5, vars: {}, profile: , target: , version: 1.7.8
[0m22:43:06.103326 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:43:06.104072 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:43:06.113346 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '350f3051-e04d-4c82-973c-e95bdc6b32f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111d29910>]}
[0m22:43:06.128875 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '350f3051-e04d-4c82-973c-e95bdc6b32f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1126f7590>]}
[0m22:43:06.129712 [info ] [MainThread]: Found 2 models, 4 tests, 0 sources, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m22:43:06.130334 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '350f3051-e04d-4c82-973c-e95bdc6b32f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112415b90>]}
[0m22:43:06.132915 [info ] [MainThread]: 
[0m22:43:06.134325 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m22:43:06.136192 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RAW'
[0m22:43:06.158029 [debug] [ThreadPool]: Using snowflake connection "list_RAW"
[0m22:43:06.158703 [debug] [ThreadPool]: On list_RAW: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_RAW"} */
show terse schemas in database RAW
    limit 10000
[0m22:43:06.159258 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:43:07.422584 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.0 seconds
[0m22:43:07.425611 [debug] [ThreadPool]: On list_RAW: Close
[0m22:43:07.556638 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RAW, now list_RAW_JAFFLE_SHOP)
[0m22:43:07.572618 [debug] [ThreadPool]: Using snowflake connection "list_RAW_JAFFLE_SHOP"
[0m22:43:07.573394 [debug] [ThreadPool]: On list_RAW_JAFFLE_SHOP: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_RAW_JAFFLE_SHOP"} */
show terse objects in RAW.JAFFLE_SHOP limit 10000
[0m22:43:07.573912 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:43:08.040349 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.0 seconds
[0m22:43:08.044746 [debug] [ThreadPool]: On list_RAW_JAFFLE_SHOP: Close
[0m22:43:08.185164 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '350f3051-e04d-4c82-973c-e95bdc6b32f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11271be90>]}
[0m22:43:08.187623 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:43:08.188558 [info ] [MainThread]: 
[0m22:43:08.193676 [debug] [Thread-1 (]: Began running node model.jaffle_shop.my_first_dbt_model
[0m22:43:08.195683 [info ] [Thread-1 (]: 1 of 2 START sql table model JAFFLE_SHOP.my_first_dbt_model .................... [RUN]
[0m22:43:08.197170 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_RAW_JAFFLE_SHOP, now model.jaffle_shop.my_first_dbt_model)
[0m22:43:08.197999 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.my_first_dbt_model
[0m22:43:08.211379 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.my_first_dbt_model"
[0m22:43:08.212679 [debug] [Thread-1 (]: Timing info for model.jaffle_shop.my_first_dbt_model (compile): 22:43:08.198530 => 22:43:08.212290
[0m22:43:08.213305 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.my_first_dbt_model
[0m22:43:08.263471 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.my_first_dbt_model"
[0m22:43:08.265442 [debug] [Thread-1 (]: Using snowflake connection "model.jaffle_shop.my_first_dbt_model"
[0m22:43:08.266371 [debug] [Thread-1 (]: On model.jaffle_shop.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.my_first_dbt_model"} */
create or replace transient table RAW.JAFFLE_SHOP.my_first_dbt_model
         as
        (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
        );
[0m22:43:08.267047 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:43:09.376949 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m22:43:09.411205 [debug] [Thread-1 (]: Timing info for model.jaffle_shop.my_first_dbt_model (execute): 22:43:08.213685 => 22:43:09.410838
[0m22:43:09.411913 [debug] [Thread-1 (]: On model.jaffle_shop.my_first_dbt_model: Close
[0m22:43:09.522029 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '350f3051-e04d-4c82-973c-e95bdc6b32f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1127c7e50>]}
[0m22:43:09.523709 [info ] [Thread-1 (]: 1 of 2 OK created sql table model JAFFLE_SHOP.my_first_dbt_model ............... [[32mSUCCESS 1[0m in 1.33s]
[0m22:43:09.525144 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.my_first_dbt_model
[0m22:43:09.526562 [debug] [Thread-3 (]: Began running node model.jaffle_shop.my_second_dbt_model
[0m22:43:09.527413 [info ] [Thread-3 (]: 2 of 2 START sql view model JAFFLE_SHOP.my_second_dbt_model .................... [RUN]
[0m22:43:09.528608 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.jaffle_shop.my_second_dbt_model'
[0m22:43:09.529205 [debug] [Thread-3 (]: Began compiling node model.jaffle_shop.my_second_dbt_model
[0m22:43:09.536652 [debug] [Thread-3 (]: Writing injected SQL for node "model.jaffle_shop.my_second_dbt_model"
[0m22:43:09.538642 [debug] [Thread-3 (]: Timing info for model.jaffle_shop.my_second_dbt_model (compile): 22:43:09.529608 => 22:43:09.537990
[0m22:43:09.539615 [debug] [Thread-3 (]: Began executing node model.jaffle_shop.my_second_dbt_model
[0m22:43:09.586467 [debug] [Thread-3 (]: Writing runtime sql for node "model.jaffle_shop.my_second_dbt_model"
[0m22:43:09.587954 [debug] [Thread-3 (]: Using snowflake connection "model.jaffle_shop.my_second_dbt_model"
[0m22:43:09.588583 [debug] [Thread-3 (]: On model.jaffle_shop.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.my_second_dbt_model"} */
create or replace   view RAW.JAFFLE_SHOP.my_second_dbt_model
  
   as (
    -- Use the `ref` function to select from other models

select *
from RAW.JAFFLE_SHOP.my_first_dbt_model
where id = 1
  );
[0m22:43:09.589169 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m22:43:10.023711 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m22:43:10.031163 [debug] [Thread-3 (]: Timing info for model.jaffle_shop.my_second_dbt_model (execute): 22:43:09.540215 => 22:43:10.030620
[0m22:43:10.032202 [debug] [Thread-3 (]: On model.jaffle_shop.my_second_dbt_model: Close
[0m22:43:10.166937 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '350f3051-e04d-4c82-973c-e95bdc6b32f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112859550>]}
[0m22:43:10.168752 [info ] [Thread-3 (]: 2 of 2 OK created sql view model JAFFLE_SHOP.my_second_dbt_model ............... [[32mSUCCESS 1[0m in 0.64s]
[0m22:43:10.170280 [debug] [Thread-3 (]: Finished running node model.jaffle_shop.my_second_dbt_model
[0m22:43:10.174408 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:43:10.175158 [debug] [MainThread]: Connection 'model.jaffle_shop.my_first_dbt_model' was properly closed.
[0m22:43:10.175811 [debug] [MainThread]: Connection 'model.jaffle_shop.my_second_dbt_model' was properly closed.
[0m22:43:10.176611 [info ] [MainThread]: 
[0m22:43:10.177519 [info ] [MainThread]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 4.04 seconds (4.04s).
[0m22:43:10.179170 [debug] [MainThread]: Command end result
[0m22:43:10.195252 [info ] [MainThread]: 
[0m22:43:10.196101 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:43:10.196793 [info ] [MainThread]: 
[0m22:43:10.197438 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m22:43:10.199719 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 4.947293, "process_user_time": 4.203761, "process_kernel_time": 0.433669, "process_mem_max_rss": "136990720", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m22:43:10.200727 [debug] [MainThread]: Command `dbt run` succeeded at 22:43:10.200496 after 4.95 seconds
[0m22:43:10.201795 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d92c110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d9b3e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111750610>]}
[0m22:43:10.202928 [debug] [MainThread]: Flushing usage events
[0m20:40:18.848624 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108dca510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108e0e510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b48f50>]}


============================== 20:40:18.854696 | a5bf9ac7-6858-48fa-a5d6-deb24d088c88 ==============================
[0m20:40:18.854696 [info ] [MainThread]: Running with dbt=1.7.8
[0m20:40:18.855899 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/ben/jaffle_shop/logs', 'profiles_dir': '/Users/ben/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt debug', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m20:40:18.856858 [info ] [MainThread]: dbt version: 1.7.8
[0m20:40:18.857463 [info ] [MainThread]: python version: 3.11.0
[0m20:40:18.858026 [info ] [MainThread]: python path: /Users/ben/dbt-env/bin/python
[0m20:40:18.858540 [info ] [MainThread]: os info: macOS-14.3.1-x86_64-i386-64bit
[0m20:40:19.229670 [info ] [MainThread]: Using profiles dir at /Users/ben/.dbt
[0m20:40:19.230433 [info ] [MainThread]: Using profiles.yml file at /Users/ben/.dbt/profiles.yml
[0m20:40:19.230988 [info ] [MainThread]: Using dbt_project.yml file at /Users/ben/jaffle_shop/dbt_project.yml
[0m20:40:19.231792 [info ] [MainThread]: adapter type: snowflake
[0m20:40:19.232327 [info ] [MainThread]: adapter version: 1.7.2
[0m20:40:19.409651 [info ] [MainThread]: Configuration:
[0m20:40:19.410394 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m20:40:19.410943 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m20:40:19.411444 [info ] [MainThread]: Required dependencies:
[0m20:40:19.412016 [debug] [MainThread]: Executing "git --help"
[0m20:40:19.443879 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m20:40:19.445193 [debug] [MainThread]: STDERR: "b''"
[0m20:40:19.445866 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m20:40:19.446482 [info ] [MainThread]: Connection:
[0m20:40:19.447269 [info ] [MainThread]:   account: eta20809.east-us-2.azure
[0m20:40:19.448188 [info ] [MainThread]:   user: DBT_EXECUTOR
[0m20:40:19.449016 [info ] [MainThread]:   database: RAW
[0m20:40:19.449699 [info ] [MainThread]:   warehouse: TRANSFORMING
[0m20:40:19.450238 [info ] [MainThread]:   role: DBT_EXECUTOR_ROLE
[0m20:40:19.450763 [info ] [MainThread]:   schema: JAFFLE_SHOP
[0m20:40:19.451629 [info ] [MainThread]:   authenticator: None
[0m20:40:19.452303 [info ] [MainThread]:   private_key_path: None
[0m20:40:19.452820 [info ] [MainThread]:   oauth_client_id: None
[0m20:40:19.453469 [info ] [MainThread]:   query_tag: None
[0m20:40:19.454307 [info ] [MainThread]:   client_session_keep_alive: False
[0m20:40:19.455321 [info ] [MainThread]:   host: None
[0m20:40:19.455932 [info ] [MainThread]:   port: None
[0m20:40:19.456450 [info ] [MainThread]:   proxy_host: None
[0m20:40:19.457133 [info ] [MainThread]:   proxy_port: None
[0m20:40:19.457686 [info ] [MainThread]:   protocol: None
[0m20:40:19.458361 [info ] [MainThread]:   connect_retries: 1
[0m20:40:19.459169 [info ] [MainThread]:   connect_timeout: None
[0m20:40:19.459721 [info ] [MainThread]:   retry_on_database_errors: False
[0m20:40:19.460228 [info ] [MainThread]:   retry_all: False
[0m20:40:19.460723 [info ] [MainThread]:   insecure_mode: False
[0m20:40:19.461205 [info ] [MainThread]:   reuse_connections: None
[0m20:40:19.462032 [info ] [MainThread]: Registered adapter: snowflake=1.7.2
[0m20:40:19.473845 [debug] [MainThread]: Acquiring new snowflake connection 'debug'
[0m20:40:19.477119 [debug] [MainThread]: Using snowflake connection "debug"
[0m20:40:19.477856 [debug] [MainThread]: On debug: select 1 as id
[0m20:40:19.478953 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:40:20.692095 [debug] [MainThread]: SQL status: SUCCESS 1 in 1.0 seconds
[0m20:40:20.695517 [debug] [MainThread]: On debug: Close
[0m20:40:20.822008 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m20:40:20.823444 [info ] [MainThread]: [32mAll checks passed![0m
[0m20:40:20.826415 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 2.0584776, "process_user_time": 3.433685, "process_kernel_time": 0.36466, "process_mem_max_rss": "125165568", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m20:40:20.827882 [debug] [MainThread]: Command `dbt debug` succeeded at 20:40:20.827524 after 2.06 seconds
[0m20:40:20.828852 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m20:40:20.829826 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108afd6d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108afe1d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104abbd90>]}
[0m20:40:20.830795 [debug] [MainThread]: Flushing usage events
[0m20:49:08.456766 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1145c1190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1142649d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114264910>]}


============================== 20:49:08.463321 | 09b2a212-99d9-45f2-acf2-4a6a35471db9 ==============================
[0m20:49:08.463321 [info ] [MainThread]: Running with dbt=1.7.8
[0m20:49:08.464358 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/ben/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/ben/jaffle_shop/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m20:49:09.035895 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '09b2a212-99d9-45f2-acf2-4a6a35471db9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115050c50>]}
[0m20:49:09.175506 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '09b2a212-99d9-45f2-acf2-4a6a35471db9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115070190>]}
[0m20:49:09.176744 [info ] [MainThread]: Registered adapter: snowflake=1.7.2
[0m20:49:09.205841 [debug] [MainThread]: checksum: 67f0013ca5f0bd43af9a0873dd50792fde83ef69de63b71cacd0b4ac656c52e5, vars: {}, profile: , target: , version: 1.7.8
[0m20:49:09.310199 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m20:49:09.311512 [debug] [MainThread]: Partial parsing: added file: jaffle_shop://models/customers.sql
[0m20:49:09.519171 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '09b2a212-99d9-45f2-acf2-4a6a35471db9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1152e7090>]}
[0m20:49:09.536372 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '09b2a212-99d9-45f2-acf2-4a6a35471db9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1154ca510>]}
[0m20:49:09.537221 [info ] [MainThread]: Found 3 models, 4 tests, 0 sources, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m20:49:09.537855 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '09b2a212-99d9-45f2-acf2-4a6a35471db9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115304ed0>]}
[0m20:49:09.540575 [info ] [MainThread]: 
[0m20:49:09.541926 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m20:49:09.545170 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RAW'
[0m20:49:09.574633 [debug] [ThreadPool]: Using snowflake connection "list_RAW"
[0m20:49:09.575418 [debug] [ThreadPool]: On list_RAW: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_RAW"} */
show terse schemas in database RAW
    limit 10000
[0m20:49:09.576210 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:49:10.623904 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.0 seconds
[0m20:49:10.628658 [debug] [ThreadPool]: On list_RAW: Close
[0m20:49:10.756065 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RAW, now list_RAW_JAFFLE_SHOP)
[0m20:49:10.772580 [debug] [ThreadPool]: Using snowflake connection "list_RAW_JAFFLE_SHOP"
[0m20:49:10.773739 [debug] [ThreadPool]: On list_RAW_JAFFLE_SHOP: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_RAW_JAFFLE_SHOP"} */
show terse objects in RAW.JAFFLE_SHOP limit 10000
[0m20:49:10.774399 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:49:11.347224 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 1.0 seconds
[0m20:49:11.352071 [debug] [ThreadPool]: On list_RAW_JAFFLE_SHOP: Close
[0m20:49:11.551856 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '09b2a212-99d9-45f2-acf2-4a6a35471db9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1154cbe90>]}
[0m20:49:11.553851 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:49:11.554797 [info ] [MainThread]: 
[0m20:49:11.562786 [debug] [Thread-1 (]: Began running node model.jaffle_shop.customers
[0m20:49:11.565095 [debug] [Thread-2 (]: Began running node model.jaffle_shop.my_first_dbt_model
[0m20:49:11.566990 [info ] [Thread-1 (]: 1 of 3 START sql view model JAFFLE_SHOP.customers .............................. [RUN]
[0m20:49:11.568577 [info ] [Thread-2 (]: 2 of 3 START sql table model JAFFLE_SHOP.my_first_dbt_model .................... [RUN]
[0m20:49:11.571957 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_RAW_JAFFLE_SHOP, now model.jaffle_shop.customers)
[0m20:49:11.574573 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.jaffle_shop.my_first_dbt_model'
[0m20:49:11.576248 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.customers
[0m20:49:11.577466 [debug] [Thread-2 (]: Began compiling node model.jaffle_shop.my_first_dbt_model
[0m20:49:11.587217 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.customers"
[0m20:49:11.592201 [debug] [Thread-2 (]: Writing injected SQL for node "model.jaffle_shop.my_first_dbt_model"
[0m20:49:11.593728 [debug] [Thread-1 (]: Timing info for model.jaffle_shop.customers (compile): 20:49:11.577944 => 20:49:11.593267
[0m20:49:11.594392 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.customers
[0m20:49:11.595150 [debug] [Thread-2 (]: Timing info for model.jaffle_shop.my_first_dbt_model (compile): 20:49:11.587974 => 20:49:11.594768
[0m20:49:11.602879 [debug] [Thread-2 (]: Began executing node model.jaffle_shop.my_first_dbt_model
[0m20:49:11.689234 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.customers"
[0m20:49:11.692768 [debug] [Thread-2 (]: Writing runtime sql for node "model.jaffle_shop.my_first_dbt_model"
[0m20:49:11.696299 [debug] [Thread-1 (]: Using snowflake connection "model.jaffle_shop.customers"
[0m20:49:11.697103 [debug] [Thread-1 (]: On model.jaffle_shop.customers: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.customers"} */
create or replace   view RAW.JAFFLE_SHOP.customers
  
   as (
    with customers as (

    select
        id as customer_id,
        first_name,
        last_name

    from raw.jaffle_shop.customers

),

orders as (

    select
        id as order_id,
        user_id as customer_id,
        order_date,
        status

    from raw.jaffle_shop.orders

),

customer_orders as (

    select
        customer_id,

        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders

    from orders

    group by 1

),

final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce(customer_orders.number_of_orders, 0) as number_of_orders

    from customers

    left join customer_orders using (customer_id)

)

select * from final
  );
[0m20:49:11.698526 [debug] [Thread-2 (]: Using snowflake connection "model.jaffle_shop.my_first_dbt_model"
[0m20:49:11.699282 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:49:11.700093 [debug] [Thread-2 (]: On model.jaffle_shop.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.my_first_dbt_model"} */
create or replace transient table RAW.JAFFLE_SHOP.my_first_dbt_model
         as
        (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
        );
[0m20:49:11.702907 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m20:49:12.220650 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b2a48d-0000-15ba-000b-fc03000100da
[0m20:49:12.221814 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 002003 (42S02): SQL compilation error:
Object 'RAW.JAFFLE_SHOP.CUSTOMERS' does not exist or not authorized.
[0m20:49:12.223065 [debug] [Thread-1 (]: Timing info for model.jaffle_shop.customers (execute): 20:49:11.595501 => 20:49:12.222598
[0m20:49:12.223889 [debug] [Thread-1 (]: On model.jaffle_shop.customers: Close
[0m20:49:12.368749 [debug] [Thread-1 (]: Database Error in model customers (models/customers.sql)
  002003 (42S02): SQL compilation error:
  Object 'RAW.JAFFLE_SHOP.CUSTOMERS' does not exist or not authorized.
  compiled Code at target/run/jaffle_shop/models/customers.sql
[0m20:49:12.370162 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '09b2a212-99d9-45f2-acf2-4a6a35471db9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1152c5bd0>]}
[0m20:49:12.371626 [error] [Thread-1 (]: 1 of 3 ERROR creating sql view model JAFFLE_SHOP.customers ..................... [[31mERROR[0m in 0.80s]
[0m20:49:12.373115 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.customers
[0m20:49:12.717046 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m20:49:12.756572 [debug] [Thread-2 (]: Timing info for model.jaffle_shop.my_first_dbt_model (execute): 20:49:11.610492 => 20:49:12.756211
[0m20:49:12.757296 [debug] [Thread-2 (]: On model.jaffle_shop.my_first_dbt_model: Close
[0m20:49:12.884911 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '09b2a212-99d9-45f2-acf2-4a6a35471db9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1156479d0>]}
[0m20:49:12.887151 [info ] [Thread-2 (]: 2 of 3 OK created sql table model JAFFLE_SHOP.my_first_dbt_model ............... [[32mSUCCESS 1[0m in 1.31s]
[0m20:49:12.888913 [debug] [Thread-2 (]: Finished running node model.jaffle_shop.my_first_dbt_model
[0m20:49:12.890803 [debug] [Thread-4 (]: Began running node model.jaffle_shop.my_second_dbt_model
[0m20:49:12.892242 [info ] [Thread-4 (]: 3 of 3 START sql view model JAFFLE_SHOP.my_second_dbt_model .................... [RUN]
[0m20:49:12.894179 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.jaffle_shop.my_second_dbt_model'
[0m20:49:12.895079 [debug] [Thread-4 (]: Began compiling node model.jaffle_shop.my_second_dbt_model
[0m20:49:12.902410 [debug] [Thread-4 (]: Writing injected SQL for node "model.jaffle_shop.my_second_dbt_model"
[0m20:49:12.904572 [debug] [Thread-4 (]: Timing info for model.jaffle_shop.my_second_dbt_model (compile): 20:49:12.895585 => 20:49:12.904074
[0m20:49:12.905303 [debug] [Thread-4 (]: Began executing node model.jaffle_shop.my_second_dbt_model
[0m20:49:12.910890 [debug] [Thread-4 (]: Writing runtime sql for node "model.jaffle_shop.my_second_dbt_model"
[0m20:49:12.913678 [debug] [Thread-4 (]: Using snowflake connection "model.jaffle_shop.my_second_dbt_model"
[0m20:49:12.915131 [debug] [Thread-4 (]: On model.jaffle_shop.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.my_second_dbt_model"} */
create or replace   view RAW.JAFFLE_SHOP.my_second_dbt_model
  
   as (
    -- Use the `ref` function to select from other models

select *
from RAW.JAFFLE_SHOP.my_first_dbt_model
where id = 1
  );
[0m20:49:12.916124 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m20:49:13.399048 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m20:49:13.406200 [debug] [Thread-4 (]: Timing info for model.jaffle_shop.my_second_dbt_model (execute): 20:49:12.905677 => 20:49:13.405840
[0m20:49:13.406975 [debug] [Thread-4 (]: On model.jaffle_shop.my_second_dbt_model: Close
[0m20:49:13.530280 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '09b2a212-99d9-45f2-acf2-4a6a35471db9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115731710>]}
[0m20:49:13.531450 [info ] [Thread-4 (]: 3 of 3 OK created sql view model JAFFLE_SHOP.my_second_dbt_model ............... [[32mSUCCESS 1[0m in 0.64s]
[0m20:49:13.532435 [debug] [Thread-4 (]: Finished running node model.jaffle_shop.my_second_dbt_model
[0m20:49:13.535061 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:49:13.535599 [debug] [MainThread]: Connection 'model.jaffle_shop.customers' was properly closed.
[0m20:49:13.536341 [debug] [MainThread]: Connection 'model.jaffle_shop.my_first_dbt_model' was properly closed.
[0m20:49:13.537028 [debug] [MainThread]: Connection 'model.jaffle_shop.my_second_dbt_model' was properly closed.
[0m20:49:13.537754 [info ] [MainThread]: 
[0m20:49:13.538747 [info ] [MainThread]: Finished running 2 view models, 1 table model in 0 hours 0 minutes and 4.00 seconds (4.00s).
[0m20:49:13.540742 [debug] [MainThread]: Command end result
[0m20:49:13.554149 [info ] [MainThread]: 
[0m20:49:13.554944 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m20:49:13.555828 [info ] [MainThread]: 
[0m20:49:13.556497 [error] [MainThread]:   Database Error in model customers (models/customers.sql)
  002003 (42S02): SQL compilation error:
  Object 'RAW.JAFFLE_SHOP.CUSTOMERS' does not exist or not authorized.
  compiled Code at target/run/jaffle_shop/models/customers.sql
[0m20:49:13.557582 [info ] [MainThread]: 
[0m20:49:13.558294 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m20:49:13.560456 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 5.1882415, "process_user_time": 4.449322, "process_kernel_time": 0.456226, "process_mem_max_rss": "139403264", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m20:49:13.562190 [debug] [MainThread]: Command `dbt run` failed at 20:49:13.561849 after 5.19 seconds
[0m20:49:13.563012 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114552ad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114551fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11429b910>]}
[0m20:49:13.563965 [debug] [MainThread]: Flushing usage events
[0m21:00:31.090564 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ba4ad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108bbdc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f8c890>]}


============================== 21:00:31.096934 | f7922071-e835-40a8-8e1d-81109e9ec2da ==============================
[0m21:00:31.096934 [info ] [MainThread]: Running with dbt=1.7.8
[0m21:00:31.098001 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/ben/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/ben/jaffle_shop/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --select customers', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:00:31.678176 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f7922071-e835-40a8-8e1d-81109e9ec2da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109b31f90>]}
[0m21:00:31.951231 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f7922071-e835-40a8-8e1d-81109e9ec2da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1099c1f10>]}
[0m21:00:31.952508 [info ] [MainThread]: Registered adapter: snowflake=1.7.2
[0m21:00:31.987243 [debug] [MainThread]: checksum: 67f0013ca5f0bd43af9a0873dd50792fde83ef69de63b71cacd0b4ac656c52e5, vars: {}, profile: , target: , version: 1.7.8
[0m21:00:32.089229 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:00:32.089906 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:00:32.100980 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f7922071-e835-40a8-8e1d-81109e9ec2da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108bbf6d0>]}
[0m21:00:32.118402 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f7922071-e835-40a8-8e1d-81109e9ec2da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1091e3790>]}
[0m21:00:32.119235 [info ] [MainThread]: Found 3 models, 4 tests, 0 sources, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m21:00:32.119847 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f7922071-e835-40a8-8e1d-81109e9ec2da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1091f7950>]}
[0m21:00:32.122357 [info ] [MainThread]: 
[0m21:00:32.123582 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m21:00:32.125174 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RAW'
[0m21:00:32.151302 [debug] [ThreadPool]: Using snowflake connection "list_RAW"
[0m21:00:32.152045 [debug] [ThreadPool]: On list_RAW: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_RAW"} */
show terse schemas in database RAW
    limit 10000
[0m21:00:32.152614 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:00:33.106291 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.0 seconds
[0m21:00:33.109557 [debug] [ThreadPool]: On list_RAW: Close
[0m21:00:33.319701 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RAW, now list_RAW_JAFFLE_SHOP)
[0m21:00:33.334615 [debug] [ThreadPool]: Using snowflake connection "list_RAW_JAFFLE_SHOP"
[0m21:00:33.335305 [debug] [ThreadPool]: On list_RAW_JAFFLE_SHOP: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_RAW_JAFFLE_SHOP"} */
show terse objects in RAW.JAFFLE_SHOP limit 10000
[0m21:00:33.335832 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:00:33.886363 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 1.0 seconds
[0m21:00:33.890228 [debug] [ThreadPool]: On list_RAW_JAFFLE_SHOP: Close
[0m21:00:34.016832 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f7922071-e835-40a8-8e1d-81109e9ec2da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1091d5a10>]}
[0m21:00:34.019023 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:00:34.020225 [info ] [MainThread]: 
[0m21:00:34.027445 [debug] [Thread-1 (]: Began running node model.jaffle_shop.customers
[0m21:00:34.028612 [info ] [Thread-1 (]: 1 of 1 START sql view model JAFFLE_SHOP.customers .............................. [RUN]
[0m21:00:34.029928 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_RAW_JAFFLE_SHOP, now model.jaffle_shop.customers)
[0m21:00:34.030597 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.customers
[0m21:00:34.041555 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.customers"
[0m21:00:34.042955 [debug] [Thread-1 (]: Timing info for model.jaffle_shop.customers (compile): 21:00:34.030991 => 21:00:34.042511
[0m21:00:34.043616 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.customers
[0m21:00:34.098699 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.customers"
[0m21:00:34.102208 [debug] [Thread-1 (]: Using snowflake connection "model.jaffle_shop.customers"
[0m21:00:34.102993 [debug] [Thread-1 (]: On model.jaffle_shop.customers: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.customers"} */
create or replace   view RAW.JAFFLE_SHOP.customers
  
   as (
    with customers as (

    select
        id as customer_id,
        first_name,
        last_name

    from raw.jaffle_shop.customers

),

orders as (

    select
        id as order_id,
        user_id as customer_id,
        order_date,
        status

    from raw.jaffle_shop.orders

),

customer_orders as (

    select
        customer_id,

        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders

    from orders

    group by 1

),

final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce(customer_orders.number_of_orders, 0) as number_of_orders

    from customers

    left join customer_orders using (customer_id)

)

select * from final
  );
[0m21:00:34.103627 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:00:34.629672 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b2a498-0000-15c3-0000-000bfc03f13d
[0m21:00:34.630477 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 002003 (42S02): SQL compilation error:
Object 'RAW.JAFFLE_SHOP.CUSTOMERS' does not exist or not authorized.
[0m21:00:34.631475 [debug] [Thread-1 (]: Timing info for model.jaffle_shop.customers (execute): 21:00:34.044015 => 21:00:34.631094
[0m21:00:34.632162 [debug] [Thread-1 (]: On model.jaffle_shop.customers: Close
[0m21:00:34.823392 [debug] [Thread-1 (]: Database Error in model customers (models/customers.sql)
  002003 (42S02): SQL compilation error:
  Object 'RAW.JAFFLE_SHOP.CUSTOMERS' does not exist or not authorized.
  compiled Code at target/run/jaffle_shop/models/customers.sql
[0m21:00:34.824916 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f7922071-e835-40a8-8e1d-81109e9ec2da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108e67e10>]}
[0m21:00:34.826204 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model JAFFLE_SHOP.customers ..................... [[31mERROR[0m in 0.80s]
[0m21:00:34.828633 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.customers
[0m21:00:34.832886 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:00:34.833855 [debug] [MainThread]: Connection 'model.jaffle_shop.customers' was properly closed.
[0m21:00:34.834895 [info ] [MainThread]: 
[0m21:00:34.835822 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.71 seconds (2.71s).
[0m21:00:34.837341 [debug] [MainThread]: Command end result
[0m21:00:34.852797 [info ] [MainThread]: 
[0m21:00:34.854278 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m21:00:34.855112 [info ] [MainThread]: 
[0m21:00:34.855673 [error] [MainThread]:   Database Error in model customers (models/customers.sql)
  002003 (42S02): SQL compilation error:
  Object 'RAW.JAFFLE_SHOP.CUSTOMERS' does not exist or not authorized.
  compiled Code at target/run/jaffle_shop/models/customers.sql
[0m21:00:34.856198 [info ] [MainThread]: 
[0m21:00:34.856742 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m21:00:34.859704 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 3.871988, "process_user_time": 4.219594, "process_kernel_time": 0.547769, "process_mem_max_rss": "134803456", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m21:00:34.861579 [debug] [MainThread]: Command `dbt run` failed at 21:00:34.861120 after 3.87 seconds
[0m21:00:34.863094 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105039090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ba4ad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108e56bd0>]}
[0m21:00:34.864313 [debug] [MainThread]: Flushing usage events
[0m21:16:59.202168 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1100ff410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110112950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110111c90>]}


============================== 21:16:59.208101 | cb712a97-5de5-492a-8723-407df6018e16 ==============================
[0m21:16:59.208101 [info ] [MainThread]: Running with dbt=1.7.8
[0m21:16:59.209092 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/ben/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/Users/ben/jaffle_shop/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt seed', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:16:59.812392 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cb712a97-5de5-492a-8723-407df6018e16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110126310>]}
[0m21:16:59.967982 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cb712a97-5de5-492a-8723-407df6018e16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110fcb850>]}
[0m21:16:59.969229 [info ] [MainThread]: Registered adapter: snowflake=1.7.2
[0m21:16:59.997016 [debug] [MainThread]: checksum: 67f0013ca5f0bd43af9a0873dd50792fde83ef69de63b71cacd0b4ac656c52e5, vars: {}, profile: , target: , version: 1.7.8
[0m21:17:00.049684 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 3 files added, 0 files changed.
[0m21:17:00.050653 [debug] [MainThread]: Partial parsing: added file: jaffle_shop://seeds/raw_orders.csv
[0m21:17:00.051257 [debug] [MainThread]: Partial parsing: added file: jaffle_shop://seeds/raw_payments.csv
[0m21:17:00.051829 [debug] [MainThread]: Partial parsing: added file: jaffle_shop://seeds/raw_customers.csv
[0m21:17:00.253318 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cb712a97-5de5-492a-8723-407df6018e16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11115a6d0>]}
[0m21:17:00.272330 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cb712a97-5de5-492a-8723-407df6018e16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1112e4fd0>]}
[0m21:17:00.273126 [info ] [MainThread]: Found 3 models, 4 tests, 3 seeds, 0 sources, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m21:17:00.273754 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cb712a97-5de5-492a-8723-407df6018e16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11104a3d0>]}
[0m21:17:00.277261 [info ] [MainThread]: 
[0m21:17:00.278595 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m21:17:00.280293 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RAW'
[0m21:17:00.304785 [debug] [ThreadPool]: Using snowflake connection "list_RAW"
[0m21:17:00.305533 [debug] [ThreadPool]: On list_RAW: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_RAW"} */
show terse schemas in database RAW
    limit 10000
[0m21:17:00.306631 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:17:01.651934 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.0 seconds
[0m21:17:01.656441 [debug] [ThreadPool]: On list_RAW: Close
[0m21:17:01.804614 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RAW, now list_RAW_JAFFLE_SHOP)
[0m21:17:01.820318 [debug] [ThreadPool]: Using snowflake connection "list_RAW_JAFFLE_SHOP"
[0m21:17:01.821024 [debug] [ThreadPool]: On list_RAW_JAFFLE_SHOP: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_RAW_JAFFLE_SHOP"} */
show terse objects in RAW.JAFFLE_SHOP limit 10000
[0m21:17:01.821552 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:17:02.705863 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 1.0 seconds
[0m21:17:02.709703 [debug] [ThreadPool]: On list_RAW_JAFFLE_SHOP: Close
[0m21:17:02.847323 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cb712a97-5de5-492a-8723-407df6018e16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1103df0d0>]}
[0m21:17:02.850156 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:17:02.851603 [info ] [MainThread]: 
[0m21:17:02.856177 [debug] [Thread-1 (]: Began running node seed.jaffle_shop.raw_customers
[0m21:17:02.857283 [debug] [Thread-2 (]: Began running node seed.jaffle_shop.raw_orders
[0m21:17:02.858351 [info ] [Thread-1 (]: 1 of 3 START seed file JAFFLE_SHOP.raw_customers ............................... [RUN]
[0m21:17:02.859224 [debug] [Thread-3 (]: Began running node seed.jaffle_shop.raw_payments
[0m21:17:02.860073 [info ] [Thread-2 (]: 2 of 3 START seed file JAFFLE_SHOP.raw_orders .................................. [RUN]
[0m21:17:02.861413 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_RAW_JAFFLE_SHOP, now seed.jaffle_shop.raw_customers)
[0m21:17:02.863605 [info ] [Thread-3 (]: 3 of 3 START seed file JAFFLE_SHOP.raw_payments ................................ [RUN]
[0m21:17:02.867620 [debug] [Thread-2 (]: Acquiring new snowflake connection 'seed.jaffle_shop.raw_orders'
[0m21:17:02.868626 [debug] [Thread-1 (]: Began compiling node seed.jaffle_shop.raw_customers
[0m21:17:02.869985 [debug] [Thread-3 (]: Acquiring new snowflake connection 'seed.jaffle_shop.raw_payments'
[0m21:17:02.871079 [debug] [Thread-2 (]: Began compiling node seed.jaffle_shop.raw_orders
[0m21:17:02.872152 [debug] [Thread-1 (]: Timing info for seed.jaffle_shop.raw_customers (compile): 21:17:02.871741 => 21:17:02.871750
[0m21:17:02.872869 [debug] [Thread-3 (]: Began compiling node seed.jaffle_shop.raw_payments
[0m21:17:02.873681 [debug] [Thread-2 (]: Timing info for seed.jaffle_shop.raw_orders (compile): 21:17:02.873305 => 21:17:02.873310
[0m21:17:02.874441 [debug] [Thread-1 (]: Began executing node seed.jaffle_shop.raw_customers
[0m21:17:02.875470 [debug] [Thread-3 (]: Timing info for seed.jaffle_shop.raw_payments (compile): 21:17:02.875126 => 21:17:02.875131
[0m21:17:02.876077 [debug] [Thread-2 (]: Began executing node seed.jaffle_shop.raw_orders
[0m21:17:02.888375 [debug] [Thread-3 (]: Began executing node seed.jaffle_shop.raw_payments
[0m21:17:02.953663 [debug] [Thread-2 (]: Using snowflake connection "seed.jaffle_shop.raw_orders"
[0m21:17:02.960213 [debug] [Thread-3 (]: Using snowflake connection "seed.jaffle_shop.raw_payments"
[0m21:17:02.965235 [debug] [Thread-1 (]: Using snowflake connection "seed.jaffle_shop.raw_customers"
[0m21:17:02.965861 [debug] [Thread-2 (]: On seed.jaffle_shop.raw_orders: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_orders"} */
create table RAW.JAFFLE_SHOP.raw_orders (id integer,user_id integer,order_date date,status text)
[0m21:17:02.966531 [debug] [Thread-3 (]: On seed.jaffle_shop.raw_payments: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_payments"} */
create table RAW.JAFFLE_SHOP.raw_payments (id integer,order_id integer,payment_method text,amount integer)
[0m21:17:02.967138 [debug] [Thread-1 (]: On seed.jaffle_shop.raw_customers: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_customers"} */
create table RAW.JAFFLE_SHOP.raw_customers (id integer,first_name text,last_name text)
[0m21:17:02.967725 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m21:17:02.968531 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m21:17:02.969152 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:17:03.655527 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m21:17:03.659757 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m21:17:03.699318 [debug] [Thread-1 (]: Using snowflake connection "seed.jaffle_shop.raw_customers"
[0m21:17:03.694669 [debug] [Thread-3 (]: Using snowflake connection "seed.jaffle_shop.raw_payments"
[0m21:17:03.700626 [debug] [Thread-1 (]: On seed.jaffle_shop.raw_customers: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_customers"} */
BEGIN
[0m21:17:03.702269 [debug] [Thread-3 (]: On seed.jaffle_shop.raw_payments: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_payments"} */
BEGIN
[0m21:17:03.799757 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m21:17:03.807132 [debug] [Thread-3 (]: Using snowflake connection "seed.jaffle_shop.raw_payments"
[0m21:17:03.808138 [debug] [Thread-3 (]: On seed.jaffle_shop.raw_payments: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_payments"} */
insert into RAW.JAFFLE_SHOP.raw_payments (id, order_id, payment_method, amount) values
            (%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%...
[0m21:17:03.816119 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m21:17:03.819736 [debug] [Thread-1 (]: Using snowflake connection "seed.jaffle_shop.raw_customers"
[0m21:17:03.820719 [debug] [Thread-1 (]: On seed.jaffle_shop.raw_customers: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_customers"} */
insert into RAW.JAFFLE_SHOP.raw_customers (id, first_name, last_name) values
            (%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%...
[0m21:17:03.826388 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m21:17:03.831680 [debug] [Thread-2 (]: Using snowflake connection "seed.jaffle_shop.raw_orders"
[0m21:17:03.833614 [debug] [Thread-2 (]: On seed.jaffle_shop.raw_orders: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_orders"} */
BEGIN
[0m21:17:03.915336 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m21:17:03.919286 [debug] [Thread-2 (]: Using snowflake connection "seed.jaffle_shop.raw_orders"
[0m21:17:03.919913 [debug] [Thread-2 (]: On seed.jaffle_shop.raw_orders: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_orders"} */
insert into RAW.JAFFLE_SHOP.raw_orders (id, user_id, order_date, status) values
            (%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),...
[0m21:17:04.445902 [debug] [Thread-1 (]: SQL status: SUCCESS 100 in 1.0 seconds
[0m21:17:04.447597 [debug] [Thread-1 (]: Using snowflake connection "seed.jaffle_shop.raw_customers"
[0m21:17:04.448798 [debug] [Thread-1 (]: On seed.jaffle_shop.raw_customers: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_customers"} */
COMMIT
[0m21:17:04.685580 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m21:17:04.699230 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.jaffle_shop.raw_customers"
[0m21:17:04.701634 [debug] [Thread-3 (]: SQL status: SUCCESS 113 in 1.0 seconds
[0m21:17:04.703213 [debug] [Thread-3 (]: Using snowflake connection "seed.jaffle_shop.raw_payments"
[0m21:17:04.704029 [debug] [Thread-3 (]: On seed.jaffle_shop.raw_payments: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_payments"} */
COMMIT
[0m21:17:04.747407 [debug] [Thread-1 (]: Timing info for seed.jaffle_shop.raw_customers (execute): 21:17:02.876565 => 21:17:04.746988
[0m21:17:04.748164 [debug] [Thread-1 (]: On seed.jaffle_shop.raw_customers: Close
[0m21:17:04.848613 [debug] [Thread-2 (]: SQL status: SUCCESS 99 in 1.0 seconds
[0m21:17:04.849543 [debug] [Thread-2 (]: Using snowflake connection "seed.jaffle_shop.raw_orders"
[0m21:17:04.850584 [debug] [Thread-2 (]: On seed.jaffle_shop.raw_orders: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_orders"} */
COMMIT
[0m21:17:04.872695 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cb712a97-5de5-492a-8723-407df6018e16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11161a110>]}
[0m21:17:04.873676 [info ] [Thread-1 (]: 1 of 3 OK loaded seed file JAFFLE_SHOP.raw_customers ........................... [[32mINSERT 100[0m in 2.01s]
[0m21:17:04.874624 [debug] [Thread-1 (]: Finished running node seed.jaffle_shop.raw_customers
[0m21:17:04.880504 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m21:17:04.883466 [debug] [Thread-3 (]: Writing runtime SQL for node "seed.jaffle_shop.raw_payments"
[0m21:17:04.888483 [debug] [Thread-3 (]: Timing info for seed.jaffle_shop.raw_payments (execute): 21:17:02.944911 => 21:17:04.888123
[0m21:17:04.889752 [debug] [Thread-3 (]: On seed.jaffle_shop.raw_payments: Close
[0m21:17:05.083397 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m21:17:05.087963 [debug] [Thread-2 (]: Writing runtime SQL for node "seed.jaffle_shop.raw_orders"
[0m21:17:05.090586 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cb712a97-5de5-492a-8723-407df6018e16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111418750>]}
[0m21:17:05.092671 [info ] [Thread-3 (]: 3 of 3 OK loaded seed file JAFFLE_SHOP.raw_payments ............................ [[32mINSERT 113[0m in 2.22s]
[0m21:17:05.094994 [debug] [Thread-3 (]: Finished running node seed.jaffle_shop.raw_payments
[0m21:17:05.100600 [debug] [Thread-2 (]: Timing info for seed.jaffle_shop.raw_orders (execute): 21:17:02.917047 => 21:17:05.100003
[0m21:17:05.101703 [debug] [Thread-2 (]: On seed.jaffle_shop.raw_orders: Close
[0m21:17:05.275988 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cb712a97-5de5-492a-8723-407df6018e16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1114600d0>]}
[0m21:17:05.277457 [info ] [Thread-2 (]: 2 of 3 OK loaded seed file JAFFLE_SHOP.raw_orders .............................. [[32mINSERT 99[0m in 2.41s]
[0m21:17:05.279760 [debug] [Thread-2 (]: Finished running node seed.jaffle_shop.raw_orders
[0m21:17:05.283506 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:17:05.284279 [debug] [MainThread]: Connection 'seed.jaffle_shop.raw_customers' was properly closed.
[0m21:17:05.284926 [debug] [MainThread]: Connection 'seed.jaffle_shop.raw_orders' was properly closed.
[0m21:17:05.285562 [debug] [MainThread]: Connection 'seed.jaffle_shop.raw_payments' was properly closed.
[0m21:17:05.286388 [info ] [MainThread]: 
[0m21:17:05.287383 [info ] [MainThread]: Finished running 3 seeds in 0 hours 0 minutes and 5.01 seconds (5.01s).
[0m21:17:05.289104 [debug] [MainThread]: Command end result
[0m21:17:05.304841 [info ] [MainThread]: 
[0m21:17:05.305540 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:17:05.306105 [info ] [MainThread]: 
[0m21:17:05.306681 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m21:17:05.308602 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": true, "command_wall_clock_time": 6.1948833, "process_user_time": 4.685903, "process_kernel_time": 0.483817, "process_mem_max_rss": "139055104", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m21:17:05.309875 [debug] [MainThread]: Command `dbt seed` succeeded at 21:17:05.309629 after 6.20 seconds
[0m21:17:05.310645 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1107368d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fccc510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1104cf890>]}
[0m21:17:05.311631 [debug] [MainThread]: Flushing usage events
[0m21:20:14.224056 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111a34a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111b1fd50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111783890>]}


============================== 21:20:14.231387 | 11696132-9b67-49c1-8be6-83532ee72907 ==============================
[0m21:20:14.231387 [info ] [MainThread]: Running with dbt=1.7.8
[0m21:20:14.233013 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/Users/ben/.dbt', 'log_path': '/Users/ben/jaffle_shop/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m21:20:14.985756 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '11696132-9b67-49c1-8be6-83532ee72907', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11175cb90>]}
[0m21:20:15.229978 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '11696132-9b67-49c1-8be6-83532ee72907', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11267f0d0>]}
[0m21:20:15.231193 [info ] [MainThread]: Registered adapter: snowflake=1.7.2
[0m21:20:15.263945 [debug] [MainThread]: checksum: 67f0013ca5f0bd43af9a0873dd50792fde83ef69de63b71cacd0b4ac656c52e5, vars: {}, profile: , target: , version: 1.7.8
[0m21:20:15.327944 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:20:15.329273 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:20:15.340932 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '11696132-9b67-49c1-8be6-83532ee72907', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112902010>]}
[0m21:20:15.360320 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '11696132-9b67-49c1-8be6-83532ee72907', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112760910>]}
[0m21:20:15.361151 [info ] [MainThread]: Found 3 models, 4 tests, 3 seeds, 0 sources, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m21:20:15.361919 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '11696132-9b67-49c1-8be6-83532ee72907', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1126a6f50>]}
[0m21:20:15.364753 [info ] [MainThread]: 
[0m21:20:15.366082 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m21:20:15.368438 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RAW'
[0m21:20:15.397784 [debug] [ThreadPool]: Using snowflake connection "list_RAW"
[0m21:20:15.398549 [debug] [ThreadPool]: On list_RAW: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_RAW"} */
show terse schemas in database RAW
    limit 10000
[0m21:20:15.399315 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:20:16.390032 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.0 seconds
[0m21:20:16.394297 [debug] [ThreadPool]: On list_RAW: Close
[0m21:20:16.780034 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RAW, now list_RAW_JAFFLE_SHOP)
[0m21:20:16.809695 [debug] [ThreadPool]: Using snowflake connection "list_RAW_JAFFLE_SHOP"
[0m21:20:16.810355 [debug] [ThreadPool]: On list_RAW_JAFFLE_SHOP: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_RAW_JAFFLE_SHOP"} */
show terse objects in RAW.JAFFLE_SHOP limit 10000
[0m21:20:16.810867 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:20:17.433019 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m21:20:17.443311 [debug] [ThreadPool]: On list_RAW_JAFFLE_SHOP: Close
[0m21:20:17.731447 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '11696132-9b67-49c1-8be6-83532ee72907', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1124abad0>]}
[0m21:20:17.733995 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:20:17.735427 [info ] [MainThread]: 
[0m21:20:17.741402 [debug] [Thread-1 (]: Began running node model.jaffle_shop.customers
[0m21:20:17.742230 [debug] [Thread-2 (]: Began running node model.jaffle_shop.my_first_dbt_model
[0m21:20:17.743982 [info ] [Thread-1 (]: 1 of 3 START sql view model JAFFLE_SHOP.customers .............................. [RUN]
[0m21:20:17.744916 [info ] [Thread-2 (]: 2 of 3 START sql table model JAFFLE_SHOP.my_first_dbt_model .................... [RUN]
[0m21:20:17.746581 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_RAW_JAFFLE_SHOP, now model.jaffle_shop.customers)
[0m21:20:17.749137 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.jaffle_shop.my_first_dbt_model'
[0m21:20:17.750645 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.customers
[0m21:20:17.751665 [debug] [Thread-2 (]: Began compiling node model.jaffle_shop.my_first_dbt_model
[0m21:20:17.762564 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.customers"
[0m21:20:17.769281 [debug] [Thread-2 (]: Writing injected SQL for node "model.jaffle_shop.my_first_dbt_model"
[0m21:20:17.770705 [debug] [Thread-1 (]: Timing info for model.jaffle_shop.customers (compile): 21:20:17.752099 => 21:20:17.770210
[0m21:20:17.771504 [debug] [Thread-2 (]: Timing info for model.jaffle_shop.my_first_dbt_model (compile): 21:20:17.763117 => 21:20:17.771121
[0m21:20:17.772137 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.customers
[0m21:20:17.773244 [debug] [Thread-2 (]: Began executing node model.jaffle_shop.my_first_dbt_model
[0m21:20:17.855811 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.customers"
[0m21:20:17.862474 [debug] [Thread-2 (]: Writing runtime sql for node "model.jaffle_shop.my_first_dbt_model"
[0m21:20:17.866594 [debug] [Thread-1 (]: Using snowflake connection "model.jaffle_shop.customers"
[0m21:20:17.867465 [debug] [Thread-1 (]: On model.jaffle_shop.customers: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.customers"} */
create or replace   view RAW.JAFFLE_SHOP.customers
  
   as (
    with customers as (

    select
        id as customer_id,
        first_name,
        last_name

    from raw.jaffle_shop.customers

),

orders as (

    select
        id as order_id,
        user_id as customer_id,
        order_date,
        status

    from raw.jaffle_shop.orders

),

customer_orders as (

    select
        customer_id,

        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders

    from orders

    group by 1

),

final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce(customer_orders.number_of_orders, 0) as number_of_orders

    from customers

    left join customer_orders using (customer_id)

)

select * from final
  );
[0m21:20:17.868131 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:20:17.870834 [debug] [Thread-2 (]: Using snowflake connection "model.jaffle_shop.my_first_dbt_model"
[0m21:20:17.871712 [debug] [Thread-2 (]: On model.jaffle_shop.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.my_first_dbt_model"} */
create or replace transient table RAW.JAFFLE_SHOP.my_first_dbt_model
         as
        (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
        );
[0m21:20:17.872969 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m21:20:18.406304 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b2a4ac-0000-15c3-0000-000bfc03f1fd
[0m21:20:18.408244 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 002003 (42S02): SQL compilation error:
Object 'RAW.JAFFLE_SHOP.CUSTOMERS' does not exist or not authorized.
[0m21:20:18.409865 [debug] [Thread-1 (]: Timing info for model.jaffle_shop.customers (execute): 21:20:17.773918 => 21:20:18.409394
[0m21:20:18.410616 [debug] [Thread-1 (]: On model.jaffle_shop.customers: Close
[0m21:20:18.535833 [debug] [Thread-1 (]: Database Error in model customers (models/customers.sql)
  002003 (42S02): SQL compilation error:
  Object 'RAW.JAFFLE_SHOP.CUSTOMERS' does not exist or not authorized.
  compiled Code at target/run/jaffle_shop/models/customers.sql
[0m21:20:18.536991 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '11696132-9b67-49c1-8be6-83532ee72907', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112855390>]}
[0m21:20:18.538069 [error] [Thread-1 (]: 1 of 3 ERROR creating sql view model JAFFLE_SHOP.customers ..................... [[31mERROR[0m in 0.79s]
[0m21:20:18.539164 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.customers
[0m21:20:18.866434 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m21:20:18.907004 [debug] [Thread-2 (]: Timing info for model.jaffle_shop.my_first_dbt_model (execute): 21:20:17.800415 => 21:20:18.906649
[0m21:20:18.907712 [debug] [Thread-2 (]: On model.jaffle_shop.my_first_dbt_model: Close
[0m21:20:19.024219 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '11696132-9b67-49c1-8be6-83532ee72907', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1126eee90>]}
[0m21:20:19.025515 [info ] [Thread-2 (]: 2 of 3 OK created sql table model JAFFLE_SHOP.my_first_dbt_model ............... [[32mSUCCESS 1[0m in 1.28s]
[0m21:20:19.026816 [debug] [Thread-2 (]: Finished running node model.jaffle_shop.my_first_dbt_model
[0m21:20:19.028239 [debug] [Thread-4 (]: Began running node model.jaffle_shop.my_second_dbt_model
[0m21:20:19.029186 [info ] [Thread-4 (]: 3 of 3 START sql view model JAFFLE_SHOP.my_second_dbt_model .................... [RUN]
[0m21:20:19.030686 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.jaffle_shop.my_second_dbt_model'
[0m21:20:19.031394 [debug] [Thread-4 (]: Began compiling node model.jaffle_shop.my_second_dbt_model
[0m21:20:19.038315 [debug] [Thread-4 (]: Writing injected SQL for node "model.jaffle_shop.my_second_dbt_model"
[0m21:20:19.040221 [debug] [Thread-4 (]: Timing info for model.jaffle_shop.my_second_dbt_model (compile): 21:20:19.032343 => 21:20:19.039657
[0m21:20:19.041165 [debug] [Thread-4 (]: Began executing node model.jaffle_shop.my_second_dbt_model
[0m21:20:19.049747 [debug] [Thread-4 (]: Writing runtime sql for node "model.jaffle_shop.my_second_dbt_model"
[0m21:20:19.051651 [debug] [Thread-4 (]: Using snowflake connection "model.jaffle_shop.my_second_dbt_model"
[0m21:20:19.052522 [debug] [Thread-4 (]: On model.jaffle_shop.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.my_second_dbt_model"} */
create or replace   view RAW.JAFFLE_SHOP.my_second_dbt_model
  
   as (
    -- Use the `ref` function to select from other models

select *
from RAW.JAFFLE_SHOP.my_first_dbt_model
where id = 1
  );
[0m21:20:19.053173 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m21:20:19.789824 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m21:20:19.795491 [debug] [Thread-4 (]: Timing info for model.jaffle_shop.my_second_dbt_model (execute): 21:20:19.041562 => 21:20:19.795030
[0m21:20:19.796388 [debug] [Thread-4 (]: On model.jaffle_shop.my_second_dbt_model: Close
[0m21:20:19.923838 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '11696132-9b67-49c1-8be6-83532ee72907', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112b58450>]}
[0m21:20:19.925335 [info ] [Thread-4 (]: 3 of 3 OK created sql view model JAFFLE_SHOP.my_second_dbt_model ............... [[32mSUCCESS 1[0m in 0.89s]
[0m21:20:19.927027 [debug] [Thread-4 (]: Finished running node model.jaffle_shop.my_second_dbt_model
[0m21:20:19.930532 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:20:19.932149 [debug] [MainThread]: Connection 'model.jaffle_shop.customers' was properly closed.
[0m21:20:19.933335 [debug] [MainThread]: Connection 'model.jaffle_shop.my_first_dbt_model' was properly closed.
[0m21:20:19.934401 [debug] [MainThread]: Connection 'model.jaffle_shop.my_second_dbt_model' was properly closed.
[0m21:20:19.935207 [info ] [MainThread]: 
[0m21:20:19.935907 [info ] [MainThread]: Finished running 2 view models, 1 table model in 0 hours 0 minutes and 4.57 seconds (4.57s).
[0m21:20:19.937985 [debug] [MainThread]: Command end result
[0m21:20:19.952767 [info ] [MainThread]: 
[0m21:20:19.953723 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m21:20:19.954410 [info ] [MainThread]: 
[0m21:20:19.955121 [error] [MainThread]:   Database Error in model customers (models/customers.sql)
  002003 (42S02): SQL compilation error:
  Object 'RAW.JAFFLE_SHOP.CUSTOMERS' does not exist or not authorized.
  compiled Code at target/run/jaffle_shop/models/customers.sql
[0m21:20:19.956283 [info ] [MainThread]: 
[0m21:20:19.956933 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m21:20:19.959046 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 5.8259773, "process_user_time": 4.657328, "process_kernel_time": 0.53203, "process_mem_max_rss": "136564736", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m21:20:19.960162 [debug] [MainThread]: Command `dbt run` failed at 21:20:19.959914 after 5.83 seconds
[0m21:20:19.961188 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111b3b950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111a60d50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111ad2450>]}
[0m21:20:19.961898 [debug] [MainThread]: Flushing usage events
[0m21:23:28.132852 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112645910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1122dfdd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112652c90>]}


============================== 21:23:28.138896 | 03ea2dce-2dba-4aa7-a31e-4f0b4d798dc5 ==============================
[0m21:23:28.138896 [info ] [MainThread]: Running with dbt=1.7.8
[0m21:23:28.141004 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/ben/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/ben/jaffle_shop/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m21:23:28.728732 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '03ea2dce-2dba-4aa7-a31e-4f0b4d798dc5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112f55390>]}
[0m21:23:28.905014 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '03ea2dce-2dba-4aa7-a31e-4f0b4d798dc5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112d78cd0>]}
[0m21:23:28.907558 [info ] [MainThread]: Registered adapter: snowflake=1.7.2
[0m21:23:28.935581 [debug] [MainThread]: checksum: 67f0013ca5f0bd43af9a0873dd50792fde83ef69de63b71cacd0b4ac656c52e5, vars: {}, profile: , target: , version: 1.7.8
[0m21:23:28.997537 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m21:23:28.998760 [debug] [MainThread]: Partial parsing: updated file: jaffle_shop://models/customers.sql
[0m21:23:29.259461 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '03ea2dce-2dba-4aa7-a31e-4f0b4d798dc5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1126a3dd0>]}
[0m21:23:29.277084 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '03ea2dce-2dba-4aa7-a31e-4f0b4d798dc5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1131aa650>]}
[0m21:23:29.278758 [info ] [MainThread]: Found 3 models, 4 tests, 3 seeds, 0 sources, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m21:23:29.279687 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '03ea2dce-2dba-4aa7-a31e-4f0b4d798dc5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1130d7690>]}
[0m21:23:29.283079 [info ] [MainThread]: 
[0m21:23:29.285253 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m21:23:29.287188 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RAW'
[0m21:23:29.311631 [debug] [ThreadPool]: Using snowflake connection "list_RAW"
[0m21:23:29.312444 [debug] [ThreadPool]: On list_RAW: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_RAW"} */
show terse schemas in database RAW
    limit 10000
[0m21:23:29.313397 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:23:30.295023 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.0 seconds
[0m21:23:30.299849 [debug] [ThreadPool]: On list_RAW: Close
[0m21:23:30.430717 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RAW, now list_RAW_JAFFLE_SHOP)
[0m21:23:30.443478 [debug] [ThreadPool]: Using snowflake connection "list_RAW_JAFFLE_SHOP"
[0m21:23:30.444277 [debug] [ThreadPool]: On list_RAW_JAFFLE_SHOP: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_RAW_JAFFLE_SHOP"} */
show terse objects in RAW.JAFFLE_SHOP limit 10000
[0m21:23:30.444878 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:23:30.869984 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.0 seconds
[0m21:23:30.873935 [debug] [ThreadPool]: On list_RAW_JAFFLE_SHOP: Close
[0m21:23:31.015468 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '03ea2dce-2dba-4aa7-a31e-4f0b4d798dc5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11309e450>]}
[0m21:23:31.017222 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:23:31.017923 [info ] [MainThread]: 
[0m21:23:31.022528 [debug] [Thread-1 (]: Began running node model.jaffle_shop.customers
[0m21:23:31.023437 [debug] [Thread-2 (]: Began running node model.jaffle_shop.my_first_dbt_model
[0m21:23:31.024790 [info ] [Thread-1 (]: 1 of 3 START sql view model JAFFLE_SHOP.customers .............................. [RUN]
[0m21:23:31.026290 [info ] [Thread-2 (]: 2 of 3 START sql table model JAFFLE_SHOP.my_first_dbt_model .................... [RUN]
[0m21:23:31.027916 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_RAW_JAFFLE_SHOP, now model.jaffle_shop.customers)
[0m21:23:31.029376 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.jaffle_shop.my_first_dbt_model'
[0m21:23:31.030096 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.customers
[0m21:23:31.031194 [debug] [Thread-2 (]: Began compiling node model.jaffle_shop.my_first_dbt_model
[0m21:23:31.044130 [debug] [Thread-2 (]: Writing injected SQL for node "model.jaffle_shop.my_first_dbt_model"
[0m21:23:31.048554 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.customers"
[0m21:23:31.051286 [debug] [Thread-2 (]: Timing info for model.jaffle_shop.my_first_dbt_model (compile): 21:23:31.039453 => 21:23:31.050470
[0m21:23:31.052325 [debug] [Thread-2 (]: Began executing node model.jaffle_shop.my_first_dbt_model
[0m21:23:31.053651 [debug] [Thread-1 (]: Timing info for model.jaffle_shop.customers (compile): 21:23:31.032858 => 21:23:31.052946
[0m21:23:31.076774 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.customers
[0m21:23:31.122582 [debug] [Thread-2 (]: Writing runtime sql for node "model.jaffle_shop.my_first_dbt_model"
[0m21:23:31.141467 [debug] [Thread-2 (]: Using snowflake connection "model.jaffle_shop.my_first_dbt_model"
[0m21:23:31.146091 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.customers"
[0m21:23:31.146898 [debug] [Thread-2 (]: On model.jaffle_shop.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.my_first_dbt_model"} */
create or replace transient table RAW.JAFFLE_SHOP.my_first_dbt_model
         as
        (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
        );
[0m21:23:31.147887 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m21:23:31.151567 [debug] [Thread-1 (]: Using snowflake connection "model.jaffle_shop.customers"
[0m21:23:31.152400 [debug] [Thread-1 (]: On model.jaffle_shop.customers: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.customers"} */
create or replace   view RAW.JAFFLE_SHOP.customers
  
   as (
    with customers as (

    select
        id as customer_id,
        first_name,
        last_name

    from raw.jaffle_shop.raw_customers

),

orders as (

    select
        id as order_id,
        user_id as customer_id,
        order_date,
        status

    from raw.jaffle_shop.raw_orders

),

customer_orders as (

    select
        customer_id,

        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders

    from orders

    group by 1

),

final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce(customer_orders.number_of_orders, 0) as number_of_orders

    from customers

    left join customer_orders using (customer_id)

)

select * from final
  );
[0m21:23:31.153097 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:23:31.632403 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m21:23:31.675544 [debug] [Thread-1 (]: Timing info for model.jaffle_shop.customers (execute): 21:23:31.090443 => 21:23:31.675038
[0m21:23:31.676340 [debug] [Thread-1 (]: On model.jaffle_shop.customers: Close
[0m21:23:31.793508 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '03ea2dce-2dba-4aa7-a31e-4f0b4d798dc5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113282f50>]}
[0m21:23:31.794646 [info ] [Thread-1 (]: 1 of 3 OK created sql view model JAFFLE_SHOP.customers ......................... [[32mSUCCESS 1[0m in 0.77s]
[0m21:23:31.795653 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.customers
[0m21:23:31.852198 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m21:23:31.863780 [debug] [Thread-2 (]: Timing info for model.jaffle_shop.my_first_dbt_model (execute): 21:23:31.054311 => 21:23:31.863137
[0m21:23:31.864929 [debug] [Thread-2 (]: On model.jaffle_shop.my_first_dbt_model: Close
[0m21:23:32.000500 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '03ea2dce-2dba-4aa7-a31e-4f0b4d798dc5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112749390>]}
[0m21:23:32.001578 [info ] [Thread-2 (]: 2 of 3 OK created sql table model JAFFLE_SHOP.my_first_dbt_model ............... [[32mSUCCESS 1[0m in 0.97s]
[0m21:23:32.002864 [debug] [Thread-2 (]: Finished running node model.jaffle_shop.my_first_dbt_model
[0m21:23:32.003967 [debug] [Thread-4 (]: Began running node model.jaffle_shop.my_second_dbt_model
[0m21:23:32.004802 [info ] [Thread-4 (]: 3 of 3 START sql view model JAFFLE_SHOP.my_second_dbt_model .................... [RUN]
[0m21:23:32.006037 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.jaffle_shop.my_second_dbt_model'
[0m21:23:32.006633 [debug] [Thread-4 (]: Began compiling node model.jaffle_shop.my_second_dbt_model
[0m21:23:32.011172 [debug] [Thread-4 (]: Writing injected SQL for node "model.jaffle_shop.my_second_dbt_model"
[0m21:23:32.014019 [debug] [Thread-4 (]: Timing info for model.jaffle_shop.my_second_dbt_model (compile): 21:23:32.007211 => 21:23:32.013042
[0m21:23:32.014888 [debug] [Thread-4 (]: Began executing node model.jaffle_shop.my_second_dbt_model
[0m21:23:32.023163 [debug] [Thread-4 (]: Writing runtime sql for node "model.jaffle_shop.my_second_dbt_model"
[0m21:23:32.024876 [debug] [Thread-4 (]: Using snowflake connection "model.jaffle_shop.my_second_dbt_model"
[0m21:23:32.025671 [debug] [Thread-4 (]: On model.jaffle_shop.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.my_second_dbt_model"} */
create or replace   view RAW.JAFFLE_SHOP.my_second_dbt_model
  
   as (
    -- Use the `ref` function to select from other models

select *
from RAW.JAFFLE_SHOP.my_first_dbt_model
where id = 1
  );
[0m21:23:32.026343 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m21:23:32.437287 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m21:23:32.442058 [debug] [Thread-4 (]: Timing info for model.jaffle_shop.my_second_dbt_model (execute): 21:23:32.015438 => 21:23:32.441673
[0m21:23:32.442803 [debug] [Thread-4 (]: On model.jaffle_shop.my_second_dbt_model: Close
[0m21:23:32.561632 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '03ea2dce-2dba-4aa7-a31e-4f0b4d798dc5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112f69ad0>]}
[0m21:23:32.562967 [info ] [Thread-4 (]: 3 of 3 OK created sql view model JAFFLE_SHOP.my_second_dbt_model ............... [[32mSUCCESS 1[0m in 0.56s]
[0m21:23:32.564272 [debug] [Thread-4 (]: Finished running node model.jaffle_shop.my_second_dbt_model
[0m21:23:32.568068 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:23:32.568866 [debug] [MainThread]: Connection 'model.jaffle_shop.customers' was properly closed.
[0m21:23:32.569657 [debug] [MainThread]: Connection 'model.jaffle_shop.my_first_dbt_model' was properly closed.
[0m21:23:32.571203 [debug] [MainThread]: Connection 'model.jaffle_shop.my_second_dbt_model' was properly closed.
[0m21:23:32.572015 [info ] [MainThread]: 
[0m21:23:32.572783 [info ] [MainThread]: Finished running 2 view models, 1 table model in 0 hours 0 minutes and 3.29 seconds (3.29s).
[0m21:23:32.574458 [debug] [MainThread]: Command end result
[0m21:23:32.588708 [info ] [MainThread]: 
[0m21:23:32.589418 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:23:32.590006 [info ] [MainThread]: 
[0m21:23:32.590589 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m21:23:32.593206 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 4.5568004, "process_user_time": 4.792903, "process_kernel_time": 0.495387, "process_mem_max_rss": "137662464", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m21:23:32.594629 [debug] [MainThread]: Command `dbt run` succeeded at 21:23:32.594351 after 4.56 seconds
[0m21:23:32.595452 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112378f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112037150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e32fd10>]}
[0m21:23:32.596669 [debug] [MainThread]: Flushing usage events
[0m21:33:23.908659 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110897a50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110274d50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1102a9350>]}


============================== 21:33:23.914956 | 1312fc2d-2a3a-4b3b-8549-9dcf427e3f05 ==============================
[0m21:33:23.914956 [info ] [MainThread]: Running with dbt=1.7.8
[0m21:33:23.916235 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/Users/ben/.dbt', 'log_path': '/Users/ben/jaffle_shop/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m21:33:24.577531 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1312fc2d-2a3a-4b3b-8549-9dcf427e3f05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1108ef5d0>]}
[0m21:33:24.713420 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1312fc2d-2a3a-4b3b-8549-9dcf427e3f05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111078f10>]}
[0m21:33:24.714680 [info ] [MainThread]: Registered adapter: snowflake=1.7.2
[0m21:33:24.742432 [debug] [MainThread]: checksum: 67f0013ca5f0bd43af9a0873dd50792fde83ef69de63b71cacd0b4ac656c52e5, vars: {}, profile: , target: , version: 1.7.8
[0m21:33:24.762565 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m21:33:24.763439 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '1312fc2d-2a3a-4b3b-8549-9dcf427e3f05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111298a10>]}
[0m21:33:26.680582 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.example
[0m21:33:26.688844 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1312fc2d-2a3a-4b3b-8549-9dcf427e3f05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111404450>]}
[0m21:33:26.707510 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1312fc2d-2a3a-4b3b-8549-9dcf427e3f05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1117fad50>]}
[0m21:33:26.708293 [info ] [MainThread]: Found 3 models, 3 seeds, 4 tests, 0 sources, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m21:33:26.708890 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1312fc2d-2a3a-4b3b-8549-9dcf427e3f05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1116cf4d0>]}
[0m21:33:26.711676 [info ] [MainThread]: 
[0m21:33:26.713928 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m21:33:26.716541 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RAW'
[0m21:33:26.739609 [debug] [ThreadPool]: Using snowflake connection "list_RAW"
[0m21:33:26.740773 [debug] [ThreadPool]: On list_RAW: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_RAW"} */
show terse schemas in database RAW
    limit 10000
[0m21:33:26.741420 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:33:27.894332 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.0 seconds
[0m21:33:27.897467 [debug] [ThreadPool]: On list_RAW: Close
[0m21:33:28.018587 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RAW, now list_RAW_JAFFLE_SHOP)
[0m21:33:28.032861 [debug] [ThreadPool]: Using snowflake connection "list_RAW_JAFFLE_SHOP"
[0m21:33:28.033669 [debug] [ThreadPool]: On list_RAW_JAFFLE_SHOP: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_RAW_JAFFLE_SHOP"} */
show terse objects in RAW.JAFFLE_SHOP limit 10000
[0m21:33:28.034343 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:33:28.491027 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.0 seconds
[0m21:33:28.494284 [debug] [ThreadPool]: On list_RAW_JAFFLE_SHOP: Close
[0m21:33:28.634840 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1312fc2d-2a3a-4b3b-8549-9dcf427e3f05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111727950>]}
[0m21:33:28.636319 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:33:28.636976 [info ] [MainThread]: 
[0m21:33:28.640518 [debug] [Thread-1 (]: Began running node model.jaffle_shop.customers
[0m21:33:28.641361 [debug] [Thread-2 (]: Began running node model.jaffle_shop.my_first_dbt_model
[0m21:33:28.642200 [info ] [Thread-1 (]: 1 of 3 START sql table model JAFFLE_SHOP.customers ............................. [RUN]
[0m21:33:28.643701 [info ] [Thread-2 (]: 2 of 3 START sql table model JAFFLE_SHOP.my_first_dbt_model .................... [RUN]
[0m21:33:28.645872 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_RAW_JAFFLE_SHOP, now model.jaffle_shop.customers)
[0m21:33:28.647742 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.jaffle_shop.my_first_dbt_model'
[0m21:33:28.648690 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.customers
[0m21:33:28.650159 [debug] [Thread-2 (]: Began compiling node model.jaffle_shop.my_first_dbt_model
[0m21:33:28.662413 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.customers"
[0m21:33:28.666420 [debug] [Thread-2 (]: Writing injected SQL for node "model.jaffle_shop.my_first_dbt_model"
[0m21:33:28.668890 [debug] [Thread-1 (]: Timing info for model.jaffle_shop.customers (compile): 21:33:28.651150 => 21:33:28.667950
[0m21:33:28.670227 [debug] [Thread-2 (]: Timing info for model.jaffle_shop.my_first_dbt_model (compile): 21:33:28.662835 => 21:33:28.669474
[0m21:33:28.670989 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.customers
[0m21:33:28.671602 [debug] [Thread-2 (]: Began executing node model.jaffle_shop.my_first_dbt_model
[0m21:33:28.716523 [debug] [Thread-1 (]: Dropping relation "RAW"."JAFFLE_SHOP"."CUSTOMERS" because it is of type view
[0m21:33:28.733693 [debug] [Thread-2 (]: Writing runtime sql for node "model.jaffle_shop.my_first_dbt_model"
[0m21:33:28.747745 [debug] [Thread-1 (]: Applying DROP to: "RAW"."JAFFLE_SHOP"."CUSTOMERS"
[0m21:33:28.760119 [debug] [Thread-1 (]: Using snowflake connection "model.jaffle_shop.customers"
[0m21:33:28.761874 [debug] [Thread-2 (]: Using snowflake connection "model.jaffle_shop.my_first_dbt_model"
[0m21:33:28.762597 [debug] [Thread-1 (]: On model.jaffle_shop.customers: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.customers"} */
drop view if exists "RAW"."JAFFLE_SHOP"."CUSTOMERS" cascade
[0m21:33:28.763358 [debug] [Thread-2 (]: On model.jaffle_shop.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.my_first_dbt_model"} */
create or replace transient table RAW.JAFFLE_SHOP.my_first_dbt_model
         as
        (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
        );
[0m21:33:28.764084 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:33:28.764661 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m21:33:29.165196 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m21:33:29.168807 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.customers"
[0m21:33:29.172478 [debug] [Thread-1 (]: Using snowflake connection "model.jaffle_shop.customers"
[0m21:33:29.173351 [debug] [Thread-1 (]: On model.jaffle_shop.customers: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.customers"} */
create or replace transient table RAW.JAFFLE_SHOP.customers
         as
        (with customers as (

    select
        id as customer_id,
        first_name,
        last_name

    from raw.jaffle_shop.raw_customers

),

orders as (

    select
        id as order_id,
        user_id as customer_id,
        order_date,
        status

    from raw.jaffle_shop.raw_orders

),

customer_orders as (

    select
        customer_id,

        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders

    from orders

    group by 1

),

final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce(customer_orders.number_of_orders, 0) as number_of_orders

    from customers

    left join customer_orders using (customer_id)

)

select * from final
        );
[0m21:33:29.405549 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m21:33:29.454885 [debug] [Thread-2 (]: Timing info for model.jaffle_shop.my_first_dbt_model (execute): 21:33:28.695003 => 21:33:29.454282
[0m21:33:29.456115 [debug] [Thread-2 (]: On model.jaffle_shop.my_first_dbt_model: Close
[0m21:33:29.576520 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1312fc2d-2a3a-4b3b-8549-9dcf427e3f05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1118e4390>]}
[0m21:33:29.577847 [info ] [Thread-2 (]: 2 of 3 OK created sql table model JAFFLE_SHOP.my_first_dbt_model ............... [[32mSUCCESS 1[0m in 0.93s]
[0m21:33:29.579067 [debug] [Thread-2 (]: Finished running node model.jaffle_shop.my_first_dbt_model
[0m21:33:29.580408 [debug] [Thread-4 (]: Began running node model.jaffle_shop.my_second_dbt_model
[0m21:33:29.582170 [info ] [Thread-4 (]: 3 of 3 START sql table model JAFFLE_SHOP.my_second_dbt_model ................... [RUN]
[0m21:33:29.583965 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.jaffle_shop.my_second_dbt_model'
[0m21:33:29.585187 [debug] [Thread-4 (]: Began compiling node model.jaffle_shop.my_second_dbt_model
[0m21:33:29.590500 [debug] [Thread-4 (]: Writing injected SQL for node "model.jaffle_shop.my_second_dbt_model"
[0m21:33:29.592179 [debug] [Thread-4 (]: Timing info for model.jaffle_shop.my_second_dbt_model (compile): 21:33:29.585916 => 21:33:29.591715
[0m21:33:29.592911 [debug] [Thread-4 (]: Began executing node model.jaffle_shop.my_second_dbt_model
[0m21:33:29.686681 [debug] [Thread-4 (]: Dropping relation "RAW"."JAFFLE_SHOP"."MY_SECOND_DBT_MODEL" because it is of type view
[0m21:33:29.691709 [debug] [Thread-4 (]: Applying DROP to: "RAW"."JAFFLE_SHOP"."MY_SECOND_DBT_MODEL"
[0m21:33:29.693537 [debug] [Thread-4 (]: Using snowflake connection "model.jaffle_shop.my_second_dbt_model"
[0m21:33:29.694754 [debug] [Thread-4 (]: On model.jaffle_shop.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.my_second_dbt_model"} */
drop view if exists "RAW"."JAFFLE_SHOP"."MY_SECOND_DBT_MODEL" cascade
[0m21:33:29.696031 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m21:33:29.716555 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m21:33:29.721765 [debug] [Thread-1 (]: Timing info for model.jaffle_shop.customers (execute): 21:33:28.671977 => 21:33:29.721132
[0m21:33:29.722498 [debug] [Thread-1 (]: On model.jaffle_shop.customers: Close
[0m21:33:29.831483 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1312fc2d-2a3a-4b3b-8549-9dcf427e3f05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1117bc810>]}
[0m21:33:29.832649 [info ] [Thread-1 (]: 1 of 3 OK created sql table model JAFFLE_SHOP.customers ........................ [[32mSUCCESS 1[0m in 1.19s]
[0m21:33:29.833654 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.customers
[0m21:33:30.107347 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m21:33:30.110975 [debug] [Thread-4 (]: Writing runtime sql for node "model.jaffle_shop.my_second_dbt_model"
[0m21:33:30.112483 [debug] [Thread-4 (]: Using snowflake connection "model.jaffle_shop.my_second_dbt_model"
[0m21:33:30.113156 [debug] [Thread-4 (]: On model.jaffle_shop.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.my_second_dbt_model"} */
create or replace transient table RAW.JAFFLE_SHOP.my_second_dbt_model
         as
        (-- Use the `ref` function to select from other models

select *
from RAW.JAFFLE_SHOP.my_first_dbt_model
where id = 1
        );
[0m21:33:30.665288 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m21:33:30.673749 [debug] [Thread-4 (]: Timing info for model.jaffle_shop.my_second_dbt_model (execute): 21:33:29.593379 => 21:33:30.673196
[0m21:33:30.674815 [debug] [Thread-4 (]: On model.jaffle_shop.my_second_dbt_model: Close
[0m21:33:30.816561 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1312fc2d-2a3a-4b3b-8549-9dcf427e3f05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1118f3d10>]}
[0m21:33:30.817680 [info ] [Thread-4 (]: 3 of 3 OK created sql table model JAFFLE_SHOP.my_second_dbt_model .............. [[32mSUCCESS 1[0m in 1.23s]
[0m21:33:30.818610 [debug] [Thread-4 (]: Finished running node model.jaffle_shop.my_second_dbt_model
[0m21:33:30.821312 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:33:30.821871 [debug] [MainThread]: Connection 'model.jaffle_shop.customers' was properly closed.
[0m21:33:30.822351 [debug] [MainThread]: Connection 'model.jaffle_shop.my_first_dbt_model' was properly closed.
[0m21:33:30.822812 [debug] [MainThread]: Connection 'model.jaffle_shop.my_second_dbt_model' was properly closed.
[0m21:33:30.823380 [info ] [MainThread]: 
[0m21:33:30.824022 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 4.11 seconds (4.11s).
[0m21:33:30.825668 [debug] [MainThread]: Command end result
[0m21:33:30.842429 [info ] [MainThread]: 
[0m21:33:30.843235 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:33:30.843815 [info ] [MainThread]: 
[0m21:33:30.844370 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m21:33:30.846115 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 7.025928, "process_user_time": 6.343103, "process_kernel_time": 0.527754, "process_mem_max_rss": "141049856", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m21:33:30.846933 [debug] [MainThread]: Command `dbt run` succeeded at 21:33:30.846732 after 7.03 seconds
[0m21:33:30.847661 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ef0fa90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c62fdd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1102a82d0>]}
[0m21:33:30.848294 [debug] [MainThread]: Flushing usage events
[0m21:35:27.077628 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bb3c950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bb0c2d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bb0f350>]}


============================== 21:35:27.089776 | 6b23603a-e14e-42de-9e1a-c7c6e77eeffb ==============================
[0m21:35:27.089776 [info ] [MainThread]: Running with dbt=1.7.8
[0m21:35:27.092134 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/ben/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/ben/jaffle_shop/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt run', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:35:27.727433 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6b23603a-e14e-42de-9e1a-c7c6e77eeffb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10be87850>]}
[0m21:35:27.893206 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6b23603a-e14e-42de-9e1a-c7c6e77eeffb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bbad9d0>]}
[0m21:35:27.894586 [info ] [MainThread]: Registered adapter: snowflake=1.7.2
[0m21:35:27.923067 [debug] [MainThread]: checksum: 67f0013ca5f0bd43af9a0873dd50792fde83ef69de63b71cacd0b4ac656c52e5, vars: {}, profile: , target: , version: 1.7.8
[0m21:35:27.979461 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m21:35:27.981075 [debug] [MainThread]: Partial parsing: updated file: jaffle_shop://models/customers.sql
[0m21:35:28.195942 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.example
[0m21:35:28.204373 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6b23603a-e14e-42de-9e1a-c7c6e77eeffb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c860910>]}
[0m21:35:28.224127 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6b23603a-e14e-42de-9e1a-c7c6e77eeffb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ca10f90>]}
[0m21:35:28.225171 [info ] [MainThread]: Found 3 models, 3 seeds, 4 tests, 0 sources, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m21:35:28.226194 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6b23603a-e14e-42de-9e1a-c7c6e77eeffb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c920b90>]}
[0m21:35:28.229550 [info ] [MainThread]: 
[0m21:35:28.231024 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m21:35:28.233581 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RAW'
[0m21:35:28.258649 [debug] [ThreadPool]: Using snowflake connection "list_RAW"
[0m21:35:28.259338 [debug] [ThreadPool]: On list_RAW: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_RAW"} */
show terse schemas in database RAW
    limit 10000
[0m21:35:28.259877 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:35:29.030982 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.0 seconds
[0m21:35:29.034622 [debug] [ThreadPool]: On list_RAW: Close
[0m21:35:29.163811 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RAW, now list_RAW_JAFFLE_SHOP)
[0m21:35:29.179094 [debug] [ThreadPool]: Using snowflake connection "list_RAW_JAFFLE_SHOP"
[0m21:35:29.179837 [debug] [ThreadPool]: On list_RAW_JAFFLE_SHOP: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_RAW_JAFFLE_SHOP"} */
show terse objects in RAW.JAFFLE_SHOP limit 10000
[0m21:35:29.180374 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:35:29.941665 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.0 seconds
[0m21:35:29.945256 [debug] [ThreadPool]: On list_RAW_JAFFLE_SHOP: Close
[0m21:35:30.066418 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6b23603a-e14e-42de-9e1a-c7c6e77eeffb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bf8b050>]}
[0m21:35:30.068494 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:35:30.069237 [info ] [MainThread]: 
[0m21:35:30.073331 [debug] [Thread-1 (]: Began running node model.jaffle_shop.customers
[0m21:35:30.074235 [info ] [Thread-1 (]: 1 of 3 START sql view model JAFFLE_SHOP.customers .............................. [RUN]
[0m21:35:30.075096 [debug] [Thread-2 (]: Began running node model.jaffle_shop.my_first_dbt_model
[0m21:35:30.076454 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_RAW_JAFFLE_SHOP, now model.jaffle_shop.customers)
[0m21:35:30.077262 [info ] [Thread-2 (]: 2 of 3 START sql table model JAFFLE_SHOP.my_first_dbt_model .................... [RUN]
[0m21:35:30.078452 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.customers
[0m21:35:30.079806 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.jaffle_shop.my_first_dbt_model'
[0m21:35:30.092393 [debug] [Thread-2 (]: Began compiling node model.jaffle_shop.my_first_dbt_model
[0m21:35:30.097717 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.customers"
[0m21:35:30.103962 [debug] [Thread-2 (]: Writing injected SQL for node "model.jaffle_shop.my_first_dbt_model"
[0m21:35:30.106136 [debug] [Thread-1 (]: Timing info for model.jaffle_shop.customers (compile): 21:35:30.080395 => 21:35:30.105638
[0m21:35:30.106949 [debug] [Thread-2 (]: Timing info for model.jaffle_shop.my_first_dbt_model (compile): 21:35:30.098413 => 21:35:30.106566
[0m21:35:30.107520 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.customers
[0m21:35:30.108106 [debug] [Thread-2 (]: Began executing node model.jaffle_shop.my_first_dbt_model
[0m21:35:30.173710 [debug] [Thread-1 (]: Dropping relation "RAW"."JAFFLE_SHOP"."CUSTOMERS" because it is of type table
[0m21:35:30.190954 [debug] [Thread-1 (]: Applying DROP to: "RAW"."JAFFLE_SHOP"."CUSTOMERS"
[0m21:35:30.216683 [debug] [Thread-1 (]: Using snowflake connection "model.jaffle_shop.customers"
[0m21:35:30.218358 [debug] [Thread-2 (]: Writing runtime sql for node "model.jaffle_shop.my_first_dbt_model"
[0m21:35:30.219115 [debug] [Thread-1 (]: On model.jaffle_shop.customers: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.customers"} */
drop table if exists "RAW"."JAFFLE_SHOP"."CUSTOMERS" cascade
[0m21:35:30.220060 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:35:30.223491 [debug] [Thread-2 (]: Using snowflake connection "model.jaffle_shop.my_first_dbt_model"
[0m21:35:30.224330 [debug] [Thread-2 (]: On model.jaffle_shop.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.my_first_dbt_model"} */
create or replace transient table RAW.JAFFLE_SHOP.my_first_dbt_model
         as
        (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
        );
[0m21:35:30.225478 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m21:35:30.628949 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m21:35:30.655232 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.customers"
[0m21:35:30.657984 [debug] [Thread-1 (]: Using snowflake connection "model.jaffle_shop.customers"
[0m21:35:30.658630 [debug] [Thread-1 (]: On model.jaffle_shop.customers: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.customers"} */
create or replace   view RAW.JAFFLE_SHOP.customers
  
   as (
    


with customers as (

    select
        id as customer_id,
        first_name,
        last_name

    from raw.jaffle_shop.raw_customers

),

orders as (

    select
        id as order_id,
        user_id as customer_id,
        order_date,
        status

    from raw.jaffle_shop.raw_orders

),

customer_orders as (

    select
        customer_id,

        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders

    from orders

    group by 1

),

final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce(customer_orders.number_of_orders, 0) as number_of_orders

    from customers

    left join customer_orders using (customer_id)

)

select * from final
  );
[0m21:35:30.796568 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m21:35:30.833587 [debug] [Thread-1 (]: Timing info for model.jaffle_shop.customers (execute): 21:35:30.108556 => 21:35:30.833222
[0m21:35:30.834301 [debug] [Thread-1 (]: On model.jaffle_shop.customers: Close
[0m21:35:30.875697 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m21:35:30.883686 [debug] [Thread-2 (]: Timing info for model.jaffle_shop.my_first_dbt_model (execute): 21:35:30.130585 => 21:35:30.883003
[0m21:35:30.884984 [debug] [Thread-2 (]: On model.jaffle_shop.my_first_dbt_model: Close
[0m21:35:30.965556 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6b23603a-e14e-42de-9e1a-c7c6e77eeffb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cc63c50>]}
[0m21:35:30.967191 [info ] [Thread-1 (]: 1 of 3 OK created sql view model JAFFLE_SHOP.customers ......................... [[32mSUCCESS 1[0m in 0.89s]
[0m21:35:30.968699 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.customers
[0m21:35:31.016774 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6b23603a-e14e-42de-9e1a-c7c6e77eeffb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ca05510>]}
[0m21:35:31.017890 [info ] [Thread-2 (]: 2 of 3 OK created sql table model JAFFLE_SHOP.my_first_dbt_model ............... [[32mSUCCESS 1[0m in 0.94s]
[0m21:35:31.018922 [debug] [Thread-2 (]: Finished running node model.jaffle_shop.my_first_dbt_model
[0m21:35:31.020155 [debug] [Thread-4 (]: Began running node model.jaffle_shop.my_second_dbt_model
[0m21:35:31.021010 [info ] [Thread-4 (]: 3 of 3 START sql table model JAFFLE_SHOP.my_second_dbt_model ................... [RUN]
[0m21:35:31.022348 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.jaffle_shop.my_second_dbt_model'
[0m21:35:31.022973 [debug] [Thread-4 (]: Began compiling node model.jaffle_shop.my_second_dbt_model
[0m21:35:31.027543 [debug] [Thread-4 (]: Writing injected SQL for node "model.jaffle_shop.my_second_dbt_model"
[0m21:35:31.028873 [debug] [Thread-4 (]: Timing info for model.jaffle_shop.my_second_dbt_model (compile): 21:35:31.023347 => 21:35:31.028466
[0m21:35:31.029576 [debug] [Thread-4 (]: Began executing node model.jaffle_shop.my_second_dbt_model
[0m21:35:31.037304 [debug] [Thread-4 (]: Writing runtime sql for node "model.jaffle_shop.my_second_dbt_model"
[0m21:35:31.039030 [debug] [Thread-4 (]: Using snowflake connection "model.jaffle_shop.my_second_dbt_model"
[0m21:35:31.039691 [debug] [Thread-4 (]: On model.jaffle_shop.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.my_second_dbt_model"} */
create or replace transient table RAW.JAFFLE_SHOP.my_second_dbt_model
         as
        (-- Use the `ref` function to select from other models

select *
from RAW.JAFFLE_SHOP.my_first_dbt_model
where id = 1
        );
[0m21:35:31.040283 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m21:35:31.684743 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m21:35:31.689418 [debug] [Thread-4 (]: Timing info for model.jaffle_shop.my_second_dbt_model (execute): 21:35:31.030226 => 21:35:31.689036
[0m21:35:31.690169 [debug] [Thread-4 (]: On model.jaffle_shop.my_second_dbt_model: Close
[0m21:35:31.837786 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6b23603a-e14e-42de-9e1a-c7c6e77eeffb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cc62690>]}
[0m21:35:31.839365 [info ] [Thread-4 (]: 3 of 3 OK created sql table model JAFFLE_SHOP.my_second_dbt_model .............. [[32mSUCCESS 1[0m in 0.82s]
[0m21:35:31.841125 [debug] [Thread-4 (]: Finished running node model.jaffle_shop.my_second_dbt_model
[0m21:35:31.845025 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:35:31.846076 [debug] [MainThread]: Connection 'model.jaffle_shop.customers' was properly closed.
[0m21:35:31.847196 [debug] [MainThread]: Connection 'model.jaffle_shop.my_first_dbt_model' was properly closed.
[0m21:35:31.848134 [debug] [MainThread]: Connection 'model.jaffle_shop.my_second_dbt_model' was properly closed.
[0m21:35:31.849327 [info ] [MainThread]: 
[0m21:35:31.850497 [info ] [MainThread]: Finished running 1 view model, 2 table models in 0 hours 0 minutes and 3.62 seconds (3.62s).
[0m21:35:31.853970 [debug] [MainThread]: Command end result
[0m21:35:31.872552 [info ] [MainThread]: 
[0m21:35:31.873713 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:35:31.874622 [info ] [MainThread]: 
[0m21:35:31.875819 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m21:35:31.879295 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 4.906561, "process_user_time": 4.752687, "process_kernel_time": 0.50398, "process_mem_max_rss": "139157504", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m21:35:31.880952 [debug] [MainThread]: Command `dbt run` succeeded at 21:35:31.880658 after 4.91 seconds
[0m21:35:31.881766 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10be90a10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b7fd50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c10ed0>]}
[0m21:35:31.882398 [debug] [MainThread]: Flushing usage events
[0m21:39:03.475772 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11335f8d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1135462d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1135464d0>]}


============================== 21:39:03.482490 | 1c3ad6d2-01ff-4a90-bca6-cfe0dcdeeaf6 ==============================
[0m21:39:03.482490 [info ] [MainThread]: Running with dbt=1.7.8
[0m21:39:03.483489 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/ben/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/ben/jaffle_shop/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m21:39:04.093274 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1c3ad6d2-01ff-4a90-bca6-cfe0dcdeeaf6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113942590>]}
[0m21:39:04.230547 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1c3ad6d2-01ff-4a90-bca6-cfe0dcdeeaf6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11396c1d0>]}
[0m21:39:04.231786 [info ] [MainThread]: Registered adapter: snowflake=1.7.2
[0m21:39:04.260578 [debug] [MainThread]: checksum: 67f0013ca5f0bd43af9a0873dd50792fde83ef69de63b71cacd0b4ac656c52e5, vars: {}, profile: , target: , version: 1.7.8
[0m21:39:04.281427 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m21:39:04.282537 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '1c3ad6d2-01ff-4a90-bca6-cfe0dcdeeaf6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11426ccd0>]}
[0m21:39:05.875888 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1c3ad6d2-01ff-4a90-bca6-cfe0dcdeeaf6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1146967d0>]}
[0m21:39:05.891568 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1c3ad6d2-01ff-4a90-bca6-cfe0dcdeeaf6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11474e750>]}
[0m21:39:05.892340 [info ] [MainThread]: Found 1 model, 3 seeds, 0 sources, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m21:39:05.892942 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1c3ad6d2-01ff-4a90-bca6-cfe0dcdeeaf6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11433de50>]}
[0m21:39:05.895264 [info ] [MainThread]: 
[0m21:39:05.896591 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m21:39:05.898278 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RAW'
[0m21:39:05.921909 [debug] [ThreadPool]: Using snowflake connection "list_RAW"
[0m21:39:05.922626 [debug] [ThreadPool]: On list_RAW: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_RAW"} */
show terse schemas in database RAW
    limit 10000
[0m21:39:05.923223 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:39:06.559232 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.0 seconds
[0m21:39:06.564030 [debug] [ThreadPool]: On list_RAW: Close
[0m21:39:06.688994 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RAW, now list_RAW_JAFFLE_SHOP)
[0m21:39:06.706053 [debug] [ThreadPool]: Using snowflake connection "list_RAW_JAFFLE_SHOP"
[0m21:39:06.706715 [debug] [ThreadPool]: On list_RAW_JAFFLE_SHOP: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_RAW_JAFFLE_SHOP"} */
show terse objects in RAW.JAFFLE_SHOP limit 10000
[0m21:39:06.707230 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:39:07.092956 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.0 seconds
[0m21:39:07.096605 [debug] [ThreadPool]: On list_RAW_JAFFLE_SHOP: Close
[0m21:39:07.220123 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1c3ad6d2-01ff-4a90-bca6-cfe0dcdeeaf6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114396890>]}
[0m21:39:07.221820 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:39:07.222545 [info ] [MainThread]: 
[0m21:39:07.226468 [debug] [Thread-1 (]: Began running node model.jaffle_shop.customers
[0m21:39:07.227457 [info ] [Thread-1 (]: 1 of 1 START sql view model JAFFLE_SHOP.customers .............................. [RUN]
[0m21:39:07.228991 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_RAW_JAFFLE_SHOP, now model.jaffle_shop.customers)
[0m21:39:07.229692 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.customers
[0m21:39:07.246318 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.customers"
[0m21:39:07.249015 [debug] [Thread-1 (]: Timing info for model.jaffle_shop.customers (compile): 21:39:07.230087 => 21:39:07.248418
[0m21:39:07.249803 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.customers
[0m21:39:07.310092 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.customers"
[0m21:39:07.313081 [debug] [Thread-1 (]: Using snowflake connection "model.jaffle_shop.customers"
[0m21:39:07.313814 [debug] [Thread-1 (]: On model.jaffle_shop.customers: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.customers"} */
create or replace   view RAW.JAFFLE_SHOP.customers
  
   as (
    


with customers as (

    select
        id as customer_id,
        first_name,
        last_name

    from raw.jaffle_shop.raw_customers

),

orders as (

    select
        id as order_id,
        user_id as customer_id,
        order_date,
        status

    from raw.jaffle_shop.raw_orders

),

customer_orders as (

    select
        customer_id,

        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders

    from orders

    group by 1

),

final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce(customer_orders.number_of_orders, 0) as number_of_orders

    from customers

    left join customer_orders using (customer_id)

)

select * from final
  );
[0m21:39:07.314446 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:39:08.118407 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m21:39:08.159660 [debug] [Thread-1 (]: Timing info for model.jaffle_shop.customers (execute): 21:39:07.250279 => 21:39:08.159297
[0m21:39:08.160395 [debug] [Thread-1 (]: On model.jaffle_shop.customers: Close
[0m21:39:08.280631 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1c3ad6d2-01ff-4a90-bca6-cfe0dcdeeaf6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1143d05d0>]}
[0m21:39:08.281976 [info ] [Thread-1 (]: 1 of 1 OK created sql view model JAFFLE_SHOP.customers ......................... [[32mSUCCESS 1[0m in 1.05s]
[0m21:39:08.283256 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.customers
[0m21:39:08.286324 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:39:08.286954 [debug] [MainThread]: Connection 'model.jaffle_shop.customers' was properly closed.
[0m21:39:08.287566 [info ] [MainThread]: 
[0m21:39:08.288503 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.39 seconds (2.39s).
[0m21:39:08.289805 [debug] [MainThread]: Command end result
[0m21:39:08.306186 [info ] [MainThread]: 
[0m21:39:08.306967 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:39:08.307510 [info ] [MainThread]: 
[0m21:39:08.308079 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m21:39:08.309865 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 4.919806, "process_user_time": 5.732798, "process_kernel_time": 0.475519, "process_mem_max_rss": "138924032", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m21:39:08.310738 [debug] [MainThread]: Command `dbt run` succeeded at 21:39:08.310532 after 4.92 seconds
[0m21:39:08.311578 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113619e90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113909d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f50e8d0>]}
[0m21:39:08.312226 [debug] [MainThread]: Flushing usage events
[0m22:11:11.234980 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fd38dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fa6a990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fa6a350>]}


============================== 22:11:11.243782 | 23317645-78c2-44fb-a565-d44662d80756 ==============================
[0m22:11:11.243782 [info ] [MainThread]: Running with dbt=1.7.8
[0m22:11:11.245284 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/ben/jaffle_shop/logs', 'profiles_dir': '/Users/ben/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m22:11:12.010008 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '23317645-78c2-44fb-a565-d44662d80756', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110922790>]}
[0m22:11:12.141416 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '23317645-78c2-44fb-a565-d44662d80756', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110911910>]}
[0m22:11:12.144248 [info ] [MainThread]: Registered adapter: snowflake=1.7.2
[0m22:11:12.174287 [debug] [MainThread]: checksum: 67f0013ca5f0bd43af9a0873dd50792fde83ef69de63b71cacd0b4ac656c52e5, vars: {}, profile: , target: , version: 1.7.8
[0m22:11:12.277670 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 2 files added, 1 files changed.
[0m22:11:12.278587 [debug] [MainThread]: Partial parsing: added file: jaffle_shop://models/stg_orders.sql
[0m22:11:12.279280 [debug] [MainThread]: Partial parsing: added file: jaffle_shop://models/stg_customers.sql
[0m22:11:12.279974 [debug] [MainThread]: Partial parsing: updated file: jaffle_shop://models/customers.sql
[0m22:11:12.500264 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '23317645-78c2-44fb-a565-d44662d80756', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110d13f90>]}
[0m22:11:12.517040 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '23317645-78c2-44fb-a565-d44662d80756', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110bdea10>]}
[0m22:11:12.517843 [info ] [MainThread]: Found 3 seeds, 3 models, 0 sources, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m22:11:12.518480 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '23317645-78c2-44fb-a565-d44662d80756', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110a891d0>]}
[0m22:11:12.521604 [info ] [MainThread]: 
[0m22:11:12.523222 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m22:11:12.525802 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RAW'
[0m22:11:12.565342 [debug] [ThreadPool]: Using snowflake connection "list_RAW"
[0m22:11:12.566070 [debug] [ThreadPool]: On list_RAW: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_RAW"} */
show terse schemas in database RAW
    limit 10000
[0m22:11:12.566643 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:11:13.231239 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.0 seconds
[0m22:11:13.236392 [debug] [ThreadPool]: On list_RAW: Close
[0m22:11:13.392925 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RAW, now list_RAW_JAFFLE_SHOP)
[0m22:11:13.410450 [debug] [ThreadPool]: Using snowflake connection "list_RAW_JAFFLE_SHOP"
[0m22:11:13.411192 [debug] [ThreadPool]: On list_RAW_JAFFLE_SHOP: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_RAW_JAFFLE_SHOP"} */
show terse objects in RAW.JAFFLE_SHOP limit 10000
[0m22:11:13.411791 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:11:13.943920 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.0 seconds
[0m22:11:13.946524 [debug] [ThreadPool]: On list_RAW_JAFFLE_SHOP: Close
[0m22:11:14.074387 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '23317645-78c2-44fb-a565-d44662d80756', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110a3b050>]}
[0m22:11:14.076880 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:11:14.078237 [info ] [MainThread]: 
[0m22:11:14.084458 [debug] [Thread-1 (]: Began running node model.jaffle_shop.stg_customers
[0m22:11:14.085575 [debug] [Thread-2 (]: Began running node model.jaffle_shop.stg_orders
[0m22:11:14.086470 [info ] [Thread-1 (]: 1 of 3 START sql table model JAFFLE_SHOP.stg_customers ......................... [RUN]
[0m22:11:14.087440 [info ] [Thread-2 (]: 2 of 3 START sql table model JAFFLE_SHOP.stg_orders ............................ [RUN]
[0m22:11:14.088766 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_RAW_JAFFLE_SHOP, now model.jaffle_shop.stg_customers)
[0m22:11:14.090002 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.jaffle_shop.stg_orders'
[0m22:11:14.091245 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.stg_customers
[0m22:11:14.093195 [debug] [Thread-2 (]: Began compiling node model.jaffle_shop.stg_orders
[0m22:11:14.113825 [debug] [Thread-2 (]: Writing injected SQL for node "model.jaffle_shop.stg_orders"
[0m22:11:14.116814 [debug] [Thread-2 (]: Timing info for model.jaffle_shop.stg_orders (compile): 22:11:14.109208 => 22:11:14.114972
[0m22:11:14.118090 [debug] [Thread-2 (]: Began executing node model.jaffle_shop.stg_orders
[0m22:11:14.143208 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.stg_customers"
[0m22:11:14.149124 [debug] [Thread-1 (]: Timing info for model.jaffle_shop.stg_customers (compile): 22:11:14.094395 => 22:11:14.148187
[0m22:11:14.156716 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.stg_customers
[0m22:11:14.235289 [debug] [Thread-2 (]: Writing runtime sql for node "model.jaffle_shop.stg_orders"
[0m22:11:14.236630 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.stg_customers"
[0m22:11:14.238698 [debug] [Thread-2 (]: Using snowflake connection "model.jaffle_shop.stg_orders"
[0m22:11:14.239581 [debug] [Thread-2 (]: On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */
create or replace transient table RAW.JAFFLE_SHOP.stg_orders
         as
        (select
        id as order_id,
        user_id as customer_id,
        order_date,
        status

    from raw.jaffle_shop.raw_orders
        );
[0m22:11:14.240814 [debug] [Thread-1 (]: Using snowflake connection "model.jaffle_shop.stg_customers"
[0m22:11:14.241489 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m22:11:14.242257 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */
create or replace transient table RAW.JAFFLE_SHOP.stg_customers
         as
        (select
        id as customer_id,
        first_name,
        last_name

    from raw.jaffle_shop.raw_customers
        );
[0m22:11:14.243842 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:11:15.348402 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m22:11:15.386886 [debug] [Thread-2 (]: Timing info for model.jaffle_shop.stg_orders (execute): 22:11:14.118919 => 22:11:15.386489
[0m22:11:15.387586 [debug] [Thread-2 (]: On model.jaffle_shop.stg_orders: Close
[0m22:11:15.499174 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '23317645-78c2-44fb-a565-d44662d80756', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110e5b990>]}
[0m22:11:15.500262 [info ] [Thread-2 (]: 2 of 3 OK created sql table model JAFFLE_SHOP.stg_orders ....................... [[32mSUCCESS 1[0m in 1.41s]
[0m22:11:15.501234 [debug] [Thread-2 (]: Finished running node model.jaffle_shop.stg_orders
[0m22:11:15.545206 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m22:11:15.549239 [debug] [Thread-1 (]: Timing info for model.jaffle_shop.stg_customers (execute): 22:11:14.169637 => 22:11:15.548899
[0m22:11:15.549888 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: Close
[0m22:11:15.669981 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '23317645-78c2-44fb-a565-d44662d80756', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110e2f3d0>]}
[0m22:11:15.671502 [info ] [Thread-1 (]: 1 of 3 OK created sql table model JAFFLE_SHOP.stg_customers .................... [[32mSUCCESS 1[0m in 1.58s]
[0m22:11:15.672996 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.stg_customers
[0m22:11:15.674868 [debug] [Thread-4 (]: Began running node model.jaffle_shop.customers
[0m22:11:15.676088 [info ] [Thread-4 (]: 3 of 3 START sql view model JAFFLE_SHOP.customers .............................. [RUN]
[0m22:11:15.678266 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.jaffle_shop.customers'
[0m22:11:15.679210 [debug] [Thread-4 (]: Began compiling node model.jaffle_shop.customers
[0m22:11:15.685511 [debug] [Thread-4 (]: Writing injected SQL for node "model.jaffle_shop.customers"
[0m22:11:15.686879 [debug] [Thread-4 (]: Timing info for model.jaffle_shop.customers (compile): 22:11:15.679721 => 22:11:15.686464
[0m22:11:15.687542 [debug] [Thread-4 (]: Began executing node model.jaffle_shop.customers
[0m22:11:15.724940 [debug] [Thread-4 (]: Writing runtime sql for node "model.jaffle_shop.customers"
[0m22:11:15.727850 [debug] [Thread-4 (]: Using snowflake connection "model.jaffle_shop.customers"
[0m22:11:15.728667 [debug] [Thread-4 (]: On model.jaffle_shop.customers: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.customers"} */
create or replace   view RAW.JAFFLE_SHOP.customers
  
   as (
    


with customers as (

    select * from RAW.JAFFLE_SHOP.stg_customers

),

orders as (

    select * from RAW.JAFFLE_SHOP.stg_orders

),

customer_orders as (

    select
        customer_id,

        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders

    from orders

    group by 1

),

final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce(customer_orders.number_of_orders, 0) as number_of_orders

    from customers

    left join customer_orders using (customer_id)

)

select * from final
  );
[0m22:11:15.729290 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m22:11:16.190657 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m22:11:16.204660 [debug] [Thread-4 (]: Timing info for model.jaffle_shop.customers (execute): 22:11:15.687925 => 22:11:16.204188
[0m22:11:16.205792 [debug] [Thread-4 (]: On model.jaffle_shop.customers: Close
[0m22:11:16.328507 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '23317645-78c2-44fb-a565-d44662d80756', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110b97a90>]}
[0m22:11:16.330052 [info ] [Thread-4 (]: 3 of 3 OK created sql view model JAFFLE_SHOP.customers ......................... [[32mSUCCESS 1[0m in 0.65s]
[0m22:11:16.331796 [debug] [Thread-4 (]: Finished running node model.jaffle_shop.customers
[0m22:11:16.335515 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:11:16.336242 [debug] [MainThread]: Connection 'model.jaffle_shop.stg_customers' was properly closed.
[0m22:11:16.337027 [debug] [MainThread]: Connection 'model.jaffle_shop.stg_orders' was properly closed.
[0m22:11:16.337956 [debug] [MainThread]: Connection 'model.jaffle_shop.customers' was properly closed.
[0m22:11:16.339246 [info ] [MainThread]: 
[0m22:11:16.340012 [info ] [MainThread]: Finished running 2 table models, 1 view model in 0 hours 0 minutes and 3.82 seconds (3.82s).
[0m22:11:16.341616 [debug] [MainThread]: Command end result
[0m22:11:16.353956 [info ] [MainThread]: 
[0m22:11:16.355337 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:11:16.356100 [info ] [MainThread]: 
[0m22:11:16.356771 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m22:11:16.360183 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 5.214398, "process_user_time": 4.667575, "process_kernel_time": 0.631508, "process_mem_max_rss": "137994240", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m22:11:16.361511 [debug] [MainThread]: Command `dbt run` succeeded at 22:11:16.361210 after 5.22 seconds
[0m22:11:16.362819 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fb1d2d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fcfc810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bd5bd90>]}
[0m22:11:16.363633 [debug] [MainThread]: Flushing usage events
[0m22:14:17.184789 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1090cdf10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d69890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d81490>]}


============================== 22:14:17.193214 | 928896c1-58cb-4f20-b5b0-97318c4c1137 ==============================
[0m22:14:17.193214 [info ] [MainThread]: Running with dbt=1.7.8
[0m22:14:17.194252 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/Users/ben/.dbt', 'log_path': '/Users/ben/jaffle_shop/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m22:14:17.923482 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '928896c1-58cb-4f20-b5b0-97318c4c1137', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10985b210>]}
[0m22:14:18.057156 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '928896c1-58cb-4f20-b5b0-97318c4c1137', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1097dce90>]}
[0m22:14:18.058709 [info ] [MainThread]: Registered adapter: snowflake=1.7.2
[0m22:14:18.087953 [debug] [MainThread]: checksum: 67f0013ca5f0bd43af9a0873dd50792fde83ef69de63b71cacd0b4ac656c52e5, vars: {}, profile: , target: , version: 1.7.8
[0m22:14:18.106653 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m22:14:18.107518 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '928896c1-58cb-4f20-b5b0-97318c4c1137', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109c4b650>]}
[0m22:14:19.778527 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.staging
[0m22:14:19.786256 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '928896c1-58cb-4f20-b5b0-97318c4c1137', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109bc9f10>]}
[0m22:14:19.804594 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '928896c1-58cb-4f20-b5b0-97318c4c1137', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109d2b490>]}
[0m22:14:19.805370 [info ] [MainThread]: Found 3 models, 3 seeds, 0 sources, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m22:14:19.806253 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '928896c1-58cb-4f20-b5b0-97318c4c1137', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109de6950>]}
[0m22:14:19.809289 [info ] [MainThread]: 
[0m22:14:19.810600 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m22:14:19.812789 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RAW'
[0m22:14:19.837055 [debug] [ThreadPool]: Using snowflake connection "list_RAW"
[0m22:14:19.838021 [debug] [ThreadPool]: On list_RAW: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_RAW"} */
show terse schemas in database RAW
    limit 10000
[0m22:14:19.838631 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:14:21.104470 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.0 seconds
[0m22:14:21.107986 [debug] [ThreadPool]: On list_RAW: Close
[0m22:14:21.234003 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RAW, now list_RAW_JAFFLE_SHOP)
[0m22:14:21.250359 [debug] [ThreadPool]: Using snowflake connection "list_RAW_JAFFLE_SHOP"
[0m22:14:21.251027 [debug] [ThreadPool]: On list_RAW_JAFFLE_SHOP: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_RAW_JAFFLE_SHOP"} */
show terse objects in RAW.JAFFLE_SHOP limit 10000
[0m22:14:21.251699 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:14:21.635959 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 0.0 seconds
[0m22:14:21.640383 [debug] [ThreadPool]: On list_RAW_JAFFLE_SHOP: Close
[0m22:14:21.783039 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '928896c1-58cb-4f20-b5b0-97318c4c1137', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109e5dd50>]}
[0m22:14:21.785100 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:14:21.786237 [info ] [MainThread]: 
[0m22:14:21.792908 [debug] [Thread-1 (]: Began running node model.jaffle_shop.stg_customers
[0m22:14:21.794096 [info ] [Thread-1 (]: 1 of 3 START sql table model JAFFLE_SHOP.stg_customers ......................... [RUN]
[0m22:14:21.795229 [debug] [Thread-2 (]: Began running node model.jaffle_shop.stg_orders
[0m22:14:21.796789 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_RAW_JAFFLE_SHOP, now model.jaffle_shop.stg_customers)
[0m22:14:21.797700 [info ] [Thread-2 (]: 2 of 3 START sql table model JAFFLE_SHOP.stg_orders ............................ [RUN]
[0m22:14:21.798725 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.stg_customers
[0m22:14:21.800741 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.jaffle_shop.stg_orders'
[0m22:14:21.810290 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.stg_customers"
[0m22:14:21.811251 [debug] [Thread-2 (]: Began compiling node model.jaffle_shop.stg_orders
[0m22:14:21.815299 [debug] [Thread-2 (]: Writing injected SQL for node "model.jaffle_shop.stg_orders"
[0m22:14:21.820648 [debug] [Thread-1 (]: Timing info for model.jaffle_shop.stg_customers (compile): 22:14:21.801458 => 22:14:21.819395
[0m22:14:21.821598 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.stg_customers
[0m22:14:21.822391 [debug] [Thread-2 (]: Timing info for model.jaffle_shop.stg_orders (compile): 22:14:21.812533 => 22:14:21.822002
[0m22:14:21.845140 [debug] [Thread-2 (]: Began executing node model.jaffle_shop.stg_orders
[0m22:14:21.895454 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.stg_customers"
[0m22:14:21.899205 [debug] [Thread-2 (]: Writing runtime sql for node "model.jaffle_shop.stg_orders"
[0m22:14:21.901056 [debug] [Thread-2 (]: Using snowflake connection "model.jaffle_shop.stg_orders"
[0m22:14:21.902140 [debug] [Thread-1 (]: Using snowflake connection "model.jaffle_shop.stg_customers"
[0m22:14:21.902813 [debug] [Thread-2 (]: On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */
create or replace transient table RAW.JAFFLE_SHOP.stg_orders
         as
        (select
        id as order_id,
        user_id as customer_id,
        order_date,
        status

    from raw.jaffle_shop.raw_orders
        );
[0m22:14:21.903646 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */
create or replace transient table RAW.JAFFLE_SHOP.stg_customers
         as
        (select
        id as customer_id,
        first_name,
        last_name

    from raw.jaffle_shop.raw_customers
        );
[0m22:14:21.904396 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m22:14:21.905287 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:14:22.741499 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m22:14:22.742739 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m22:14:22.786988 [debug] [Thread-2 (]: Timing info for model.jaffle_shop.stg_orders (execute): 22:14:21.852057 => 22:14:22.786576
[0m22:14:22.789275 [debug] [Thread-1 (]: Timing info for model.jaffle_shop.stg_customers (execute): 22:14:21.822732 => 22:14:22.788954
[0m22:14:22.789958 [debug] [Thread-2 (]: On model.jaffle_shop.stg_orders: Close
[0m22:14:22.790575 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: Close
[0m22:14:22.930956 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '928896c1-58cb-4f20-b5b0-97318c4c1137', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109f9d750>]}
[0m22:14:22.932977 [info ] [Thread-2 (]: 2 of 3 OK created sql table model JAFFLE_SHOP.stg_orders ....................... [[32mSUCCESS 1[0m in 1.13s]
[0m22:14:22.934713 [debug] [Thread-2 (]: Finished running node model.jaffle_shop.stg_orders
[0m22:14:22.988324 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '928896c1-58cb-4f20-b5b0-97318c4c1137', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109c4ee50>]}
[0m22:14:22.989436 [info ] [Thread-1 (]: 1 of 3 OK created sql table model JAFFLE_SHOP.stg_customers .................... [[32mSUCCESS 1[0m in 1.19s]
[0m22:14:22.990521 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.stg_customers
[0m22:14:22.991718 [debug] [Thread-4 (]: Began running node model.jaffle_shop.customers
[0m22:14:22.993142 [info ] [Thread-4 (]: 3 of 3 START sql view model JAFFLE_SHOP.customers .............................. [RUN]
[0m22:14:22.995027 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.jaffle_shop.customers'
[0m22:14:23.012896 [debug] [Thread-4 (]: Began compiling node model.jaffle_shop.customers
[0m22:14:23.018024 [debug] [Thread-4 (]: Writing injected SQL for node "model.jaffle_shop.customers"
[0m22:14:23.019342 [debug] [Thread-4 (]: Timing info for model.jaffle_shop.customers (compile): 22:14:23.013414 => 22:14:23.018967
[0m22:14:23.019967 [debug] [Thread-4 (]: Began executing node model.jaffle_shop.customers
[0m22:14:23.059772 [debug] [Thread-4 (]: Writing runtime sql for node "model.jaffle_shop.customers"
[0m22:14:23.063652 [debug] [Thread-4 (]: Using snowflake connection "model.jaffle_shop.customers"
[0m22:14:23.064935 [debug] [Thread-4 (]: On model.jaffle_shop.customers: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.customers"} */
create or replace   view RAW.JAFFLE_SHOP.customers
  
   as (
    


with customers as (

    select * from RAW.JAFFLE_SHOP.stg_customers

),

orders as (

    select * from RAW.JAFFLE_SHOP.stg_orders

),

customer_orders as (

    select
        customer_id,

        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders

    from orders

    group by 1

),

final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce(customer_orders.number_of_orders, 0) as number_of_orders

    from customers

    left join customer_orders using (customer_id)

)

select * from final
  );
[0m22:14:23.065868 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m22:14:23.944716 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m22:14:23.953446 [debug] [Thread-4 (]: Timing info for model.jaffle_shop.customers (execute): 22:14:23.020662 => 22:14:23.952889
[0m22:14:23.954477 [debug] [Thread-4 (]: On model.jaffle_shop.customers: Close
[0m22:14:24.084301 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '928896c1-58cb-4f20-b5b0-97318c4c1137', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109faf290>]}
[0m22:14:24.085838 [info ] [Thread-4 (]: 3 of 3 OK created sql view model JAFFLE_SHOP.customers ......................... [[32mSUCCESS 1[0m in 1.09s]
[0m22:14:24.087142 [debug] [Thread-4 (]: Finished running node model.jaffle_shop.customers
[0m22:14:24.090081 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:14:24.090691 [debug] [MainThread]: Connection 'model.jaffle_shop.stg_customers' was properly closed.
[0m22:14:24.091243 [debug] [MainThread]: Connection 'model.jaffle_shop.stg_orders' was properly closed.
[0m22:14:24.091774 [debug] [MainThread]: Connection 'model.jaffle_shop.customers' was properly closed.
[0m22:14:24.092658 [info ] [MainThread]: 
[0m22:14:24.093555 [info ] [MainThread]: Finished running 2 table models, 1 view model in 0 hours 0 minutes and 4.28 seconds (4.28s).
[0m22:14:24.094993 [debug] [MainThread]: Command end result
[0m22:14:24.107295 [info ] [MainThread]: 
[0m22:14:24.108136 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:14:24.108711 [info ] [MainThread]: 
[0m22:14:24.109284 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m22:14:24.112879 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 7.0138745, "process_user_time": 5.87618, "process_kernel_time": 0.62858, "process_mem_max_rss": "139296768", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m22:14:24.114506 [debug] [MainThread]: Command `dbt run` succeeded at 22:14:24.114116 after 7.02 seconds
[0m22:14:24.115806 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109123950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109d30810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f21090>]}
[0m22:14:24.116928 [debug] [MainThread]: Flushing usage events
[0m22:15:35.253188 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105be4710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105be48d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106487890>]}


============================== 22:15:35.259046 | 4b684fbd-85cc-4bfc-a08e-0407581c5339 ==============================
[0m22:15:35.259046 [info ] [MainThread]: Running with dbt=1.7.8
[0m22:15:35.260097 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/ben/jaffle_shop/logs', 'profiles_dir': '/Users/ben/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt run', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:15:35.803790 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4b684fbd-85cc-4bfc-a08e-0407581c5339', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10664a5d0>]}
[0m22:15:35.934736 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4b684fbd-85cc-4bfc-a08e-0407581c5339', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10667c550>]}
[0m22:15:35.935974 [info ] [MainThread]: Registered adapter: snowflake=1.7.2
[0m22:15:35.963577 [debug] [MainThread]: checksum: 67f0013ca5f0bd43af9a0873dd50792fde83ef69de63b71cacd0b4ac656c52e5, vars: {}, profile: , target: , version: 1.7.8
[0m22:15:35.980086 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m22:15:35.981158 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '4b684fbd-85cc-4bfc-a08e-0407581c5339', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10708a2d0>]}
[0m22:15:37.461858 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4b684fbd-85cc-4bfc-a08e-0407581c5339', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107202390>]}
[0m22:15:37.477002 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4b684fbd-85cc-4bfc-a08e-0407581c5339', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107486bd0>]}
[0m22:15:37.477819 [info ] [MainThread]: Found 3 models, 3 seeds, 0 sources, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m22:15:37.478425 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4b684fbd-85cc-4bfc-a08e-0407581c5339', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107088950>]}
[0m22:15:37.481269 [info ] [MainThread]: 
[0m22:15:37.482540 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m22:15:37.484664 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RAW'
[0m22:15:37.507158 [debug] [ThreadPool]: Using snowflake connection "list_RAW"
[0m22:15:37.507837 [debug] [ThreadPool]: On list_RAW: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_RAW"} */
show terse schemas in database RAW
    limit 10000
[0m22:15:37.508375 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:15:38.270368 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.0 seconds
[0m22:15:38.274451 [debug] [ThreadPool]: On list_RAW: Close
[0m22:15:38.399550 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RAW, now list_RAW_JAFFLE_SHOP)
[0m22:15:38.414663 [debug] [ThreadPool]: Using snowflake connection "list_RAW_JAFFLE_SHOP"
[0m22:15:38.415350 [debug] [ThreadPool]: On list_RAW_JAFFLE_SHOP: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_RAW_JAFFLE_SHOP"} */
show terse objects in RAW.JAFFLE_SHOP limit 10000
[0m22:15:38.415866 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:15:38.955644 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 1.0 seconds
[0m22:15:38.961213 [debug] [ThreadPool]: On list_RAW_JAFFLE_SHOP: Close
[0m22:15:39.089561 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4b684fbd-85cc-4bfc-a08e-0407581c5339', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10706f9d0>]}
[0m22:15:39.091624 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:15:39.092544 [info ] [MainThread]: 
[0m22:15:39.097545 [debug] [Thread-1 (]: Began running node model.jaffle_shop.stg_customers
[0m22:15:39.098617 [debug] [Thread-2 (]: Began running node model.jaffle_shop.stg_orders
[0m22:15:39.100315 [info ] [Thread-1 (]: 1 of 3 START sql view model JAFFLE_SHOP.stg_customers .......................... [RUN]
[0m22:15:39.101513 [info ] [Thread-2 (]: 2 of 3 START sql view model JAFFLE_SHOP.stg_orders ............................. [RUN]
[0m22:15:39.102872 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_RAW_JAFFLE_SHOP, now model.jaffle_shop.stg_customers)
[0m22:15:39.104103 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.jaffle_shop.stg_orders'
[0m22:15:39.104976 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.stg_customers
[0m22:15:39.106559 [debug] [Thread-2 (]: Began compiling node model.jaffle_shop.stg_orders
[0m22:15:39.117270 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.stg_customers"
[0m22:15:39.122171 [debug] [Thread-2 (]: Writing injected SQL for node "model.jaffle_shop.stg_orders"
[0m22:15:39.123962 [debug] [Thread-1 (]: Timing info for model.jaffle_shop.stg_customers (compile): 22:15:39.107944 => 22:15:39.123448
[0m22:15:39.124806 [debug] [Thread-2 (]: Timing info for model.jaffle_shop.stg_orders (compile): 22:15:39.117907 => 22:15:39.124385
[0m22:15:39.125550 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.stg_customers
[0m22:15:39.126174 [debug] [Thread-2 (]: Began executing node model.jaffle_shop.stg_orders
[0m22:15:39.188442 [debug] [Thread-1 (]: Dropping relation "RAW"."JAFFLE_SHOP"."STG_CUSTOMERS" because it is of type table
[0m22:15:39.191305 [debug] [Thread-2 (]: Dropping relation "RAW"."JAFFLE_SHOP"."STG_ORDERS" because it is of type table
[0m22:15:39.201666 [debug] [Thread-1 (]: Applying DROP to: "RAW"."JAFFLE_SHOP"."STG_CUSTOMERS"
[0m22:15:39.205770 [debug] [Thread-2 (]: Applying DROP to: "RAW"."JAFFLE_SHOP"."STG_ORDERS"
[0m22:15:39.216347 [debug] [Thread-1 (]: Using snowflake connection "model.jaffle_shop.stg_customers"
[0m22:15:39.218275 [debug] [Thread-2 (]: Using snowflake connection "model.jaffle_shop.stg_orders"
[0m22:15:39.219072 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */
drop table if exists "RAW"."JAFFLE_SHOP"."STG_CUSTOMERS" cascade
[0m22:15:39.219687 [debug] [Thread-2 (]: On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */
drop table if exists "RAW"."JAFFLE_SHOP"."STG_ORDERS" cascade
[0m22:15:39.220269 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:15:39.220816 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m22:15:39.646619 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m22:15:39.673091 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m22:15:39.674212 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.stg_customers"
[0m22:15:39.677019 [debug] [Thread-2 (]: Writing runtime sql for node "model.jaffle_shop.stg_orders"
[0m22:15:39.678679 [debug] [Thread-2 (]: Using snowflake connection "model.jaffle_shop.stg_orders"
[0m22:15:39.679683 [debug] [Thread-1 (]: Using snowflake connection "model.jaffle_shop.stg_customers"
[0m22:15:39.680326 [debug] [Thread-2 (]: On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */
create or replace   view RAW.JAFFLE_SHOP.stg_orders
  
   as (
    select
        id as order_id,
        user_id as customer_id,
        order_date,
        status

    from raw.jaffle_shop.raw_orders
  );
[0m22:15:39.680987 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */
create or replace   view RAW.JAFFLE_SHOP.stg_customers
  
   as (
    select
        id as customer_id,
        first_name,
        last_name

    from raw.jaffle_shop.raw_customers
  );
[0m22:15:39.811411 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m22:15:39.849363 [debug] [Thread-2 (]: Timing info for model.jaffle_shop.stg_orders (execute): 22:15:39.143669 => 22:15:39.848890
[0m22:15:39.850896 [debug] [Thread-2 (]: On model.jaffle_shop.stg_orders: Close
[0m22:15:39.875319 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m22:15:39.878928 [debug] [Thread-1 (]: Timing info for model.jaffle_shop.stg_customers (execute): 22:15:39.126558 => 22:15:39.878598
[0m22:15:39.879561 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: Close
[0m22:15:39.976391 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4b684fbd-85cc-4bfc-a08e-0407581c5339', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10742ac90>]}
[0m22:15:39.978019 [info ] [Thread-2 (]: 2 of 3 OK created sql view model JAFFLE_SHOP.stg_orders ........................ [[32mSUCCESS 1[0m in 0.87s]
[0m22:15:39.979551 [debug] [Thread-2 (]: Finished running node model.jaffle_shop.stg_orders
[0m22:15:39.994430 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4b684fbd-85cc-4bfc-a08e-0407581c5339', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10732af10>]}
[0m22:15:39.996635 [info ] [Thread-1 (]: 1 of 3 OK created sql view model JAFFLE_SHOP.stg_customers ..................... [[32mSUCCESS 1[0m in 0.89s]
[0m22:15:39.998708 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.stg_customers
[0m22:15:40.000006 [debug] [Thread-4 (]: Began running node model.jaffle_shop.customers
[0m22:15:40.001413 [info ] [Thread-4 (]: 3 of 3 START sql view model JAFFLE_SHOP.customers .............................. [RUN]
[0m22:15:40.003256 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.jaffle_shop.customers'
[0m22:15:40.004453 [debug] [Thread-4 (]: Began compiling node model.jaffle_shop.customers
[0m22:15:40.011281 [debug] [Thread-4 (]: Writing injected SQL for node "model.jaffle_shop.customers"
[0m22:15:40.012990 [debug] [Thread-4 (]: Timing info for model.jaffle_shop.customers (compile): 22:15:40.004896 => 22:15:40.012445
[0m22:15:40.014210 [debug] [Thread-4 (]: Began executing node model.jaffle_shop.customers
[0m22:15:40.019600 [debug] [Thread-4 (]: Writing runtime sql for node "model.jaffle_shop.customers"
[0m22:15:40.021984 [debug] [Thread-4 (]: Using snowflake connection "model.jaffle_shop.customers"
[0m22:15:40.022672 [debug] [Thread-4 (]: On model.jaffle_shop.customers: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.customers"} */
create or replace   view RAW.JAFFLE_SHOP.customers
  
   as (
    


with customers as (

    select * from RAW.JAFFLE_SHOP.stg_customers

),

orders as (

    select * from RAW.JAFFLE_SHOP.stg_orders

),

customer_orders as (

    select
        customer_id,

        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders

    from orders

    group by 1

),

final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce(customer_orders.number_of_orders, 0) as number_of_orders

    from customers

    left join customer_orders using (customer_id)

)

select * from final
  );
[0m22:15:40.023287 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m22:15:40.481644 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m22:15:40.490861 [debug] [Thread-4 (]: Timing info for model.jaffle_shop.customers (execute): 22:15:40.014784 => 22:15:40.490467
[0m22:15:40.491773 [debug] [Thread-4 (]: On model.jaffle_shop.customers: Close
[0m22:15:40.742203 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4b684fbd-85cc-4bfc-a08e-0407581c5339', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1075636d0>]}
[0m22:15:40.743880 [info ] [Thread-4 (]: 3 of 3 OK created sql view model JAFFLE_SHOP.customers ......................... [[32mSUCCESS 1[0m in 0.74s]
[0m22:15:40.745700 [debug] [Thread-4 (]: Finished running node model.jaffle_shop.customers
[0m22:15:40.749405 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:15:40.750136 [debug] [MainThread]: Connection 'model.jaffle_shop.stg_customers' was properly closed.
[0m22:15:40.750806 [debug] [MainThread]: Connection 'model.jaffle_shop.stg_orders' was properly closed.
[0m22:15:40.751462 [debug] [MainThread]: Connection 'model.jaffle_shop.customers' was properly closed.
[0m22:15:40.752208 [info ] [MainThread]: 
[0m22:15:40.752949 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 3.27 seconds (3.27s).
[0m22:15:40.754538 [debug] [MainThread]: Command end result
[0m22:15:40.771901 [info ] [MainThread]: 
[0m22:15:40.772613 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:15:40.773153 [info ] [MainThread]: 
[0m22:15:40.773717 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m22:15:40.775611 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 5.60529, "process_user_time": 5.639551, "process_kernel_time": 0.451393, "process_mem_max_rss": "139210752", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m22:15:40.777155 [debug] [MainThread]: Command `dbt run` succeeded at 22:15:40.776738 after 5.61 seconds
[0m22:15:40.778065 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063e3750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1022e4150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10236bc50>]}
[0m22:15:40.779130 [debug] [MainThread]: Flushing usage events
[0m22:17:38.822665 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112016590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111fdb490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111fda390>]}


============================== 22:17:38.829789 | 5a30c26f-1ba4-4078-a5d9-c202da1a507d ==============================
[0m22:17:38.829789 [info ] [MainThread]: Running with dbt=1.7.8
[0m22:17:38.830737 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/ben/jaffle_shop/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/ben/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m22:17:39.412439 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5a30c26f-1ba4-4078-a5d9-c202da1a507d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112763a90>]}
[0m22:17:39.542000 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5a30c26f-1ba4-4078-a5d9-c202da1a507d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1128e4910>]}
[0m22:17:39.543394 [info ] [MainThread]: Registered adapter: snowflake=1.7.2
[0m22:17:39.569392 [debug] [MainThread]: checksum: 67f0013ca5f0bd43af9a0873dd50792fde83ef69de63b71cacd0b4ac656c52e5, vars: {}, profile: , target: , version: 1.7.8
[0m22:17:39.619936 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m22:17:39.620983 [debug] [MainThread]: Partial parsing: updated file: jaffle_shop://models/staging/stg_orders.sql
[0m22:17:39.621678 [debug] [MainThread]: Partial parsing: updated file: jaffle_shop://models/staging/stg_customers.sql
[0m22:17:39.834518 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5a30c26f-1ba4-4078-a5d9-c202da1a507d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112b0bb90>]}
[0m22:17:39.851000 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5a30c26f-1ba4-4078-a5d9-c202da1a507d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112a58190>]}
[0m22:17:39.851874 [info ] [MainThread]: Found 3 models, 3 seeds, 0 sources, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m22:17:39.852516 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5a30c26f-1ba4-4078-a5d9-c202da1a507d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112957310>]}
[0m22:17:39.855158 [info ] [MainThread]: 
[0m22:17:39.856601 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m22:17:39.858385 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RAW'
[0m22:17:39.880837 [debug] [ThreadPool]: Using snowflake connection "list_RAW"
[0m22:17:39.881695 [debug] [ThreadPool]: On list_RAW: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_RAW"} */
show terse schemas in database RAW
    limit 10000
[0m22:17:39.882255 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:17:40.998705 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.0 seconds
[0m22:17:41.001748 [debug] [ThreadPool]: On list_RAW: Close
[0m22:17:41.132909 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RAW, now list_RAW_JAFFLE_SHOP)
[0m22:17:41.148996 [debug] [ThreadPool]: Using snowflake connection "list_RAW_JAFFLE_SHOP"
[0m22:17:41.149747 [debug] [ThreadPool]: On list_RAW_JAFFLE_SHOP: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_RAW_JAFFLE_SHOP"} */
show terse objects in RAW.JAFFLE_SHOP limit 10000
[0m22:17:41.150336 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:17:42.009322 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 1.0 seconds
[0m22:17:42.014246 [debug] [ThreadPool]: On list_RAW_JAFFLE_SHOP: Close
[0m22:17:42.150709 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5a30c26f-1ba4-4078-a5d9-c202da1a507d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112cbed50>]}
[0m22:17:42.152132 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:17:42.152773 [info ] [MainThread]: 
[0m22:17:42.156319 [debug] [Thread-1 (]: Began running node model.jaffle_shop.stg_customers
[0m22:17:42.157102 [debug] [Thread-2 (]: Began running node model.jaffle_shop.stg_orders
[0m22:17:42.157853 [info ] [Thread-1 (]: 1 of 3 START sql view model JAFFLE_SHOP.stg_customers .......................... [RUN]
[0m22:17:42.159184 [info ] [Thread-2 (]: 2 of 3 START sql view model JAFFLE_SHOP.stg_orders ............................. [RUN]
[0m22:17:42.161156 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_RAW_JAFFLE_SHOP, now model.jaffle_shop.stg_customers)
[0m22:17:42.162862 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.jaffle_shop.stg_orders'
[0m22:17:42.163620 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.stg_customers
[0m22:17:42.164642 [debug] [Thread-2 (]: Began compiling node model.jaffle_shop.stg_orders
[0m22:17:42.181953 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.stg_customers"
[0m22:17:42.186401 [debug] [Thread-2 (]: Writing injected SQL for node "model.jaffle_shop.stg_orders"
[0m22:17:42.188111 [debug] [Thread-2 (]: Timing info for model.jaffle_shop.stg_orders (compile): 22:17:42.182515 => 22:17:42.187682
[0m22:17:42.188885 [debug] [Thread-1 (]: Timing info for model.jaffle_shop.stg_customers (compile): 22:17:42.165834 => 22:17:42.188507
[0m22:17:42.189464 [debug] [Thread-2 (]: Began executing node model.jaffle_shop.stg_orders
[0m22:17:42.190046 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.stg_customers
[0m22:17:42.261395 [debug] [Thread-2 (]: Writing runtime sql for node "model.jaffle_shop.stg_orders"
[0m22:17:42.264997 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.stg_customers"
[0m22:17:42.266722 [debug] [Thread-1 (]: Using snowflake connection "model.jaffle_shop.stg_customers"
[0m22:17:42.267752 [debug] [Thread-2 (]: Using snowflake connection "model.jaffle_shop.stg_orders"
[0m22:17:42.268319 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */
create or replace   view RAW.JAFFLE_SHOP.stg_customers
  
   as (
    

select
    id as customer_id,
    first_name,
    last_name

from raw.jaffle_shop.raw_customers
  );
[0m22:17:42.268938 [debug] [Thread-2 (]: On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */
create or replace   view RAW.JAFFLE_SHOP.stg_orders
  
   as (
    

select
    id as order_id,
    user_id as customer_id,
    order_date,
    status

from raw.jaffle_shop.raw_orders
  );
[0m22:17:42.269601 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:17:42.270218 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m22:17:43.083734 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m22:17:43.106046 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m22:17:43.145513 [debug] [Thread-1 (]: Timing info for model.jaffle_shop.stg_customers (execute): 22:17:42.214996 => 22:17:43.144817
[0m22:17:43.146996 [debug] [Thread-2 (]: Timing info for model.jaffle_shop.stg_orders (execute): 22:17:42.190428 => 22:17:43.146626
[0m22:17:43.147646 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: Close
[0m22:17:43.148382 [debug] [Thread-2 (]: On model.jaffle_shop.stg_orders: Close
[0m22:17:43.340193 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5a30c26f-1ba4-4078-a5d9-c202da1a507d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112b31cd0>]}
[0m22:17:43.342100 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5a30c26f-1ba4-4078-a5d9-c202da1a507d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112ca38d0>]}
[0m22:17:43.343467 [info ] [Thread-2 (]: 2 of 3 OK created sql view model JAFFLE_SHOP.stg_orders ........................ [[32mSUCCESS 1[0m in 1.18s]
[0m22:17:43.344658 [info ] [Thread-1 (]: 1 of 3 OK created sql view model JAFFLE_SHOP.stg_customers ..................... [[32mSUCCESS 1[0m in 1.18s]
[0m22:17:43.345746 [debug] [Thread-2 (]: Finished running node model.jaffle_shop.stg_orders
[0m22:17:43.346666 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.stg_customers
[0m22:17:43.348219 [debug] [Thread-4 (]: Began running node model.jaffle_shop.customers
[0m22:17:43.349162 [info ] [Thread-4 (]: 3 of 3 START sql view model JAFFLE_SHOP.customers .............................. [RUN]
[0m22:17:43.350623 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.jaffle_shop.customers'
[0m22:17:43.351412 [debug] [Thread-4 (]: Began compiling node model.jaffle_shop.customers
[0m22:17:43.357851 [debug] [Thread-4 (]: Writing injected SQL for node "model.jaffle_shop.customers"
[0m22:17:43.360167 [debug] [Thread-4 (]: Timing info for model.jaffle_shop.customers (compile): 22:17:43.351829 => 22:17:43.359639
[0m22:17:43.360863 [debug] [Thread-4 (]: Began executing node model.jaffle_shop.customers
[0m22:17:43.366311 [debug] [Thread-4 (]: Writing runtime sql for node "model.jaffle_shop.customers"
[0m22:17:43.368700 [debug] [Thread-4 (]: Using snowflake connection "model.jaffle_shop.customers"
[0m22:17:43.369346 [debug] [Thread-4 (]: On model.jaffle_shop.customers: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.customers"} */
create or replace   view RAW.JAFFLE_SHOP.customers
  
   as (
    


with customers as (

    select * from RAW.JAFFLE_SHOP.stg_customers

),

orders as (

    select * from RAW.JAFFLE_SHOP.stg_orders

),

customer_orders as (

    select
        customer_id,

        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders

    from orders

    group by 1

),

final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce(customer_orders.number_of_orders, 0) as number_of_orders

    from customers

    left join customer_orders using (customer_id)

)

select * from final
  );
[0m22:17:43.369935 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m22:17:44.076343 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m22:17:44.083900 [debug] [Thread-4 (]: Timing info for model.jaffle_shop.customers (execute): 22:17:43.361246 => 22:17:44.083367
[0m22:17:44.084891 [debug] [Thread-4 (]: On model.jaffle_shop.customers: Close
[0m22:17:44.285363 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5a30c26f-1ba4-4078-a5d9-c202da1a507d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112c369d0>]}
[0m22:17:44.286456 [info ] [Thread-4 (]: 3 of 3 OK created sql view model JAFFLE_SHOP.customers ......................... [[32mSUCCESS 1[0m in 0.94s]
[0m22:17:44.287425 [debug] [Thread-4 (]: Finished running node model.jaffle_shop.customers
[0m22:17:44.290089 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:17:44.290628 [debug] [MainThread]: Connection 'model.jaffle_shop.stg_customers' was properly closed.
[0m22:17:44.291109 [debug] [MainThread]: Connection 'model.jaffle_shop.stg_orders' was properly closed.
[0m22:17:44.291571 [debug] [MainThread]: Connection 'model.jaffle_shop.customers' was properly closed.
[0m22:17:44.292277 [info ] [MainThread]: 
[0m22:17:44.293329 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 4.44 seconds (4.44s).
[0m22:17:44.295128 [debug] [MainThread]: Command end result
[0m22:17:44.308608 [info ] [MainThread]: 
[0m22:17:44.309717 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:17:44.310400 [info ] [MainThread]: 
[0m22:17:44.311688 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m22:17:44.313909 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 5.582401, "process_user_time": 4.710201, "process_kernel_time": 0.483853, "process_mem_max_rss": "138313728", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m22:17:44.314868 [debug] [MainThread]: Command `dbt run` succeeded at 22:17:44.314641 after 5.58 seconds
[0m22:17:44.316304 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112027b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112025090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112c84450>]}
[0m22:17:44.317541 [debug] [MainThread]: Flushing usage events
[0m22:18:31.355068 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1091a4290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109250dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1091ca110>]}


============================== 22:18:31.362458 | 0ccc3ed3-d6d9-4e4b-bacc-daa4d8a2ecba ==============================
[0m22:18:31.362458 [info ] [MainThread]: Running with dbt=1.7.8
[0m22:18:31.363531 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/ben/jaffle_shop/logs', 'profiles_dir': '/Users/ben/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --select staging', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m22:18:31.978829 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0ccc3ed3-d6d9-4e4b-bacc-daa4d8a2ecba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a104410>]}
[0m22:18:32.118632 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0ccc3ed3-d6d9-4e4b-bacc-daa4d8a2ecba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a0e9b90>]}
[0m22:18:32.119872 [info ] [MainThread]: Registered adapter: snowflake=1.7.2
[0m22:18:32.148843 [debug] [MainThread]: checksum: 67f0013ca5f0bd43af9a0873dd50792fde83ef69de63b71cacd0b4ac656c52e5, vars: {}, profile: , target: , version: 1.7.8
[0m22:18:32.201747 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:18:32.202421 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:18:32.212309 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0ccc3ed3-d6d9-4e4b-bacc-daa4d8a2ecba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a258390>]}
[0m22:18:32.228546 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0ccc3ed3-d6d9-4e4b-bacc-daa4d8a2ecba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109842dd0>]}
[0m22:18:32.229400 [info ] [MainThread]: Found 3 models, 3 seeds, 0 sources, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m22:18:32.230492 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0ccc3ed3-d6d9-4e4b-bacc-daa4d8a2ecba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10986c210>]}
[0m22:18:32.234187 [info ] [MainThread]: 
[0m22:18:32.236300 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m22:18:32.239054 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RAW'
[0m22:18:32.267105 [debug] [ThreadPool]: Using snowflake connection "list_RAW"
[0m22:18:32.267827 [debug] [ThreadPool]: On list_RAW: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_RAW"} */
show terse schemas in database RAW
    limit 10000
[0m22:18:32.268377 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:18:33.019484 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.0 seconds
[0m22:18:33.025733 [debug] [ThreadPool]: On list_RAW: Close
[0m22:18:33.150832 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RAW, now list_RAW_JAFFLE_SHOP)
[0m22:18:33.163918 [debug] [ThreadPool]: Using snowflake connection "list_RAW_JAFFLE_SHOP"
[0m22:18:33.164640 [debug] [ThreadPool]: On list_RAW_JAFFLE_SHOP: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_RAW_JAFFLE_SHOP"} */
show terse objects in RAW.JAFFLE_SHOP limit 10000
[0m22:18:33.165180 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:18:33.539792 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 0.0 seconds
[0m22:18:33.545279 [debug] [ThreadPool]: On list_RAW_JAFFLE_SHOP: Close
[0m22:18:33.671680 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0ccc3ed3-d6d9-4e4b-bacc-daa4d8a2ecba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10947a190>]}
[0m22:18:33.673705 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:18:33.674574 [info ] [MainThread]: 
[0m22:18:33.679633 [debug] [Thread-1 (]: Began running node model.jaffle_shop.stg_customers
[0m22:18:33.680648 [debug] [Thread-2 (]: Began running node model.jaffle_shop.stg_orders
[0m22:18:33.681526 [info ] [Thread-1 (]: 1 of 2 START sql view model JAFFLE_SHOP.stg_customers .......................... [RUN]
[0m22:18:33.682542 [info ] [Thread-2 (]: 2 of 2 START sql view model JAFFLE_SHOP.stg_orders ............................. [RUN]
[0m22:18:33.683936 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_RAW_JAFFLE_SHOP, now model.jaffle_shop.stg_customers)
[0m22:18:33.685323 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.jaffle_shop.stg_orders'
[0m22:18:33.686055 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.stg_customers
[0m22:18:33.686721 [debug] [Thread-2 (]: Began compiling node model.jaffle_shop.stg_orders
[0m22:18:33.699409 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.stg_customers"
[0m22:18:33.704067 [debug] [Thread-2 (]: Writing injected SQL for node "model.jaffle_shop.stg_orders"
[0m22:18:33.705553 [debug] [Thread-1 (]: Timing info for model.jaffle_shop.stg_customers (compile): 22:18:33.687344 => 22:18:33.705029
[0m22:18:33.706401 [debug] [Thread-2 (]: Timing info for model.jaffle_shop.stg_orders (compile): 22:18:33.700064 => 22:18:33.705997
[0m22:18:33.707544 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.stg_customers
[0m22:18:33.708291 [debug] [Thread-2 (]: Began executing node model.jaffle_shop.stg_orders
[0m22:18:33.785723 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.stg_customers"
[0m22:18:33.790019 [debug] [Thread-2 (]: Writing runtime sql for node "model.jaffle_shop.stg_orders"
[0m22:18:33.791784 [debug] [Thread-1 (]: Using snowflake connection "model.jaffle_shop.stg_customers"
[0m22:18:33.792472 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */
create or replace   view RAW.JAFFLE_SHOP.stg_customers
  
   as (
    

select
    id as customer_id,
    first_name,
    last_name

from raw.jaffle_shop.raw_customers
  );
[0m22:18:33.793503 [debug] [Thread-2 (]: Using snowflake connection "model.jaffle_shop.stg_orders"
[0m22:18:33.794068 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:18:33.794801 [debug] [Thread-2 (]: On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */
create or replace   view RAW.JAFFLE_SHOP.stg_orders
  
   as (
    

select
    id as order_id,
    user_id as customer_id,
    order_date,
    status

from raw.jaffle_shop.raw_orders
  );
[0m22:18:33.797412 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m22:18:34.256468 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m22:18:34.259700 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m22:18:34.313185 [debug] [Thread-2 (]: Timing info for model.jaffle_shop.stg_orders (execute): 22:18:33.722274 => 22:18:34.312824
[0m22:18:34.315435 [debug] [Thread-1 (]: Timing info for model.jaffle_shop.stg_customers (execute): 22:18:33.708737 => 22:18:34.314699
[0m22:18:34.316072 [debug] [Thread-2 (]: On model.jaffle_shop.stg_orders: Close
[0m22:18:34.316748 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: Close
[0m22:18:34.457374 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0ccc3ed3-d6d9-4e4b-bacc-daa4d8a2ecba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a325b90>]}
[0m22:18:34.460752 [info ] [Thread-2 (]: 2 of 2 OK created sql view model JAFFLE_SHOP.stg_orders ........................ [[32mSUCCESS 1[0m in 0.77s]
[0m22:18:34.464616 [debug] [Thread-2 (]: Finished running node model.jaffle_shop.stg_orders
[0m22:18:34.506719 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0ccc3ed3-d6d9-4e4b-bacc-daa4d8a2ecba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a3526d0>]}
[0m22:18:34.508691 [info ] [Thread-1 (]: 1 of 2 OK created sql view model JAFFLE_SHOP.stg_customers ..................... [[32mSUCCESS 1[0m in 0.82s]
[0m22:18:34.510939 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.stg_customers
[0m22:18:34.514178 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:18:34.514865 [debug] [MainThread]: Connection 'model.jaffle_shop.stg_customers' was properly closed.
[0m22:18:34.515662 [debug] [MainThread]: Connection 'model.jaffle_shop.stg_orders' was properly closed.
[0m22:18:34.516455 [info ] [MainThread]: 
[0m22:18:34.517227 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 2.28 seconds (2.28s).
[0m22:18:34.518990 [debug] [MainThread]: Command end result
[0m22:18:34.533701 [info ] [MainThread]: 
[0m22:18:34.534407 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:18:34.534957 [info ] [MainThread]: 
[0m22:18:34.535736 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m22:18:34.538108 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 3.288478, "process_user_time": 4.268011, "process_kernel_time": 0.445554, "process_mem_max_rss": "134578176", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m22:18:34.539210 [debug] [MainThread]: Command `dbt run` succeeded at 22:18:34.538959 after 3.29 seconds
[0m22:18:34.539892 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109485e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109496090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1092869d0>]}
[0m22:18:34.540554 [debug] [MainThread]: Flushing usage events
[0m22:20:03.915815 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a162550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a788950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a364950>]}


============================== 22:20:03.922147 | 713cc71d-8080-4c68-8ef3-c65ae651c4c2 ==============================
[0m22:20:03.922147 [info ] [MainThread]: Running with dbt=1.7.8
[0m22:20:03.923144 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/ben/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/ben/jaffle_shop/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt test', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:20:04.500273 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '713cc71d-8080-4c68-8ef3-c65ae651c4c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b0c5110>]}
[0m22:20:04.638919 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '713cc71d-8080-4c68-8ef3-c65ae651c4c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ab58750>]}
[0m22:20:04.640131 [info ] [MainThread]: Registered adapter: snowflake=1.7.2
[0m22:20:04.668565 [debug] [MainThread]: checksum: 67f0013ca5f0bd43af9a0873dd50792fde83ef69de63b71cacd0b4ac656c52e5, vars: {}, profile: , target: , version: 1.7.8
[0m22:20:04.723504 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m22:20:04.724722 [debug] [MainThread]: Partial parsing: added file: jaffle_shop://models/schema.yml
[0m22:20:05.034268 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '713cc71d-8080-4c68-8ef3-c65ae651c4c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b439b50>]}
[0m22:20:05.052258 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '713cc71d-8080-4c68-8ef3-c65ae651c4c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b3c8050>]}
[0m22:20:05.053085 [info ] [MainThread]: Found 3 models, 3 seeds, 9 tests, 0 sources, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m22:20:05.053712 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '713cc71d-8080-4c68-8ef3-c65ae651c4c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b121f90>]}
[0m22:20:05.057332 [info ] [MainThread]: 
[0m22:20:05.058800 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m22:20:05.061092 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RAW_JAFFLE_SHOP'
[0m22:20:05.088829 [debug] [ThreadPool]: Using snowflake connection "list_RAW_JAFFLE_SHOP"
[0m22:20:05.089541 [debug] [ThreadPool]: On list_RAW_JAFFLE_SHOP: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_RAW_JAFFLE_SHOP"} */
show terse objects in RAW.JAFFLE_SHOP limit 10000
[0m22:20:05.090253 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:20:06.005739 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 1.0 seconds
[0m22:20:06.011278 [debug] [ThreadPool]: On list_RAW_JAFFLE_SHOP: Close
[0m22:20:06.157966 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '713cc71d-8080-4c68-8ef3-c65ae651c4c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b462f90>]}
[0m22:20:06.159319 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:20:06.159971 [info ] [MainThread]: 
[0m22:20:06.166181 [debug] [Thread-1 (]: Began running node test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad
[0m22:20:06.167504 [debug] [Thread-2 (]: Began running node test.jaffle_shop.not_null_customers_customer_id.5c9bf9911d
[0m22:20:06.168674 [debug] [Thread-3 (]: Began running node test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m22:20:06.170761 [debug] [Thread-4 (]: Began running node test.jaffle_shop.not_null_stg_orders_customer_id.af79d5e4b5
[0m22:20:06.170009 [info ] [Thread-1 (]: 1 of 9 START test accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned  [RUN]
[0m22:20:06.172034 [info ] [Thread-2 (]: 2 of 9 START test not_null_customers_customer_id ............................... [RUN]
[0m22:20:06.173002 [info ] [Thread-3 (]: 3 of 9 START test not_null_stg_customers_customer_id ........................... [RUN]
[0m22:20:06.174601 [info ] [Thread-4 (]: 4 of 9 START test not_null_stg_orders_customer_id .............................. [RUN]
[0m22:20:06.176554 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_RAW_JAFFLE_SHOP, now test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad)
[0m22:20:06.177924 [debug] [Thread-2 (]: Acquiring new snowflake connection 'test.jaffle_shop.not_null_customers_customer_id.5c9bf9911d'
[0m22:20:06.179114 [debug] [Thread-3 (]: Acquiring new snowflake connection 'test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa'
[0m22:20:06.180545 [debug] [Thread-4 (]: Acquiring new snowflake connection 'test.jaffle_shop.not_null_stg_orders_customer_id.af79d5e4b5'
[0m22:20:06.181429 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad
[0m22:20:06.182173 [debug] [Thread-2 (]: Began compiling node test.jaffle_shop.not_null_customers_customer_id.5c9bf9911d
[0m22:20:06.182965 [debug] [Thread-3 (]: Began compiling node test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m22:20:06.183779 [debug] [Thread-4 (]: Began compiling node test.jaffle_shop.not_null_stg_orders_customer_id.af79d5e4b5
[0m22:20:06.199230 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad"
[0m22:20:06.214861 [debug] [Thread-2 (]: Writing injected SQL for node "test.jaffle_shop.not_null_customers_customer_id.5c9bf9911d"
[0m22:20:06.222211 [debug] [Thread-3 (]: Writing injected SQL for node "test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m22:20:06.229044 [debug] [Thread-4 (]: Writing injected SQL for node "test.jaffle_shop.not_null_stg_orders_customer_id.af79d5e4b5"
[0m22:20:06.230914 [debug] [Thread-2 (]: Timing info for test.jaffle_shop.not_null_customers_customer_id.5c9bf9911d (compile): 22:20:06.199672 => 22:20:06.230482
[0m22:20:06.231717 [debug] [Thread-1 (]: Timing info for test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad (compile): 22:20:06.184256 => 22:20:06.231306
[0m22:20:06.232818 [debug] [Thread-3 (]: Timing info for test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa (compile): 22:20:06.215393 => 22:20:06.232314
[0m22:20:06.233696 [debug] [Thread-2 (]: Began executing node test.jaffle_shop.not_null_customers_customer_id.5c9bf9911d
[0m22:20:06.234645 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad
[0m22:20:06.235514 [debug] [Thread-4 (]: Timing info for test.jaffle_shop.not_null_stg_orders_customer_id.af79d5e4b5 (compile): 22:20:06.222744 => 22:20:06.235114
[0m22:20:06.236064 [debug] [Thread-3 (]: Began executing node test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m22:20:06.278033 [debug] [Thread-4 (]: Began executing node test.jaffle_shop.not_null_stg_orders_customer_id.af79d5e4b5
[0m22:20:06.295495 [debug] [Thread-2 (]: Writing runtime sql for node "test.jaffle_shop.not_null_customers_customer_id.5c9bf9911d"
[0m22:20:06.294470 [debug] [Thread-1 (]: Writing runtime sql for node "test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad"
[0m22:20:06.300469 [debug] [Thread-3 (]: Writing runtime sql for node "test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m22:20:06.305130 [debug] [Thread-4 (]: Writing runtime sql for node "test.jaffle_shop.not_null_stg_orders_customer_id.af79d5e4b5"
[0m22:20:06.307485 [debug] [Thread-1 (]: Using snowflake connection "test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad"
[0m22:20:06.308825 [debug] [Thread-2 (]: Using snowflake connection "test.jaffle_shop.not_null_customers_customer_id.5c9bf9911d"
[0m22:20:06.310126 [debug] [Thread-1 (]: On test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        status as value_field,
        count(*) as n_records

    from RAW.JAFFLE_SHOP.stg_orders
    group by status

)

select *
from all_values
where value_field not in (
    'placed','shipped','completed','return_pending','returned'
)



      
    ) dbt_internal_test
[0m22:20:06.310943 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_customers_customer_id.5c9bf9911d: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_customers_customer_id.5c9bf9911d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from RAW.JAFFLE_SHOP.customers
where customer_id is null



      
    ) dbt_internal_test
[0m22:20:06.312085 [debug] [Thread-3 (]: Using snowflake connection "test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa"
[0m22:20:06.313060 [debug] [Thread-4 (]: Using snowflake connection "test.jaffle_shop.not_null_stg_orders_customer_id.af79d5e4b5"
[0m22:20:06.313651 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:20:06.314306 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m22:20:06.314996 [debug] [Thread-3 (]: On test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from RAW.JAFFLE_SHOP.stg_customers
where customer_id is null



      
    ) dbt_internal_test
[0m22:20:06.315750 [debug] [Thread-4 (]: On test.jaffle_shop.not_null_stg_orders_customer_id.af79d5e4b5: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_stg_orders_customer_id.af79d5e4b5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from RAW.JAFFLE_SHOP.stg_orders
where customer_id is null



      
    ) dbt_internal_test
[0m22:20:06.321036 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m22:20:06.321816 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m22:20:06.802210 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m22:20:06.818105 [debug] [Thread-3 (]: Timing info for test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa (execute): 22:20:06.296161 => 22:20:06.817507
[0m22:20:06.819096 [debug] [Thread-3 (]: On test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa: Close
[0m22:20:06.954980 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m22:20:06.960850 [debug] [Thread-2 (]: Timing info for test.jaffle_shop.not_null_customers_customer_id.5c9bf9911d (execute): 22:20:06.236467 => 22:20:06.960214
[0m22:20:06.963114 [info ] [Thread-3 (]: 3 of 9 PASS not_null_stg_customers_customer_id ................................. [[32mPASS[0m in 0.78s]
[0m22:20:06.964291 [debug] [Thread-2 (]: On test.jaffle_shop.not_null_customers_customer_id.5c9bf9911d: Close
[0m22:20:06.965777 [debug] [Thread-3 (]: Finished running node test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa
[0m22:20:06.968704 [debug] [Thread-3 (]: Began running node test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64
[0m22:20:06.970506 [info ] [Thread-3 (]: 5 of 9 START test not_null_stg_orders_order_id ................................. [RUN]
[0m22:20:06.972342 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.jaffle_shop.not_null_stg_customers_customer_id.e2cfb1f9aa, now test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64)
[0m22:20:06.973702 [debug] [Thread-3 (]: Began compiling node test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64
[0m22:20:06.985053 [debug] [Thread-3 (]: Writing injected SQL for node "test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64"
[0m22:20:06.987147 [debug] [Thread-3 (]: Timing info for test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64 (compile): 22:20:06.974818 => 22:20:06.986644
[0m22:20:06.987859 [debug] [Thread-3 (]: Began executing node test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64
[0m22:20:06.994986 [debug] [Thread-3 (]: Writing runtime sql for node "test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64"
[0m22:20:06.997156 [debug] [Thread-3 (]: Using snowflake connection "test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64"
[0m22:20:06.998304 [debug] [Thread-3 (]: On test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select order_id
from RAW.JAFFLE_SHOP.stg_orders
where order_id is null



      
    ) dbt_internal_test
[0m22:20:06.999506 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m22:20:07.104827 [info ] [Thread-2 (]: 2 of 9 PASS not_null_customers_customer_id ..................................... [[32mPASS[0m in 0.93s]
[0m22:20:07.106540 [debug] [Thread-2 (]: Finished running node test.jaffle_shop.not_null_customers_customer_id.5c9bf9911d
[0m22:20:07.107702 [debug] [Thread-2 (]: Began running node test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m22:20:07.108835 [info ] [Thread-2 (]: 6 of 9 START test relationships_stg_orders_customer_id__customer_id__ref_stg_customers_  [RUN]
[0m22:20:07.111051 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.jaffle_shop.not_null_customers_customer_id.5c9bf9911d, now test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500)
[0m22:20:07.112331 [debug] [Thread-2 (]: Began compiling node test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m22:20:07.128512 [debug] [Thread-2 (]: Writing injected SQL for node "test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"
[0m22:20:07.130482 [debug] [Thread-2 (]: Timing info for test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500 (compile): 22:20:07.113210 => 22:20:07.129814
[0m22:20:07.131745 [debug] [Thread-2 (]: Began executing node test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m22:20:07.140963 [debug] [Thread-2 (]: Writing runtime sql for node "test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"
[0m22:20:07.144415 [debug] [Thread-2 (]: Using snowflake connection "test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"
[0m22:20:07.145933 [debug] [Thread-2 (]: On test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select customer_id as from_field
    from RAW.JAFFLE_SHOP.stg_orders
    where customer_id is not null
),

parent as (
    select customer_id as to_field
    from RAW.JAFFLE_SHOP.stg_customers
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m22:20:07.147142 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:20:07.291273 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m22:20:07.296796 [debug] [Thread-4 (]: Timing info for test.jaffle_shop.not_null_stg_orders_customer_id.af79d5e4b5 (execute): 22:20:06.301053 => 22:20:07.296130
[0m22:20:07.297888 [debug] [Thread-4 (]: On test.jaffle_shop.not_null_stg_orders_customer_id.af79d5e4b5: Close
[0m22:20:07.437019 [info ] [Thread-4 (]: 4 of 9 PASS not_null_stg_orders_customer_id .................................... [[32mPASS[0m in 1.26s]
[0m22:20:07.438682 [debug] [Thread-4 (]: Finished running node test.jaffle_shop.not_null_stg_orders_customer_id.af79d5e4b5
[0m22:20:07.439761 [debug] [Thread-4 (]: Began running node test.jaffle_shop.unique_customers_customer_id.c5af1ff4b1
[0m22:20:07.440653 [info ] [Thread-4 (]: 7 of 9 START test unique_customers_customer_id ................................. [RUN]
[0m22:20:07.442204 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.jaffle_shop.not_null_stg_orders_customer_id.af79d5e4b5, now test.jaffle_shop.unique_customers_customer_id.c5af1ff4b1)
[0m22:20:07.443041 [debug] [Thread-4 (]: Began compiling node test.jaffle_shop.unique_customers_customer_id.c5af1ff4b1
[0m22:20:07.457109 [debug] [Thread-4 (]: Writing injected SQL for node "test.jaffle_shop.unique_customers_customer_id.c5af1ff4b1"
[0m22:20:07.458500 [debug] [Thread-4 (]: Timing info for test.jaffle_shop.unique_customers_customer_id.c5af1ff4b1 (compile): 22:20:07.443542 => 22:20:07.458077
[0m22:20:07.459138 [debug] [Thread-4 (]: Began executing node test.jaffle_shop.unique_customers_customer_id.c5af1ff4b1
[0m22:20:07.464006 [debug] [Thread-4 (]: Writing runtime sql for node "test.jaffle_shop.unique_customers_customer_id.c5af1ff4b1"
[0m22:20:07.469514 [debug] [Thread-4 (]: Using snowflake connection "test.jaffle_shop.unique_customers_customer_id.c5af1ff4b1"
[0m22:20:07.471096 [debug] [Thread-4 (]: On test.jaffle_shop.unique_customers_customer_id.c5af1ff4b1: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.unique_customers_customer_id.c5af1ff4b1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    customer_id as unique_field,
    count(*) as n_records

from RAW.JAFFLE_SHOP.customers
where customer_id is not null
group by customer_id
having count(*) > 1



      
    ) dbt_internal_test
[0m22:20:07.471876 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m22:20:07.534368 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m22:20:07.537523 [debug] [Thread-1 (]: Timing info for test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad (execute): 22:20:06.242397 => 22:20:07.537124
[0m22:20:07.538797 [debug] [Thread-1 (]: On test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad: Close
[0m22:20:07.539992 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m22:20:07.544121 [debug] [Thread-3 (]: Timing info for test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64 (execute): 22:20:06.988270 => 22:20:07.543738
[0m22:20:07.545018 [debug] [Thread-3 (]: On test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64: Close
[0m22:20:07.676368 [info ] [Thread-1 (]: 1 of 9 PASS accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned  [[32mPASS[0m in 1.50s]
[0m22:20:07.677753 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad
[0m22:20:07.678567 [debug] [Thread-1 (]: Began running node test.jaffle_shop.unique_stg_customers_customer_id.c7614daada
[0m22:20:07.679742 [info ] [Thread-1 (]: 8 of 9 START test unique_stg_customers_customer_id ............................. [RUN]
[0m22:20:07.681120 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned.080fb20aad, now test.jaffle_shop.unique_stg_customers_customer_id.c7614daada)
[0m22:20:07.681837 [debug] [Thread-1 (]: Began compiling node test.jaffle_shop.unique_stg_customers_customer_id.c7614daada
[0m22:20:07.689601 [debug] [Thread-1 (]: Writing injected SQL for node "test.jaffle_shop.unique_stg_customers_customer_id.c7614daada"
[0m22:20:07.692506 [debug] [Thread-1 (]: Timing info for test.jaffle_shop.unique_stg_customers_customer_id.c7614daada (compile): 22:20:07.682401 => 22:20:07.692033
[0m22:20:07.693181 [debug] [Thread-1 (]: Began executing node test.jaffle_shop.unique_stg_customers_customer_id.c7614daada
[0m22:20:07.697698 [debug] [Thread-1 (]: Writing runtime sql for node "test.jaffle_shop.unique_stg_customers_customer_id.c7614daada"
[0m22:20:07.699252 [info ] [Thread-3 (]: 5 of 9 PASS not_null_stg_orders_order_id ....................................... [[32mPASS[0m in 0.73s]
[0m22:20:07.700665 [debug] [Thread-3 (]: Finished running node test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64
[0m22:20:07.702339 [debug] [Thread-1 (]: Using snowflake connection "test.jaffle_shop.unique_stg_customers_customer_id.c7614daada"
[0m22:20:07.703514 [debug] [Thread-3 (]: Began running node test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a
[0m22:20:07.704666 [debug] [Thread-1 (]: On test.jaffle_shop.unique_stg_customers_customer_id.c7614daada: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.unique_stg_customers_customer_id.c7614daada"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    customer_id as unique_field,
    count(*) as n_records

from RAW.JAFFLE_SHOP.stg_customers
where customer_id is not null
group by customer_id
having count(*) > 1



      
    ) dbt_internal_test
[0m22:20:07.705674 [info ] [Thread-3 (]: 9 of 9 START test unique_stg_orders_order_id ................................... [RUN]
[0m22:20:07.706382 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:20:07.707409 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.jaffle_shop.not_null_stg_orders_order_id.81cfe2fe64, now test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a)
[0m22:20:07.709375 [debug] [Thread-3 (]: Began compiling node test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a
[0m22:20:07.716052 [debug] [Thread-3 (]: Writing injected SQL for node "test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a"
[0m22:20:07.718434 [debug] [Thread-3 (]: Timing info for test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a (compile): 22:20:07.709919 => 22:20:07.717935
[0m22:20:07.719226 [debug] [Thread-3 (]: Began executing node test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a
[0m22:20:07.724542 [debug] [Thread-3 (]: Writing runtime sql for node "test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a"
[0m22:20:07.727549 [debug] [Thread-3 (]: Using snowflake connection "test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a"
[0m22:20:07.728576 [debug] [Thread-3 (]: On test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    order_id as unique_field,
    count(*) as n_records

from RAW.JAFFLE_SHOP.stg_orders
where order_id is not null
group by order_id
having count(*) > 1



      
    ) dbt_internal_test
[0m22:20:07.729454 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m22:20:08.246709 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m22:20:08.252877 [debug] [Thread-2 (]: Timing info for test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500 (execute): 22:20:07.132633 => 22:20:08.252060
[0m22:20:08.253928 [debug] [Thread-2 (]: On test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500: Close
[0m22:20:08.341147 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m22:20:08.343386 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m22:20:08.348327 [debug] [Thread-1 (]: Timing info for test.jaffle_shop.unique_stg_customers_customer_id.c7614daada (execute): 22:20:07.693559 => 22:20:08.347741
[0m22:20:08.352901 [debug] [Thread-4 (]: Timing info for test.jaffle_shop.unique_customers_customer_id.c5af1ff4b1 (execute): 22:20:07.459509 => 22:20:08.352202
[0m22:20:08.353929 [debug] [Thread-1 (]: On test.jaffle_shop.unique_stg_customers_customer_id.c7614daada: Close
[0m22:20:08.354747 [debug] [Thread-4 (]: On test.jaffle_shop.unique_customers_customer_id.c5af1ff4b1: Close
[0m22:20:08.360023 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m22:20:08.364808 [debug] [Thread-3 (]: Timing info for test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a (execute): 22:20:07.719915 => 22:20:08.364317
[0m22:20:08.366144 [debug] [Thread-3 (]: On test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a: Close
[0m22:20:08.374020 [info ] [Thread-2 (]: 6 of 9 PASS relationships_stg_orders_customer_id__customer_id__ref_stg_customers_  [[32mPASS[0m in 1.26s]
[0m22:20:08.375084 [debug] [Thread-2 (]: Finished running node test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500
[0m22:20:08.501250 [info ] [Thread-1 (]: 8 of 9 PASS unique_stg_customers_customer_id ................................... [[32mPASS[0m in 0.82s]
[0m22:20:08.503437 [info ] [Thread-4 (]: 7 of 9 PASS unique_customers_customer_id ....................................... [[32mPASS[0m in 1.06s]
[0m22:20:08.505105 [info ] [Thread-3 (]: 9 of 9 PASS unique_stg_orders_order_id ......................................... [[32mPASS[0m in 0.80s]
[0m22:20:08.506597 [debug] [Thread-1 (]: Finished running node test.jaffle_shop.unique_stg_customers_customer_id.c7614daada
[0m22:20:08.507655 [debug] [Thread-4 (]: Finished running node test.jaffle_shop.unique_customers_customer_id.c5af1ff4b1
[0m22:20:08.508659 [debug] [Thread-3 (]: Finished running node test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a
[0m22:20:08.512480 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:20:08.513161 [debug] [MainThread]: Connection 'test.jaffle_shop.unique_stg_customers_customer_id.c7614daada' was properly closed.
[0m22:20:08.513809 [debug] [MainThread]: Connection 'test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_.430bf21500' was properly closed.
[0m22:20:08.514720 [debug] [MainThread]: Connection 'test.jaffle_shop.unique_stg_orders_order_id.e3b841c71a' was properly closed.
[0m22:20:08.516369 [debug] [MainThread]: Connection 'test.jaffle_shop.unique_customers_customer_id.c5af1ff4b1' was properly closed.
[0m22:20:08.517116 [info ] [MainThread]: 
[0m22:20:08.518052 [info ] [MainThread]: Finished running 9 tests in 0 hours 0 minutes and 3.46 seconds (3.46s).
[0m22:20:08.521085 [debug] [MainThread]: Command end result
[0m22:20:08.534929 [info ] [MainThread]: 
[0m22:20:08.535732 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:20:08.536340 [info ] [MainThread]: 
[0m22:20:08.536929 [info ] [MainThread]: Done. PASS=9 WARN=0 ERROR=0 SKIP=0 TOTAL=9
[0m22:20:08.539065 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 4.7072005, "process_user_time": 5.164863, "process_kernel_time": 0.518576, "process_mem_max_rss": "141516800", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m22:20:08.540429 [debug] [MainThread]: Command `dbt test` succeeded at 22:20:08.540085 after 4.71 seconds
[0m22:20:08.541818 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109bf8950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a7a1810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10648bd10>]}
[0m22:20:08.542745 [debug] [MainThread]: Flushing usage events
[0m18:18:04.194598 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b296210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10af43b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10af41b10>]}


============================== 18:18:04.204016 | 8b1729bd-0be9-454f-9800-6cf9db51c255 ==============================
[0m18:18:04.204016 [info ] [MainThread]: Running with dbt=1.7.8
[0m18:18:04.205281 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/Users/ben/.dbt', 'log_path': '/Users/ben/jaffle_shop/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt debug', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:18:04.206333 [info ] [MainThread]: dbt version: 1.7.8
[0m18:18:04.207189 [info ] [MainThread]: python version: 3.11.0
[0m18:18:04.207805 [info ] [MainThread]: python path: /Users/ben/dbt-env/bin/python
[0m18:18:04.208332 [info ] [MainThread]: os info: macOS-14.4.1-x86_64-i386-64bit
[0m18:18:04.212649 [info ] [MainThread]: target not specified in profile 'jaffle_shop', using 'default'
[0m18:18:04.213361 [info ] [MainThread]: Using profiles dir at /Users/ben/.dbt
[0m18:18:04.213728 [info ] [MainThread]: Using profiles.yml file at /Users/ben/.dbt/profiles.yml
[0m18:18:04.214136 [info ] [MainThread]: Using dbt_project.yml file at /Users/ben/jaffle_shop/dbt_project.yml
[0m18:18:04.297235 [info ] [MainThread]: Configuration:
[0m18:18:04.297975 [info ] [MainThread]:   profiles.yml file [[31mERROR invalid[0m]
[0m18:18:04.298373 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m18:18:04.298732 [info ] [MainThread]: Required dependencies:
[0m18:18:04.299137 [debug] [MainThread]: Executing "git --help"
[0m18:18:04.321725 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m18:18:04.322776 [debug] [MainThread]: STDERR: "b''"
[0m18:18:04.323360 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m18:18:04.323982 [info ] [MainThread]: Connection test skipped since no profile was found
[0m18:18:04.324530 [info ] [MainThread]: [31m1 check failed:[0m
[0m18:18:04.324917 [info ] [MainThread]: Profile loading failed for the following reason:
Runtime Error
  The profile 'jaffle_shop' does not have a target named 'default'. The valid target names for this profile are:
   - dev
   - target


[0m18:18:04.327977 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_wall_clock_time": 0.1950578, "process_user_time": 2.066583, "process_kernel_time": 0.368206, "process_mem_max_rss": "105406464", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m18:18:04.328763 [debug] [MainThread]: Command `dbt debug` failed at 18:18:04.328578 after 0.20 seconds
[0m18:18:04.329341 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10af55990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f9fc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ac502d0>]}
[0m18:18:04.330089 [debug] [MainThread]: Flushing usage events
[0m18:29:06.338307 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104db5e90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b13cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b122d0>]}


============================== 18:29:06.346165 | 6164382a-a800-40b8-9b89-04a8fbf0fab1 ==============================
[0m18:29:06.346165 [info ] [MainThread]: Running with dbt=1.7.8
[0m18:29:06.347196 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/ben/jaffle_shop/logs', 'version_check': 'True', 'profiles_dir': '/Users/ben/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt debug', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:29:06.348073 [info ] [MainThread]: dbt version: 1.7.8
[0m18:29:06.348845 [info ] [MainThread]: python version: 3.11.0
[0m18:29:06.349350 [info ] [MainThread]: python path: /Users/ben/dbt-env/bin/python
[0m18:29:06.349784 [info ] [MainThread]: os info: macOS-14.4.1-x86_64-i386-64bit
[0m18:29:06.353418 [info ] [MainThread]: target not specified in profile 'jaffle_shop', using 'default'
[0m18:29:06.354179 [info ] [MainThread]: Using profiles dir at /Users/ben/.dbt
[0m18:29:06.354818 [info ] [MainThread]: Using profiles.yml file at /Users/ben/.dbt/profiles.yml
[0m18:29:06.355439 [info ] [MainThread]: Using dbt_project.yml file at /Users/ben/jaffle_shop/dbt_project.yml
[0m18:29:06.435828 [info ] [MainThread]: Configuration:
[0m18:29:06.436423 [info ] [MainThread]:   profiles.yml file [[31mERROR invalid[0m]
[0m18:29:06.437081 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m18:29:06.437494 [info ] [MainThread]: Required dependencies:
[0m18:29:06.438309 [debug] [MainThread]: Executing "git --help"
[0m18:29:06.459432 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m18:29:06.460348 [debug] [MainThread]: STDERR: "b''"
[0m18:29:06.460825 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m18:29:06.461294 [info ] [MainThread]: Connection test skipped since no profile was found
[0m18:29:06.461797 [info ] [MainThread]: [31m1 check failed:[0m
[0m18:29:06.462153 [info ] [MainThread]: Profile loading failed for the following reason:
Runtime Error
  The profile 'jaffle_shop' does not have a target named 'default'. The valid target names for this profile are:
   - dev
   - target


[0m18:29:06.465818 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_wall_clock_time": 0.18716818, "process_user_time": 2.103107, "process_kernel_time": 0.330942, "process_mem_max_rss": "106414080", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m18:29:06.467064 [debug] [MainThread]: Command `dbt debug` failed at 18:29:06.466799 after 0.19 seconds
[0m18:29:06.467926 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104de4890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104de4d50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104dab810>]}
[0m18:29:06.468758 [debug] [MainThread]: Flushing usage events
[0m18:33:15.100619 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1061ce310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e53dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e53c90>]}


============================== 18:33:15.108548 | faa2871d-5886-446d-b1b0-10c948eefc0f ==============================
[0m18:33:15.108548 [info ] [MainThread]: Running with dbt=1.7.8
[0m18:33:15.109511 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/Users/ben/.dbt', 'log_path': '/Users/ben/jaffle_shop/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt debug', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m18:33:15.110169 [info ] [MainThread]: dbt version: 1.7.8
[0m18:33:15.110603 [info ] [MainThread]: python version: 3.11.0
[0m18:33:15.111005 [info ] [MainThread]: python path: /Users/ben/dbt-env/bin/python
[0m18:33:15.111394 [info ] [MainThread]: os info: macOS-14.4.1-x86_64-i386-64bit
[0m18:33:15.115383 [info ] [MainThread]: target not specified in profile 'jaffle_shop', using 'default'
[0m18:33:15.115998 [info ] [MainThread]: Using profiles dir at /Users/ben/.dbt
[0m18:33:15.116343 [info ] [MainThread]: Using profiles.yml file at /Users/ben/.dbt/profiles.yml
[0m18:33:15.116805 [info ] [MainThread]: Using dbt_project.yml file at /Users/ben/jaffle_shop/dbt_project.yml
[0m18:33:15.199543 [info ] [MainThread]: Configuration:
[0m18:33:15.200037 [info ] [MainThread]:   profiles.yml file [[31mERROR invalid[0m]
[0m18:33:15.200385 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m18:33:15.200711 [info ] [MainThread]: Required dependencies:
[0m18:33:15.201102 [debug] [MainThread]: Executing "git --help"
[0m18:33:15.221993 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m18:33:15.222998 [debug] [MainThread]: STDERR: "b''"
[0m18:33:15.223704 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m18:33:15.224213 [info ] [MainThread]: Connection test skipped since no profile was found
[0m18:33:15.224611 [info ] [MainThread]: [31m1 check failed:[0m
[0m18:33:15.224933 [info ] [MainThread]: Profile loading failed for the following reason:
Runtime Error
  The profile 'jaffle_shop' does not have a target named 'default'. The valid target names for this profile are:
   - dev
   - target


[0m18:33:15.228083 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_wall_clock_time": 0.19188273, "process_user_time": 2.111473, "process_kernel_time": 0.31717, "process_mem_max_rss": "105521152", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m18:33:15.228873 [debug] [MainThread]: Command `dbt debug` failed at 18:33:15.228641 after 0.19 seconds
[0m18:33:15.229403 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1058ccf90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10621d850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x101ec4610>]}
[0m18:33:15.229904 [debug] [MainThread]: Flushing usage events
[0m18:33:45.163226 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114295210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113f60690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113f60c90>]}


============================== 18:33:45.167684 | 3b1ebf03-a011-41c9-90c7-626cb1c41f15 ==============================
[0m18:33:45.167684 [info ] [MainThread]: Running with dbt=1.7.8
[0m18:33:45.168339 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/Users/ben/.dbt', 'log_path': '/Users/ben/jaffle_shop/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt debug', 'send_anonymous_usage_stats': 'True'}
[0m18:33:45.168978 [info ] [MainThread]: dbt version: 1.7.8
[0m18:33:45.169444 [info ] [MainThread]: python version: 3.11.0
[0m18:33:45.169821 [info ] [MainThread]: python path: /Users/ben/dbt-env/bin/python
[0m18:33:45.170275 [info ] [MainThread]: os info: macOS-14.4.1-x86_64-i386-64bit
[0m18:33:45.605554 [info ] [MainThread]: Using profiles dir at /Users/ben/.dbt
[0m18:33:45.606063 [info ] [MainThread]: Using profiles.yml file at /Users/ben/.dbt/profiles.yml
[0m18:33:45.606481 [info ] [MainThread]: Using dbt_project.yml file at /Users/ben/jaffle_shop/dbt_project.yml
[0m18:33:45.607616 [info ] [MainThread]: adapter type: snowflake
[0m18:33:45.607964 [info ] [MainThread]: adapter version: 1.7.2
[0m18:33:45.748069 [info ] [MainThread]: Configuration:
[0m18:33:45.748657 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m18:33:45.749034 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m18:33:45.749395 [info ] [MainThread]: Required dependencies:
[0m18:33:45.749863 [debug] [MainThread]: Executing "git --help"
[0m18:33:45.774963 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m18:33:45.775798 [debug] [MainThread]: STDERR: "b''"
[0m18:33:45.776204 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m18:33:45.776558 [info ] [MainThread]: Connection:
[0m18:33:45.777025 [info ] [MainThread]:   account: admwhpm-kn63693
[0m18:33:45.777458 [info ] [MainThread]:   user: dbt
[0m18:33:45.778162 [info ] [MainThread]:   database: RAW
[0m18:33:45.778617 [info ] [MainThread]:   warehouse: COMPUTE_WH
[0m18:33:45.779064 [info ] [MainThread]:   role: transform
[0m18:33:45.779465 [info ] [MainThread]:   schema: JAFFLE_SHOP
[0m18:33:45.779849 [info ] [MainThread]:   authenticator: None
[0m18:33:45.780161 [info ] [MainThread]:   private_key_path: None
[0m18:33:45.780461 [info ] [MainThread]:   oauth_client_id: None
[0m18:33:45.780768 [info ] [MainThread]:   query_tag: None
[0m18:33:45.781093 [info ] [MainThread]:   client_session_keep_alive: False
[0m18:33:45.781404 [info ] [MainThread]:   host: None
[0m18:33:45.781798 [info ] [MainThread]:   port: None
[0m18:33:45.782312 [info ] [MainThread]:   proxy_host: None
[0m18:33:45.782687 [info ] [MainThread]:   proxy_port: None
[0m18:33:45.783005 [info ] [MainThread]:   protocol: None
[0m18:33:45.783350 [info ] [MainThread]:   connect_retries: 1
[0m18:33:45.783655 [info ] [MainThread]:   connect_timeout: None
[0m18:33:45.783972 [info ] [MainThread]:   retry_on_database_errors: False
[0m18:33:45.784313 [info ] [MainThread]:   retry_all: False
[0m18:33:45.784619 [info ] [MainThread]:   insecure_mode: False
[0m18:33:45.784985 [info ] [MainThread]:   reuse_connections: None
[0m18:33:45.785569 [info ] [MainThread]: Registered adapter: snowflake=1.7.2
[0m18:33:45.797060 [debug] [MainThread]: Acquiring new snowflake connection 'debug'
[0m18:33:45.798896 [debug] [MainThread]: Using snowflake connection "debug"
[0m18:33:45.799334 [debug] [MainThread]: On debug: select 1 as id
[0m18:33:45.799677 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:33:47.052501 [debug] [MainThread]: SQL status: SUCCESS 1 in 1.0 seconds
[0m18:33:47.055763 [debug] [MainThread]: On debug: Close
[0m18:33:47.206836 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m18:33:47.208307 [info ] [MainThread]: [32mAll checks passed![0m
[0m18:33:47.211708 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 2.1093545, "process_user_time": 2.573031, "process_kernel_time": 0.320785, "process_mem_max_rss": "129560576", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m18:33:47.213085 [debug] [MainThread]: Command `dbt debug` succeeded at 18:33:47.212746 after 2.11 seconds
[0m18:33:47.213955 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m18:33:47.214849 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1142a6510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1142e6c90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113c94290>]}
[0m18:33:47.215818 [debug] [MainThread]: Flushing usage events
[0m18:33:54.539703 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11212e050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1121408d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111af5f50>]}


============================== 18:33:54.544091 | 49a748c5-62bd-4a80-87ee-10a34f65c6e7 ==============================
[0m18:33:54.544091 [info ] [MainThread]: Running with dbt=1.7.8
[0m18:33:54.544708 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/ben/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/ben/jaffle_shop/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m18:33:54.928613 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '49a748c5-62bd-4a80-87ee-10a34f65c6e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111db8cd0>]}
[0m18:33:55.017472 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '49a748c5-62bd-4a80-87ee-10a34f65c6e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11281f990>]}
[0m18:33:55.018568 [info ] [MainThread]: Registered adapter: snowflake=1.7.2
[0m18:33:55.039223 [debug] [MainThread]: checksum: 67f0013ca5f0bd43af9a0873dd50792fde83ef69de63b71cacd0b4ac656c52e5, vars: {}, profile: , target: , version: 1.7.8
[0m18:33:55.054131 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m18:33:55.054754 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '49a748c5-62bd-4a80-87ee-10a34f65c6e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1129b11d0>]}
[0m18:33:56.242998 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '49a748c5-62bd-4a80-87ee-10a34f65c6e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112bdce10>]}
[0m18:33:56.256299 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '49a748c5-62bd-4a80-87ee-10a34f65c6e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112fac7d0>]}
[0m18:33:56.256953 [info ] [MainThread]: Found 3 models, 3 seeds, 9 tests, 0 sources, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m18:33:56.257408 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '49a748c5-62bd-4a80-87ee-10a34f65c6e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112bd62d0>]}
[0m18:33:56.259367 [info ] [MainThread]: 
[0m18:33:56.260437 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m18:33:56.261961 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RAW'
[0m18:33:56.275801 [debug] [ThreadPool]: Using snowflake connection "list_RAW"
[0m18:33:56.276401 [debug] [ThreadPool]: On list_RAW: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_RAW"} */
show terse schemas in database RAW
    limit 10000
[0m18:33:56.276788 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:33:56.837809 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.0 seconds
[0m18:33:56.841709 [debug] [ThreadPool]: On list_RAW: Close
[0m18:33:57.007585 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RAW, now list_RAW_JAFFLE_SHOP)
[0m18:33:57.026291 [debug] [ThreadPool]: Using snowflake connection "list_RAW_JAFFLE_SHOP"
[0m18:33:57.046216 [debug] [ThreadPool]: On list_RAW_JAFFLE_SHOP: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_RAW_JAFFLE_SHOP"} */
show terse objects in RAW.JAFFLE_SHOP limit 10000
[0m18:33:57.047590 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:33:57.599636 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 1.0 seconds
[0m18:33:57.603791 [debug] [ThreadPool]: On list_RAW_JAFFLE_SHOP: Close
[0m18:33:57.753687 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '49a748c5-62bd-4a80-87ee-10a34f65c6e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112ec8fd0>]}
[0m18:33:57.756233 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:33:57.757344 [info ] [MainThread]: 
[0m18:33:57.763087 [debug] [Thread-1 (]: Began running node model.jaffle_shop.stg_customers
[0m18:33:57.764235 [debug] [Thread-2 (]: Began running node model.jaffle_shop.stg_orders
[0m18:33:57.765252 [info ] [Thread-1 (]: 1 of 3 START sql view model JAFFLE_SHOP.stg_customers .......................... [RUN]
[0m18:33:57.766372 [info ] [Thread-2 (]: 2 of 3 START sql view model JAFFLE_SHOP.stg_orders ............................. [RUN]
[0m18:33:57.768049 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_RAW_JAFFLE_SHOP, now model.jaffle_shop.stg_customers)
[0m18:33:57.769622 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.jaffle_shop.stg_orders'
[0m18:33:57.770415 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.stg_customers
[0m18:33:57.771127 [debug] [Thread-2 (]: Began compiling node model.jaffle_shop.stg_orders
[0m18:33:57.782653 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.stg_customers"
[0m18:33:57.786232 [debug] [Thread-2 (]: Writing injected SQL for node "model.jaffle_shop.stg_orders"
[0m18:33:57.787360 [debug] [Thread-1 (]: Timing info for model.jaffle_shop.stg_customers (compile): 18:33:57.771540 => 18:33:57.787051
[0m18:33:57.787972 [debug] [Thread-2 (]: Timing info for model.jaffle_shop.stg_orders (compile): 18:33:57.783157 => 18:33:57.787662
[0m18:33:57.788425 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.stg_customers
[0m18:33:57.788892 [debug] [Thread-2 (]: Began executing node model.jaffle_shop.stg_orders
[0m18:33:57.897511 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.stg_customers"
[0m18:33:57.901775 [debug] [Thread-2 (]: Writing runtime sql for node "model.jaffle_shop.stg_orders"
[0m18:33:57.902831 [debug] [Thread-2 (]: Using snowflake connection "model.jaffle_shop.stg_orders"
[0m18:33:57.903252 [debug] [Thread-2 (]: On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */
create or replace   view RAW.JAFFLE_SHOP.stg_orders
  
   as (
    

select
    id as order_id,
    user_id as customer_id,
    order_date,
    status

from raw.jaffle_shop.raw_orders
  );
[0m18:33:57.903676 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m18:33:57.905026 [debug] [Thread-1 (]: Using snowflake connection "model.jaffle_shop.stg_customers"
[0m18:33:57.905437 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */
create or replace   view RAW.JAFFLE_SHOP.stg_customers
  
   as (
    

select
    id as customer_id,
    first_name,
    last_name

from raw.jaffle_shop.raw_customers
  );
[0m18:33:57.905806 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:33:58.439194 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b3a689-0001-c86a-0005-81260003d04a
[0m18:33:58.440002 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 002003 (42S02): SQL compilation error:
Object 'RAW.JAFFLE_SHOP.RAW_CUSTOMERS' does not exist or not authorized.
[0m18:33:58.440991 [debug] [Thread-1 (]: Timing info for model.jaffle_shop.stg_customers (execute): 18:33:57.789192 => 18:33:58.440604
[0m18:33:58.441663 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: Close
[0m18:33:58.546024 [debug] [Thread-2 (]: Snowflake adapter: Snowflake query id: 01b3a689-0001-c890-0005-81260003b052
[0m18:33:58.547372 [debug] [Thread-2 (]: Snowflake adapter: Snowflake error: 002003 (42S02): SQL compilation error:
Object 'RAW.JAFFLE_SHOP.RAW_ORDERS' does not exist or not authorized.
[0m18:33:58.549013 [debug] [Thread-2 (]: Timing info for model.jaffle_shop.stg_orders (execute): 18:33:57.812473 => 18:33:58.548365
[0m18:33:58.550137 [debug] [Thread-2 (]: On model.jaffle_shop.stg_orders: Close
[0m18:33:58.597246 [debug] [Thread-1 (]: Database Error in model stg_customers (models/staging/stg_customers.sql)
  002003 (42S02): SQL compilation error:
  Object 'RAW.JAFFLE_SHOP.RAW_CUSTOMERS' does not exist or not authorized.
  compiled Code at target/run/jaffle_shop/models/staging/stg_customers.sql
[0m18:33:58.598675 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '49a748c5-62bd-4a80-87ee-10a34f65c6e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112f604d0>]}
[0m18:33:58.600079 [error] [Thread-1 (]: 1 of 3 ERROR creating sql view model JAFFLE_SHOP.stg_customers ................. [[31mERROR[0m in 0.83s]
[0m18:33:58.601282 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.stg_customers
[0m18:33:58.704758 [debug] [Thread-2 (]: Database Error in model stg_orders (models/staging/stg_orders.sql)
  002003 (42S02): SQL compilation error:
  Object 'RAW.JAFFLE_SHOP.RAW_ORDERS' does not exist or not authorized.
  compiled Code at target/run/jaffle_shop/models/staging/stg_orders.sql
[0m18:33:58.706128 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '49a748c5-62bd-4a80-87ee-10a34f65c6e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1129c3a10>]}
[0m18:33:58.707462 [error] [Thread-2 (]: 2 of 3 ERROR creating sql view model JAFFLE_SHOP.stg_orders .................... [[31mERROR[0m in 0.94s]
[0m18:33:58.708845 [debug] [Thread-2 (]: Finished running node model.jaffle_shop.stg_orders
[0m18:33:58.710244 [debug] [Thread-4 (]: Began running node model.jaffle_shop.customers
[0m18:33:58.711872 [info ] [Thread-4 (]: 3 of 3 SKIP relation JAFFLE_SHOP.customers ..................................... [[33mSKIP[0m]
[0m18:33:58.713063 [debug] [Thread-4 (]: Finished running node model.jaffle_shop.customers
[0m18:33:58.716728 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:33:58.717540 [debug] [MainThread]: Connection 'model.jaffle_shop.stg_customers' was properly closed.
[0m18:33:58.718094 [debug] [MainThread]: Connection 'model.jaffle_shop.stg_orders' was properly closed.
[0m18:33:58.718699 [info ] [MainThread]: 
[0m18:33:58.719311 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 2.46 seconds (2.46s).
[0m18:33:58.720655 [debug] [MainThread]: Command end result
[0m18:33:58.734401 [info ] [MainThread]: 
[0m18:33:58.735222 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m18:33:58.736539 [info ] [MainThread]: 
[0m18:33:58.737325 [error] [MainThread]:   Database Error in model stg_customers (models/staging/stg_customers.sql)
  002003 (42S02): SQL compilation error:
  Object 'RAW.JAFFLE_SHOP.RAW_CUSTOMERS' does not exist or not authorized.
  compiled Code at target/run/jaffle_shop/models/staging/stg_customers.sql
[0m18:33:58.737840 [info ] [MainThread]: 
[0m18:33:58.738274 [error] [MainThread]:   Database Error in model stg_orders (models/staging/stg_orders.sql)
  002003 (42S02): SQL compilation error:
  Object 'RAW.JAFFLE_SHOP.RAW_ORDERS' does not exist or not authorized.
  compiled Code at target/run/jaffle_shop/models/staging/stg_orders.sql
[0m18:33:58.738714 [info ] [MainThread]: 
[0m18:33:58.739154 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=2 SKIP=1 TOTAL=3
[0m18:33:58.741366 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 4.264904, "process_user_time": 4.054611, "process_kernel_time": 0.341287, "process_mem_max_rss": "141553664", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m18:33:58.742352 [debug] [MainThread]: Command `dbt run` failed at 18:33:58.742148 after 4.27 seconds
[0m18:33:58.742919 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111af5f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111d0cb90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11212d890>]}
[0m18:33:58.743419 [debug] [MainThread]: Flushing usage events
[0m18:36:03.205430 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c591490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c8e7bd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c8dd190>]}


============================== 18:36:03.210762 | 5745ec60-59c2-4305-893e-23505e4391e2 ==============================
[0m18:36:03.210762 [info ] [MainThread]: Running with dbt=1.7.8
[0m18:36:03.211383 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/ben/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/Users/ben/jaffle_shop/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt seed', 'send_anonymous_usage_stats': 'True'}
[0m18:36:03.584336 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5745ec60-59c2-4305-893e-23505e4391e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d0e3c90>]}
[0m18:36:03.669623 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5745ec60-59c2-4305-893e-23505e4391e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c2d9110>]}
[0m18:36:03.670475 [info ] [MainThread]: Registered adapter: snowflake=1.7.2
[0m18:36:03.689858 [debug] [MainThread]: checksum: 67f0013ca5f0bd43af9a0873dd50792fde83ef69de63b71cacd0b4ac656c52e5, vars: {}, profile: , target: , version: 1.7.8
[0m18:36:03.742286 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:36:03.742748 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:36:03.750261 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5745ec60-59c2-4305-893e-23505e4391e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d398d90>]}
[0m18:36:03.762972 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5745ec60-59c2-4305-893e-23505e4391e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d391850>]}
[0m18:36:03.763517 [info ] [MainThread]: Found 3 models, 3 seeds, 9 tests, 0 sources, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m18:36:03.763909 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5745ec60-59c2-4305-893e-23505e4391e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d1022d0>]}
[0m18:36:03.765917 [info ] [MainThread]: 
[0m18:36:03.766802 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m18:36:03.768250 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RAW'
[0m18:36:03.784073 [debug] [ThreadPool]: Using snowflake connection "list_RAW"
[0m18:36:03.784635 [debug] [ThreadPool]: On list_RAW: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_RAW"} */
show terse schemas in database RAW
    limit 10000
[0m18:36:03.785072 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:36:04.523097 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.0 seconds
[0m18:36:04.529154 [debug] [ThreadPool]: On list_RAW: Close
[0m18:36:04.676981 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RAW, now list_RAW_JAFFLE_SHOP)
[0m18:36:04.693542 [debug] [ThreadPool]: Using snowflake connection "list_RAW_JAFFLE_SHOP"
[0m18:36:04.694243 [debug] [ThreadPool]: On list_RAW_JAFFLE_SHOP: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_RAW_JAFFLE_SHOP"} */
show terse objects in RAW.JAFFLE_SHOP limit 10000
[0m18:36:04.694784 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:36:05.217684 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 1.0 seconds
[0m18:36:05.222267 [debug] [ThreadPool]: On list_RAW_JAFFLE_SHOP: Close
[0m18:36:05.378787 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5745ec60-59c2-4305-893e-23505e4391e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b74fd90>]}
[0m18:36:05.381247 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:36:05.382240 [info ] [MainThread]: 
[0m18:36:05.387788 [debug] [Thread-1 (]: Began running node seed.jaffle_shop.raw_customers
[0m18:36:05.389014 [info ] [Thread-1 (]: 1 of 3 START seed file JAFFLE_SHOP.raw_customers ............................... [RUN]
[0m18:36:05.390058 [debug] [Thread-2 (]: Began running node seed.jaffle_shop.raw_orders
[0m18:36:05.391375 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_RAW_JAFFLE_SHOP, now seed.jaffle_shop.raw_customers)
[0m18:36:05.392230 [debug] [Thread-3 (]: Began running node seed.jaffle_shop.raw_payments
[0m18:36:05.393536 [info ] [Thread-2 (]: 2 of 3 START seed file JAFFLE_SHOP.raw_orders .................................. [RUN]
[0m18:36:05.394617 [debug] [Thread-1 (]: Began compiling node seed.jaffle_shop.raw_customers
[0m18:36:05.395603 [info ] [Thread-3 (]: 3 of 3 START seed file JAFFLE_SHOP.raw_payments ................................ [RUN]
[0m18:36:05.397247 [debug] [Thread-2 (]: Acquiring new snowflake connection 'seed.jaffle_shop.raw_orders'
[0m18:36:05.398348 [debug] [Thread-1 (]: Timing info for seed.jaffle_shop.raw_customers (compile): 18:36:05.397925 => 18:36:05.397934
[0m18:36:05.399605 [debug] [Thread-3 (]: Acquiring new snowflake connection 'seed.jaffle_shop.raw_payments'
[0m18:36:05.400322 [debug] [Thread-2 (]: Began compiling node seed.jaffle_shop.raw_orders
[0m18:36:05.401016 [debug] [Thread-1 (]: Began executing node seed.jaffle_shop.raw_customers
[0m18:36:05.401654 [debug] [Thread-3 (]: Began compiling node seed.jaffle_shop.raw_payments
[0m18:36:05.402314 [debug] [Thread-2 (]: Timing info for seed.jaffle_shop.raw_orders (compile): 18:36:05.402007 => 18:36:05.402010
[0m18:36:05.420404 [debug] [Thread-3 (]: Timing info for seed.jaffle_shop.raw_payments (compile): 18:36:05.420060 => 18:36:05.420066
[0m18:36:05.445889 [debug] [Thread-2 (]: Began executing node seed.jaffle_shop.raw_orders
[0m18:36:05.448068 [debug] [Thread-1 (]: Using snowflake connection "seed.jaffle_shop.raw_customers"
[0m18:36:05.448532 [debug] [Thread-3 (]: Began executing node seed.jaffle_shop.raw_payments
[0m18:36:05.452079 [debug] [Thread-1 (]: On seed.jaffle_shop.raw_customers: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_customers"} */
create table RAW.JAFFLE_SHOP.raw_customers (id integer,first_name text,last_name text)
[0m18:36:05.456556 [debug] [Thread-2 (]: Using snowflake connection "seed.jaffle_shop.raw_orders"
[0m18:36:05.463119 [debug] [Thread-3 (]: Using snowflake connection "seed.jaffle_shop.raw_payments"
[0m18:36:05.463527 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:36:05.463909 [debug] [Thread-2 (]: On seed.jaffle_shop.raw_orders: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_orders"} */
create table RAW.JAFFLE_SHOP.raw_orders (id integer,user_id integer,order_date date,status text)
[0m18:36:05.464280 [debug] [Thread-3 (]: On seed.jaffle_shop.raw_payments: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_payments"} */
create table RAW.JAFFLE_SHOP.raw_payments (id integer,order_id integer,payment_method text,amount integer)
[0m18:36:05.466138 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m18:36:05.466633 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m18:36:06.125900 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m18:36:06.152970 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m18:36:06.157522 [debug] [Thread-1 (]: Using snowflake connection "seed.jaffle_shop.raw_customers"
[0m18:36:06.161673 [debug] [Thread-3 (]: Using snowflake connection "seed.jaffle_shop.raw_payments"
[0m18:36:06.162229 [debug] [Thread-1 (]: On seed.jaffle_shop.raw_customers: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_customers"} */
BEGIN
[0m18:36:06.162706 [debug] [Thread-3 (]: On seed.jaffle_shop.raw_payments: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_payments"} */
BEGIN
[0m18:36:06.190902 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m18:36:06.196200 [debug] [Thread-2 (]: Using snowflake connection "seed.jaffle_shop.raw_orders"
[0m18:36:06.196802 [debug] [Thread-2 (]: On seed.jaffle_shop.raw_orders: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_orders"} */
BEGIN
[0m18:36:06.292699 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m18:36:06.299568 [debug] [Thread-1 (]: Using snowflake connection "seed.jaffle_shop.raw_customers"
[0m18:36:06.300663 [debug] [Thread-1 (]: On seed.jaffle_shop.raw_customers: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_customers"} */
insert into RAW.JAFFLE_SHOP.raw_customers (id, first_name, last_name) values
            (%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%...
[0m18:36:06.302829 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m18:36:06.310827 [debug] [Thread-3 (]: Using snowflake connection "seed.jaffle_shop.raw_payments"
[0m18:36:06.312426 [debug] [Thread-3 (]: On seed.jaffle_shop.raw_payments: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_payments"} */
insert into RAW.JAFFLE_SHOP.raw_payments (id, order_id, payment_method, amount) values
            (%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%...
[0m18:36:06.325223 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m18:36:06.329952 [debug] [Thread-2 (]: Using snowflake connection "seed.jaffle_shop.raw_orders"
[0m18:36:06.330681 [debug] [Thread-2 (]: On seed.jaffle_shop.raw_orders: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_orders"} */
insert into RAW.JAFFLE_SHOP.raw_orders (id, user_id, order_date, status) values
            (%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),(%s,%s,%s,%s),...
[0m18:36:07.236797 [debug] [Thread-3 (]: SQL status: SUCCESS 113 in 1.0 seconds
[0m18:36:07.238392 [debug] [Thread-3 (]: Using snowflake connection "seed.jaffle_shop.raw_payments"
[0m18:36:07.239483 [debug] [Thread-3 (]: On seed.jaffle_shop.raw_payments: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_payments"} */
COMMIT
[0m18:36:07.259630 [debug] [Thread-2 (]: SQL status: SUCCESS 99 in 1.0 seconds
[0m18:36:07.260949 [debug] [Thread-2 (]: Using snowflake connection "seed.jaffle_shop.raw_orders"
[0m18:36:07.261832 [debug] [Thread-2 (]: On seed.jaffle_shop.raw_orders: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_orders"} */
COMMIT
[0m18:36:07.277100 [debug] [Thread-1 (]: SQL status: SUCCESS 100 in 1.0 seconds
[0m18:36:07.278681 [debug] [Thread-1 (]: Using snowflake connection "seed.jaffle_shop.raw_customers"
[0m18:36:07.279810 [debug] [Thread-1 (]: On seed.jaffle_shop.raw_customers: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "seed.jaffle_shop.raw_customers"} */
COMMIT
[0m18:36:07.509415 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m18:36:07.524878 [debug] [Thread-3 (]: Writing runtime SQL for node "seed.jaffle_shop.raw_payments"
[0m18:36:07.534008 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m18:36:07.547973 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.jaffle_shop.raw_customers"
[0m18:36:07.554440 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m18:36:07.561198 [debug] [Thread-3 (]: Timing info for seed.jaffle_shop.raw_payments (execute): 18:36:05.456917 => 18:36:07.560959
[0m18:36:07.562711 [debug] [Thread-2 (]: Writing runtime SQL for node "seed.jaffle_shop.raw_orders"
[0m18:36:07.563306 [debug] [Thread-3 (]: On seed.jaffle_shop.raw_payments: Close
[0m18:36:07.567145 [debug] [Thread-1 (]: Timing info for seed.jaffle_shop.raw_customers (execute): 18:36:05.402655 => 18:36:07.566897
[0m18:36:07.569677 [debug] [Thread-1 (]: On seed.jaffle_shop.raw_customers: Close
[0m18:36:07.573653 [debug] [Thread-2 (]: Timing info for seed.jaffle_shop.raw_orders (execute): 18:36:05.448784 => 18:36:07.573413
[0m18:36:07.576263 [debug] [Thread-2 (]: On seed.jaffle_shop.raw_orders: Close
[0m18:36:07.721790 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5745ec60-59c2-4305-893e-23505e4391e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d5952d0>]}
[0m18:36:07.723532 [info ] [Thread-1 (]: 1 of 3 OK loaded seed file JAFFLE_SHOP.raw_customers ........................... [[32mINSERT 100[0m in 2.33s]
[0m18:36:07.725399 [debug] [Thread-1 (]: Finished running node seed.jaffle_shop.raw_customers
[0m18:36:07.737158 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5745ec60-59c2-4305-893e-23505e4391e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d411990>]}
[0m18:36:07.738354 [info ] [Thread-3 (]: 3 of 3 OK loaded seed file JAFFLE_SHOP.raw_payments ............................ [[32mINSERT 113[0m in 2.34s]
[0m18:36:07.740200 [debug] [Thread-3 (]: Finished running node seed.jaffle_shop.raw_payments
[0m18:36:07.746426 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5745ec60-59c2-4305-893e-23505e4391e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d67d6d0>]}
[0m18:36:07.747501 [info ] [Thread-2 (]: 2 of 3 OK loaded seed file JAFFLE_SHOP.raw_orders .............................. [[32mINSERT 99[0m in 2.35s]
[0m18:36:07.748548 [debug] [Thread-2 (]: Finished running node seed.jaffle_shop.raw_orders
[0m18:36:07.751668 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:36:07.752249 [debug] [MainThread]: Connection 'seed.jaffle_shop.raw_customers' was properly closed.
[0m18:36:07.752869 [debug] [MainThread]: Connection 'seed.jaffle_shop.raw_orders' was properly closed.
[0m18:36:07.753369 [debug] [MainThread]: Connection 'seed.jaffle_shop.raw_payments' was properly closed.
[0m18:36:07.754207 [info ] [MainThread]: 
[0m18:36:07.754976 [info ] [MainThread]: Finished running 3 seeds in 0 hours 0 minutes and 3.99 seconds (3.99s).
[0m18:36:07.756494 [debug] [MainThread]: Command end result
[0m18:36:07.767623 [info ] [MainThread]: 
[0m18:36:07.768146 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:36:07.768706 [info ] [MainThread]: 
[0m18:36:07.769490 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m18:36:07.773414 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": true, "command_wall_clock_time": 4.633335, "process_user_time": 3.126695, "process_kernel_time": 0.352954, "process_mem_max_rss": "137961472", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m18:36:07.774433 [debug] [MainThread]: Command `dbt seed` succeeded at 18:36:07.774220 after 4.63 seconds
[0m18:36:07.774947 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c2737d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c34ad10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108697d10>]}
[0m18:36:07.775437 [debug] [MainThread]: Flushing usage events
[0m18:36:14.410061 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fb47390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fb6b910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11017fd50>]}


============================== 18:36:14.414895 | eda3d1e5-0bcc-445c-8a39-1d0b5bb64bf3 ==============================
[0m18:36:14.414895 [info ] [MainThread]: Running with dbt=1.7.8
[0m18:36:14.415521 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/ben/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/ben/jaffle_shop/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:36:14.786427 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'eda3d1e5-0bcc-445c-8a39-1d0b5bb64bf3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110b1c550>]}
[0m18:36:14.871182 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'eda3d1e5-0bcc-445c-8a39-1d0b5bb64bf3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110a693d0>]}
[0m18:36:14.871999 [info ] [MainThread]: Registered adapter: snowflake=1.7.2
[0m18:36:14.889963 [debug] [MainThread]: checksum: 67f0013ca5f0bd43af9a0873dd50792fde83ef69de63b71cacd0b4ac656c52e5, vars: {}, profile: , target: , version: 1.7.8
[0m18:36:14.924644 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:36:14.925306 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:36:14.932552 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'eda3d1e5-0bcc-445c-8a39-1d0b5bb64bf3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11017e1d0>]}
[0m18:36:14.945420 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'eda3d1e5-0bcc-445c-8a39-1d0b5bb64bf3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110ad15d0>]}
[0m18:36:14.945942 [info ] [MainThread]: Found 3 models, 3 seeds, 9 tests, 0 sources, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m18:36:14.946389 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'eda3d1e5-0bcc-445c-8a39-1d0b5bb64bf3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110bf4310>]}
[0m18:36:14.948528 [info ] [MainThread]: 
[0m18:36:14.949403 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m18:36:14.950999 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RAW'
[0m18:36:14.965909 [debug] [ThreadPool]: Using snowflake connection "list_RAW"
[0m18:36:14.966381 [debug] [ThreadPool]: On list_RAW: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_RAW"} */
show terse schemas in database RAW
    limit 10000
[0m18:36:14.966728 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:36:15.445067 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.0 seconds
[0m18:36:15.450113 [debug] [ThreadPool]: On list_RAW: Close
[0m18:36:15.611600 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RAW, now list_RAW_JAFFLE_SHOP)
[0m18:36:15.628463 [debug] [ThreadPool]: Using snowflake connection "list_RAW_JAFFLE_SHOP"
[0m18:36:15.629147 [debug] [ThreadPool]: On list_RAW_JAFFLE_SHOP: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_RAW_JAFFLE_SHOP"} */
show terse objects in RAW.JAFFLE_SHOP limit 10000
[0m18:36:15.629709 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:36:16.116270 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.0 seconds
[0m18:36:16.120863 [debug] [ThreadPool]: On list_RAW_JAFFLE_SHOP: Close
[0m18:36:16.266692 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'eda3d1e5-0bcc-445c-8a39-1d0b5bb64bf3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110b5d410>]}
[0m18:36:16.268894 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:36:16.269938 [info ] [MainThread]: 
[0m18:36:16.274827 [debug] [Thread-1 (]: Began running node model.jaffle_shop.stg_customers
[0m18:36:16.275915 [info ] [Thread-1 (]: 1 of 3 START sql view model JAFFLE_SHOP.stg_customers .......................... [RUN]
[0m18:36:16.276881 [debug] [Thread-2 (]: Began running node model.jaffle_shop.stg_orders
[0m18:36:16.278253 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_RAW_JAFFLE_SHOP, now model.jaffle_shop.stg_customers)
[0m18:36:16.279257 [info ] [Thread-2 (]: 2 of 3 START sql view model JAFFLE_SHOP.stg_orders ............................. [RUN]
[0m18:36:16.280434 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.stg_customers
[0m18:36:16.281668 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.jaffle_shop.stg_orders'
[0m18:36:16.292838 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.stg_customers"
[0m18:36:16.293493 [debug] [Thread-2 (]: Began compiling node model.jaffle_shop.stg_orders
[0m18:36:16.297635 [debug] [Thread-2 (]: Writing injected SQL for node "model.jaffle_shop.stg_orders"
[0m18:36:16.298647 [debug] [Thread-1 (]: Timing info for model.jaffle_shop.stg_customers (compile): 18:36:16.282112 => 18:36:16.298299
[0m18:36:16.299200 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.stg_customers
[0m18:36:16.305478 [debug] [Thread-2 (]: Timing info for model.jaffle_shop.stg_orders (compile): 18:36:16.293987 => 18:36:16.305153
[0m18:36:16.305965 [debug] [Thread-2 (]: Began executing node model.jaffle_shop.stg_orders
[0m18:36:16.351914 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.stg_customers"
[0m18:36:16.352406 [debug] [Thread-2 (]: Writing runtime sql for node "model.jaffle_shop.stg_orders"
[0m18:36:16.353474 [debug] [Thread-2 (]: Using snowflake connection "model.jaffle_shop.stg_orders"
[0m18:36:16.353885 [debug] [Thread-2 (]: On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */
create or replace   view RAW.JAFFLE_SHOP.stg_orders
  
   as (
    

select
    id as order_id,
    user_id as customer_id,
    order_date,
    status

from raw.jaffle_shop.raw_orders
  );
[0m18:36:16.354246 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m18:36:16.355508 [debug] [Thread-1 (]: Using snowflake connection "model.jaffle_shop.stg_customers"
[0m18:36:16.356577 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */
create or replace   view RAW.JAFFLE_SHOP.stg_customers
  
   as (
    

select
    id as customer_id,
    first_name,
    last_name

from raw.jaffle_shop.raw_customers
  );
[0m18:36:16.357092 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:36:16.949569 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m18:36:16.980225 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m18:36:16.988387 [debug] [Thread-1 (]: Timing info for model.jaffle_shop.stg_customers (execute): 18:36:16.299529 => 18:36:16.988135
[0m18:36:16.990157 [debug] [Thread-2 (]: Timing info for model.jaffle_shop.stg_orders (execute): 18:36:16.312340 => 18:36:16.989844
[0m18:36:16.990680 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: Close
[0m18:36:16.991137 [debug] [Thread-2 (]: On model.jaffle_shop.stg_orders: Close
[0m18:36:17.143712 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eda3d1e5-0bcc-445c-8a39-1d0b5bb64bf3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110ca8490>]}
[0m18:36:17.145969 [info ] [Thread-1 (]: 1 of 3 OK created sql view model JAFFLE_SHOP.stg_customers ..................... [[32mSUCCESS 1[0m in 0.87s]
[0m18:36:17.147814 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.stg_customers
[0m18:36:17.169172 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eda3d1e5-0bcc-445c-8a39-1d0b5bb64bf3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110ea7f90>]}
[0m18:36:17.170623 [info ] [Thread-2 (]: 2 of 3 OK created sql view model JAFFLE_SHOP.stg_orders ........................ [[32mSUCCESS 1[0m in 0.89s]
[0m18:36:17.172068 [debug] [Thread-2 (]: Finished running node model.jaffle_shop.stg_orders
[0m18:36:17.173498 [debug] [Thread-4 (]: Began running node model.jaffle_shop.customers
[0m18:36:17.174647 [info ] [Thread-4 (]: 3 of 3 START sql view model JAFFLE_SHOP.customers .............................. [RUN]
[0m18:36:17.176461 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.jaffle_shop.customers'
[0m18:36:17.177276 [debug] [Thread-4 (]: Began compiling node model.jaffle_shop.customers
[0m18:36:17.182755 [debug] [Thread-4 (]: Writing injected SQL for node "model.jaffle_shop.customers"
[0m18:36:17.185043 [debug] [Thread-4 (]: Timing info for model.jaffle_shop.customers (compile): 18:36:17.177753 => 18:36:17.184305
[0m18:36:17.185812 [debug] [Thread-4 (]: Began executing node model.jaffle_shop.customers
[0m18:36:17.191507 [debug] [Thread-4 (]: Writing runtime sql for node "model.jaffle_shop.customers"
[0m18:36:17.193925 [debug] [Thread-4 (]: Using snowflake connection "model.jaffle_shop.customers"
[0m18:36:17.194567 [debug] [Thread-4 (]: On model.jaffle_shop.customers: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.customers"} */
create or replace   view RAW.JAFFLE_SHOP.customers
  
   as (
    


with customers as (

    select * from RAW.JAFFLE_SHOP.stg_customers

),

orders as (

    select * from RAW.JAFFLE_SHOP.stg_orders

),

customer_orders as (

    select
        customer_id,

        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders

    from orders

    group by 1

),

final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce(customer_orders.number_of_orders, 0) as number_of_orders

    from customers

    left join customer_orders using (customer_id)

)

select * from final
  );
[0m18:36:17.195138 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m18:36:17.852685 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m18:36:17.859349 [debug] [Thread-4 (]: Timing info for model.jaffle_shop.customers (execute): 18:36:17.186181 => 18:36:17.858665
[0m18:36:17.860397 [debug] [Thread-4 (]: On model.jaffle_shop.customers: Close
[0m18:36:18.026717 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eda3d1e5-0bcc-445c-8a39-1d0b5bb64bf3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110ce2e90>]}
[0m18:36:18.028357 [info ] [Thread-4 (]: 3 of 3 OK created sql view model JAFFLE_SHOP.customers ......................... [[32mSUCCESS 1[0m in 0.85s]
[0m18:36:18.030068 [debug] [Thread-4 (]: Finished running node model.jaffle_shop.customers
[0m18:36:18.033757 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:36:18.034439 [debug] [MainThread]: Connection 'model.jaffle_shop.stg_customers' was properly closed.
[0m18:36:18.035023 [debug] [MainThread]: Connection 'model.jaffle_shop.stg_orders' was properly closed.
[0m18:36:18.035588 [debug] [MainThread]: Connection 'model.jaffle_shop.customers' was properly closed.
[0m18:36:18.036243 [info ] [MainThread]: 
[0m18:36:18.036923 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 3.09 seconds (3.09s).
[0m18:36:18.039248 [debug] [MainThread]: Command end result
[0m18:36:18.053814 [info ] [MainThread]: 
[0m18:36:18.054449 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:36:18.054916 [info ] [MainThread]: 
[0m18:36:18.055400 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m18:36:18.056969 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 3.7068114, "process_user_time": 3.012941, "process_kernel_time": 0.304429, "process_mem_max_rss": "137097216", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m18:36:18.057670 [debug] [MainThread]: Command `dbt run` succeeded at 18:36:18.057483 after 3.71 seconds
[0m18:36:18.058189 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fd60ad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bf3c050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fb46cd0>]}
[0m18:36:18.058676 [debug] [MainThread]: Flushing usage events
[0m18:37:04.452261 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1061d0e90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a06f0d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a06f010>]}


============================== 18:37:04.460131 | be4b133a-7cb0-447a-a7fc-0232925815c3 ==============================
[0m18:37:04.460131 [info ] [MainThread]: Running with dbt=1.7.8
[0m18:37:04.461044 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/ben/jaffle_shop/logs', 'profiles_dir': '/Users/ben/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m18:37:04.998586 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'be4b133a-7cb0-447a-a7fc-0232925815c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ad315d0>]}
[0m18:37:05.092299 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'be4b133a-7cb0-447a-a7fc-0232925815c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109e03b90>]}
[0m18:37:05.093836 [info ] [MainThread]: Registered adapter: snowflake=1.7.2
[0m18:37:05.114546 [debug] [MainThread]: checksum: 67f0013ca5f0bd43af9a0873dd50792fde83ef69de63b71cacd0b4ac656c52e5, vars: {}, profile: , target: , version: 1.7.8
[0m18:37:05.194680 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:37:05.195188 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:37:05.202461 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'be4b133a-7cb0-447a-a7fc-0232925815c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10af88950>]}
[0m18:37:05.214423 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'be4b133a-7cb0-447a-a7fc-0232925815c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10acfea10>]}
[0m18:37:05.215087 [info ] [MainThread]: Found 3 models, 3 seeds, 9 tests, 0 sources, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m18:37:05.215591 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'be4b133a-7cb0-447a-a7fc-0232925815c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a4aec50>]}
[0m18:37:05.217510 [info ] [MainThread]: 
[0m18:37:05.218365 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m18:37:05.219678 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RAW'
[0m18:37:05.234642 [debug] [ThreadPool]: Using snowflake connection "list_RAW"
[0m18:37:05.235180 [debug] [ThreadPool]: On list_RAW: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_RAW"} */
show terse schemas in database RAW
    limit 10000
[0m18:37:05.235537 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:37:06.010898 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.0 seconds
[0m18:37:06.016398 [debug] [ThreadPool]: On list_RAW: Close
[0m18:37:06.381234 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RAW, now list_RAW_JAFFLE_SHOP)
[0m18:37:06.398441 [debug] [ThreadPool]: Using snowflake connection "list_RAW_JAFFLE_SHOP"
[0m18:37:06.399170 [debug] [ThreadPool]: On list_RAW_JAFFLE_SHOP: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_RAW_JAFFLE_SHOP"} */
show terse objects in RAW.JAFFLE_SHOP limit 10000
[0m18:37:06.399764 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:37:07.063165 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.0 seconds
[0m18:37:07.068499 [debug] [ThreadPool]: On list_RAW_JAFFLE_SHOP: Close
[0m18:37:07.212649 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'be4b133a-7cb0-447a-a7fc-0232925815c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10abb8590>]}
[0m18:37:07.214667 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:37:07.215601 [info ] [MainThread]: 
[0m18:37:07.221629 [debug] [Thread-1 (]: Began running node model.jaffle_shop.stg_customers
[0m18:37:07.222640 [debug] [Thread-2 (]: Began running node model.jaffle_shop.stg_orders
[0m18:37:07.223724 [info ] [Thread-1 (]: 1 of 3 START sql view model JAFFLE_SHOP.stg_customers .......................... [RUN]
[0m18:37:07.224772 [info ] [Thread-2 (]: 2 of 3 START sql view model JAFFLE_SHOP.stg_orders ............................. [RUN]
[0m18:37:07.225992 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_RAW_JAFFLE_SHOP, now model.jaffle_shop.stg_customers)
[0m18:37:07.227236 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.jaffle_shop.stg_orders'
[0m18:37:07.227922 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.stg_customers
[0m18:37:07.228561 [debug] [Thread-2 (]: Began compiling node model.jaffle_shop.stg_orders
[0m18:37:07.240552 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.stg_customers"
[0m18:37:07.244372 [debug] [Thread-2 (]: Writing injected SQL for node "model.jaffle_shop.stg_orders"
[0m18:37:07.245529 [debug] [Thread-1 (]: Timing info for model.jaffle_shop.stg_customers (compile): 18:37:07.228994 => 18:37:07.245206
[0m18:37:07.246036 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.stg_customers
[0m18:37:07.252057 [debug] [Thread-2 (]: Timing info for model.jaffle_shop.stg_orders (compile): 18:37:07.241102 => 18:37:07.251764
[0m18:37:07.252583 [debug] [Thread-2 (]: Began executing node model.jaffle_shop.stg_orders
[0m18:37:07.301348 [debug] [Thread-2 (]: Writing runtime sql for node "model.jaffle_shop.stg_orders"
[0m18:37:07.301901 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.stg_customers"
[0m18:37:07.303029 [debug] [Thread-2 (]: Using snowflake connection "model.jaffle_shop.stg_orders"
[0m18:37:07.303432 [debug] [Thread-2 (]: On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */
create or replace   view RAW.JAFFLE_SHOP.stg_orders
  
   as (
    

select
    id as order_id,
    user_id as customer_id,
    order_date,
    status

from raw.jaffle_shop.raw_orders
  );
[0m18:37:07.303815 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m18:37:07.305518 [debug] [Thread-1 (]: Using snowflake connection "model.jaffle_shop.stg_customers"
[0m18:37:07.306042 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */
create or replace   view RAW.JAFFLE_SHOP.stg_customers
  
   as (
    

select
    id as customer_id,
    first_name,
    last_name

from raw.jaffle_shop.raw_customers
  );
[0m18:37:07.306475 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:37:07.857207 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m18:37:07.895059 [debug] [Thread-2 (]: Timing info for model.jaffle_shop.stg_orders (execute): 18:37:07.252995 => 18:37:07.894688
[0m18:37:07.895576 [debug] [Thread-2 (]: On model.jaffle_shop.stg_orders: Close
[0m18:37:08.031168 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'be4b133a-7cb0-447a-a7fc-0232925815c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ad8e210>]}
[0m18:37:08.033043 [info ] [Thread-2 (]: 2 of 3 OK created sql view model JAFFLE_SHOP.stg_orders ........................ [[32mSUCCESS 1[0m in 0.80s]
[0m18:37:08.035723 [debug] [Thread-2 (]: Finished running node model.jaffle_shop.stg_orders
[0m18:37:08.085243 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m18:37:08.093006 [debug] [Thread-1 (]: Timing info for model.jaffle_shop.stg_customers (execute): 18:37:07.246320 => 18:37:08.092447
[0m18:37:08.094032 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: Close
[0m18:37:08.241340 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'be4b133a-7cb0-447a-a7fc-0232925815c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b24ec50>]}
[0m18:37:08.243232 [info ] [Thread-1 (]: 1 of 3 OK created sql view model JAFFLE_SHOP.stg_customers ..................... [[32mSUCCESS 1[0m in 1.02s]
[0m18:37:08.245077 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.stg_customers
[0m18:37:08.246572 [debug] [Thread-4 (]: Began running node model.jaffle_shop.customers
[0m18:37:08.248360 [info ] [Thread-4 (]: 3 of 3 START sql view model JAFFLE_SHOP.customers .............................. [RUN]
[0m18:37:08.250802 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.jaffle_shop.customers'
[0m18:37:08.251716 [debug] [Thread-4 (]: Began compiling node model.jaffle_shop.customers
[0m18:37:08.258189 [debug] [Thread-4 (]: Writing injected SQL for node "model.jaffle_shop.customers"
[0m18:37:08.259565 [debug] [Thread-4 (]: Timing info for model.jaffle_shop.customers (compile): 18:37:08.252205 => 18:37:08.259145
[0m18:37:08.260237 [debug] [Thread-4 (]: Began executing node model.jaffle_shop.customers
[0m18:37:08.265343 [debug] [Thread-4 (]: Writing runtime sql for node "model.jaffle_shop.customers"
[0m18:37:08.267761 [debug] [Thread-4 (]: Using snowflake connection "model.jaffle_shop.customers"
[0m18:37:08.268794 [debug] [Thread-4 (]: On model.jaffle_shop.customers: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.customers"} */
create or replace   view RAW.JAFFLE_SHOP.customers
  
   as (
    


with customers as (

    select * from RAW.JAFFLE_SHOP.stg_customers

),

orders as (

    select * from RAW.JAFFLE_SHOP.stg_orders

),

customer_orders as (

    select
        customer_id,

        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders

    from orders

    group by 1

),

final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce(customer_orders.number_of_orders, 0) as number_of_orders

    from customers

    left join customer_orders using (customer_id)

)

select * from final
  );
[0m18:37:08.269823 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m18:37:09.087156 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m18:37:09.095316 [debug] [Thread-4 (]: Timing info for model.jaffle_shop.customers (execute): 18:37:08.260652 => 18:37:09.094824
[0m18:37:09.096161 [debug] [Thread-4 (]: On model.jaffle_shop.customers: Close
[0m18:37:09.360035 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'be4b133a-7cb0-447a-a7fc-0232925815c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10af13890>]}
[0m18:37:09.361837 [info ] [Thread-4 (]: 3 of 3 OK created sql view model JAFFLE_SHOP.customers ......................... [[32mSUCCESS 1[0m in 1.11s]
[0m18:37:09.364070 [debug] [Thread-4 (]: Finished running node model.jaffle_shop.customers
[0m18:37:09.368849 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:37:09.369829 [debug] [MainThread]: Connection 'model.jaffle_shop.stg_customers' was properly closed.
[0m18:37:09.370484 [debug] [MainThread]: Connection 'model.jaffle_shop.stg_orders' was properly closed.
[0m18:37:09.371124 [debug] [MainThread]: Connection 'model.jaffle_shop.customers' was properly closed.
[0m18:37:09.371841 [info ] [MainThread]: 
[0m18:37:09.372570 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 4.15 seconds (4.15s).
[0m18:37:09.374333 [debug] [MainThread]: Command end result
[0m18:37:09.388127 [info ] [MainThread]: 
[0m18:37:09.388807 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:37:09.389287 [info ] [MainThread]: 
[0m18:37:09.389779 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m18:37:09.392788 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 5.0050635, "process_user_time": 3.182195, "process_kernel_time": 0.481007, "process_mem_max_rss": "135294976", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m18:37:09.393602 [debug] [MainThread]: Command `dbt run` succeeded at 18:37:09.393425 after 5.01 seconds
[0m18:37:09.394133 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a06f0d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a469ad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1060a9d10>]}
[0m18:37:09.394615 [debug] [MainThread]: Flushing usage events
[0m21:00:18.282517 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dc9d350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dc82e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10da033d0>]}


============================== 21:00:18.292606 | f3d9d774-471c-48a7-8954-e03a9b089efa ==============================
[0m21:00:18.292606 [info ] [MainThread]: Running with dbt=1.7.8
[0m21:00:18.293944 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/ben/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/ben/jaffle_shop/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m21:00:19.044660 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f3d9d774-471c-48a7-8954-e03a9b089efa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10da1a310>]}
[0m21:00:19.176178 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f3d9d774-471c-48a7-8954-e03a9b089efa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e402b90>]}
[0m21:00:19.177880 [info ] [MainThread]: Registered adapter: snowflake=1.7.2
[0m21:00:19.204883 [debug] [MainThread]: checksum: 67f0013ca5f0bd43af9a0873dd50792fde83ef69de63b71cacd0b4ac656c52e5, vars: {}, profile: , target: , version: 1.7.8
[0m21:00:19.310187 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 2 files changed.
[0m21:00:19.311173 [debug] [MainThread]: Partial parsing: added file: jaffle_shop://models/staging/stg_payments.sql
[0m21:00:19.311949 [debug] [MainThread]: Partial parsing: updated file: jaffle_shop://models/schema.yml
[0m21:00:19.312649 [debug] [MainThread]: Partial parsing: updated file: jaffle_shop://models/staging/stg_customers.sql
[0m21:00:19.741126 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f3d9d774-471c-48a7-8954-e03a9b089efa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10eaee190>]}
[0m21:00:19.759812 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f3d9d774-471c-48a7-8954-e03a9b089efa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e726d10>]}
[0m21:00:19.760612 [info ] [MainThread]: Found 4 models, 3 seeds, 11 tests, 0 sources, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m21:00:19.761220 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f3d9d774-471c-48a7-8954-e03a9b089efa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e84cf10>]}
[0m21:00:19.765089 [info ] [MainThread]: 
[0m21:00:19.766406 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m21:00:19.768098 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RAW'
[0m21:00:19.787286 [debug] [ThreadPool]: Using snowflake connection "list_RAW"
[0m21:00:19.788281 [debug] [ThreadPool]: On list_RAW: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_RAW"} */
show terse schemas in database RAW
    limit 10000
[0m21:00:19.788898 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:00:20.683215 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.0 seconds
[0m21:00:20.688711 [debug] [ThreadPool]: On list_RAW: Close
[0m21:00:20.854087 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RAW, now list_RAW_JAFFLE_SHOP)
[0m21:00:20.871096 [debug] [ThreadPool]: Using snowflake connection "list_RAW_JAFFLE_SHOP"
[0m21:00:20.871858 [debug] [ThreadPool]: On list_RAW_JAFFLE_SHOP: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_RAW_JAFFLE_SHOP"} */
show terse objects in RAW.JAFFLE_SHOP limit 10000
[0m21:00:20.872442 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:00:21.480302 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.0 seconds
[0m21:00:21.485892 [debug] [ThreadPool]: On list_RAW_JAFFLE_SHOP: Close
[0m21:00:21.641423 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f3d9d774-471c-48a7-8954-e03a9b089efa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e9a3090>]}
[0m21:00:21.643455 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:00:21.644759 [info ] [MainThread]: 
[0m21:00:21.650379 [debug] [Thread-1 (]: Began running node model.jaffle_shop.stg_customers
[0m21:00:21.651314 [debug] [Thread-2 (]: Began running node model.jaffle_shop.stg_orders
[0m21:00:21.652408 [info ] [Thread-1 (]: 1 of 4 START sql view model JAFFLE_SHOP.stg_customers .......................... [RUN]
[0m21:00:21.653401 [debug] [Thread-3 (]: Began running node model.jaffle_shop.stg_payments
[0m21:00:21.654402 [info ] [Thread-2 (]: 2 of 4 START sql view model JAFFLE_SHOP.stg_orders ............................. [RUN]
[0m21:00:21.655830 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_RAW_JAFFLE_SHOP, now model.jaffle_shop.stg_customers)
[0m21:00:21.656927 [info ] [Thread-3 (]: 3 of 4 START sql view model JAFFLE_SHOP.stg_payments ........................... [RUN]
[0m21:00:21.658629 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.jaffle_shop.stg_orders'
[0m21:00:21.659688 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.stg_customers
[0m21:00:21.661041 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.jaffle_shop.stg_payments'
[0m21:00:21.661764 [debug] [Thread-2 (]: Began compiling node model.jaffle_shop.stg_orders
[0m21:00:21.672970 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.stg_customers"
[0m21:00:21.674551 [debug] [Thread-3 (]: Began compiling node model.jaffle_shop.stg_payments
[0m21:00:21.679555 [debug] [Thread-2 (]: Writing injected SQL for node "model.jaffle_shop.stg_orders"
[0m21:00:21.684247 [debug] [Thread-3 (]: Writing injected SQL for node "model.jaffle_shop.stg_payments"
[0m21:00:21.685732 [debug] [Thread-1 (]: Timing info for model.jaffle_shop.stg_customers (compile): 21:00:21.662227 => 21:00:21.685275
[0m21:00:21.686525 [debug] [Thread-2 (]: Timing info for model.jaffle_shop.stg_orders (compile): 21:00:21.675375 => 21:00:21.686198
[0m21:00:21.687170 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.stg_customers
[0m21:00:21.687852 [debug] [Thread-2 (]: Began executing node model.jaffle_shop.stg_orders
[0m21:00:21.701462 [debug] [Thread-3 (]: Timing info for model.jaffle_shop.stg_payments (compile): 21:00:21.680328 => 21:00:21.700982
[0m21:00:21.741163 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.stg_customers"
[0m21:00:21.750400 [debug] [Thread-2 (]: Writing runtime sql for node "model.jaffle_shop.stg_orders"
[0m21:00:21.751133 [debug] [Thread-3 (]: Began executing node model.jaffle_shop.stg_payments
[0m21:00:21.757791 [debug] [Thread-1 (]: Using snowflake connection "model.jaffle_shop.stg_customers"
[0m21:00:21.758508 [debug] [Thread-3 (]: Writing runtime sql for node "model.jaffle_shop.stg_payments"
[0m21:00:21.759193 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */
create or replace   view RAW.JAFFLE_SHOP.stg_customers
  
   as (
    -- noinspection SqlNoDataSourceInspectionForFile



select
    id as customer_id,
    first_name,
    last_name

from raw.jaffle_shop.raw_customers
  );
[0m21:00:21.760447 [debug] [Thread-2 (]: Using snowflake connection "model.jaffle_shop.stg_orders"
[0m21:00:21.761163 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:00:21.761889 [debug] [Thread-2 (]: On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */
create or replace   view RAW.JAFFLE_SHOP.stg_orders
  
   as (
    

select
    id as order_id,
    user_id as customer_id,
    order_date,
    status

from raw.jaffle_shop.raw_orders
  );
[0m21:00:21.763025 [debug] [Thread-3 (]: Using snowflake connection "model.jaffle_shop.stg_payments"
[0m21:00:21.764498 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m21:00:21.765717 [debug] [Thread-3 (]: On model.jaffle_shop.stg_payments: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_payments"} */
create or replace   view RAW.JAFFLE_SHOP.stg_payments
  
   as (
    

select
    id,
    order_id,
    payment_method,
    amount

from raw.jaffle_shop.raw_payments
  );
[0m21:00:21.768163 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m21:00:23.370491 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m21:00:23.372336 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m21:00:23.373398 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m21:00:23.431552 [debug] [Thread-2 (]: Timing info for model.jaffle_shop.stg_orders (execute): 21:00:21.724569 => 21:00:23.431198
[0m21:00:23.433109 [debug] [Thread-1 (]: Timing info for model.jaffle_shop.stg_customers (execute): 21:00:21.688331 => 21:00:23.432795
[0m21:00:23.436840 [debug] [Thread-3 (]: Timing info for model.jaffle_shop.stg_payments (execute): 21:00:21.751986 => 21:00:23.436394
[0m21:00:23.437648 [debug] [Thread-2 (]: On model.jaffle_shop.stg_orders: Close
[0m21:00:23.438302 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: Close
[0m21:00:23.438886 [debug] [Thread-3 (]: On model.jaffle_shop.stg_payments: Close
[0m21:00:23.687992 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f3d9d774-471c-48a7-8954-e03a9b089efa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ed1fc50>]}
[0m21:00:23.690320 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f3d9d774-471c-48a7-8954-e03a9b089efa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ed77e50>]}
[0m21:00:23.692280 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f3d9d774-471c-48a7-8954-e03a9b089efa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ed74390>]}
[0m21:00:23.694958 [info ] [Thread-1 (]: 1 of 4 OK created sql view model JAFFLE_SHOP.stg_customers ..................... [[32mSUCCESS 1[0m in 2.03s]
[0m21:00:23.696664 [info ] [Thread-3 (]: 3 of 4 OK created sql view model JAFFLE_SHOP.stg_payments ...................... [[32mSUCCESS 1[0m in 2.03s]
[0m21:00:23.698427 [info ] [Thread-2 (]: 2 of 4 OK created sql view model JAFFLE_SHOP.stg_orders ........................ [[32mSUCCESS 1[0m in 2.03s]
[0m21:00:23.700633 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.stg_customers
[0m21:00:23.702346 [debug] [Thread-3 (]: Finished running node model.jaffle_shop.stg_payments
[0m21:00:23.703582 [debug] [Thread-2 (]: Finished running node model.jaffle_shop.stg_orders
[0m21:00:23.705363 [debug] [Thread-4 (]: Began running node model.jaffle_shop.customers
[0m21:00:23.706562 [info ] [Thread-4 (]: 4 of 4 START sql view model JAFFLE_SHOP.customers .............................. [RUN]
[0m21:00:23.708418 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.jaffle_shop.customers'
[0m21:00:23.709042 [debug] [Thread-4 (]: Began compiling node model.jaffle_shop.customers
[0m21:00:23.713700 [debug] [Thread-4 (]: Writing injected SQL for node "model.jaffle_shop.customers"
[0m21:00:23.714881 [debug] [Thread-4 (]: Timing info for model.jaffle_shop.customers (compile): 21:00:23.709412 => 21:00:23.714509
[0m21:00:23.715599 [debug] [Thread-4 (]: Began executing node model.jaffle_shop.customers
[0m21:00:23.722097 [debug] [Thread-4 (]: Writing runtime sql for node "model.jaffle_shop.customers"
[0m21:00:23.724993 [debug] [Thread-4 (]: Using snowflake connection "model.jaffle_shop.customers"
[0m21:00:23.726378 [debug] [Thread-4 (]: On model.jaffle_shop.customers: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.customers"} */
create or replace   view RAW.JAFFLE_SHOP.customers
  
   as (
    


with customers as (

    select * from RAW.JAFFLE_SHOP.stg_customers

),

orders as (

    select * from RAW.JAFFLE_SHOP.stg_orders

),

customer_orders as (

    select
        customer_id,

        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders

    from orders

    group by 1

),

final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce(customer_orders.number_of_orders, 0) as number_of_orders

    from customers

    left join customer_orders using (customer_id)

)

select * from final
  );
[0m21:00:23.728085 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m21:00:24.807692 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m21:00:24.815448 [debug] [Thread-4 (]: Timing info for model.jaffle_shop.customers (execute): 21:00:23.716129 => 21:00:24.814919
[0m21:00:24.816412 [debug] [Thread-4 (]: On model.jaffle_shop.customers: Close
[0m21:00:25.094252 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f3d9d774-471c-48a7-8954-e03a9b089efa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ed5f610>]}
[0m21:00:25.095775 [info ] [Thread-4 (]: 4 of 4 OK created sql view model JAFFLE_SHOP.customers ......................... [[32mSUCCESS 1[0m in 1.39s]
[0m21:00:25.097353 [debug] [Thread-4 (]: Finished running node model.jaffle_shop.customers
[0m21:00:25.101661 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:00:25.102599 [debug] [MainThread]: Connection 'model.jaffle_shop.stg_customers' was properly closed.
[0m21:00:25.106088 [debug] [MainThread]: Connection 'model.jaffle_shop.stg_orders' was properly closed.
[0m21:00:25.125778 [debug] [MainThread]: Connection 'model.jaffle_shop.stg_payments' was properly closed.
[0m21:00:25.126918 [debug] [MainThread]: Connection 'model.jaffle_shop.customers' was properly closed.
[0m21:00:25.128280 [info ] [MainThread]: 
[0m21:00:25.129038 [info ] [MainThread]: Finished running 4 view models in 0 hours 0 minutes and 5.36 seconds (5.36s).
[0m21:00:25.130685 [debug] [MainThread]: Command end result
[0m21:00:25.145446 [info ] [MainThread]: 
[0m21:00:25.146702 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:00:25.147420 [info ] [MainThread]: 
[0m21:00:25.148389 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m21:00:25.153167 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 6.9599442, "process_user_time": 4.913296, "process_kernel_time": 0.692451, "process_mem_max_rss": "143544320", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m21:00:25.154214 [debug] [MainThread]: Command `dbt run` succeeded at 21:00:25.153998 after 6.96 seconds
[0m21:00:25.154849 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d8da690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109904050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10998bd90>]}
[0m21:00:25.155455 [debug] [MainThread]: Flushing usage events
[0m21:32:45.029670 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1095c8fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109253090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109253790>]}


============================== 21:32:45.045344 | 2d600f93-3ef1-48f2-85d7-189ac733affe ==============================
[0m21:32:45.045344 [info ] [MainThread]: Running with dbt=1.7.8
[0m21:32:45.046891 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/ben/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/ben/jaffle_shop/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m21:32:45.906214 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2d600f93-3ef1-48f2-85d7-189ac733affe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108f90f90>]}
[0m21:32:46.087585 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2d600f93-3ef1-48f2-85d7-189ac733affe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1099a0f90>]}
[0m21:32:46.089832 [info ] [MainThread]: Registered adapter: snowflake=1.7.2
[0m21:32:46.136849 [debug] [MainThread]: checksum: 67f0013ca5f0bd43af9a0873dd50792fde83ef69de63b71cacd0b4ac656c52e5, vars: {}, profile: , target: , version: 1.7.8
[0m21:32:46.253422 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:32:46.254138 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:32:46.267257 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2d600f93-3ef1-48f2-85d7-189ac733affe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108fbc4d0>]}
[0m21:32:46.290153 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2d600f93-3ef1-48f2-85d7-189ac733affe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a04b510>]}
[0m21:32:46.291010 [info ] [MainThread]: Found 4 models, 3 seeds, 11 tests, 0 sources, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m21:32:46.291653 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2d600f93-3ef1-48f2-85d7-189ac733affe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a00de90>]}
[0m21:32:46.295169 [info ] [MainThread]: 
[0m21:32:46.296570 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m21:32:46.299315 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RAW'
[0m21:32:46.327281 [debug] [ThreadPool]: Using snowflake connection "list_RAW"
[0m21:32:46.328811 [debug] [ThreadPool]: On list_RAW: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_RAW"} */
show terse schemas in database RAW
    limit 10000
[0m21:32:46.329613 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:32:47.120642 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.0 seconds
[0m21:32:47.123985 [debug] [ThreadPool]: On list_RAW: Close
[0m21:32:47.264923 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RAW, now list_RAW_JAFFLE_SHOP)
[0m21:32:47.280729 [debug] [ThreadPool]: Using snowflake connection "list_RAW_JAFFLE_SHOP"
[0m21:32:47.281522 [debug] [ThreadPool]: On list_RAW_JAFFLE_SHOP: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_RAW_JAFFLE_SHOP"} */
show terse objects in RAW.JAFFLE_SHOP limit 10000
[0m21:32:47.282707 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:32:47.817411 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.0 seconds
[0m21:32:47.821346 [debug] [ThreadPool]: On list_RAW_JAFFLE_SHOP: Close
[0m21:32:47.962679 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2d600f93-3ef1-48f2-85d7-189ac733affe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109651010>]}
[0m21:32:47.966282 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:32:47.967503 [info ] [MainThread]: 
[0m21:32:47.973970 [debug] [Thread-1 (]: Began running node model.jaffle_shop.stg_customers
[0m21:32:47.974727 [debug] [Thread-2 (]: Began running node model.jaffle_shop.stg_orders
[0m21:32:47.975471 [debug] [Thread-3 (]: Began running node model.jaffle_shop.stg_payments
[0m21:32:47.976192 [info ] [Thread-1 (]: 1 of 4 START sql view model JAFFLE_SHOP.stg_customers .......................... [RUN]
[0m21:32:47.977197 [info ] [Thread-2 (]: 2 of 4 START sql view model JAFFLE_SHOP.stg_orders ............................. [RUN]
[0m21:32:47.978191 [info ] [Thread-3 (]: 3 of 4 START sql view model JAFFLE_SHOP.stg_payments ........................... [RUN]
[0m21:32:47.980020 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_RAW_JAFFLE_SHOP, now model.jaffle_shop.stg_customers)
[0m21:32:47.981810 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.jaffle_shop.stg_orders'
[0m21:32:47.983262 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.jaffle_shop.stg_payments'
[0m21:32:47.984453 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.stg_customers
[0m21:32:47.985704 [debug] [Thread-2 (]: Began compiling node model.jaffle_shop.stg_orders
[0m21:32:47.986714 [debug] [Thread-3 (]: Began compiling node model.jaffle_shop.stg_payments
[0m21:32:48.005427 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.stg_customers"
[0m21:32:48.010153 [debug] [Thread-2 (]: Writing injected SQL for node "model.jaffle_shop.stg_orders"
[0m21:32:48.015674 [debug] [Thread-3 (]: Writing injected SQL for node "model.jaffle_shop.stg_payments"
[0m21:32:48.018056 [debug] [Thread-3 (]: Timing info for model.jaffle_shop.stg_payments (compile): 21:32:48.010693 => 21:32:48.017289
[0m21:32:48.019488 [debug] [Thread-2 (]: Timing info for model.jaffle_shop.stg_orders (compile): 21:32:48.006340 => 21:32:48.018823
[0m21:32:48.020393 [debug] [Thread-3 (]: Began executing node model.jaffle_shop.stg_payments
[0m21:32:48.021091 [debug] [Thread-1 (]: Timing info for model.jaffle_shop.stg_customers (compile): 21:32:47.987319 => 21:32:48.020755
[0m21:32:48.021770 [debug] [Thread-2 (]: Began executing node model.jaffle_shop.stg_orders
[0m21:32:48.044330 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.stg_customers
[0m21:32:48.090066 [debug] [Thread-3 (]: Writing runtime sql for node "model.jaffle_shop.stg_payments"
[0m21:32:48.100536 [debug] [Thread-2 (]: Writing runtime sql for node "model.jaffle_shop.stg_orders"
[0m21:32:48.107034 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.stg_customers"
[0m21:32:48.108864 [debug] [Thread-3 (]: Using snowflake connection "model.jaffle_shop.stg_payments"
[0m21:32:48.110019 [debug] [Thread-3 (]: On model.jaffle_shop.stg_payments: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_payments"} */
create or replace   view RAW.JAFFLE_SHOP.stg_payments
  
   as (
    

select
    id,
    order_id,
    payment_method,
    amount

from raw.jaffle_shop.raw_payments
  );
[0m21:32:48.111253 [debug] [Thread-1 (]: Using snowflake connection "model.jaffle_shop.stg_customers"
[0m21:32:48.111893 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m21:32:48.112983 [debug] [Thread-2 (]: Using snowflake connection "model.jaffle_shop.stg_orders"
[0m21:32:48.114047 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */
create or replace   view RAW.JAFFLE_SHOP.stg_customers
  
   as (
    -- noinspection SqlNoDataSourceInspectionForFile



select
    id as customer_id,
    first_name,
    last_name

from raw.jaffle_shop.raw_customers
  );
[0m21:32:48.116514 [debug] [Thread-2 (]: On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */
create or replace   view RAW.JAFFLE_SHOP.stg_orders
  
   as (
    

select
    id as order_id,
    user_id as customer_id,
    order_date,
    status

from raw.jaffle_shop.raw_orders
  );
[0m21:32:48.118083 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:32:48.118987 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m21:32:48.766933 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m21:32:48.811682 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m21:32:48.812948 [debug] [Thread-1 (]: Timing info for model.jaffle_shop.stg_customers (execute): 21:32:48.101377 => 21:32:48.810209
[0m21:32:48.820232 [debug] [Thread-2 (]: Timing info for model.jaffle_shop.stg_orders (execute): 21:32:48.073037 => 21:32:48.819481
[0m21:32:48.821531 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: Close
[0m21:32:48.822431 [debug] [Thread-2 (]: On model.jaffle_shop.stg_orders: Close
[0m21:32:48.862875 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m21:32:48.869667 [debug] [Thread-3 (]: Timing info for model.jaffle_shop.stg_payments (execute): 21:32:48.022154 => 21:32:48.869140
[0m21:32:48.870434 [debug] [Thread-3 (]: On model.jaffle_shop.stg_payments: Close
[0m21:32:48.994582 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2d600f93-3ef1-48f2-85d7-189ac733affe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a2ece50>]}
[0m21:32:48.996225 [info ] [Thread-2 (]: 2 of 4 OK created sql view model JAFFLE_SHOP.stg_orders ........................ [[32mSUCCESS 1[0m in 1.01s]
[0m21:32:48.999413 [debug] [Thread-2 (]: Finished running node model.jaffle_shop.stg_orders
[0m21:32:49.011856 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2d600f93-3ef1-48f2-85d7-189ac733affe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a183dd0>]}
[0m21:32:49.013710 [info ] [Thread-1 (]: 1 of 4 OK created sql view model JAFFLE_SHOP.stg_customers ..................... [[32mSUCCESS 1[0m in 1.03s]
[0m21:32:49.014860 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.stg_customers
[0m21:32:49.016370 [debug] [Thread-4 (]: Began running node model.jaffle_shop.customers
[0m21:32:49.017219 [info ] [Thread-4 (]: 4 of 4 START sql view model JAFFLE_SHOP.customers .............................. [RUN]
[0m21:32:49.019549 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.jaffle_shop.customers'
[0m21:32:49.020631 [debug] [Thread-4 (]: Began compiling node model.jaffle_shop.customers
[0m21:32:49.026966 [debug] [Thread-4 (]: Writing injected SQL for node "model.jaffle_shop.customers"
[0m21:32:49.032542 [debug] [Thread-4 (]: Timing info for model.jaffle_shop.customers (compile): 21:32:49.021077 => 21:32:49.031820
[0m21:32:49.035180 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2d600f93-3ef1-48f2-85d7-189ac733affe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a2d3dd0>]}
[0m21:32:49.036821 [debug] [Thread-4 (]: Began executing node model.jaffle_shop.customers
[0m21:32:49.037910 [info ] [Thread-3 (]: 3 of 4 OK created sql view model JAFFLE_SHOP.stg_payments ...................... [[32mSUCCESS 1[0m in 1.05s]
[0m21:32:49.044433 [debug] [Thread-4 (]: Writing runtime sql for node "model.jaffle_shop.customers"
[0m21:32:49.048718 [debug] [Thread-3 (]: Finished running node model.jaffle_shop.stg_payments
[0m21:32:49.055748 [debug] [Thread-4 (]: Using snowflake connection "model.jaffle_shop.customers"
[0m21:32:49.058025 [debug] [Thread-4 (]: On model.jaffle_shop.customers: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.customers"} */
create or replace   view RAW.JAFFLE_SHOP.customers
  
   as (
    


with customers as (

    select * from RAW.JAFFLE_SHOP.stg_customers

),

orders as (

    select * from RAW.JAFFLE_SHOP.stg_orders

),

customer_orders as (

    select
        customer_id,

        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders

    from orders

    group by 1

),

final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce(customer_orders.number_of_orders, 0) as number_of_orders

    from customers

    left join customer_orders using (customer_id)

)

select * from final
  );
[0m21:32:49.059484 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m21:32:49.781313 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m21:32:49.787621 [debug] [Thread-4 (]: Timing info for model.jaffle_shop.customers (execute): 21:32:49.038584 => 21:32:49.787077
[0m21:32:49.788603 [debug] [Thread-4 (]: On model.jaffle_shop.customers: Close
[0m21:32:49.931349 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2d600f93-3ef1-48f2-85d7-189ac733affe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a298590>]}
[0m21:32:49.932962 [info ] [Thread-4 (]: 4 of 4 OK created sql view model JAFFLE_SHOP.customers ......................... [[32mSUCCESS 1[0m in 0.91s]
[0m21:32:49.935000 [debug] [Thread-4 (]: Finished running node model.jaffle_shop.customers
[0m21:32:49.939292 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:32:49.939933 [debug] [MainThread]: Connection 'model.jaffle_shop.stg_customers' was properly closed.
[0m21:32:49.940480 [debug] [MainThread]: Connection 'model.jaffle_shop.stg_orders' was properly closed.
[0m21:32:49.940956 [debug] [MainThread]: Connection 'model.jaffle_shop.stg_payments' was properly closed.
[0m21:32:49.941398 [debug] [MainThread]: Connection 'model.jaffle_shop.customers' was properly closed.
[0m21:32:49.941926 [info ] [MainThread]: 
[0m21:32:49.942492 [info ] [MainThread]: Finished running 4 view models in 0 hours 0 minutes and 3.65 seconds (3.65s).
[0m21:32:49.944400 [debug] [MainThread]: Command end result
[0m21:32:49.960964 [info ] [MainThread]: 
[0m21:32:49.962396 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:32:49.963050 [info ] [MainThread]: 
[0m21:32:49.963740 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m21:32:49.968893 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 5.057345, "process_user_time": 5.351743, "process_kernel_time": 0.892341, "process_mem_max_rss": "137371648", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m21:32:49.970827 [debug] [MainThread]: Command `dbt run` succeeded at 21:32:49.970499 after 5.06 seconds
[0m21:32:49.971783 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10904ca50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105221e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1092f38d0>]}
[0m21:32:49.972615 [debug] [MainThread]: Flushing usage events
[0m21:55:44.464446 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112b3c650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10eba4690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112e8fdd0>]}


============================== 21:55:44.473962 | aeeee37f-4a6c-46a9-a698-4f781cb07f50 ==============================
[0m21:55:44.473962 [info ] [MainThread]: Running with dbt=1.7.8
[0m21:55:44.475690 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/ben/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/Users/ben/jaffle_shop/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt compile --select int_orders__pivoted', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:55:45.248298 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'aeeee37f-4a6c-46a9-a698-4f781cb07f50', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1137d8fd0>]}
[0m21:55:45.378729 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'aeeee37f-4a6c-46a9-a698-4f781cb07f50', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112ed5c50>]}
[0m21:55:45.381378 [info ] [MainThread]: Registered adapter: snowflake=1.7.2
[0m21:55:45.410003 [debug] [MainThread]: checksum: 67f0013ca5f0bd43af9a0873dd50792fde83ef69de63b71cacd0b4ac656c52e5, vars: {}, profile: , target: , version: 1.7.8
[0m21:55:45.519060 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m21:55:45.520078 [debug] [MainThread]: Partial parsing: added file: jaffle_shop://models/marts/core/int_orders__pivoted.sql
[0m21:55:45.737195 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'aeeee37f-4a6c-46a9-a698-4f781cb07f50', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113b9ee50>]}
[0m21:55:45.756080 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'aeeee37f-4a6c-46a9-a698-4f781cb07f50', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113937190>]}
[0m21:55:45.756890 [info ] [MainThread]: Found 5 models, 3 seeds, 11 tests, 0 sources, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m21:55:45.757500 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'aeeee37f-4a6c-46a9-a698-4f781cb07f50', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1137db110>]}
[0m21:55:45.760351 [info ] [MainThread]: 
[0m21:55:45.761627 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m21:55:45.763453 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RAW_JAFFLE_SHOP'
[0m21:55:45.786196 [debug] [ThreadPool]: Using snowflake connection "list_RAW_JAFFLE_SHOP"
[0m21:55:45.786977 [debug] [ThreadPool]: On list_RAW_JAFFLE_SHOP: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_RAW_JAFFLE_SHOP"} */
show terse objects in RAW.JAFFLE_SHOP limit 10000
[0m21:55:45.788347 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:55:46.733427 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.0 seconds
[0m21:55:46.738991 [debug] [ThreadPool]: On list_RAW_JAFFLE_SHOP: Close
[0m21:55:46.905203 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'aeeee37f-4a6c-46a9-a698-4f781cb07f50', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1139d5690>]}
[0m21:55:46.907161 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:55:46.908157 [info ] [MainThread]: 
[0m21:55:46.913705 [debug] [Thread-1 (]: Began running node model.jaffle_shop.int_orders__pivoted
[0m21:55:46.915296 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_RAW_JAFFLE_SHOP, now model.jaffle_shop.int_orders__pivoted)
[0m21:55:46.916177 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.int_orders__pivoted
[0m21:55:46.930409 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.int_orders__pivoted"
[0m21:55:46.932389 [debug] [Thread-1 (]: Timing info for model.jaffle_shop.int_orders__pivoted (compile): 21:55:46.916630 => 21:55:46.931950
[0m21:55:46.933030 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.int_orders__pivoted
[0m21:55:46.933753 [debug] [Thread-1 (]: Timing info for model.jaffle_shop.int_orders__pivoted (execute): 21:55:46.933400 => 21:55:46.933442
[0m21:55:46.935383 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.int_orders__pivoted
[0m21:55:46.937077 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:55:46.938219 [debug] [MainThread]: Connection 'model.jaffle_shop.int_orders__pivoted' was properly closed.
[0m21:55:46.939715 [debug] [MainThread]: Command end result
[0m21:55:46.954132 [info ] [MainThread]: Compiled node 'int_orders__pivoted' is:


WITH payments AS (
    SELECT * FROM RAW.JAFFLE_SHOP.stg_payments
),

pivoted AS (
    SELECT
        order_id,

        

        SUM(CASE WHEN payment_method = 'bank_transfer' THEN amount ELSE 0 END) AS bank_transfer_amount
        
            ,
        

        

        SUM(CASE WHEN payment_method = 'coupon' THEN amount ELSE 0 END) AS coupon_amount
        
            ,
        

        

        SUM(CASE WHEN payment_method = 'credit_card' THEN amount ELSE 0 END) AS credit_card_amount
        
            ,
        

        

        SUM(CASE WHEN payment_method = 'gift_card' THEN amount ELSE 0 END) AS gift_card_amount
        

        

    FROM payments
    WHERE status = 'success'
    GROUP BY 1
)
[0m21:55:46.956639 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_success": true, "command_wall_clock_time": 2.581078, "process_user_time": 4.070062, "process_kernel_time": 0.618077, "process_mem_max_rss": "135831552", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m21:55:46.957618 [debug] [MainThread]: Command `dbt compile` succeeded at 21:55:46.957401 after 2.58 seconds
[0m21:55:46.958407 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112bb7750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112871c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10eb05d10>]}
[0m21:55:46.959194 [debug] [MainThread]: Flushing usage events
[0m21:56:45.399493 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10825b890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1085d6550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1085e4e10>]}


============================== 21:56:45.409289 | d96f8d1d-7a9b-4001-b7b4-43cb817b6fa2 ==============================
[0m21:56:45.409289 [info ] [MainThread]: Running with dbt=1.7.8
[0m21:56:45.410559 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/ben/jaffle_shop/logs', 'profiles_dir': '/Users/ben/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt compile --select int_orders__pivoted', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:56:46.138671 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd96f8d1d-7a9b-4001-b7b4-43cb817b6fa2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108eda090>]}
[0m21:56:46.266550 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd96f8d1d-7a9b-4001-b7b4-43cb817b6fa2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1085d6590>]}
[0m21:56:46.268624 [info ] [MainThread]: Registered adapter: snowflake=1.7.2
[0m21:56:46.296009 [debug] [MainThread]: checksum: 67f0013ca5f0bd43af9a0873dd50792fde83ef69de63b71cacd0b4ac656c52e5, vars: {}, profile: , target: , version: 1.7.8
[0m21:56:46.399248 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m21:56:46.400337 [debug] [MainThread]: Partial parsing: updated file: jaffle_shop://models/marts/core/int_orders__pivoted.sql
[0m21:56:46.615569 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd96f8d1d-7a9b-4001-b7b4-43cb817b6fa2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1090ef250>]}
[0m21:56:46.633838 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd96f8d1d-7a9b-4001-b7b4-43cb817b6fa2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10907a6d0>]}
[0m21:56:46.634643 [info ] [MainThread]: Found 5 models, 3 seeds, 11 tests, 0 sources, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m21:56:46.635288 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd96f8d1d-7a9b-4001-b7b4-43cb817b6fa2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1090d5ed0>]}
[0m21:56:46.638232 [info ] [MainThread]: 
[0m21:56:46.639792 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m21:56:46.641986 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RAW_JAFFLE_SHOP'
[0m21:56:46.665379 [debug] [ThreadPool]: Using snowflake connection "list_RAW_JAFFLE_SHOP"
[0m21:56:46.666151 [debug] [ThreadPool]: On list_RAW_JAFFLE_SHOP: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_RAW_JAFFLE_SHOP"} */
show terse objects in RAW.JAFFLE_SHOP limit 10000
[0m21:56:46.666752 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:56:47.434339 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.0 seconds
[0m21:56:47.439612 [debug] [ThreadPool]: On list_RAW_JAFFLE_SHOP: Close
[0m21:56:47.602258 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd96f8d1d-7a9b-4001-b7b4-43cb817b6fa2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10918be10>]}
[0m21:56:47.604182 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:56:47.605253 [info ] [MainThread]: 
[0m21:56:47.610525 [debug] [Thread-1 (]: Began running node model.jaffle_shop.int_orders__pivoted
[0m21:56:47.612062 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_RAW_JAFFLE_SHOP, now model.jaffle_shop.int_orders__pivoted)
[0m21:56:47.612933 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.int_orders__pivoted
[0m21:56:47.626949 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.int_orders__pivoted"
[0m21:56:47.628304 [debug] [Thread-1 (]: Timing info for model.jaffle_shop.int_orders__pivoted (compile): 21:56:47.613741 => 21:56:47.627895
[0m21:56:47.628938 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.int_orders__pivoted
[0m21:56:47.629672 [debug] [Thread-1 (]: Timing info for model.jaffle_shop.int_orders__pivoted (execute): 21:56:47.629309 => 21:56:47.629353
[0m21:56:47.633167 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.int_orders__pivoted
[0m21:56:47.635254 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:56:47.636163 [debug] [MainThread]: Connection 'model.jaffle_shop.int_orders__pivoted' was properly closed.
[0m21:56:47.637359 [debug] [MainThread]: Command end result
[0m21:56:47.651044 [info ] [MainThread]: Compiled node 'int_orders__pivoted' is:


WITH payments AS (
    SELECT * FROM RAW.JAFFLE_SHOP.stg_payments
),

pivoted AS (
    SELECT
        order_id,

        SUM(CASE WHEN payment_method = 'bank_transfer' THEN amount ELSE 0 END) AS bank_transfer_amount
        
            ,
        

        SUM(CASE WHEN payment_method = 'coupon' THEN amount ELSE 0 END) AS coupon_amount
        
            ,
        

        SUM(CASE WHEN payment_method = 'credit_card' THEN amount ELSE 0 END) AS credit_card_amount
        
            ,
        

        SUM(CASE WHEN payment_method = 'gift_card' THEN amount ELSE 0 END) AS gift_card_amount
        

        

    FROM payments
    WHERE status = 'success'
    GROUP BY 1
)
[0m21:56:47.654127 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_success": true, "command_wall_clock_time": 2.3388984, "process_user_time": 4.077323, "process_kernel_time": 0.576262, "process_mem_max_rss": "136728576", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m21:56:47.655160 [debug] [MainThread]: Command `dbt compile` succeeded at 21:56:47.654945 after 2.34 seconds
[0m21:56:47.655960 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f53b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108265fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104225d50>]}
[0m21:56:47.656677 [debug] [MainThread]: Flushing usage events
[0m21:57:15.788947 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113092a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112a8a350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112a8a650>]}


============================== 21:57:15.795186 | 9b375598-e057-4606-ba3d-d465263e81f7 ==============================
[0m21:57:15.795186 [info ] [MainThread]: Running with dbt=1.7.8
[0m21:57:15.796350 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/ben/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/ben/jaffle_shop/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt compile --select int_orders__pivoted', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:57:16.329936 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9b375598-e057-4606-ba3d-d465263e81f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113876690>]}
[0m21:57:16.458614 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9b375598-e057-4606-ba3d-d465263e81f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1130e3b90>]}
[0m21:57:16.459905 [info ] [MainThread]: Registered adapter: snowflake=1.7.2
[0m21:57:16.482568 [debug] [MainThread]: checksum: 67f0013ca5f0bd43af9a0873dd50792fde83ef69de63b71cacd0b4ac656c52e5, vars: {}, profile: , target: , version: 1.7.8
[0m21:57:16.536704 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m21:57:16.538279 [debug] [MainThread]: Partial parsing: updated file: jaffle_shop://models/marts/core/int_orders__pivoted.sql
[0m21:57:16.750951 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9b375598-e057-4606-ba3d-d465263e81f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113d77710>]}
[0m21:57:16.768090 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9b375598-e057-4606-ba3d-d465263e81f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113b12710>]}
[0m21:57:16.768893 [info ] [MainThread]: Found 5 models, 3 seeds, 11 tests, 0 sources, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m21:57:16.769499 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9b375598-e057-4606-ba3d-d465263e81f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113d8c310>]}
[0m21:57:16.771853 [info ] [MainThread]: 
[0m21:57:16.773060 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m21:57:16.774946 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RAW_JAFFLE_SHOP'
[0m21:57:16.799537 [debug] [ThreadPool]: Using snowflake connection "list_RAW_JAFFLE_SHOP"
[0m21:57:16.800520 [debug] [ThreadPool]: On list_RAW_JAFFLE_SHOP: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_RAW_JAFFLE_SHOP"} */
show terse objects in RAW.JAFFLE_SHOP limit 10000
[0m21:57:16.801162 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:57:17.980774 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.0 seconds
[0m21:57:17.985819 [debug] [ThreadPool]: On list_RAW_JAFFLE_SHOP: Close
[0m21:57:18.147609 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9b375598-e057-4606-ba3d-d465263e81f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11381a7d0>]}
[0m21:57:18.149539 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:57:18.150668 [info ] [MainThread]: 
[0m21:57:18.155678 [debug] [Thread-1 (]: Began running node model.jaffle_shop.int_orders__pivoted
[0m21:57:18.157173 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_RAW_JAFFLE_SHOP, now model.jaffle_shop.int_orders__pivoted)
[0m21:57:18.158021 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.int_orders__pivoted
[0m21:57:18.171374 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.int_orders__pivoted"
[0m21:57:18.172850 [debug] [Thread-1 (]: Timing info for model.jaffle_shop.int_orders__pivoted (compile): 21:57:18.158570 => 21:57:18.172425
[0m21:57:18.173631 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.int_orders__pivoted
[0m21:57:18.174392 [debug] [Thread-1 (]: Timing info for model.jaffle_shop.int_orders__pivoted (execute): 21:57:18.174028 => 21:57:18.174065
[0m21:57:18.177045 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.int_orders__pivoted
[0m21:57:18.179307 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:57:18.180019 [debug] [MainThread]: Connection 'model.jaffle_shop.int_orders__pivoted' was properly closed.
[0m21:57:18.181130 [debug] [MainThread]: Command end result
[0m21:57:18.194125 [info ] [MainThread]: Compiled node 'int_orders__pivoted' is:


WITH payments AS (
    SELECT * FROM RAW.JAFFLE_SHOP.stg_payments
),

pivoted AS (
    SELECT
        order_id,

        SUM(CASE WHEN payment_method = 'bank_transfer' THEN amount ELSE 0 END) AS bank_transfer_amount,
        

        SUM(CASE WHEN payment_method = 'coupon' THEN amount ELSE 0 END) AS coupon_amount,
        

        SUM(CASE WHEN payment_method = 'credit_card' THEN amount ELSE 0 END) AS credit_card_amount,
        

        SUM(CASE WHEN payment_method = 'gift_card' THEN amount ELSE 0 END) AS gift_card_amount

        

    FROM payments
    WHERE status = 'success'
    GROUP BY 1
)
[0m21:57:18.196135 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_success": true, "command_wall_clock_time": 2.4862194, "process_user_time": 3.874459, "process_kernel_time": 0.363151, "process_mem_max_rss": "136937472", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m21:57:18.197088 [debug] [MainThread]: Command `dbt compile` succeeded at 21:57:18.196854 after 2.49 seconds
[0m21:57:18.197741 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113092b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113093390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ed7a650>]}
[0m21:57:18.198362 [debug] [MainThread]: Flushing usage events
[0m21:57:48.026753 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10695bd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a44650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a298d0>]}


============================== 21:57:48.032694 | 2f673b21-d24f-40b3-b8d8-6fe14bde6ac3 ==============================
[0m21:57:48.032694 [info ] [MainThread]: Running with dbt=1.7.8
[0m21:57:48.033831 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/ben/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/ben/jaffle_shop/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt compile --select int_orders__pivoted', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:57:48.563887 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2f673b21-d24f-40b3-b8d8-6fe14bde6ac3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106deb2d0>]}
[0m21:57:48.692386 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2f673b21-d24f-40b3-b8d8-6fe14bde6ac3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f55990>]}
[0m21:57:48.693613 [info ] [MainThread]: Registered adapter: snowflake=1.7.2
[0m21:57:48.717163 [debug] [MainThread]: checksum: 67f0013ca5f0bd43af9a0873dd50792fde83ef69de63b71cacd0b4ac656c52e5, vars: {}, profile: , target: , version: 1.7.8
[0m21:57:48.768123 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m21:57:48.769624 [debug] [MainThread]: Partial parsing: updated file: jaffle_shop://models/marts/core/int_orders__pivoted.sql
[0m21:57:48.981243 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2f673b21-d24f-40b3-b8d8-6fe14bde6ac3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107aa3890>]}
[0m21:57:48.998139 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2f673b21-d24f-40b3-b8d8-6fe14bde6ac3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10783b0d0>]}
[0m21:57:48.998910 [info ] [MainThread]: Found 5 models, 3 seeds, 11 tests, 0 sources, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m21:57:48.999518 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2f673b21-d24f-40b3-b8d8-6fe14bde6ac3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107792ed0>]}
[0m21:57:49.002130 [info ] [MainThread]: 
[0m21:57:49.003599 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m21:57:49.005528 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RAW_JAFFLE_SHOP'
[0m21:57:49.030141 [debug] [ThreadPool]: Using snowflake connection "list_RAW_JAFFLE_SHOP"
[0m21:57:49.031059 [debug] [ThreadPool]: On list_RAW_JAFFLE_SHOP: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_RAW_JAFFLE_SHOP"} */
show terse objects in RAW.JAFFLE_SHOP limit 10000
[0m21:57:49.031649 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:57:49.711436 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.0 seconds
[0m21:57:49.717229 [debug] [ThreadPool]: On list_RAW_JAFFLE_SHOP: Close
[0m21:57:49.858888 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2f673b21-d24f-40b3-b8d8-6fe14bde6ac3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107929f10>]}
[0m21:57:49.860830 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:57:49.861726 [info ] [MainThread]: 
[0m21:57:49.866260 [debug] [Thread-1 (]: Began running node model.jaffle_shop.int_orders__pivoted
[0m21:57:49.867807 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_RAW_JAFFLE_SHOP, now model.jaffle_shop.int_orders__pivoted)
[0m21:57:49.868660 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.int_orders__pivoted
[0m21:57:49.882197 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.int_orders__pivoted"
[0m21:57:49.883516 [debug] [Thread-1 (]: Timing info for model.jaffle_shop.int_orders__pivoted (compile): 21:57:49.869084 => 21:57:49.883134
[0m21:57:49.884295 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.int_orders__pivoted
[0m21:57:49.885039 [debug] [Thread-1 (]: Timing info for model.jaffle_shop.int_orders__pivoted (execute): 21:57:49.884680 => 21:57:49.884718
[0m21:57:49.886731 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.int_orders__pivoted
[0m21:57:49.889598 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:57:49.890248 [debug] [MainThread]: Connection 'model.jaffle_shop.int_orders__pivoted' was properly closed.
[0m21:57:49.891293 [debug] [MainThread]: Command end result
[0m21:57:49.904667 [info ] [MainThread]: Compiled node 'int_orders__pivoted' is:


WITH payments AS (
    SELECT * FROM RAW.JAFFLE_SHOP.stg_payments
),

pivoted AS (
    SELECT
        order_id,

        SUM(CASE WHEN payment_method = 'bank_transfer' THEN amount ELSE 0 END) AS bank_transfer_amount,
        SUM(CASE WHEN payment_method = 'coupon' THEN amount ELSE 0 END) AS coupon_amount,
        SUM(CASE WHEN payment_method = 'credit_card' THEN amount ELSE 0 END) AS credit_card_amount,
        SUM(CASE WHEN payment_method = 'gift_card' THEN amount ELSE 0 END) AS gift_card_amountFROM payments
    WHERE status = 'success'
    GROUP BY 1
)
[0m21:57:49.906679 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_success": true, "command_wall_clock_time": 1.9607381, "process_user_time": 3.861358, "process_kernel_time": 0.338575, "process_mem_max_rss": "137945088", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m21:57:49.907591 [debug] [MainThread]: Command `dbt compile` succeeded at 21:57:49.907372 after 1.96 seconds
[0m21:57:49.908248 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a461d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10682b910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102a06650>]}
[0m21:57:49.908989 [debug] [MainThread]: Flushing usage events
[0m21:58:23.760864 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108160790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1081d2010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1081d1f90>]}


============================== 21:58:23.766618 | 5e89bf70-e3ab-4bc7-bc46-9f91b3ea07b1 ==============================
[0m21:58:23.766618 [info ] [MainThread]: Running with dbt=1.7.8
[0m21:58:23.767629 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/ben/jaffle_shop/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/ben/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt compile --select int_orders__pivoted', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:58:24.328970 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5e89bf70-e3ab-4bc7-bc46-9f91b3ea07b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108dc4b10>]}
[0m21:58:24.457440 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5e89bf70-e3ab-4bc7-bc46-9f91b3ea07b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10823be90>]}
[0m21:58:24.458684 [info ] [MainThread]: Registered adapter: snowflake=1.7.2
[0m21:58:24.481995 [debug] [MainThread]: checksum: 67f0013ca5f0bd43af9a0873dd50792fde83ef69de63b71cacd0b4ac656c52e5, vars: {}, profile: , target: , version: 1.7.8
[0m21:58:24.533672 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m21:58:24.535061 [debug] [MainThread]: Partial parsing: updated file: jaffle_shop://models/marts/core/int_orders__pivoted.sql
[0m21:58:24.747038 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5e89bf70-e3ab-4bc7-bc46-9f91b3ea07b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109174ad0>]}
[0m21:58:24.763820 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5e89bf70-e3ab-4bc7-bc46-9f91b3ea07b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108e94290>]}
[0m21:58:24.764610 [info ] [MainThread]: Found 5 models, 3 seeds, 11 tests, 0 sources, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m21:58:24.765208 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5e89bf70-e3ab-4bc7-bc46-9f91b3ea07b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108bd0e10>]}
[0m21:58:24.767448 [info ] [MainThread]: 
[0m21:58:24.768871 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m21:58:24.771075 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RAW_JAFFLE_SHOP'
[0m21:58:24.795328 [debug] [ThreadPool]: Using snowflake connection "list_RAW_JAFFLE_SHOP"
[0m21:58:24.796144 [debug] [ThreadPool]: On list_RAW_JAFFLE_SHOP: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_RAW_JAFFLE_SHOP"} */
show terse objects in RAW.JAFFLE_SHOP limit 10000
[0m21:58:24.796895 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:58:25.393129 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.0 seconds
[0m21:58:25.398705 [debug] [ThreadPool]: On list_RAW_JAFFLE_SHOP: Close
[0m21:58:25.557455 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5e89bf70-e3ab-4bc7-bc46-9f91b3ea07b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108f83b90>]}
[0m21:58:25.559427 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:58:25.560323 [info ] [MainThread]: 
[0m21:58:25.564599 [debug] [Thread-1 (]: Began running node model.jaffle_shop.int_orders__pivoted
[0m21:58:25.566055 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_RAW_JAFFLE_SHOP, now model.jaffle_shop.int_orders__pivoted)
[0m21:58:25.566884 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.int_orders__pivoted
[0m21:58:25.581171 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.int_orders__pivoted"
[0m21:58:25.582526 [debug] [Thread-1 (]: Timing info for model.jaffle_shop.int_orders__pivoted (compile): 21:58:25.567379 => 21:58:25.582140
[0m21:58:25.583141 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.int_orders__pivoted
[0m21:58:25.583857 [debug] [Thread-1 (]: Timing info for model.jaffle_shop.int_orders__pivoted (execute): 21:58:25.583506 => 21:58:25.583544
[0m21:58:25.585488 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.int_orders__pivoted
[0m21:58:25.588025 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:58:25.588752 [debug] [MainThread]: Connection 'model.jaffle_shop.int_orders__pivoted' was properly closed.
[0m21:58:25.589706 [debug] [MainThread]: Command end result
[0m21:58:25.604301 [info ] [MainThread]: Compiled node 'int_orders__pivoted' is:


WITH payments AS (
    SELECT * FROM RAW.JAFFLE_SHOP.stg_payments
),

pivoted AS (
    SELECT
        order_id,SUM(CASE WHEN payment_method = 'bank_transfer' THEN amount ELSE 0 END) AS bank_transfer_amount,
        SUM(CASE WHEN payment_method = 'coupon' THEN amount ELSE 0 END) AS coupon_amount,
        SUM(CASE WHEN payment_method = 'credit_card' THEN amount ELSE 0 END) AS credit_card_amount,
        SUM(CASE WHEN payment_method = 'gift_card' THEN amount ELSE 0 END) AS gift_card_amount

    FROM payments
    WHERE status = 'success'
    GROUP BY 1
)
[0m21:58:25.606322 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_success": true, "command_wall_clock_time": 1.9249071, "process_user_time": 3.872132, "process_kernel_time": 0.369083, "process_mem_max_rss": "135663616", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m21:58:25.607242 [debug] [MainThread]: Command `dbt compile` succeeded at 21:58:25.607030 after 1.93 seconds
[0m21:58:25.607878 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e83650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e6cd50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e23d50>]}
[0m21:58:25.608491 [debug] [MainThread]: Flushing usage events
[0m21:58:53.038382 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c34d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c84d050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c84c350>]}


============================== 21:58:53.044488 | 77adb6af-7666-498f-85cd-832349d621a6 ==============================
[0m21:58:53.044488 [info ] [MainThread]: Running with dbt=1.7.8
[0m21:58:53.045688 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/ben/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/ben/jaffle_shop/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt compile --select int_orders__pivoted', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:58:53.606251 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '77adb6af-7666-498f-85cd-832349d621a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cb19510>]}
[0m21:58:53.736685 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '77adb6af-7666-498f-85cd-832349d621a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ce92390>]}
[0m21:58:53.738021 [info ] [MainThread]: Registered adapter: snowflake=1.7.2
[0m21:58:53.761209 [debug] [MainThread]: checksum: 67f0013ca5f0bd43af9a0873dd50792fde83ef69de63b71cacd0b4ac656c52e5, vars: {}, profile: , target: , version: 1.7.8
[0m21:58:53.813664 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m21:58:53.814813 [debug] [MainThread]: Partial parsing: updated file: jaffle_shop://models/marts/core/int_orders__pivoted.sql
[0m21:58:54.028291 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '77adb6af-7666-498f-85cd-832349d621a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dbb7950>]}
[0m21:58:54.044752 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '77adb6af-7666-498f-85cd-832349d621a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d93a6d0>]}
[0m21:58:54.045858 [info ] [MainThread]: Found 5 models, 3 seeds, 11 tests, 0 sources, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m21:58:54.046624 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '77adb6af-7666-498f-85cd-832349d621a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dbaa4d0>]}
[0m21:58:54.050115 [info ] [MainThread]: 
[0m21:58:54.051406 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m21:58:54.053268 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RAW_JAFFLE_SHOP'
[0m21:58:54.074599 [debug] [ThreadPool]: Using snowflake connection "list_RAW_JAFFLE_SHOP"
[0m21:58:54.075306 [debug] [ThreadPool]: On list_RAW_JAFFLE_SHOP: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_RAW_JAFFLE_SHOP"} */
show terse objects in RAW.JAFFLE_SHOP limit 10000
[0m21:58:54.075841 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:58:54.829210 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.0 seconds
[0m21:58:54.832652 [debug] [ThreadPool]: On list_RAW_JAFFLE_SHOP: Close
[0m21:58:54.978399 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '77adb6af-7666-498f-85cd-832349d621a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10da2f050>]}
[0m21:58:54.980376 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:58:54.981463 [info ] [MainThread]: 
[0m21:58:54.986735 [debug] [Thread-1 (]: Began running node model.jaffle_shop.int_orders__pivoted
[0m21:58:54.988333 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_RAW_JAFFLE_SHOP, now model.jaffle_shop.int_orders__pivoted)
[0m21:58:54.989173 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.int_orders__pivoted
[0m21:58:55.002487 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.int_orders__pivoted"
[0m21:58:55.003830 [debug] [Thread-1 (]: Timing info for model.jaffle_shop.int_orders__pivoted (compile): 21:58:54.989727 => 21:58:55.003432
[0m21:58:55.004453 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.int_orders__pivoted
[0m21:58:55.005389 [debug] [Thread-1 (]: Timing info for model.jaffle_shop.int_orders__pivoted (execute): 21:58:55.004989 => 21:58:55.005032
[0m21:58:55.007329 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.int_orders__pivoted
[0m21:58:55.010274 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:58:55.011004 [debug] [MainThread]: Connection 'model.jaffle_shop.int_orders__pivoted' was properly closed.
[0m21:58:55.011984 [debug] [MainThread]: Command end result
[0m21:58:55.024406 [info ] [MainThread]: Compiled node 'int_orders__pivoted' is:


WITH payments AS (
    SELECT * FROM RAW.JAFFLE_SHOP.stg_payments
),

pivoted AS (
    SELECT
        order_id,

        SUM(CASE WHEN payment_method = 'bank_transfer' THEN amount ELSE 0 END) AS bank_transfer_amount,
        SUM(CASE WHEN payment_method = 'coupon' THEN amount ELSE 0 END) AS coupon_amount,
        SUM(CASE WHEN payment_method = 'credit_card' THEN amount ELSE 0 END) AS credit_card_amount,
        SUM(CASE WHEN payment_method = 'gift_card' THEN amount ELSE 0 END) AS gift_card_amount

    FROM payments
    WHERE status = 'success'
    GROUP BY 1
)
[0m21:58:55.026329 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_success": true, "command_wall_clock_time": 2.0844827, "process_user_time": 3.881828, "process_kernel_time": 0.343806, "process_mem_max_rss": "134983680", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m21:58:55.027275 [debug] [MainThread]: Command `dbt compile` succeeded at 21:58:55.027052 after 2.09 seconds
[0m21:58:55.027931 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cb54b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d81b010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c890150>]}
[0m21:58:55.028558 [debug] [MainThread]: Flushing usage events
[0m22:01:02.022363 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113a26a50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1136801d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113683350>]}


============================== 22:01:02.028401 | 4a59119d-49af-4063-aaea-48d75a392f57 ==============================
[0m22:01:02.028401 [info ] [MainThread]: Running with dbt=1.7.8
[0m22:01:02.029373 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/ben/jaffle_shop/logs', 'profiles_dir': '/Users/ben/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt compile --select int_orders__pivoted', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m22:01:02.574021 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4a59119d-49af-4063-aaea-48d75a392f57', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1143ce1d0>]}
[0m22:01:02.703526 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4a59119d-49af-4063-aaea-48d75a392f57', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113a4f950>]}
[0m22:01:02.704818 [info ] [MainThread]: Registered adapter: snowflake=1.7.2
[0m22:01:02.728401 [debug] [MainThread]: checksum: 67f0013ca5f0bd43af9a0873dd50792fde83ef69de63b71cacd0b4ac656c52e5, vars: {}, profile: , target: , version: 1.7.8
[0m22:01:02.782755 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m22:01:02.784017 [debug] [MainThread]: Partial parsing: updated file: jaffle_shop://models/marts/core/int_orders__pivoted.sql
[0m22:01:02.996284 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4a59119d-49af-4063-aaea-48d75a392f57', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114737150>]}
[0m22:01:03.014455 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4a59119d-49af-4063-aaea-48d75a392f57', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1144c9f10>]}
[0m22:01:03.015293 [info ] [MainThread]: Found 5 models, 3 seeds, 11 tests, 0 sources, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m22:01:03.015897 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4a59119d-49af-4063-aaea-48d75a392f57', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1147079d0>]}
[0m22:01:03.018357 [info ] [MainThread]: 
[0m22:01:03.019691 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m22:01:03.022369 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RAW_JAFFLE_SHOP'
[0m22:01:03.047667 [debug] [ThreadPool]: Using snowflake connection "list_RAW_JAFFLE_SHOP"
[0m22:01:03.048487 [debug] [ThreadPool]: On list_RAW_JAFFLE_SHOP: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_RAW_JAFFLE_SHOP"} */
show terse objects in RAW.JAFFLE_SHOP limit 10000
[0m22:01:03.049086 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:01:04.120442 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.0 seconds
[0m22:01:04.125687 [debug] [ThreadPool]: On list_RAW_JAFFLE_SHOP: Close
[0m22:01:04.499612 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4a59119d-49af-4063-aaea-48d75a392f57', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11471f7d0>]}
[0m22:01:04.501593 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:01:04.502973 [info ] [MainThread]: 
[0m22:01:04.508731 [debug] [Thread-1 (]: Began running node model.jaffle_shop.int_orders__pivoted
[0m22:01:04.510267 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_RAW_JAFFLE_SHOP, now model.jaffle_shop.int_orders__pivoted)
[0m22:01:04.511094 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.int_orders__pivoted
[0m22:01:04.524844 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.int_orders__pivoted"
[0m22:01:04.526292 [debug] [Thread-1 (]: Timing info for model.jaffle_shop.int_orders__pivoted (compile): 22:01:04.511595 => 22:01:04.525864
[0m22:01:04.526913 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.int_orders__pivoted
[0m22:01:04.527766 [debug] [Thread-1 (]: Timing info for model.jaffle_shop.int_orders__pivoted (execute): 22:01:04.527277 => 22:01:04.527321
[0m22:01:04.529635 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.int_orders__pivoted
[0m22:01:04.532589 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:01:04.533209 [debug] [MainThread]: Connection 'model.jaffle_shop.int_orders__pivoted' was properly closed.
[0m22:01:04.534207 [debug] [MainThread]: Command end result
[0m22:01:04.548023 [info ] [MainThread]: Compiled node 'int_orders__pivoted' is:


WITH payments AS (
    SELECT * FROM RAW.JAFFLE_SHOP.stg_payments
),

pivoted AS (
    SELECT
        order_id,

        SUM(CASE WHEN payment_method = 'bank_transfer' THEN amount ELSE 0 END) AS bank_transfer_amount,
        SUM(CASE WHEN payment_method = 'coupon' THEN amount ELSE 0 END) AS coupon_amount,
        SUM(CASE WHEN payment_method = 'credit_card' THEN amount ELSE 0 END) AS credit_card_amount,
        SUM(CASE WHEN payment_method = 'gift_card' THEN amount ELSE 0 END) AS gift_card_amount

    FROM payments
    WHERE status = 'success'
    GROUP BY 1
)
[0m22:01:04.550122 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_success": true, "command_wall_clock_time": 2.6074977, "process_user_time": 3.90791, "process_kernel_time": 0.371871, "process_mem_max_rss": "137691136", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m22:01:04.551132 [debug] [MainThread]: Command `dbt compile` succeeded at 22:01:04.550910 after 2.61 seconds
[0m22:01:04.551816 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11383e850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113a03ad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f625dd0>]}
[0m22:01:04.552496 [debug] [MainThread]: Flushing usage events
[0m22:01:31.491558 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1134bff10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1134bd010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112ec5a90>]}


============================== 22:01:31.497430 | df5e0afd-2c3f-4ed4-bcf0-179ca62fe80b ==============================
[0m22:01:31.497430 [info ] [MainThread]: Running with dbt=1.7.8
[0m22:01:31.498486 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/ben/jaffle_shop/logs', 'profiles_dir': '/Users/ben/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt compile --select int_orders__pivoted', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:01:32.040912 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'df5e0afd-2c3f-4ed4-bcf0-179ca62fe80b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113e74810>]}
[0m22:01:32.167715 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'df5e0afd-2c3f-4ed4-bcf0-179ca62fe80b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113d07990>]}
[0m22:01:32.169004 [info ] [MainThread]: Registered adapter: snowflake=1.7.2
[0m22:01:32.191578 [debug] [MainThread]: checksum: 67f0013ca5f0bd43af9a0873dd50792fde83ef69de63b71cacd0b4ac656c52e5, vars: {}, profile: , target: , version: 1.7.8
[0m22:01:32.244105 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m22:01:32.245240 [debug] [MainThread]: Partial parsing: updated file: jaffle_shop://models/marts/core/int_orders__pivoted.sql
[0m22:01:32.458344 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'df5e0afd-2c3f-4ed4-bcf0-179ca62fe80b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114036290>]}
[0m22:01:32.476430 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'df5e0afd-2c3f-4ed4-bcf0-179ca62fe80b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113f91e50>]}
[0m22:01:32.477250 [info ] [MainThread]: Found 5 models, 3 seeds, 11 tests, 0 sources, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m22:01:32.477860 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'df5e0afd-2c3f-4ed4-bcf0-179ca62fe80b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112f54a50>]}
[0m22:01:32.480325 [info ] [MainThread]: 
[0m22:01:32.481535 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m22:01:32.483395 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RAW_JAFFLE_SHOP'
[0m22:01:32.504922 [debug] [ThreadPool]: Using snowflake connection "list_RAW_JAFFLE_SHOP"
[0m22:01:32.506149 [debug] [ThreadPool]: On list_RAW_JAFFLE_SHOP: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_RAW_JAFFLE_SHOP"} */
show terse objects in RAW.JAFFLE_SHOP limit 10000
[0m22:01:32.506927 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:01:33.163520 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.0 seconds
[0m22:01:33.168307 [debug] [ThreadPool]: On list_RAW_JAFFLE_SHOP: Close
[0m22:01:33.314090 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'df5e0afd-2c3f-4ed4-bcf0-179ca62fe80b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114283650>]}
[0m22:01:33.316051 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:01:33.317047 [info ] [MainThread]: 
[0m22:01:33.322087 [debug] [Thread-1 (]: Began running node model.jaffle_shop.int_orders__pivoted
[0m22:01:33.323666 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_RAW_JAFFLE_SHOP, now model.jaffle_shop.int_orders__pivoted)
[0m22:01:33.324513 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.int_orders__pivoted
[0m22:01:33.338284 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.int_orders__pivoted"
[0m22:01:33.339592 [debug] [Thread-1 (]: Timing info for model.jaffle_shop.int_orders__pivoted (compile): 22:01:33.325005 => 22:01:33.339186
[0m22:01:33.340207 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.int_orders__pivoted
[0m22:01:33.340912 [debug] [Thread-1 (]: Timing info for model.jaffle_shop.int_orders__pivoted (execute): 22:01:33.340563 => 22:01:33.340608
[0m22:01:33.342577 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.int_orders__pivoted
[0m22:01:33.345555 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:01:33.346167 [debug] [MainThread]: Connection 'model.jaffle_shop.int_orders__pivoted' was properly closed.
[0m22:01:33.347155 [debug] [MainThread]: Command end result
[0m22:01:33.360242 [info ] [MainThread]: Compiled node 'int_orders__pivoted' is:


WITH payments AS (
    SELECT * FROM RAW.JAFFLE_SHOP.stg_payments
),

pivoted AS (
    SELECT
        order_id,SUM(CASE WHEN payment_method = 'bank_transfer' THEN amount ELSE 0 END) AS bank_transfer_amount,
        SUM(CASE WHEN payment_method = 'coupon' THEN amount ELSE 0 END) AS coupon_amount,
        SUM(CASE WHEN payment_method = 'credit_card' THEN amount ELSE 0 END) AS credit_card_amount,
        SUM(CASE WHEN payment_method = 'gift_card' THEN amount ELSE 0 END) AS gift_card_amount

    FROM payments
    WHERE status = 'success'
    GROUP BY 1
)
[0m22:01:33.362269 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_success": true, "command_wall_clock_time": 1.951351, "process_user_time": 3.847951, "process_kernel_time": 0.36333, "process_mem_max_rss": "136404992", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m22:01:33.363201 [debug] [MainThread]: Command `dbt compile` succeeded at 22:01:33.362975 after 1.95 seconds
[0m22:01:33.363831 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1134bebd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113ed04d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112f41850>]}
[0m22:01:33.364523 [debug] [MainThread]: Flushing usage events
[0m22:01:48.020446 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11286a8d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e5eb350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e5e8e50>]}


============================== 22:01:48.026211 | f985dea7-35bf-4d79-a748-772133a20347 ==============================
[0m22:01:48.026211 [info ] [MainThread]: Running with dbt=1.7.8
[0m22:01:48.027240 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/ben/jaffle_shop/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/ben/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt compile --select int_orders__pivoted', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m22:01:48.557526 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f985dea7-35bf-4d79-a748-772133a20347', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1124c9d90>]}
[0m22:01:48.685916 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f985dea7-35bf-4d79-a748-772133a20347', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112205150>]}
[0m22:01:48.687166 [info ] [MainThread]: Registered adapter: snowflake=1.7.2
[0m22:01:48.710164 [debug] [MainThread]: checksum: 67f0013ca5f0bd43af9a0873dd50792fde83ef69de63b71cacd0b4ac656c52e5, vars: {}, profile: , target: , version: 1.7.8
[0m22:01:48.761416 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m22:01:48.762696 [debug] [MainThread]: Partial parsing: updated file: jaffle_shop://models/marts/core/int_orders__pivoted.sql
[0m22:01:48.975237 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f985dea7-35bf-4d79-a748-772133a20347', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113398950>]}
[0m22:01:48.991749 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f985dea7-35bf-4d79-a748-772133a20347', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1133128d0>]}
[0m22:01:48.992561 [info ] [MainThread]: Found 5 models, 3 seeds, 11 tests, 0 sources, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m22:01:48.993175 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f985dea7-35bf-4d79-a748-772133a20347', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1132c8a10>]}
[0m22:01:48.995704 [info ] [MainThread]: 
[0m22:01:48.997071 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m22:01:48.999057 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RAW_JAFFLE_SHOP'
[0m22:01:49.023952 [debug] [ThreadPool]: Using snowflake connection "list_RAW_JAFFLE_SHOP"
[0m22:01:49.024858 [debug] [ThreadPool]: On list_RAW_JAFFLE_SHOP: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_RAW_JAFFLE_SHOP"} */
show terse objects in RAW.JAFFLE_SHOP limit 10000
[0m22:01:49.025596 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:01:49.933486 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.0 seconds
[0m22:01:49.938974 [debug] [ThreadPool]: On list_RAW_JAFFLE_SHOP: Close
[0m22:01:50.092731 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f985dea7-35bf-4d79-a748-772133a20347', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1133d3650>]}
[0m22:01:50.094891 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:01:50.095835 [info ] [MainThread]: 
[0m22:01:50.100655 [debug] [Thread-1 (]: Began running node model.jaffle_shop.int_orders__pivoted
[0m22:01:50.102152 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_RAW_JAFFLE_SHOP, now model.jaffle_shop.int_orders__pivoted)
[0m22:01:50.102963 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.int_orders__pivoted
[0m22:01:50.116545 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.int_orders__pivoted"
[0m22:01:50.117875 [debug] [Thread-1 (]: Timing info for model.jaffle_shop.int_orders__pivoted (compile): 22:01:50.103454 => 22:01:50.117488
[0m22:01:50.118486 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.int_orders__pivoted
[0m22:01:50.119291 [debug] [Thread-1 (]: Timing info for model.jaffle_shop.int_orders__pivoted (execute): 22:01:50.118844 => 22:01:50.118913
[0m22:01:50.120990 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.int_orders__pivoted
[0m22:01:50.123841 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:01:50.124452 [debug] [MainThread]: Connection 'model.jaffle_shop.int_orders__pivoted' was properly closed.
[0m22:01:50.125438 [debug] [MainThread]: Command end result
[0m22:01:50.140568 [info ] [MainThread]: Compiled node 'int_orders__pivoted' is:


WITH payments AS (
    SELECT * FROM RAW.JAFFLE_SHOP.stg_payments
),

pivoted AS (
    SELECT
        order_id,

        SUM(CASE WHEN payment_method = 'bank_transfer' THEN amount ELSE 0 END) AS bank_transfer_amount,
        SUM(CASE WHEN payment_method = 'coupon' THEN amount ELSE 0 END) AS coupon_amount,
        SUM(CASE WHEN payment_method = 'credit_card' THEN amount ELSE 0 END) AS credit_card_amount,
        SUM(CASE WHEN payment_method = 'gift_card' THEN amount ELSE 0 END) AS gift_card_amount

    FROM payments
    WHERE status = 'success'
    GROUP BY 1
)
[0m22:01:50.142525 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_success": true, "command_wall_clock_time": 2.2043316, "process_user_time": 3.850481, "process_kernel_time": 0.335845, "process_mem_max_rss": "135696384", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m22:01:50.143453 [debug] [MainThread]: Command `dbt compile` succeeded at 22:01:50.143227 after 2.21 seconds
[0m22:01:50.144079 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11286a8d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1124fc9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112150d90>]}
[0m22:01:50.144708 [debug] [MainThread]: Flushing usage events
[0m22:02:14.363280 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10605c750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e09a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d2ba10>]}


============================== 22:02:14.369610 | bc15f130-9a04-470b-86f8-42c888dce50a ==============================
[0m22:02:14.369610 [info ] [MainThread]: Running with dbt=1.7.8
[0m22:02:14.371134 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/Users/ben/.dbt', 'log_path': '/Users/ben/jaffle_shop/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt compile --select int_orders__pivoted', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m22:02:14.910131 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bc15f130-9a04-470b-86f8-42c888dce50a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b62710>]}
[0m22:02:15.041273 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bc15f130-9a04-470b-86f8-42c888dce50a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063e8c50>]}
[0m22:02:15.042563 [info ] [MainThread]: Registered adapter: snowflake=1.7.2
[0m22:02:15.065875 [debug] [MainThread]: checksum: 67f0013ca5f0bd43af9a0873dd50792fde83ef69de63b71cacd0b4ac656c52e5, vars: {}, profile: , target: , version: 1.7.8
[0m22:02:15.118106 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m22:02:15.119278 [debug] [MainThread]: Partial parsing: updated file: jaffle_shop://models/marts/core/int_orders__pivoted.sql
[0m22:02:15.336324 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bc15f130-9a04-470b-86f8-42c888dce50a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10708c7d0>]}
[0m22:02:15.352902 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bc15f130-9a04-470b-86f8-42c888dce50a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e12650>]}
[0m22:02:15.353685 [info ] [MainThread]: Found 5 models, 3 seeds, 11 tests, 0 sources, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m22:02:15.354300 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bc15f130-9a04-470b-86f8-42c888dce50a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107075b50>]}
[0m22:02:15.356542 [info ] [MainThread]: 
[0m22:02:15.357901 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m22:02:15.359818 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RAW_JAFFLE_SHOP'
[0m22:02:15.384075 [debug] [ThreadPool]: Using snowflake connection "list_RAW_JAFFLE_SHOP"
[0m22:02:15.384791 [debug] [ThreadPool]: On list_RAW_JAFFLE_SHOP: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_RAW_JAFFLE_SHOP"} */
show terse objects in RAW.JAFFLE_SHOP limit 10000
[0m22:02:15.385429 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:02:16.521126 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.0 seconds
[0m22:02:16.527348 [debug] [ThreadPool]: On list_RAW_JAFFLE_SHOP: Close
[0m22:02:16.873182 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bc15f130-9a04-470b-86f8-42c888dce50a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d63150>]}
[0m22:02:16.875159 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:02:16.876154 [info ] [MainThread]: 
[0m22:02:16.881571 [debug] [Thread-1 (]: Began running node model.jaffle_shop.int_orders__pivoted
[0m22:02:16.883087 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_RAW_JAFFLE_SHOP, now model.jaffle_shop.int_orders__pivoted)
[0m22:02:16.883925 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.int_orders__pivoted
[0m22:02:16.897315 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.int_orders__pivoted"
[0m22:02:16.898671 [debug] [Thread-1 (]: Timing info for model.jaffle_shop.int_orders__pivoted (compile): 22:02:16.884357 => 22:02:16.898271
[0m22:02:16.899296 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.int_orders__pivoted
[0m22:02:16.900038 [debug] [Thread-1 (]: Timing info for model.jaffle_shop.int_orders__pivoted (execute): 22:02:16.899683 => 22:02:16.899716
[0m22:02:16.901793 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.int_orders__pivoted
[0m22:02:16.904708 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:02:16.905332 [debug] [MainThread]: Connection 'model.jaffle_shop.int_orders__pivoted' was properly closed.
[0m22:02:16.906351 [debug] [MainThread]: Command end result
[0m22:02:16.920283 [info ] [MainThread]: Compiled node 'int_orders__pivoted' is:


WITH payments AS (
    SELECT * FROM RAW.JAFFLE_SHOP.stg_payments
),

pivoted AS (
    SELECT
        order_id,
        SUM(CASE WHEN payment_method = 'bank_transfer' THEN amount ELSE 0 END) AS bank_transfer_amount,
        SUM(CASE WHEN payment_method = 'coupon' THEN amount ELSE 0 END) AS coupon_amount,
        SUM(CASE WHEN payment_method = 'credit_card' THEN amount ELSE 0 END) AS credit_card_amount,
        SUM(CASE WHEN payment_method = 'gift_card' THEN amount ELSE 0 END) AS gift_card_amount

    FROM payments
    WHERE status = 'success'
    GROUP BY 1
)
[0m22:02:16.922322 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_success": true, "command_wall_clock_time": 2.639265, "process_user_time": 3.881074, "process_kernel_time": 0.362606, "process_mem_max_rss": "135983104", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m22:02:16.923254 [debug] [MainThread]: Command `dbt compile` succeeded at 22:02:16.923031 after 2.64 seconds
[0m22:02:16.923900 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10638e590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106115d50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102123cd0>]}
[0m22:02:16.924779 [debug] [MainThread]: Flushing usage events
[0m22:02:27.922578 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105107b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b54a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1050e42d0>]}


============================== 22:02:27.928371 | d9f4da81-da62-43ec-80d1-55a0708f28c1 ==============================
[0m22:02:27.928371 [info ] [MainThread]: Running with dbt=1.7.8
[0m22:02:27.929394 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/ben/jaffle_shop/logs', 'profiles_dir': '/Users/ben/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt compile --select int_orders__pivoted', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m22:02:28.462208 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd9f4da81-da62-43ec-80d1-55a0708f28c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a16f10>]}
[0m22:02:28.590059 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd9f4da81-da62-43ec-80d1-55a0708f28c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1051bf990>]}
[0m22:02:28.591304 [info ] [MainThread]: Registered adapter: snowflake=1.7.2
[0m22:02:28.614328 [debug] [MainThread]: checksum: 67f0013ca5f0bd43af9a0873dd50792fde83ef69de63b71cacd0b4ac656c52e5, vars: {}, profile: , target: , version: 1.7.8
[0m22:02:28.668883 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m22:02:28.669972 [debug] [MainThread]: Partial parsing: updated file: jaffle_shop://models/marts/core/int_orders__pivoted.sql
[0m22:02:28.883896 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd9f4da81-da62-43ec-80d1-55a0708f28c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d70ad0>]}
[0m22:02:28.901520 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd9f4da81-da62-43ec-80d1-55a0708f28c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105deb750>]}
[0m22:02:28.902459 [info ] [MainThread]: Found 5 models, 3 seeds, 11 tests, 0 sources, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m22:02:28.903136 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd9f4da81-da62-43ec-80d1-55a0708f28c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105b6cad0>]}
[0m22:02:28.905587 [info ] [MainThread]: 
[0m22:02:28.906783 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m22:02:28.908618 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RAW_JAFFLE_SHOP'
[0m22:02:28.931098 [debug] [ThreadPool]: Using snowflake connection "list_RAW_JAFFLE_SHOP"
[0m22:02:28.932313 [debug] [ThreadPool]: On list_RAW_JAFFLE_SHOP: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_RAW_JAFFLE_SHOP"} */
show terse objects in RAW.JAFFLE_SHOP limit 10000
[0m22:02:28.932905 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:02:29.688101 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.0 seconds
[0m22:02:29.694694 [debug] [ThreadPool]: On list_RAW_JAFFLE_SHOP: Close
[0m22:02:29.843254 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd9f4da81-da62-43ec-80d1-55a0708f28c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a8b810>]}
[0m22:02:29.845170 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:02:29.846099 [info ] [MainThread]: 
[0m22:02:29.851042 [debug] [Thread-1 (]: Began running node model.jaffle_shop.int_orders__pivoted
[0m22:02:29.852636 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_RAW_JAFFLE_SHOP, now model.jaffle_shop.int_orders__pivoted)
[0m22:02:29.853525 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.int_orders__pivoted
[0m22:02:29.866441 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.int_orders__pivoted"
[0m22:02:29.868210 [debug] [Thread-1 (]: Timing info for model.jaffle_shop.int_orders__pivoted (compile): 22:02:29.853967 => 22:02:29.867537
[0m22:02:29.869027 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.int_orders__pivoted
[0m22:02:29.869774 [debug] [Thread-1 (]: Timing info for model.jaffle_shop.int_orders__pivoted (execute): 22:02:29.869418 => 22:02:29.869456
[0m22:02:29.871620 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.int_orders__pivoted
[0m22:02:29.874055 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:02:29.875052 [debug] [MainThread]: Connection 'model.jaffle_shop.int_orders__pivoted' was properly closed.
[0m22:02:29.876064 [debug] [MainThread]: Command end result
[0m22:02:29.888683 [info ] [MainThread]: Compiled node 'int_orders__pivoted' is:


WITH payments AS (
    SELECT * FROM RAW.JAFFLE_SHOP.stg_payments
),

pivoted AS (
    SELECT
        order_id,
        SUM(CASE WHEN payment_method = 'bank_transfer' THEN amount ELSE 0 END) AS bank_transfer_amount,
        SUM(CASE WHEN payment_method = 'coupon' THEN amount ELSE 0 END) AS coupon_amount,
        SUM(CASE WHEN payment_method = 'credit_card' THEN amount ELSE 0 END) AS credit_card_amount,
        SUM(CASE WHEN payment_method = 'gift_card' THEN amount ELSE 0 END) AS gift_card_amount
    FROM payments
    WHERE status = 'success'
    GROUP BY 1
)
[0m22:02:29.890793 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_success": true, "command_wall_clock_time": 2.0490038, "process_user_time": 3.856837, "process_kernel_time": 0.341781, "process_mem_max_rss": "136384512", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m22:02:29.891761 [debug] [MainThread]: Command `dbt compile` succeeded at 22:02:29.891544 after 2.05 seconds
[0m22:02:29.892407 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10511aad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105006a10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d54090>]}
[0m22:02:29.893016 [debug] [MainThread]: Flushing usage events
[0m22:02:38.481000 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e2e8e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e2f9550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e9249d0>]}


============================== 22:02:38.487069 | c6cc6651-563e-4229-be4f-64bb9aac9f18 ==============================
[0m22:02:38.487069 [info ] [MainThread]: Running with dbt=1.7.8
[0m22:02:38.488108 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/ben/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/ben/jaffle_shop/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:02:39.072746 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c6cc6651-563e-4229-be4f-64bb9aac9f18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f1023d0>]}
[0m22:02:39.225217 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c6cc6651-563e-4229-be4f-64bb9aac9f18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e935fd0>]}
[0m22:02:39.226535 [info ] [MainThread]: Registered adapter: snowflake=1.7.2
[0m22:02:39.252389 [debug] [MainThread]: checksum: 67f0013ca5f0bd43af9a0873dd50792fde83ef69de63b71cacd0b4ac656c52e5, vars: {}, profile: , target: , version: 1.7.8
[0m22:02:39.305520 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:02:39.306200 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:02:39.316419 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c6cc6651-563e-4229-be4f-64bb9aac9f18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e32e790>]}
[0m22:02:39.333372 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c6cc6651-563e-4229-be4f-64bb9aac9f18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f14d150>]}
[0m22:02:39.334169 [info ] [MainThread]: Found 5 models, 3 seeds, 11 tests, 0 sources, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m22:02:39.334780 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c6cc6651-563e-4229-be4f-64bb9aac9f18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f155690>]}
[0m22:02:39.338317 [info ] [MainThread]: 
[0m22:02:39.340000 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m22:02:39.342108 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RAW'
[0m22:02:39.364543 [debug] [ThreadPool]: Using snowflake connection "list_RAW"
[0m22:02:39.365223 [debug] [ThreadPool]: On list_RAW: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_RAW"} */
show terse schemas in database RAW
    limit 10000
[0m22:02:39.365796 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:02:39.997062 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.0 seconds
[0m22:02:40.002131 [debug] [ThreadPool]: On list_RAW: Close
[0m22:02:40.146617 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RAW, now list_RAW_JAFFLE_SHOP)
[0m22:02:40.162948 [debug] [ThreadPool]: Using snowflake connection "list_RAW_JAFFLE_SHOP"
[0m22:02:40.163686 [debug] [ThreadPool]: On list_RAW_JAFFLE_SHOP: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_RAW_JAFFLE_SHOP"} */
show terse objects in RAW.JAFFLE_SHOP limit 10000
[0m22:02:40.164247 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:02:40.755801 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.0 seconds
[0m22:02:40.760748 [debug] [ThreadPool]: On list_RAW_JAFFLE_SHOP: Close
[0m22:02:40.925752 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c6cc6651-563e-4229-be4f-64bb9aac9f18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f38e810>]}
[0m22:02:40.928512 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:02:40.929662 [info ] [MainThread]: 
[0m22:02:40.934954 [debug] [Thread-1 (]: Began running node model.jaffle_shop.stg_customers
[0m22:02:40.936071 [info ] [Thread-1 (]: 1 of 5 START sql view model JAFFLE_SHOP.stg_customers .......................... [RUN]
[0m22:02:40.937027 [debug] [Thread-2 (]: Began running node model.jaffle_shop.stg_orders
[0m22:02:40.938375 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_RAW_JAFFLE_SHOP, now model.jaffle_shop.stg_customers)
[0m22:02:40.939152 [debug] [Thread-3 (]: Began running node model.jaffle_shop.stg_payments
[0m22:02:40.940066 [info ] [Thread-2 (]: 2 of 5 START sql view model JAFFLE_SHOP.stg_orders ............................. [RUN]
[0m22:02:40.940895 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.stg_customers
[0m22:02:40.941640 [info ] [Thread-3 (]: 3 of 5 START sql view model JAFFLE_SHOP.stg_payments ........................... [RUN]
[0m22:02:40.942872 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.jaffle_shop.stg_orders'
[0m22:02:40.954045 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.stg_customers"
[0m22:02:40.955499 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.jaffle_shop.stg_payments'
[0m22:02:40.956240 [debug] [Thread-2 (]: Began compiling node model.jaffle_shop.stg_orders
[0m22:02:40.958271 [debug] [Thread-3 (]: Began compiling node model.jaffle_shop.stg_payments
[0m22:02:40.962640 [debug] [Thread-2 (]: Writing injected SQL for node "model.jaffle_shop.stg_orders"
[0m22:02:40.967165 [debug] [Thread-3 (]: Writing injected SQL for node "model.jaffle_shop.stg_payments"
[0m22:02:40.967943 [debug] [Thread-1 (]: Timing info for model.jaffle_shop.stg_customers (compile): 22:02:40.943315 => 22:02:40.967584
[0m22:02:40.969269 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.stg_customers
[0m22:02:40.975963 [debug] [Thread-3 (]: Timing info for model.jaffle_shop.stg_payments (compile): 22:02:40.963236 => 22:02:40.975533
[0m22:02:40.989418 [debug] [Thread-2 (]: Timing info for model.jaffle_shop.stg_orders (compile): 22:02:40.958894 => 22:02:40.988971
[0m22:02:40.989991 [debug] [Thread-3 (]: Began executing node model.jaffle_shop.stg_payments
[0m22:02:41.008307 [debug] [Thread-2 (]: Began executing node model.jaffle_shop.stg_orders
[0m22:02:41.019349 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.stg_customers"
[0m22:02:41.025081 [debug] [Thread-3 (]: Writing runtime sql for node "model.jaffle_shop.stg_payments"
[0m22:02:41.029929 [debug] [Thread-2 (]: Writing runtime sql for node "model.jaffle_shop.stg_orders"
[0m22:02:41.031804 [debug] [Thread-3 (]: Using snowflake connection "model.jaffle_shop.stg_payments"
[0m22:02:41.032928 [debug] [Thread-1 (]: Using snowflake connection "model.jaffle_shop.stg_customers"
[0m22:02:41.033583 [debug] [Thread-3 (]: On model.jaffle_shop.stg_payments: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_payments"} */
create or replace   view RAW.JAFFLE_SHOP.stg_payments
  
   as (
    

select
    id,
    order_id,
    payment_method,
    amount

from raw.jaffle_shop.raw_payments
  );
[0m22:02:41.034646 [debug] [Thread-2 (]: Using snowflake connection "model.jaffle_shop.stg_orders"
[0m22:02:41.035218 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */
create or replace   view RAW.JAFFLE_SHOP.stg_customers
  
   as (
    -- noinspection SqlNoDataSourceInspectionForFile



select
    id as customer_id,
    first_name,
    last_name

from raw.jaffle_shop.raw_customers
  );
[0m22:02:41.035802 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m22:02:41.036376 [debug] [Thread-2 (]: On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */
create or replace   view RAW.JAFFLE_SHOP.stg_orders
  
   as (
    

select
    id as order_id,
    user_id as customer_id,
    order_date,
    status

from raw.jaffle_shop.raw_orders
  );
[0m22:02:41.036926 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:02:41.038391 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m22:02:41.612058 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m22:02:41.651116 [debug] [Thread-1 (]: Timing info for model.jaffle_shop.stg_customers (execute): 22:02:40.969794 => 22:02:41.650746
[0m22:02:41.651853 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: Close
[0m22:02:41.665266 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m22:02:41.670105 [debug] [Thread-2 (]: Timing info for model.jaffle_shop.stg_orders (execute): 22:02:41.025607 => 22:02:41.669608
[0m22:02:41.670915 [debug] [Thread-2 (]: On model.jaffle_shop.stg_orders: Close
[0m22:02:41.688726 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m22:02:41.692732 [debug] [Thread-3 (]: Timing info for model.jaffle_shop.stg_payments (execute): 22:02:41.019901 => 22:02:41.692404
[0m22:02:41.693322 [debug] [Thread-3 (]: On model.jaffle_shop.stg_payments: Close
[0m22:02:41.798434 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c6cc6651-563e-4229-be4f-64bb9aac9f18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f4e1d90>]}
[0m22:02:41.800651 [info ] [Thread-1 (]: 1 of 5 OK created sql view model JAFFLE_SHOP.stg_customers ..................... [[32mSUCCESS 1[0m in 0.86s]
[0m22:02:41.802572 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.stg_customers
[0m22:02:41.820227 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c6cc6651-563e-4229-be4f-64bb9aac9f18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f40be10>]}
[0m22:02:41.822286 [info ] [Thread-2 (]: 2 of 5 OK created sql view model JAFFLE_SHOP.stg_orders ........................ [[32mSUCCESS 1[0m in 0.88s]
[0m22:02:41.823720 [debug] [Thread-2 (]: Finished running node model.jaffle_shop.stg_orders
[0m22:02:41.825015 [debug] [Thread-4 (]: Began running node model.jaffle_shop.customers
[0m22:02:41.826088 [info ] [Thread-4 (]: 4 of 5 START sql view model JAFFLE_SHOP.customers .............................. [RUN]
[0m22:02:41.827838 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.jaffle_shop.customers'
[0m22:02:41.828672 [debug] [Thread-4 (]: Began compiling node model.jaffle_shop.customers
[0m22:02:41.837273 [debug] [Thread-4 (]: Writing injected SQL for node "model.jaffle_shop.customers"
[0m22:02:41.839298 [debug] [Thread-4 (]: Timing info for model.jaffle_shop.customers (compile): 22:02:41.829151 => 22:02:41.838589
[0m22:02:41.840088 [debug] [Thread-4 (]: Began executing node model.jaffle_shop.customers
[0m22:02:41.845285 [debug] [Thread-4 (]: Writing runtime sql for node "model.jaffle_shop.customers"
[0m22:02:41.847913 [debug] [Thread-4 (]: Using snowflake connection "model.jaffle_shop.customers"
[0m22:02:41.848940 [debug] [Thread-4 (]: On model.jaffle_shop.customers: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.customers"} */
create or replace   view RAW.JAFFLE_SHOP.customers
  
   as (
    


with customers as (

    select * from RAW.JAFFLE_SHOP.stg_customers

),

orders as (

    select * from RAW.JAFFLE_SHOP.stg_orders

),

customer_orders as (

    select
        customer_id,

        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders

    from orders

    group by 1

),

final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce(customer_orders.number_of_orders, 0) as number_of_orders

    from customers

    left join customer_orders using (customer_id)

)

select * from final
  );
[0m22:02:41.850181 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m22:02:41.895886 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c6cc6651-563e-4229-be4f-64bb9aac9f18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f65f2d0>]}
[0m22:02:41.896884 [info ] [Thread-3 (]: 3 of 5 OK created sql view model JAFFLE_SHOP.stg_payments ...................... [[32mSUCCESS 1[0m in 0.94s]
[0m22:02:41.897788 [debug] [Thread-3 (]: Finished running node model.jaffle_shop.stg_payments
[0m22:02:41.898694 [debug] [Thread-2 (]: Began running node model.jaffle_shop.int_orders__pivoted
[0m22:02:41.899525 [info ] [Thread-2 (]: 5 of 5 START sql table model JAFFLE_SHOP.int_orders__pivoted ................... [RUN]
[0m22:02:41.900767 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.jaffle_shop.stg_orders, now model.jaffle_shop.int_orders__pivoted)
[0m22:02:41.901462 [debug] [Thread-2 (]: Began compiling node model.jaffle_shop.int_orders__pivoted
[0m22:02:41.908365 [debug] [Thread-2 (]: Writing injected SQL for node "model.jaffle_shop.int_orders__pivoted"
[0m22:02:41.910681 [debug] [Thread-2 (]: Timing info for model.jaffle_shop.int_orders__pivoted (compile): 22:02:41.901873 => 22:02:41.910082
[0m22:02:41.911367 [debug] [Thread-2 (]: Began executing node model.jaffle_shop.int_orders__pivoted
[0m22:02:41.949784 [debug] [Thread-2 (]: Writing runtime sql for node "model.jaffle_shop.int_orders__pivoted"
[0m22:02:41.952183 [debug] [Thread-2 (]: Using snowflake connection "model.jaffle_shop.int_orders__pivoted"
[0m22:02:41.952807 [debug] [Thread-2 (]: On model.jaffle_shop.int_orders__pivoted: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.int_orders__pivoted"} */
create or replace transient table RAW.JAFFLE_SHOP.int_orders__pivoted
         as
        (

WITH payments AS (
    SELECT * FROM RAW.JAFFLE_SHOP.stg_payments
),

pivoted AS (
    SELECT
        order_id,
        SUM(CASE WHEN payment_method = 'bank_transfer' THEN amount ELSE 0 END) AS bank_transfer_amount,
        SUM(CASE WHEN payment_method = 'coupon' THEN amount ELSE 0 END) AS coupon_amount,
        SUM(CASE WHEN payment_method = 'credit_card' THEN amount ELSE 0 END) AS credit_card_amount,
        SUM(CASE WHEN payment_method = 'gift_card' THEN amount ELSE 0 END) AS gift_card_amount
    FROM payments
    WHERE status = 'success'
    GROUP BY 1
)
        );
[0m22:02:41.953378 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:02:42.473023 [debug] [Thread-2 (]: Snowflake adapter: Snowflake query id: 01b3a75a-0001-c86f-0005-81260003e106
[0m22:02:42.474042 [debug] [Thread-2 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 20 at position 8 unexpected ')'.
[0m22:02:42.475167 [debug] [Thread-2 (]: Timing info for model.jaffle_shop.int_orders__pivoted (execute): 22:02:41.911799 => 22:02:42.474731
[0m22:02:42.475944 [debug] [Thread-2 (]: On model.jaffle_shop.int_orders__pivoted: Close
[0m22:02:42.517617 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m22:02:42.525280 [debug] [Thread-4 (]: Timing info for model.jaffle_shop.customers (execute): 22:02:41.840593 => 22:02:42.524734
[0m22:02:42.527718 [debug] [Thread-4 (]: On model.jaffle_shop.customers: Close
[0m22:02:42.636766 [debug] [Thread-2 (]: Database Error in model int_orders__pivoted (models/marts/core/int_orders__pivoted.sql)
  001003 (42000): SQL compilation error:
  syntax error line 20 at position 8 unexpected ')'.
  compiled Code at target/run/jaffle_shop/models/marts/core/int_orders__pivoted.sql
[0m22:02:42.638914 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c6cc6651-563e-4229-be4f-64bb9aac9f18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f765150>]}
[0m22:02:42.640576 [error] [Thread-2 (]: 5 of 5 ERROR creating sql table model JAFFLE_SHOP.int_orders__pivoted .......... [[31mERROR[0m in 0.74s]
[0m22:02:42.642531 [debug] [Thread-2 (]: Finished running node model.jaffle_shop.int_orders__pivoted
[0m22:02:42.665922 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c6cc6651-563e-4229-be4f-64bb9aac9f18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f7a4450>]}
[0m22:02:42.667383 [info ] [Thread-4 (]: 4 of 5 OK created sql view model JAFFLE_SHOP.customers ......................... [[32mSUCCESS 1[0m in 0.84s]
[0m22:02:42.668784 [debug] [Thread-4 (]: Finished running node model.jaffle_shop.customers
[0m22:02:42.672412 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:02:42.673125 [debug] [MainThread]: Connection 'model.jaffle_shop.stg_customers' was properly closed.
[0m22:02:42.673741 [debug] [MainThread]: Connection 'model.jaffle_shop.int_orders__pivoted' was properly closed.
[0m22:02:42.674347 [debug] [MainThread]: Connection 'model.jaffle_shop.stg_payments' was properly closed.
[0m22:02:42.674923 [debug] [MainThread]: Connection 'model.jaffle_shop.customers' was properly closed.
[0m22:02:42.675866 [info ] [MainThread]: 
[0m22:02:42.676559 [info ] [MainThread]: Finished running 4 view models, 1 table model in 0 hours 0 minutes and 3.34 seconds (3.34s).
[0m22:02:42.678480 [debug] [MainThread]: Command end result
[0m22:02:42.691078 [info ] [MainThread]: 
[0m22:02:42.691744 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m22:02:42.692247 [info ] [MainThread]: 
[0m22:02:42.692745 [error] [MainThread]:   Database Error in model int_orders__pivoted (models/marts/core/int_orders__pivoted.sql)
  001003 (42000): SQL compilation error:
  syntax error line 20 at position 8 unexpected ')'.
  compiled Code at target/run/jaffle_shop/models/marts/core/int_orders__pivoted.sql
[0m22:02:42.693246 [info ] [MainThread]: 
[0m22:02:42.693771 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
[0m22:02:42.695564 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 4.294541, "process_user_time": 4.444581, "process_kernel_time": 0.420593, "process_mem_max_rss": "140623872", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m22:02:42.696466 [debug] [MainThread]: Command `dbt run` failed at 22:02:42.696256 after 4.30 seconds
[0m22:02:42.698113 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e5b2790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e318750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e32c090>]}
[0m22:02:42.699781 [debug] [MainThread]: Flushing usage events
[0m22:04:16.235852 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11067e890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110421d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110420e90>]}


============================== 22:04:16.242290 | 4a646595-e338-43f4-9401-a9412cbd7e8f ==============================
[0m22:04:16.242290 [info ] [MainThread]: Running with dbt=1.7.8
[0m22:04:16.244138 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/ben/jaffle_shop/logs', 'profiles_dir': '/Users/ben/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:04:16.781266 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4a646595-e338-43f4-9401-a9412cbd7e8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1113a1910>]}
[0m22:04:16.913187 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4a646595-e338-43f4-9401-a9412cbd7e8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110b6f990>]}
[0m22:04:16.914453 [info ] [MainThread]: Registered adapter: snowflake=1.7.2
[0m22:04:16.939937 [debug] [MainThread]: checksum: 67f0013ca5f0bd43af9a0873dd50792fde83ef69de63b71cacd0b4ac656c52e5, vars: {}, profile: , target: , version: 1.7.8
[0m22:04:16.991756 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m22:04:16.992836 [debug] [MainThread]: Partial parsing: updated file: jaffle_shop://models/marts/core/int_orders__pivoted.sql
[0m22:04:17.208943 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4a646595-e338-43f4-9401-a9412cbd7e8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111546150>]}
[0m22:04:17.226294 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4a646595-e338-43f4-9401-a9412cbd7e8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1114ee790>]}
[0m22:04:17.227097 [info ] [MainThread]: Found 5 models, 3 seeds, 11 tests, 0 sources, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m22:04:17.227707 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4a646595-e338-43f4-9401-a9412cbd7e8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1114b7550>]}
[0m22:04:17.230685 [info ] [MainThread]: 
[0m22:04:17.231876 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m22:04:17.233644 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RAW'
[0m22:04:17.252719 [debug] [ThreadPool]: Using snowflake connection "list_RAW"
[0m22:04:17.253444 [debug] [ThreadPool]: On list_RAW: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_RAW"} */
show terse schemas in database RAW
    limit 10000
[0m22:04:17.253986 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:04:18.032252 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.0 seconds
[0m22:04:18.036262 [debug] [ThreadPool]: On list_RAW: Close
[0m22:04:18.264127 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RAW, now list_RAW_JAFFLE_SHOP)
[0m22:04:18.281617 [debug] [ThreadPool]: Using snowflake connection "list_RAW_JAFFLE_SHOP"
[0m22:04:18.282352 [debug] [ThreadPool]: On list_RAW_JAFFLE_SHOP: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_RAW_JAFFLE_SHOP"} */
show terse objects in RAW.JAFFLE_SHOP limit 10000
[0m22:04:18.282865 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:04:18.900931 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.0 seconds
[0m22:04:18.906696 [debug] [ThreadPool]: On list_RAW_JAFFLE_SHOP: Close
[0m22:04:19.061203 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4a646595-e338-43f4-9401-a9412cbd7e8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1114d57d0>]}
[0m22:04:19.063859 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:04:19.065292 [info ] [MainThread]: 
[0m22:04:19.070359 [debug] [Thread-1 (]: Began running node model.jaffle_shop.stg_customers
[0m22:04:19.071407 [debug] [Thread-2 (]: Began running node model.jaffle_shop.stg_orders
[0m22:04:19.072359 [info ] [Thread-1 (]: 1 of 5 START sql view model JAFFLE_SHOP.stg_customers .......................... [RUN]
[0m22:04:19.073280 [debug] [Thread-3 (]: Began running node model.jaffle_shop.stg_payments
[0m22:04:19.074135 [info ] [Thread-2 (]: 2 of 5 START sql view model JAFFLE_SHOP.stg_orders ............................. [RUN]
[0m22:04:19.075372 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_RAW_JAFFLE_SHOP, now model.jaffle_shop.stg_customers)
[0m22:04:19.076149 [info ] [Thread-3 (]: 3 of 5 START sql view model JAFFLE_SHOP.stg_payments ........................... [RUN]
[0m22:04:19.077413 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.jaffle_shop.stg_orders'
[0m22:04:19.078088 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.stg_customers
[0m22:04:19.079209 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.jaffle_shop.stg_payments'
[0m22:04:19.079780 [debug] [Thread-2 (]: Began compiling node model.jaffle_shop.stg_orders
[0m22:04:19.091759 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.stg_customers"
[0m22:04:19.092539 [debug] [Thread-3 (]: Began compiling node model.jaffle_shop.stg_payments
[0m22:04:19.098117 [debug] [Thread-2 (]: Writing injected SQL for node "model.jaffle_shop.stg_orders"
[0m22:04:19.103127 [debug] [Thread-3 (]: Writing injected SQL for node "model.jaffle_shop.stg_payments"
[0m22:04:19.104496 [debug] [Thread-1 (]: Timing info for model.jaffle_shop.stg_customers (compile): 22:04:19.080159 => 22:04:19.104044
[0m22:04:19.105484 [debug] [Thread-2 (]: Timing info for model.jaffle_shop.stg_orders (compile): 22:04:19.093030 => 22:04:19.105094
[0m22:04:19.106276 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.stg_customers
[0m22:04:19.107066 [debug] [Thread-2 (]: Began executing node model.jaffle_shop.stg_orders
[0m22:04:19.107847 [debug] [Thread-3 (]: Timing info for model.jaffle_shop.stg_payments (compile): 22:04:19.099100 => 22:04:19.107498
[0m22:04:19.168626 [debug] [Thread-2 (]: Writing runtime sql for node "model.jaffle_shop.stg_orders"
[0m22:04:19.172606 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.stg_customers"
[0m22:04:19.173344 [debug] [Thread-3 (]: Began executing node model.jaffle_shop.stg_payments
[0m22:04:19.179358 [debug] [Thread-3 (]: Writing runtime sql for node "model.jaffle_shop.stg_payments"
[0m22:04:19.180750 [debug] [Thread-1 (]: Using snowflake connection "model.jaffle_shop.stg_customers"
[0m22:04:19.181781 [debug] [Thread-2 (]: Using snowflake connection "model.jaffle_shop.stg_orders"
[0m22:04:19.182455 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */
create or replace   view RAW.JAFFLE_SHOP.stg_customers
  
   as (
    -- noinspection SqlNoDataSourceInspectionForFile



select
    id as customer_id,
    first_name,
    last_name

from raw.jaffle_shop.raw_customers
  );
[0m22:04:19.183131 [debug] [Thread-2 (]: On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */
create or replace   view RAW.JAFFLE_SHOP.stg_orders
  
   as (
    

select
    id as order_id,
    user_id as customer_id,
    order_date,
    status

from raw.jaffle_shop.raw_orders
  );
[0m22:04:19.184190 [debug] [Thread-3 (]: Using snowflake connection "model.jaffle_shop.stg_payments"
[0m22:04:19.184699 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:04:19.185376 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m22:04:19.186029 [debug] [Thread-3 (]: On model.jaffle_shop.stg_payments: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_payments"} */
create or replace   view RAW.JAFFLE_SHOP.stg_payments
  
   as (
    

select
    id,
    order_id,
    payment_method,
    amount

from raw.jaffle_shop.raw_payments
  );
[0m22:04:19.189556 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m22:04:19.775042 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m22:04:19.817092 [debug] [Thread-2 (]: Timing info for model.jaffle_shop.stg_orders (execute): 22:04:19.135075 => 22:04:19.816731
[0m22:04:19.818592 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m22:04:19.819271 [debug] [Thread-2 (]: On model.jaffle_shop.stg_orders: Close
[0m22:04:19.823147 [debug] [Thread-1 (]: Timing info for model.jaffle_shop.stg_customers (execute): 22:04:19.108201 => 22:04:19.822816
[0m22:04:19.824917 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: Close
[0m22:04:19.897822 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m22:04:19.908345 [debug] [Thread-3 (]: Timing info for model.jaffle_shop.stg_payments (execute): 22:04:19.174370 => 22:04:19.907199
[0m22:04:19.910306 [debug] [Thread-3 (]: On model.jaffle_shop.stg_payments: Close
[0m22:04:19.991648 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4a646595-e338-43f4-9401-a9412cbd7e8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1118e4410>]}
[0m22:04:19.993470 [info ] [Thread-2 (]: 2 of 5 OK created sql view model JAFFLE_SHOP.stg_orders ........................ [[32mSUCCESS 1[0m in 0.91s]
[0m22:04:19.995391 [debug] [Thread-2 (]: Finished running node model.jaffle_shop.stg_orders
[0m22:04:20.008057 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4a646595-e338-43f4-9401-a9412cbd7e8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1117e4510>]}
[0m22:04:20.009736 [info ] [Thread-1 (]: 1 of 5 OK created sql view model JAFFLE_SHOP.stg_customers ..................... [[32mSUCCESS 1[0m in 0.93s]
[0m22:04:20.011417 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.stg_customers
[0m22:04:20.013431 [debug] [Thread-4 (]: Began running node model.jaffle_shop.customers
[0m22:04:20.014629 [info ] [Thread-4 (]: 4 of 5 START sql view model JAFFLE_SHOP.customers .............................. [RUN]
[0m22:04:20.016146 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.jaffle_shop.customers'
[0m22:04:20.016899 [debug] [Thread-4 (]: Began compiling node model.jaffle_shop.customers
[0m22:04:20.023309 [debug] [Thread-4 (]: Writing injected SQL for node "model.jaffle_shop.customers"
[0m22:04:20.024697 [debug] [Thread-4 (]: Timing info for model.jaffle_shop.customers (compile): 22:04:20.017371 => 22:04:20.024288
[0m22:04:20.025416 [debug] [Thread-4 (]: Began executing node model.jaffle_shop.customers
[0m22:04:20.031792 [debug] [Thread-4 (]: Writing runtime sql for node "model.jaffle_shop.customers"
[0m22:04:20.034685 [debug] [Thread-4 (]: Using snowflake connection "model.jaffle_shop.customers"
[0m22:04:20.035887 [debug] [Thread-4 (]: On model.jaffle_shop.customers: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.customers"} */
create or replace   view RAW.JAFFLE_SHOP.customers
  
   as (
    


with customers as (

    select * from RAW.JAFFLE_SHOP.stg_customers

),

orders as (

    select * from RAW.JAFFLE_SHOP.stg_orders

),

customer_orders as (

    select
        customer_id,

        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders

    from orders

    group by 1

),

final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce(customer_orders.number_of_orders, 0) as number_of_orders

    from customers

    left join customer_orders using (customer_id)

)

select * from final
  );
[0m22:04:20.036810 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m22:04:20.068602 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4a646595-e338-43f4-9401-a9412cbd7e8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11175c410>]}
[0m22:04:20.070369 [info ] [Thread-3 (]: 3 of 5 OK created sql view model JAFFLE_SHOP.stg_payments ...................... [[32mSUCCESS 1[0m in 0.99s]
[0m22:04:20.072027 [debug] [Thread-3 (]: Finished running node model.jaffle_shop.stg_payments
[0m22:04:20.073393 [debug] [Thread-1 (]: Began running node model.jaffle_shop.int_orders__pivoted
[0m22:04:20.074288 [info ] [Thread-1 (]: 5 of 5 START sql table model JAFFLE_SHOP.int_orders__pivoted ................... [RUN]
[0m22:04:20.075537 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.jaffle_shop.stg_customers, now model.jaffle_shop.int_orders__pivoted)
[0m22:04:20.076218 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.int_orders__pivoted
[0m22:04:20.082753 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.int_orders__pivoted"
[0m22:04:20.084039 [debug] [Thread-1 (]: Timing info for model.jaffle_shop.int_orders__pivoted (compile): 22:04:20.076674 => 22:04:20.083656
[0m22:04:20.084641 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.int_orders__pivoted
[0m22:04:20.121341 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.int_orders__pivoted"
[0m22:04:20.123891 [debug] [Thread-1 (]: Using snowflake connection "model.jaffle_shop.int_orders__pivoted"
[0m22:04:20.124602 [debug] [Thread-1 (]: On model.jaffle_shop.int_orders__pivoted: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.int_orders__pivoted"} */
create or replace transient table RAW.JAFFLE_SHOP.int_orders__pivoted
         as
        (

WITH payments AS (
    SELECT * FROM RAW.JAFFLE_SHOP.stg_payments
),

pivoted AS (
    SELECT
        order_id,
        SUM(CASE WHEN payment_method = 'bank_transfer' THEN amount ELSE 0 END) AS bank_transfer_amount,
        SUM(CASE WHEN payment_method = 'coupon' THEN amount ELSE 0 END) AS coupon_amount,
        SUM(CASE WHEN payment_method = 'credit_card' THEN amount ELSE 0 END) AS credit_card_amount,
        SUM(CASE WHEN payment_method = 'gift_card' THEN amount ELSE 0 END) AS gift_card_amount
    FROM payments
    WHERE status = 'success'
    GROUP BY 1
)

SELECT * FROM pivoted
        );
[0m22:04:20.125207 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:04:20.629294 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b3a75c-0001-c86f-0005-81260003e10a
[0m22:04:20.630426 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 17 at position 10
invalid identifier 'STATUS'
[0m22:04:20.631793 [debug] [Thread-1 (]: Timing info for model.jaffle_shop.int_orders__pivoted (execute): 22:04:20.085002 => 22:04:20.631250
[0m22:04:20.632740 [debug] [Thread-1 (]: On model.jaffle_shop.int_orders__pivoted: Close
[0m22:04:20.772354 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m22:04:20.780515 [debug] [Thread-4 (]: Timing info for model.jaffle_shop.customers (execute): 22:04:20.025876 => 22:04:20.779968
[0m22:04:20.784143 [debug] [Thread-4 (]: On model.jaffle_shop.customers: Close
[0m22:04:20.790455 [debug] [Thread-1 (]: Database Error in model int_orders__pivoted (models/marts/core/int_orders__pivoted.sql)
  000904 (42000): SQL compilation error: error line 17 at position 10
  invalid identifier 'STATUS'
  compiled Code at target/run/jaffle_shop/models/marts/core/int_orders__pivoted.sql
[0m22:04:20.791589 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4a646595-e338-43f4-9401-a9412cbd7e8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111a15590>]}
[0m22:04:20.792760 [error] [Thread-1 (]: 5 of 5 ERROR creating sql table model JAFFLE_SHOP.int_orders__pivoted .......... [[31mERROR[0m in 0.72s]
[0m22:04:20.795041 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.int_orders__pivoted
[0m22:04:20.932062 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4a646595-e338-43f4-9401-a9412cbd7e8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111990fd0>]}
[0m22:04:20.934335 [info ] [Thread-4 (]: 4 of 5 OK created sql view model JAFFLE_SHOP.customers ......................... [[32mSUCCESS 1[0m in 0.92s]
[0m22:04:20.939305 [debug] [Thread-4 (]: Finished running node model.jaffle_shop.customers
[0m22:04:20.944024 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:04:20.944878 [debug] [MainThread]: Connection 'model.jaffle_shop.int_orders__pivoted' was properly closed.
[0m22:04:20.945541 [debug] [MainThread]: Connection 'model.jaffle_shop.stg_orders' was properly closed.
[0m22:04:20.946156 [debug] [MainThread]: Connection 'model.jaffle_shop.stg_payments' was properly closed.
[0m22:04:20.946762 [debug] [MainThread]: Connection 'model.jaffle_shop.customers' was properly closed.
[0m22:04:20.947493 [info ] [MainThread]: 
[0m22:04:20.948220 [info ] [MainThread]: Finished running 4 view models, 1 table model in 0 hours 0 minutes and 3.72 seconds (3.72s).
[0m22:04:20.950187 [debug] [MainThread]: Command end result
[0m22:04:20.965650 [info ] [MainThread]: 
[0m22:04:20.966352 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m22:04:20.966891 [info ] [MainThread]: 
[0m22:04:20.967451 [error] [MainThread]:   Database Error in model int_orders__pivoted (models/marts/core/int_orders__pivoted.sql)
  000904 (42000): SQL compilation error: error line 17 at position 10
  invalid identifier 'STATUS'
  compiled Code at target/run/jaffle_shop/models/marts/core/int_orders__pivoted.sql
[0m22:04:20.968008 [info ] [MainThread]: 
[0m22:04:20.968582 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
[0m22:04:20.970423 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 4.814588, "process_user_time": 4.654932, "process_kernel_time": 0.443826, "process_mem_max_rss": "140496896", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m22:04:20.971332 [debug] [MainThread]: Command `dbt run` failed at 22:04:20.971124 after 4.82 seconds
[0m22:04:20.972133 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110a21490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1106b8950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11175f850>]}
[0m22:04:20.972911 [debug] [MainThread]: Flushing usage events
[0m22:27:45.117196 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10715da50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1073ff050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1073ff850>]}


============================== 22:27:45.126390 | 7cb46019-be08-410c-bf96-388bc9cf122b ==============================
[0m22:27:45.126390 [info ] [MainThread]: Running with dbt=1.7.8
[0m22:27:45.128135 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/ben/jaffle_shop/logs', 'profiles_dir': '/Users/ben/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt compile --select int_orders__pivoted', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m22:27:45.875051 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7cb46019-be08-410c-bf96-388bc9cf122b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10778c8d0>]}
[0m22:27:46.013046 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7cb46019-be08-410c-bf96-388bc9cf122b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108002a90>]}
[0m22:27:46.014818 [info ] [MainThread]: Registered adapter: snowflake=1.7.2
[0m22:27:46.041317 [debug] [MainThread]: checksum: 67f0013ca5f0bd43af9a0873dd50792fde83ef69de63b71cacd0b4ac656c52e5, vars: {}, profile: , target: , version: 1.7.8
[0m22:27:46.147295 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m22:27:46.148364 [debug] [MainThread]: Partial parsing: updated file: jaffle_shop://models/marts/core/int_orders__pivoted.sql
[0m22:27:46.372593 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7cb46019-be08-410c-bf96-388bc9cf122b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108493e10>]}
[0m22:27:46.390297 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7cb46019-be08-410c-bf96-388bc9cf122b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108223490>]}
[0m22:27:46.391063 [info ] [MainThread]: Found 5 models, 3 seeds, 11 tests, 0 sources, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m22:27:46.391672 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7cb46019-be08-410c-bf96-388bc9cf122b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1084b8e90>]}
[0m22:27:46.394801 [info ] [MainThread]: 
[0m22:27:46.396483 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m22:27:46.398567 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RAW_JAFFLE_SHOP'
[0m22:27:46.422669 [debug] [ThreadPool]: Using snowflake connection "list_RAW_JAFFLE_SHOP"
[0m22:27:46.424542 [debug] [ThreadPool]: On list_RAW_JAFFLE_SHOP: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_RAW_JAFFLE_SHOP"} */
show terse objects in RAW.JAFFLE_SHOP limit 10000
[0m22:27:46.425219 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:27:47.240551 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.0 seconds
[0m22:27:47.245982 [debug] [ThreadPool]: On list_RAW_JAFFLE_SHOP: Close
[0m22:27:47.404913 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7cb46019-be08-410c-bf96-388bc9cf122b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1081ca110>]}
[0m22:27:47.406582 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:27:47.407348 [info ] [MainThread]: 
[0m22:27:47.412825 [debug] [Thread-1 (]: Began running node model.jaffle_shop.int_orders__pivoted
[0m22:27:47.414347 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_RAW_JAFFLE_SHOP, now model.jaffle_shop.int_orders__pivoted)
[0m22:27:47.415086 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.int_orders__pivoted
[0m22:27:47.429817 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.int_orders__pivoted"
[0m22:27:47.431279 [debug] [Thread-1 (]: Timing info for model.jaffle_shop.int_orders__pivoted (compile): 22:27:47.415514 => 22:27:47.430792
[0m22:27:47.431926 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.int_orders__pivoted
[0m22:27:47.432641 [debug] [Thread-1 (]: Timing info for model.jaffle_shop.int_orders__pivoted (execute): 22:27:47.432296 => 22:27:47.432330
[0m22:27:47.434642 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.int_orders__pivoted
[0m22:27:47.436286 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:27:47.436836 [debug] [MainThread]: Connection 'model.jaffle_shop.int_orders__pivoted' was properly closed.
[0m22:27:47.438183 [debug] [MainThread]: Command end result
[0m22:27:47.454725 [info ] [MainThread]: Compiled node 'int_orders__pivoted' is:


WITH payments AS (
    SELECT p.id AS id,
           p.order_id AS order_id,
           p.payment_method AS payment_method,
           p.amount AS amount,
           o.status AS status
    FROM RAW.JAFFLE_SHOP.stg_payments p
    JOIN RAW.JAFFLE_SHOP.stg_orders o
    ON p.order_id = o.order_id
),
pivoted AS (
    SELECT
        order_id,
        SUM(CASE WHEN payment_method = 'bank_transfer' THEN amount ELSE 0 END) AS bank_transfer_amount,
        SUM(CASE WHEN payment_method = 'coupon' THEN amount ELSE 0 END) AS coupon_amount,
        SUM(CASE WHEN payment_method = 'credit_card' THEN amount ELSE 0 END) AS credit_card_amount,
        SUM(CASE WHEN payment_method = 'gift_card' THEN amount ELSE 0 END) AS gift_card_amount
    FROM payments
    WHERE status = 'success'
    GROUP BY 1
)

SELECT * FROM pivoted
;
[0m22:27:47.458239 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_success": true, "command_wall_clock_time": 2.4354126, "process_user_time": 4.159415, "process_kernel_time": 0.62405, "process_mem_max_rss": "134758400", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m22:27:47.459546 [debug] [MainThread]: Command `dbt compile` succeeded at 22:27:47.459259 after 2.44 seconds
[0m22:27:47.460612 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10510d590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10777f710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103483c90>]}
[0m22:27:47.461406 [debug] [MainThread]: Flushing usage events
[0m22:28:08.466868 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c2cf7d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bccc9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c2dd110>]}


============================== 22:28:08.475571 | df7ec178-e951-4a63-a090-5865a811ec18 ==============================
[0m22:28:08.475571 [info ] [MainThread]: Running with dbt=1.7.8
[0m22:28:08.477220 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/ben/jaffle_shop/logs', 'debug': 'False', 'profiles_dir': '/Users/ben/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m22:28:09.290137 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'df7ec178-e951-4a63-a090-5865a811ec18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c2ce750>]}
[0m22:28:09.420171 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'df7ec178-e951-4a63-a090-5865a811ec18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c2ce750>]}
[0m22:28:09.422402 [info ] [MainThread]: Registered adapter: snowflake=1.7.2
[0m22:28:09.454350 [debug] [MainThread]: checksum: 67f0013ca5f0bd43af9a0873dd50792fde83ef69de63b71cacd0b4ac656c52e5, vars: {}, profile: , target: , version: 1.7.8
[0m22:28:09.536726 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:28:09.537476 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:28:09.548662 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'df7ec178-e951-4a63-a090-5865a811ec18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ce88950>]}
[0m22:28:09.565796 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'df7ec178-e951-4a63-a090-5865a811ec18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cccdd50>]}
[0m22:28:09.566614 [info ] [MainThread]: Found 5 models, 3 seeds, 11 tests, 0 sources, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m22:28:09.567250 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'df7ec178-e951-4a63-a090-5865a811ec18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ccb0610>]}
[0m22:28:09.570873 [info ] [MainThread]: 
[0m22:28:09.572396 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m22:28:09.574355 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RAW'
[0m22:28:09.598767 [debug] [ThreadPool]: Using snowflake connection "list_RAW"
[0m22:28:09.599476 [debug] [ThreadPool]: On list_RAW: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_RAW"} */
show terse schemas in database RAW
    limit 10000
[0m22:28:09.600060 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:28:10.309500 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.0 seconds
[0m22:28:10.314439 [debug] [ThreadPool]: On list_RAW: Close
[0m22:28:10.462721 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RAW, now list_RAW_JAFFLE_SHOP)
[0m22:28:10.479525 [debug] [ThreadPool]: Using snowflake connection "list_RAW_JAFFLE_SHOP"
[0m22:28:10.480269 [debug] [ThreadPool]: On list_RAW_JAFFLE_SHOP: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_RAW_JAFFLE_SHOP"} */
show terse objects in RAW.JAFFLE_SHOP limit 10000
[0m22:28:10.480846 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:28:10.926405 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.0 seconds
[0m22:28:10.931398 [debug] [ThreadPool]: On list_RAW_JAFFLE_SHOP: Close
[0m22:28:11.102354 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'df7ec178-e951-4a63-a090-5865a811ec18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10903e810>]}
[0m22:28:11.104237 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:28:11.105098 [info ] [MainThread]: 
[0m22:28:11.109438 [debug] [Thread-1 (]: Began running node model.jaffle_shop.stg_customers
[0m22:28:11.110172 [debug] [Thread-2 (]: Began running node model.jaffle_shop.stg_orders
[0m22:28:11.111033 [debug] [Thread-3 (]: Began running node model.jaffle_shop.stg_payments
[0m22:28:11.112173 [info ] [Thread-1 (]: 1 of 5 START sql view model JAFFLE_SHOP.stg_customers .......................... [RUN]
[0m22:28:11.113155 [info ] [Thread-2 (]: 2 of 5 START sql view model JAFFLE_SHOP.stg_orders ............................. [RUN]
[0m22:28:11.114267 [info ] [Thread-3 (]: 3 of 5 START sql view model JAFFLE_SHOP.stg_payments ........................... [RUN]
[0m22:28:11.115657 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_RAW_JAFFLE_SHOP, now model.jaffle_shop.stg_customers)
[0m22:28:11.116811 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.jaffle_shop.stg_orders'
[0m22:28:11.117862 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.jaffle_shop.stg_payments'
[0m22:28:11.118456 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.stg_customers
[0m22:28:11.119019 [debug] [Thread-2 (]: Began compiling node model.jaffle_shop.stg_orders
[0m22:28:11.119561 [debug] [Thread-3 (]: Began compiling node model.jaffle_shop.stg_payments
[0m22:28:11.131840 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.stg_customers"
[0m22:28:11.136995 [debug] [Thread-2 (]: Writing injected SQL for node "model.jaffle_shop.stg_orders"
[0m22:28:11.141400 [debug] [Thread-3 (]: Writing injected SQL for node "model.jaffle_shop.stg_payments"
[0m22:28:11.143429 [debug] [Thread-1 (]: Timing info for model.jaffle_shop.stg_customers (compile): 22:28:11.119934 => 22:28:11.142854
[0m22:28:11.144911 [debug] [Thread-2 (]: Timing info for model.jaffle_shop.stg_orders (compile): 22:28:11.132408 => 22:28:11.144419
[0m22:28:11.145829 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.stg_customers
[0m22:28:11.146507 [debug] [Thread-2 (]: Began executing node model.jaffle_shop.stg_orders
[0m22:28:11.160479 [debug] [Thread-3 (]: Timing info for model.jaffle_shop.stg_payments (compile): 22:28:11.137658 => 22:28:11.159610
[0m22:28:11.210999 [debug] [Thread-3 (]: Began executing node model.jaffle_shop.stg_payments
[0m22:28:11.219359 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.stg_customers"
[0m22:28:11.220340 [debug] [Thread-2 (]: Writing runtime sql for node "model.jaffle_shop.stg_orders"
[0m22:28:11.225541 [debug] [Thread-3 (]: Writing runtime sql for node "model.jaffle_shop.stg_payments"
[0m22:28:11.227722 [debug] [Thread-1 (]: Using snowflake connection "model.jaffle_shop.stg_customers"
[0m22:28:11.228941 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */
create or replace   view RAW.JAFFLE_SHOP.stg_customers
  
   as (
    -- noinspection SqlNoDataSourceInspectionForFile



select
    id as customer_id,
    first_name,
    last_name

from raw.jaffle_shop.raw_customers
  );
[0m22:28:11.229887 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:28:11.230968 [debug] [Thread-3 (]: Using snowflake connection "model.jaffle_shop.stg_payments"
[0m22:28:11.233466 [debug] [Thread-2 (]: Using snowflake connection "model.jaffle_shop.stg_orders"
[0m22:28:11.234266 [debug] [Thread-3 (]: On model.jaffle_shop.stg_payments: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_payments"} */
create or replace   view RAW.JAFFLE_SHOP.stg_payments
  
   as (
    

select
    id,
    order_id,
    payment_method,
    amount

from raw.jaffle_shop.raw_payments
  );
[0m22:28:11.234977 [debug] [Thread-2 (]: On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */
create or replace   view RAW.JAFFLE_SHOP.stg_orders
  
   as (
    

select
    id as order_id,
    user_id as customer_id,
    order_date,
    status

from raw.jaffle_shop.raw_orders
  );
[0m22:28:11.235970 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m22:28:11.237539 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m22:28:11.879395 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m22:28:11.920986 [debug] [Thread-2 (]: Timing info for model.jaffle_shop.stg_orders (execute): 22:28:11.166394 => 22:28:11.920528
[0m22:28:11.921779 [debug] [Thread-2 (]: On model.jaffle_shop.stg_orders: Close
[0m22:28:11.923273 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m22:28:11.924507 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m22:28:11.931017 [debug] [Thread-1 (]: Timing info for model.jaffle_shop.stg_customers (execute): 22:28:11.146977 => 22:28:11.930662
[0m22:28:11.934939 [debug] [Thread-3 (]: Timing info for model.jaffle_shop.stg_payments (execute): 22:28:11.220826 => 22:28:11.934612
[0m22:28:11.935757 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: Close
[0m22:28:11.936437 [debug] [Thread-3 (]: On model.jaffle_shop.stg_payments: Close
[0m22:28:12.087982 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'df7ec178-e951-4a63-a090-5865a811ec18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cdc0bd0>]}
[0m22:28:12.089988 [info ] [Thread-3 (]: 3 of 5 OK created sql view model JAFFLE_SHOP.stg_payments ...................... [[32mSUCCESS 1[0m in 0.97s]
[0m22:28:12.092409 [debug] [Thread-3 (]: Finished running node model.jaffle_shop.stg_payments
[0m22:28:12.099929 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'df7ec178-e951-4a63-a090-5865a811ec18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d01ba50>]}
[0m22:28:12.101222 [info ] [Thread-2 (]: 2 of 5 OK created sql view model JAFFLE_SHOP.stg_orders ........................ [[32mSUCCESS 1[0m in 0.98s]
[0m22:28:12.102704 [debug] [Thread-2 (]: Finished running node model.jaffle_shop.stg_orders
[0m22:28:12.103846 [debug] [Thread-4 (]: Began running node model.jaffle_shop.int_orders__pivoted
[0m22:28:12.104810 [info ] [Thread-4 (]: 4 of 5 START sql table model JAFFLE_SHOP.int_orders__pivoted ................... [RUN]
[0m22:28:12.106207 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.jaffle_shop.int_orders__pivoted'
[0m22:28:12.106867 [debug] [Thread-4 (]: Began compiling node model.jaffle_shop.int_orders__pivoted
[0m22:28:12.114106 [debug] [Thread-4 (]: Writing injected SQL for node "model.jaffle_shop.int_orders__pivoted"
[0m22:28:12.115373 [debug] [Thread-4 (]: Timing info for model.jaffle_shop.int_orders__pivoted (compile): 22:28:12.107277 => 22:28:12.114998
[0m22:28:12.115968 [debug] [Thread-4 (]: Began executing node model.jaffle_shop.int_orders__pivoted
[0m22:28:12.161798 [debug] [Thread-4 (]: Writing runtime sql for node "model.jaffle_shop.int_orders__pivoted"
[0m22:28:12.164947 [debug] [Thread-4 (]: Using snowflake connection "model.jaffle_shop.int_orders__pivoted"
[0m22:28:12.165834 [debug] [Thread-4 (]: On model.jaffle_shop.int_orders__pivoted: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.int_orders__pivoted"} */
create or replace transient table RAW.JAFFLE_SHOP.int_orders__pivoted
         as
        (

WITH payments AS (
    SELECT p.id AS id,
           p.order_id AS order_id,
           p.payment_method AS payment_method,
           p.amount AS amount,
           o.status AS status
    FROM RAW.JAFFLE_SHOP.stg_payments p
    JOIN RAW.JAFFLE_SHOP.stg_orders o
    ON p.order_id = o.order_id
),
pivoted AS (
    SELECT
        order_id,
        SUM(CASE WHEN payment_method = 'bank_transfer' THEN amount ELSE 0 END) AS bank_transfer_amount,
        SUM(CASE WHEN payment_method = 'coupon' THEN amount ELSE 0 END) AS coupon_amount,
        SUM(CASE WHEN payment_method = 'credit_card' THEN amount ELSE 0 END) AS credit_card_amount,
        SUM(CASE WHEN payment_method = 'gift_card' THEN amount ELSE 0 END) AS gift_card_amount
    FROM payments
    WHERE status = 'success'
    GROUP BY 1
)

SELECT * FROM pivoted
;
[0m22:28:12.166552 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m22:28:12.167845 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'df7ec178-e951-4a63-a090-5865a811ec18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cdae4d0>]}
[0m22:28:12.170659 [info ] [Thread-1 (]: 1 of 5 OK created sql view model JAFFLE_SHOP.stg_customers ..................... [[32mSUCCESS 1[0m in 1.05s]
[0m22:28:12.172514 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.stg_customers
[0m22:28:12.174451 [debug] [Thread-2 (]: Began running node model.jaffle_shop.customers
[0m22:28:12.175493 [info ] [Thread-2 (]: 5 of 5 START sql view model JAFFLE_SHOP.customers .............................. [RUN]
[0m22:28:12.178285 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.jaffle_shop.stg_orders, now model.jaffle_shop.customers)
[0m22:28:12.179477 [debug] [Thread-2 (]: Began compiling node model.jaffle_shop.customers
[0m22:28:12.186513 [debug] [Thread-2 (]: Writing injected SQL for node "model.jaffle_shop.customers"
[0m22:28:12.188565 [debug] [Thread-2 (]: Timing info for model.jaffle_shop.customers (compile): 22:28:12.180184 => 22:28:12.188076
[0m22:28:12.189253 [debug] [Thread-2 (]: Began executing node model.jaffle_shop.customers
[0m22:28:12.196506 [debug] [Thread-2 (]: Writing runtime sql for node "model.jaffle_shop.customers"
[0m22:28:12.199105 [debug] [Thread-2 (]: Using snowflake connection "model.jaffle_shop.customers"
[0m22:28:12.200507 [debug] [Thread-2 (]: On model.jaffle_shop.customers: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.customers"} */
create or replace   view RAW.JAFFLE_SHOP.customers
  
   as (
    


with customers as (

    select * from RAW.JAFFLE_SHOP.stg_customers

),

orders as (

    select * from RAW.JAFFLE_SHOP.stg_orders

),

customer_orders as (

    select
        customer_id,

        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders

    from orders

    group by 1

),

final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce(customer_orders.number_of_orders, 0) as number_of_orders

    from customers

    left join customer_orders using (customer_id)

)

select * from final
  );
[0m22:28:12.201349 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:28:12.696865 [debug] [Thread-4 (]: Snowflake adapter: Snowflake query id: 01b3a774-0001-c86b-0005-81260003f06e
[0m22:28:12.698001 [debug] [Thread-4 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 28 at position 0 unexpected ';'.
[0m22:28:12.699357 [debug] [Thread-4 (]: Timing info for model.jaffle_shop.int_orders__pivoted (execute): 22:28:12.116333 => 22:28:12.698827
[0m22:28:12.700285 [debug] [Thread-4 (]: On model.jaffle_shop.int_orders__pivoted: Close
[0m22:28:12.781026 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m22:28:12.785219 [debug] [Thread-2 (]: Timing info for model.jaffle_shop.customers (execute): 22:28:12.189686 => 22:28:12.784878
[0m22:28:12.785865 [debug] [Thread-2 (]: On model.jaffle_shop.customers: Close
[0m22:28:12.865758 [debug] [Thread-4 (]: Database Error in model int_orders__pivoted (models/marts/core/int_orders__pivoted.sql)
  001003 (42000): SQL compilation error:
  syntax error line 28 at position 0 unexpected ';'.
  compiled Code at target/run/jaffle_shop/models/marts/core/int_orders__pivoted.sql
[0m22:28:12.866712 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'df7ec178-e951-4a63-a090-5865a811ec18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d027c50>]}
[0m22:28:12.867713 [error] [Thread-4 (]: 4 of 5 ERROR creating sql table model JAFFLE_SHOP.int_orders__pivoted .......... [[31mERROR[0m in 0.76s]
[0m22:28:12.869224 [debug] [Thread-4 (]: Finished running node model.jaffle_shop.int_orders__pivoted
[0m22:28:12.936472 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'df7ec178-e951-4a63-a090-5865a811ec18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d0ee990>]}
[0m22:28:12.938372 [info ] [Thread-2 (]: 5 of 5 OK created sql view model JAFFLE_SHOP.customers ......................... [[32mSUCCESS 1[0m in 0.76s]
[0m22:28:12.940085 [debug] [Thread-2 (]: Finished running node model.jaffle_shop.customers
[0m22:28:12.944354 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:28:12.945201 [debug] [MainThread]: Connection 'model.jaffle_shop.stg_customers' was properly closed.
[0m22:28:12.945877 [debug] [MainThread]: Connection 'model.jaffle_shop.customers' was properly closed.
[0m22:28:12.946489 [debug] [MainThread]: Connection 'model.jaffle_shop.stg_payments' was properly closed.
[0m22:28:12.947425 [debug] [MainThread]: Connection 'model.jaffle_shop.int_orders__pivoted' was properly closed.
[0m22:28:12.948609 [info ] [MainThread]: 
[0m22:28:12.949766 [info ] [MainThread]: Finished running 4 view models, 1 table model in 0 hours 0 minutes and 3.38 seconds (3.38s).
[0m22:28:12.951821 [debug] [MainThread]: Command end result
[0m22:28:12.967806 [info ] [MainThread]: 
[0m22:28:12.968619 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m22:28:12.969177 [info ] [MainThread]: 
[0m22:28:12.969912 [error] [MainThread]:   Database Error in model int_orders__pivoted (models/marts/core/int_orders__pivoted.sql)
  001003 (42000): SQL compilation error:
  syntax error line 28 at position 0 unexpected ';'.
  compiled Code at target/run/jaffle_shop/models/marts/core/int_orders__pivoted.sql
[0m22:28:12.970778 [info ] [MainThread]: 
[0m22:28:12.971485 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
[0m22:28:12.975360 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 4.6028, "process_user_time": 4.812681, "process_kernel_time": 0.689233, "process_mem_max_rss": "137707520", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m22:28:12.976367 [debug] [MainThread]: Command `dbt run` failed at 22:28:12.976146 after 4.60 seconds
[0m22:28:12.977154 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c2d5bd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bf0bfd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bcadc10>]}
[0m22:28:12.978216 [debug] [MainThread]: Flushing usage events
[0m22:29:15.050869 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b27510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107509b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ea4ad0>]}


============================== 22:29:15.061096 | e8e729b3-856e-46b5-a821-d295115bdc8c ==============================
[0m22:29:15.061096 [info ] [MainThread]: Running with dbt=1.7.8
[0m22:29:15.062673 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/ben/jaffle_shop/logs', 'profiles_dir': '/Users/ben/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m22:29:15.821797 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e8e729b3-856e-46b5-a821-d295115bdc8c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ef1150>]}
[0m22:29:15.945235 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e8e729b3-856e-46b5-a821-d295115bdc8c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107dc6c10>]}
[0m22:29:15.947084 [info ] [MainThread]: Registered adapter: snowflake=1.7.2
[0m22:29:15.973014 [debug] [MainThread]: checksum: 67f0013ca5f0bd43af9a0873dd50792fde83ef69de63b71cacd0b4ac656c52e5, vars: {}, profile: , target: , version: 1.7.8
[0m22:29:16.080919 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m22:29:16.082053 [debug] [MainThread]: Partial parsing: updated file: jaffle_shop://models/marts/core/int_orders__pivoted.sql
[0m22:29:16.294161 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e8e729b3-856e-46b5-a821-d295115bdc8c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108b8f110>]}
[0m22:29:16.311387 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e8e729b3-856e-46b5-a821-d295115bdc8c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10893e690>]}
[0m22:29:16.312169 [info ] [MainThread]: Found 5 models, 3 seeds, 11 tests, 0 sources, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m22:29:16.312779 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e8e729b3-856e-46b5-a821-d295115bdc8c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1089af490>]}
[0m22:29:16.316108 [info ] [MainThread]: 
[0m22:29:16.317390 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m22:29:16.319146 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RAW'
[0m22:29:16.338714 [debug] [ThreadPool]: Using snowflake connection "list_RAW"
[0m22:29:16.339393 [debug] [ThreadPool]: On list_RAW: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_RAW"} */
show terse schemas in database RAW
    limit 10000
[0m22:29:16.339948 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:29:17.138090 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.0 seconds
[0m22:29:17.143188 [debug] [ThreadPool]: On list_RAW: Close
[0m22:29:17.293331 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RAW, now list_RAW_JAFFLE_SHOP)
[0m22:29:17.309847 [debug] [ThreadPool]: Using snowflake connection "list_RAW_JAFFLE_SHOP"
[0m22:29:17.310583 [debug] [ThreadPool]: On list_RAW_JAFFLE_SHOP: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_RAW_JAFFLE_SHOP"} */
show terse objects in RAW.JAFFLE_SHOP limit 10000
[0m22:29:17.311170 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:29:17.845538 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.0 seconds
[0m22:29:17.850555 [debug] [ThreadPool]: On list_RAW_JAFFLE_SHOP: Close
[0m22:29:18.022948 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e8e729b3-856e-46b5-a821-d295115bdc8c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108a2d2d0>]}
[0m22:29:18.024927 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:29:18.025944 [info ] [MainThread]: 
[0m22:29:18.031844 [debug] [Thread-1 (]: Began running node model.jaffle_shop.stg_customers
[0m22:29:18.032988 [info ] [Thread-1 (]: 1 of 5 START sql view model JAFFLE_SHOP.stg_customers .......................... [RUN]
[0m22:29:18.033796 [debug] [Thread-2 (]: Began running node model.jaffle_shop.stg_orders
[0m22:29:18.034432 [debug] [Thread-3 (]: Began running node model.jaffle_shop.stg_payments
[0m22:29:18.035549 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_RAW_JAFFLE_SHOP, now model.jaffle_shop.stg_customers)
[0m22:29:18.036304 [info ] [Thread-2 (]: 2 of 5 START sql view model JAFFLE_SHOP.stg_orders ............................. [RUN]
[0m22:29:18.037218 [info ] [Thread-3 (]: 3 of 5 START sql view model JAFFLE_SHOP.stg_payments ........................... [RUN]
[0m22:29:18.038003 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.stg_customers
[0m22:29:18.039230 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.jaffle_shop.stg_orders'
[0m22:29:18.040328 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.jaffle_shop.stg_payments'
[0m22:29:18.051899 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.stg_customers"
[0m22:29:18.052635 [debug] [Thread-2 (]: Began compiling node model.jaffle_shop.stg_orders
[0m22:29:18.053247 [debug] [Thread-3 (]: Began compiling node model.jaffle_shop.stg_payments
[0m22:29:18.059402 [debug] [Thread-2 (]: Writing injected SQL for node "model.jaffle_shop.stg_orders"
[0m22:29:18.063735 [debug] [Thread-3 (]: Writing injected SQL for node "model.jaffle_shop.stg_payments"
[0m22:29:18.064744 [debug] [Thread-1 (]: Timing info for model.jaffle_shop.stg_customers (compile): 22:29:18.040762 => 22:29:18.064202
[0m22:29:18.066040 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.stg_customers
[0m22:29:18.078797 [debug] [Thread-2 (]: Timing info for model.jaffle_shop.stg_orders (compile): 22:29:18.054006 => 22:29:18.078337
[0m22:29:18.079537 [debug] [Thread-2 (]: Began executing node model.jaffle_shop.stg_orders
[0m22:29:18.091870 [debug] [Thread-3 (]: Timing info for model.jaffle_shop.stg_payments (compile): 22:29:18.060254 => 22:29:18.091438
[0m22:29:18.123188 [debug] [Thread-3 (]: Began executing node model.jaffle_shop.stg_payments
[0m22:29:18.149940 [debug] [Thread-2 (]: Writing runtime sql for node "model.jaffle_shop.stg_orders"
[0m22:29:18.153710 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.stg_customers"
[0m22:29:18.156223 [debug] [Thread-3 (]: Writing runtime sql for node "model.jaffle_shop.stg_payments"
[0m22:29:18.157926 [debug] [Thread-2 (]: Using snowflake connection "model.jaffle_shop.stg_orders"
[0m22:29:18.158909 [debug] [Thread-1 (]: Using snowflake connection "model.jaffle_shop.stg_customers"
[0m22:29:18.159756 [debug] [Thread-3 (]: Using snowflake connection "model.jaffle_shop.stg_payments"
[0m22:29:18.160315 [debug] [Thread-2 (]: On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */
create or replace   view RAW.JAFFLE_SHOP.stg_orders
  
   as (
    

select
    id as order_id,
    user_id as customer_id,
    order_date,
    status

from raw.jaffle_shop.raw_orders
  );
[0m22:29:18.161067 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */
create or replace   view RAW.JAFFLE_SHOP.stg_customers
  
   as (
    -- noinspection SqlNoDataSourceInspectionForFile



select
    id as customer_id,
    first_name,
    last_name

from raw.jaffle_shop.raw_customers
  );
[0m22:29:18.161696 [debug] [Thread-3 (]: On model.jaffle_shop.stg_payments: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_payments"} */
create or replace   view RAW.JAFFLE_SHOP.stg_payments
  
   as (
    

select
    id,
    order_id,
    payment_method,
    amount

from raw.jaffle_shop.raw_payments
  );
[0m22:29:18.162282 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m22:29:18.162837 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:29:18.163367 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m22:29:18.724515 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m22:29:18.745350 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m22:29:18.772138 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m22:29:18.773300 [debug] [Thread-1 (]: Timing info for model.jaffle_shop.stg_customers (execute): 22:29:18.066466 => 22:29:18.772956
[0m22:29:18.777422 [debug] [Thread-2 (]: Timing info for model.jaffle_shop.stg_orders (execute): 22:29:18.085268 => 22:29:18.777091
[0m22:29:18.781028 [debug] [Thread-3 (]: Timing info for model.jaffle_shop.stg_payments (execute): 22:29:18.123749 => 22:29:18.780710
[0m22:29:18.781685 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: Close
[0m22:29:18.782277 [debug] [Thread-2 (]: On model.jaffle_shop.stg_orders: Close
[0m22:29:18.782846 [debug] [Thread-3 (]: On model.jaffle_shop.stg_payments: Close
[0m22:29:19.029057 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e8e729b3-856e-46b5-a821-d295115bdc8c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108cc0750>]}
[0m22:29:19.031183 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e8e729b3-856e-46b5-a821-d295115bdc8c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108cdbcd0>]}
[0m22:29:19.032994 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e8e729b3-856e-46b5-a821-d295115bdc8c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108cc1750>]}
[0m22:29:19.035857 [info ] [Thread-2 (]: 2 of 5 OK created sql view model JAFFLE_SHOP.stg_orders ........................ [[32mSUCCESS 1[0m in 0.99s]
[0m22:29:19.038190 [info ] [Thread-1 (]: 1 of 5 OK created sql view model JAFFLE_SHOP.stg_customers ..................... [[32mSUCCESS 1[0m in 1.00s]
[0m22:29:19.039904 [info ] [Thread-3 (]: 3 of 5 OK created sql view model JAFFLE_SHOP.stg_payments ...................... [[32mSUCCESS 1[0m in 0.99s]
[0m22:29:19.041545 [debug] [Thread-2 (]: Finished running node model.jaffle_shop.stg_orders
[0m22:29:19.042704 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.stg_customers
[0m22:29:19.043755 [debug] [Thread-3 (]: Finished running node model.jaffle_shop.stg_payments
[0m22:29:19.045754 [debug] [Thread-4 (]: Began running node model.jaffle_shop.customers
[0m22:29:19.046800 [info ] [Thread-4 (]: 4 of 5 START sql view model JAFFLE_SHOP.customers .............................. [RUN]
[0m22:29:19.048269 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.jaffle_shop.customers'
[0m22:29:19.049107 [debug] [Thread-2 (]: Began running node model.jaffle_shop.int_orders__pivoted
[0m22:29:19.049801 [debug] [Thread-4 (]: Began compiling node model.jaffle_shop.customers
[0m22:29:19.050608 [info ] [Thread-2 (]: 5 of 5 START sql table model JAFFLE_SHOP.int_orders__pivoted ................... [RUN]
[0m22:29:19.057675 [debug] [Thread-4 (]: Writing injected SQL for node "model.jaffle_shop.customers"
[0m22:29:19.058815 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.jaffle_shop.stg_orders, now model.jaffle_shop.int_orders__pivoted)
[0m22:29:19.059680 [debug] [Thread-2 (]: Began compiling node model.jaffle_shop.int_orders__pivoted
[0m22:29:19.066641 [debug] [Thread-4 (]: Timing info for model.jaffle_shop.customers (compile): 22:29:19.051114 => 22:29:19.065542
[0m22:29:19.067499 [debug] [Thread-2 (]: Writing injected SQL for node "model.jaffle_shop.int_orders__pivoted"
[0m22:29:19.068369 [debug] [Thread-4 (]: Began executing node model.jaffle_shop.customers
[0m22:29:19.075545 [debug] [Thread-4 (]: Writing runtime sql for node "model.jaffle_shop.customers"
[0m22:29:19.076800 [debug] [Thread-2 (]: Timing info for model.jaffle_shop.int_orders__pivoted (compile): 22:29:19.060241 => 22:29:19.076304
[0m22:29:19.077673 [debug] [Thread-2 (]: Began executing node model.jaffle_shop.int_orders__pivoted
[0m22:29:19.081582 [debug] [Thread-4 (]: Using snowflake connection "model.jaffle_shop.customers"
[0m22:29:19.094099 [debug] [Thread-4 (]: On model.jaffle_shop.customers: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.customers"} */
create or replace   view RAW.JAFFLE_SHOP.customers
  
   as (
    


with customers as (

    select * from RAW.JAFFLE_SHOP.stg_customers

),

orders as (

    select * from RAW.JAFFLE_SHOP.stg_orders

),

customer_orders as (

    select
        customer_id,

        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders

    from orders

    group by 1

),

final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce(customer_orders.number_of_orders, 0) as number_of_orders

    from customers

    left join customer_orders using (customer_id)

)

select * from final
  );
[0m22:29:19.112006 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m22:29:19.142428 [debug] [Thread-2 (]: Writing runtime sql for node "model.jaffle_shop.int_orders__pivoted"
[0m22:29:19.147978 [debug] [Thread-2 (]: Using snowflake connection "model.jaffle_shop.int_orders__pivoted"
[0m22:29:19.149656 [debug] [Thread-2 (]: On model.jaffle_shop.int_orders__pivoted: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.int_orders__pivoted"} */
create or replace transient table RAW.JAFFLE_SHOP.int_orders__pivoted
         as
        (

WITH payments AS (
    SELECT p.id AS id,
           p.order_id AS order_id,
           p.payment_method AS payment_method,
           p.amount AS amount,
           o.status AS status
    FROM RAW.JAFFLE_SHOP.stg_payments p
    JOIN RAW.JAFFLE_SHOP.stg_orders o
    ON p.order_id = o.order_id
),
pivoted AS (
    SELECT
        order_id,
        SUM(CASE WHEN payment_method = 'bank_transfer' THEN amount ELSE 0 END) AS bank_transfer_amount,
        SUM(CASE WHEN payment_method = 'coupon' THEN amount ELSE 0 END) AS coupon_amount,
        SUM(CASE WHEN payment_method = 'credit_card' THEN amount ELSE 0 END) AS credit_card_amount,
        SUM(CASE WHEN payment_method = 'gift_card' THEN amount ELSE 0 END) AS gift_card_amount
    FROM payments
    WHERE status = 'success'
    GROUP BY 1
)

SELECT * FROM pivoted
        );
[0m22:29:19.152107 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:29:20.061918 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m22:29:20.069390 [debug] [Thread-4 (]: Timing info for model.jaffle_shop.customers (execute): 22:29:19.068968 => 22:29:20.068878
[0m22:29:20.070359 [debug] [Thread-4 (]: On model.jaffle_shop.customers: Close
[0m22:29:20.225896 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e8e729b3-856e-46b5-a821-d295115bdc8c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108cdb8d0>]}
[0m22:29:20.227728 [info ] [Thread-4 (]: 4 of 5 OK created sql view model JAFFLE_SHOP.customers ......................... [[32mSUCCESS 1[0m in 1.18s]
[0m22:29:20.229687 [debug] [Thread-4 (]: Finished running node model.jaffle_shop.customers
[0m22:29:20.664591 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m22:29:20.672301 [debug] [Thread-2 (]: Timing info for model.jaffle_shop.int_orders__pivoted (execute): 22:29:19.082529 => 22:29:20.671757
[0m22:29:20.673330 [debug] [Thread-2 (]: On model.jaffle_shop.int_orders__pivoted: Close
[0m22:29:20.827096 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e8e729b3-856e-46b5-a821-d295115bdc8c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ddf010>]}
[0m22:29:20.829203 [info ] [Thread-2 (]: 5 of 5 OK created sql table model JAFFLE_SHOP.int_orders__pivoted .............. [[32mSUCCESS 1[0m in 1.77s]
[0m22:29:20.831244 [debug] [Thread-2 (]: Finished running node model.jaffle_shop.int_orders__pivoted
[0m22:29:20.835559 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:29:20.836490 [debug] [MainThread]: Connection 'model.jaffle_shop.stg_customers' was properly closed.
[0m22:29:20.837253 [debug] [MainThread]: Connection 'model.jaffle_shop.int_orders__pivoted' was properly closed.
[0m22:29:20.837852 [debug] [MainThread]: Connection 'model.jaffle_shop.stg_payments' was properly closed.
[0m22:29:20.838444 [debug] [MainThread]: Connection 'model.jaffle_shop.customers' was properly closed.
[0m22:29:20.839227 [info ] [MainThread]: 
[0m22:29:20.840030 [info ] [MainThread]: Finished running 4 view models, 1 table model in 0 hours 0 minutes and 4.52 seconds (4.52s).
[0m22:29:20.842273 [debug] [MainThread]: Command end result
[0m22:29:20.855854 [info ] [MainThread]: 
[0m22:29:20.856534 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:29:20.857058 [info ] [MainThread]: 
[0m22:29:20.857605 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m22:29:20.861620 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 5.8983526, "process_user_time": 4.864004, "process_kernel_time": 0.687396, "process_mem_max_rss": "139304960", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m22:29:20.862740 [debug] [MainThread]: Command `dbt run` succeeded at 22:29:20.862519 after 5.90 seconds
[0m22:29:20.863401 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ed6dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103b9fc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b24550>]}
[0m22:29:20.864247 [debug] [MainThread]: Flushing usage events
[0m22:32:13.618404 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108fc64d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1089cdbd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1089cc090>]}


============================== 22:32:13.626854 | 0f439a7d-4d75-408c-a4de-6506b300a265 ==============================
[0m22:32:13.626854 [info ] [MainThread]: Running with dbt=1.7.8
[0m22:32:13.628034 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/ben/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/Users/ben/jaffle_shop/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:32:14.327411 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0f439a7d-4d75-408c-a4de-6506b300a265', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109757050>]}
[0m22:32:14.462743 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0f439a7d-4d75-408c-a4de-6506b300a265', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108a45c50>]}
[0m22:32:14.463997 [info ] [MainThread]: Registered adapter: snowflake=1.7.2
[0m22:32:14.489285 [debug] [MainThread]: checksum: 67f0013ca5f0bd43af9a0873dd50792fde83ef69de63b71cacd0b4ac656c52e5, vars: {}, profile: , target: , version: 1.7.8
[0m22:32:14.547426 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m22:32:14.548527 [debug] [MainThread]: Partial parsing: updated file: jaffle_shop://models/marts/core/int_orders__pivoted.sql
[0m22:32:14.770488 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0f439a7d-4d75-408c-a4de-6506b300a265', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109ca8e10>]}
[0m22:32:14.788650 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0f439a7d-4d75-408c-a4de-6506b300a265', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109a45110>]}
[0m22:32:14.789542 [info ] [MainThread]: Found 5 models, 3 seeds, 11 tests, 0 sources, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m22:32:14.790322 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0f439a7d-4d75-408c-a4de-6506b300a265', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109cc44d0>]}
[0m22:32:14.793857 [info ] [MainThread]: 
[0m22:32:14.795165 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m22:32:14.796942 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RAW'
[0m22:32:14.817304 [debug] [ThreadPool]: Using snowflake connection "list_RAW"
[0m22:32:14.817983 [debug] [ThreadPool]: On list_RAW: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_RAW"} */
show terse schemas in database RAW
    limit 10000
[0m22:32:14.818772 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:32:15.544703 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.0 seconds
[0m22:32:15.548773 [debug] [ThreadPool]: On list_RAW: Close
[0m22:32:15.705932 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RAW, now list_RAW_JAFFLE_SHOP)
[0m22:32:15.723147 [debug] [ThreadPool]: Using snowflake connection "list_RAW_JAFFLE_SHOP"
[0m22:32:15.723826 [debug] [ThreadPool]: On list_RAW_JAFFLE_SHOP: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_RAW_JAFFLE_SHOP"} */
show terse objects in RAW.JAFFLE_SHOP limit 10000
[0m22:32:15.724332 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:32:16.169543 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 0.0 seconds
[0m22:32:16.175522 [debug] [ThreadPool]: On list_RAW_JAFFLE_SHOP: Close
[0m22:32:16.329113 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0f439a7d-4d75-408c-a4de-6506b300a265', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1098fc290>]}
[0m22:32:16.331063 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:32:16.332008 [info ] [MainThread]: 
[0m22:32:16.338275 [debug] [Thread-1 (]: Began running node model.jaffle_shop.stg_customers
[0m22:32:16.339409 [debug] [Thread-2 (]: Began running node model.jaffle_shop.stg_orders
[0m22:32:16.340217 [info ] [Thread-1 (]: 1 of 5 START sql view model JAFFLE_SHOP.stg_customers .......................... [RUN]
[0m22:32:16.341031 [debug] [Thread-3 (]: Began running node model.jaffle_shop.stg_payments
[0m22:32:16.341869 [info ] [Thread-2 (]: 2 of 5 START sql view model JAFFLE_SHOP.stg_orders ............................. [RUN]
[0m22:32:16.343071 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_RAW_JAFFLE_SHOP, now model.jaffle_shop.stg_customers)
[0m22:32:16.343827 [info ] [Thread-3 (]: 3 of 5 START sql view model JAFFLE_SHOP.stg_payments ........................... [RUN]
[0m22:32:16.345442 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.jaffle_shop.stg_orders'
[0m22:32:16.346334 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.stg_customers
[0m22:32:16.347503 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.jaffle_shop.stg_payments'
[0m22:32:16.348146 [debug] [Thread-2 (]: Began compiling node model.jaffle_shop.stg_orders
[0m22:32:16.361817 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.stg_customers"
[0m22:32:16.362969 [debug] [Thread-3 (]: Began compiling node model.jaffle_shop.stg_payments
[0m22:32:16.369042 [debug] [Thread-2 (]: Writing injected SQL for node "model.jaffle_shop.stg_orders"
[0m22:32:16.373788 [debug] [Thread-3 (]: Writing injected SQL for node "model.jaffle_shop.stg_payments"
[0m22:32:16.375188 [debug] [Thread-2 (]: Timing info for model.jaffle_shop.stg_orders (compile): 22:32:16.364129 => 22:32:16.374762
[0m22:32:16.376082 [debug] [Thread-1 (]: Timing info for model.jaffle_shop.stg_customers (compile): 22:32:16.348574 => 22:32:16.375701
[0m22:32:16.376783 [debug] [Thread-2 (]: Began executing node model.jaffle_shop.stg_orders
[0m22:32:16.377516 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.stg_customers
[0m22:32:16.378323 [debug] [Thread-3 (]: Timing info for model.jaffle_shop.stg_payments (compile): 22:32:16.369922 => 22:32:16.377981
[0m22:32:16.433161 [debug] [Thread-3 (]: Began executing node model.jaffle_shop.stg_payments
[0m22:32:16.446691 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.stg_customers"
[0m22:32:16.457368 [debug] [Thread-3 (]: Writing runtime sql for node "model.jaffle_shop.stg_payments"
[0m22:32:16.457933 [debug] [Thread-2 (]: Writing runtime sql for node "model.jaffle_shop.stg_orders"
[0m22:32:16.459684 [debug] [Thread-1 (]: Using snowflake connection "model.jaffle_shop.stg_customers"
[0m22:32:16.460499 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */
create or replace   view RAW.JAFFLE_SHOP.stg_customers
  
   as (
    -- noinspection SqlNoDataSourceInspectionForFile



select
    id as customer_id,
    first_name,
    last_name

from raw.jaffle_shop.raw_customers
  );
[0m22:32:16.461600 [debug] [Thread-3 (]: Using snowflake connection "model.jaffle_shop.stg_payments"
[0m22:32:16.462179 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:32:16.463225 [debug] [Thread-2 (]: Using snowflake connection "model.jaffle_shop.stg_orders"
[0m22:32:16.463793 [debug] [Thread-3 (]: On model.jaffle_shop.stg_payments: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_payments"} */
create or replace   view RAW.JAFFLE_SHOP.stg_payments
  
   as (
    

select
    id,
    order_id,
    payment_method,
    amount

from raw.jaffle_shop.raw_payments
  );
[0m22:32:16.466108 [debug] [Thread-2 (]: On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */
create or replace   view RAW.JAFFLE_SHOP.stg_orders
  
   as (
    

select
    id as order_id,
    user_id as customer_id,
    order_date,
    status

from raw.jaffle_shop.raw_orders
  );
[0m22:32:16.467041 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m22:32:16.467843 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m22:32:17.044171 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m22:32:17.071634 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m22:32:17.086421 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m22:32:17.103985 [debug] [Thread-3 (]: Timing info for model.jaffle_shop.stg_payments (execute): 22:32:16.452649 => 22:32:17.103568
[0m22:32:17.107840 [debug] [Thread-1 (]: Timing info for model.jaffle_shop.stg_customers (execute): 22:32:16.391334 => 22:32:17.107518
[0m22:32:17.111069 [debug] [Thread-2 (]: Timing info for model.jaffle_shop.stg_orders (execute): 22:32:16.378643 => 22:32:17.110741
[0m22:32:17.111838 [debug] [Thread-3 (]: On model.jaffle_shop.stg_payments: Close
[0m22:32:17.112613 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: Close
[0m22:32:17.113287 [debug] [Thread-2 (]: On model.jaffle_shop.stg_orders: Close
[0m22:32:17.281714 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0f439a7d-4d75-408c-a4de-6506b300a265', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109c7b210>]}
[0m22:32:17.283515 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0f439a7d-4d75-408c-a4de-6506b300a265', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109b10450>]}
[0m22:32:17.285637 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0f439a7d-4d75-408c-a4de-6506b300a265', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1099ed710>]}
[0m22:32:17.287447 [info ] [Thread-1 (]: 1 of 5 OK created sql view model JAFFLE_SHOP.stg_customers ..................... [[32mSUCCESS 1[0m in 0.94s]
[0m22:32:17.289837 [info ] [Thread-3 (]: 3 of 5 OK created sql view model JAFFLE_SHOP.stg_payments ...................... [[32mSUCCESS 1[0m in 0.94s]
[0m22:32:17.291170 [info ] [Thread-2 (]: 2 of 5 OK created sql view model JAFFLE_SHOP.stg_orders ........................ [[32mSUCCESS 1[0m in 0.94s]
[0m22:32:17.292972 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.stg_customers
[0m22:32:17.294035 [debug] [Thread-3 (]: Finished running node model.jaffle_shop.stg_payments
[0m22:32:17.294929 [debug] [Thread-2 (]: Finished running node model.jaffle_shop.stg_orders
[0m22:32:17.296407 [debug] [Thread-4 (]: Began running node model.jaffle_shop.customers
[0m22:32:17.297241 [debug] [Thread-1 (]: Began running node model.jaffle_shop.int_orders__pivoted
[0m22:32:17.297910 [info ] [Thread-4 (]: 4 of 5 START sql view model JAFFLE_SHOP.customers .............................. [RUN]
[0m22:32:17.298829 [info ] [Thread-1 (]: 5 of 5 START sql view model JAFFLE_SHOP.int_orders__pivoted .................... [RUN]
[0m22:32:17.300513 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.jaffle_shop.customers'
[0m22:32:17.301769 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.jaffle_shop.stg_customers, now model.jaffle_shop.int_orders__pivoted)
[0m22:32:17.302518 [debug] [Thread-4 (]: Began compiling node model.jaffle_shop.customers
[0m22:32:17.303180 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.int_orders__pivoted
[0m22:32:17.309434 [debug] [Thread-4 (]: Writing injected SQL for node "model.jaffle_shop.customers"
[0m22:32:17.315929 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.int_orders__pivoted"
[0m22:32:17.317474 [debug] [Thread-4 (]: Timing info for model.jaffle_shop.customers (compile): 22:32:17.303782 => 22:32:17.316967
[0m22:32:17.318234 [debug] [Thread-4 (]: Began executing node model.jaffle_shop.customers
[0m22:32:17.319245 [debug] [Thread-1 (]: Timing info for model.jaffle_shop.int_orders__pivoted (compile): 22:32:17.309987 => 22:32:17.318756
[0m22:32:17.327790 [debug] [Thread-4 (]: Writing runtime sql for node "model.jaffle_shop.customers"
[0m22:32:17.328555 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.int_orders__pivoted
[0m22:32:17.349345 [debug] [Thread-4 (]: Using snowflake connection "model.jaffle_shop.customers"
[0m22:32:17.350170 [debug] [Thread-1 (]: Dropping relation "RAW"."JAFFLE_SHOP"."INT_ORDERS__PIVOTED" because it is of type table
[0m22:32:17.351457 [debug] [Thread-4 (]: On model.jaffle_shop.customers: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.customers"} */
create or replace   view RAW.JAFFLE_SHOP.customers
  
   as (
    


with customers as (

    select * from RAW.JAFFLE_SHOP.stg_customers

),

orders as (

    select * from RAW.JAFFLE_SHOP.stg_orders

),

customer_orders as (

    select
        customer_id,

        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders

    from orders

    group by 1

),

final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce(customer_orders.number_of_orders, 0) as number_of_orders

    from customers

    left join customer_orders using (customer_id)

)

select * from final
  );
[0m22:32:17.365541 [debug] [Thread-1 (]: Applying DROP to: "RAW"."JAFFLE_SHOP"."INT_ORDERS__PIVOTED"
[0m22:32:17.366634 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m22:32:17.382732 [debug] [Thread-1 (]: Using snowflake connection "model.jaffle_shop.int_orders__pivoted"
[0m22:32:17.385726 [debug] [Thread-1 (]: On model.jaffle_shop.int_orders__pivoted: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.int_orders__pivoted"} */
drop table if exists "RAW"."JAFFLE_SHOP"."INT_ORDERS__PIVOTED" cascade
[0m22:32:17.386975 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:32:17.945673 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m22:32:17.952679 [debug] [Thread-4 (]: Timing info for model.jaffle_shop.customers (execute): 22:32:17.319784 => 22:32:17.952249
[0m22:32:17.953617 [debug] [Thread-4 (]: On model.jaffle_shop.customers: Close
[0m22:32:18.049161 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m22:32:18.052819 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.int_orders__pivoted"
[0m22:32:18.055916 [debug] [Thread-1 (]: Using snowflake connection "model.jaffle_shop.int_orders__pivoted"
[0m22:32:18.056648 [debug] [Thread-1 (]: On model.jaffle_shop.int_orders__pivoted: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.int_orders__pivoted"} */
create or replace   view RAW.JAFFLE_SHOP.int_orders__pivoted
  
   as (
    



WITH payments AS (
    SELECT p.id AS id,
           p.order_id AS order_id,
           p.payment_method AS payment_method,
           p.amount AS amount,
           o.status AS status
    FROM RAW.JAFFLE_SHOP.stg_payments p
    JOIN RAW.JAFFLE_SHOP.stg_orders o
    ON p.order_id = o.order_id
),
pivoted AS (
    SELECT
        order_id,
        SUM(CASE WHEN payment_method = 'bank_transfer' THEN amount ELSE 0 END) AS bank_transfer_amount,
        SUM(CASE WHEN payment_method = 'coupon' THEN amount ELSE 0 END) AS coupon_amount,
        SUM(CASE WHEN payment_method = 'credit_card' THEN amount ELSE 0 END) AS credit_card_amount,
        SUM(CASE WHEN payment_method = 'gift_card' THEN amount ELSE 0 END) AS gift_card_amount
    FROM payments
    WHERE status = 'success'
    GROUP BY 1
)

SELECT * FROM pivoted
  );
[0m22:32:18.096965 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0f439a7d-4d75-408c-a4de-6506b300a265', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109d32550>]}
[0m22:32:18.098079 [info ] [Thread-4 (]: 4 of 5 OK created sql view model JAFFLE_SHOP.customers ......................... [[32mSUCCESS 1[0m in 0.80s]
[0m22:32:18.099274 [debug] [Thread-4 (]: Finished running node model.jaffle_shop.customers
[0m22:32:18.300174 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m22:32:18.308646 [debug] [Thread-1 (]: Timing info for model.jaffle_shop.int_orders__pivoted (execute): 22:32:17.329400 => 22:32:18.308094
[0m22:32:18.309692 [debug] [Thread-1 (]: On model.jaffle_shop.int_orders__pivoted: Close
[0m22:32:18.492140 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0f439a7d-4d75-408c-a4de-6506b300a265', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109dc4050>]}
[0m22:32:18.493878 [info ] [Thread-1 (]: 5 of 5 OK created sql view model JAFFLE_SHOP.int_orders__pivoted ............... [[32mSUCCESS 1[0m in 1.19s]
[0m22:32:18.495313 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.int_orders__pivoted
[0m22:32:18.499477 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:32:18.500210 [debug] [MainThread]: Connection 'model.jaffle_shop.int_orders__pivoted' was properly closed.
[0m22:32:18.501055 [debug] [MainThread]: Connection 'model.jaffle_shop.stg_orders' was properly closed.
[0m22:32:18.501703 [debug] [MainThread]: Connection 'model.jaffle_shop.stg_payments' was properly closed.
[0m22:32:18.502500 [debug] [MainThread]: Connection 'model.jaffle_shop.customers' was properly closed.
[0m22:32:18.503373 [info ] [MainThread]: 
[0m22:32:18.504738 [info ] [MainThread]: Finished running 5 view models in 0 hours 0 minutes and 3.71 seconds (3.71s).
[0m22:32:18.507181 [debug] [MainThread]: Command end result
[0m22:32:18.522358 [info ] [MainThread]: 
[0m22:32:18.523079 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:32:18.523620 [info ] [MainThread]: 
[0m22:32:18.524180 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m22:32:18.526798 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 4.998042, "process_user_time": 4.875185, "process_kernel_time": 0.64821, "process_mem_max_rss": "140267520", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m22:32:18.528433 [debug] [MainThread]: Command `dbt run` succeeded at 22:32:18.528160 after 5.00 seconds
[0m22:32:18.529337 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10901e950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10901ee50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d77c10>]}
[0m22:32:18.530096 [debug] [MainThread]: Flushing usage events
[0m22:42:12.242935 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1099ff950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10994bc90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10994b810>]}


============================== 22:42:12.251601 | 8cc72603-ed6b-4e1c-9720-14e1a08b4085 ==============================
[0m22:42:12.251601 [info ] [MainThread]: Running with dbt=1.7.8
[0m22:42:12.252720 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/ben/jaffle_shop/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/ben/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt run', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:42:12.960209 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8cc72603-ed6b-4e1c-9720-14e1a08b4085', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109f92590>]}
[0m22:42:13.099688 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8cc72603-ed6b-4e1c-9720-14e1a08b4085', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a930f90>]}
[0m22:42:13.100983 [info ] [MainThread]: Registered adapter: snowflake=1.7.2
[0m22:42:13.126720 [debug] [MainThread]: checksum: 67f0013ca5f0bd43af9a0873dd50792fde83ef69de63b71cacd0b4ac656c52e5, vars: {}, profile: , target: , version: 1.7.8
[0m22:42:13.187152 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m22:42:13.188354 [debug] [MainThread]: Partial parsing: updated file: jaffle_shop://models/marts/core/int_orders__pivoted.sql
[0m22:42:13.420544 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8cc72603-ed6b-4e1c-9720-14e1a08b4085', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aac4a90>]}
[0m22:42:13.439031 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8cc72603-ed6b-4e1c-9720-14e1a08b4085', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ac91d90>]}
[0m22:42:13.439974 [info ] [MainThread]: Found 5 models, 3 seeds, 11 tests, 0 sources, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m22:42:13.441373 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8cc72603-ed6b-4e1c-9720-14e1a08b4085', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ac7bed0>]}
[0m22:42:13.445020 [info ] [MainThread]: 
[0m22:42:13.446357 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m22:42:13.448607 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_RAW'
[0m22:42:13.469872 [debug] [ThreadPool]: Using snowflake connection "list_RAW"
[0m22:42:13.470926 [debug] [ThreadPool]: On list_RAW: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_RAW"} */
show terse schemas in database RAW
    limit 10000
[0m22:42:13.471818 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:42:14.290414 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.0 seconds
[0m22:42:14.295829 [debug] [ThreadPool]: On list_RAW: Close
[0m22:42:14.463333 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_RAW, now list_RAW_JAFFLE_SHOP)
[0m22:42:14.480172 [debug] [ThreadPool]: Using snowflake connection "list_RAW_JAFFLE_SHOP"
[0m22:42:14.480885 [debug] [ThreadPool]: On list_RAW_JAFFLE_SHOP: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "list_RAW_JAFFLE_SHOP"} */
show terse objects in RAW.JAFFLE_SHOP limit 10000
[0m22:42:14.481403 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:42:15.012803 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 1.0 seconds
[0m22:42:15.016973 [debug] [ThreadPool]: On list_RAW_JAFFLE_SHOP: Close
[0m22:42:15.153573 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8cc72603-ed6b-4e1c-9720-14e1a08b4085', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aa81910>]}
[0m22:42:15.155376 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:42:15.156312 [info ] [MainThread]: 
[0m22:42:15.160373 [debug] [Thread-1 (]: Began running node model.jaffle_shop.stg_customers
[0m22:42:15.161145 [debug] [Thread-2 (]: Began running node model.jaffle_shop.stg_orders
[0m22:42:15.161886 [info ] [Thread-1 (]: 1 of 5 START sql view model JAFFLE_SHOP.stg_customers .......................... [RUN]
[0m22:42:15.162598 [debug] [Thread-3 (]: Began running node model.jaffle_shop.stg_payments
[0m22:42:15.163332 [info ] [Thread-2 (]: 2 of 5 START sql view model JAFFLE_SHOP.stg_orders ............................. [RUN]
[0m22:42:15.164413 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_RAW_JAFFLE_SHOP, now model.jaffle_shop.stg_customers)
[0m22:42:15.165097 [info ] [Thread-3 (]: 3 of 5 START sql view model JAFFLE_SHOP.stg_payments ........................... [RUN]
[0m22:42:15.166341 [debug] [Thread-2 (]: Acquiring new snowflake connection 'model.jaffle_shop.stg_orders'
[0m22:42:15.167114 [debug] [Thread-1 (]: Began compiling node model.jaffle_shop.stg_customers
[0m22:42:15.168287 [debug] [Thread-3 (]: Acquiring new snowflake connection 'model.jaffle_shop.stg_payments'
[0m22:42:15.168973 [debug] [Thread-2 (]: Began compiling node model.jaffle_shop.stg_orders
[0m22:42:15.182962 [debug] [Thread-3 (]: Began compiling node model.jaffle_shop.stg_payments
[0m22:42:15.182270 [debug] [Thread-1 (]: Writing injected SQL for node "model.jaffle_shop.stg_customers"
[0m22:42:15.188298 [debug] [Thread-2 (]: Writing injected SQL for node "model.jaffle_shop.stg_orders"
[0m22:42:15.194025 [debug] [Thread-3 (]: Writing injected SQL for node "model.jaffle_shop.stg_payments"
[0m22:42:15.196057 [debug] [Thread-2 (]: Timing info for model.jaffle_shop.stg_orders (compile): 22:42:15.183484 => 22:42:15.195601
[0m22:42:15.196909 [debug] [Thread-1 (]: Timing info for model.jaffle_shop.stg_customers (compile): 22:42:15.169411 => 22:42:15.196505
[0m22:42:15.197582 [debug] [Thread-2 (]: Began executing node model.jaffle_shop.stg_orders
[0m22:42:15.198333 [debug] [Thread-3 (]: Timing info for model.jaffle_shop.stg_payments (compile): 22:42:15.189049 => 22:42:15.198010
[0m22:42:15.198847 [debug] [Thread-1 (]: Began executing node model.jaffle_shop.stg_customers
[0m22:42:15.222431 [debug] [Thread-3 (]: Began executing node model.jaffle_shop.stg_payments
[0m22:42:15.246708 [debug] [Thread-2 (]: Writing runtime sql for node "model.jaffle_shop.stg_orders"
[0m22:42:15.251584 [debug] [Thread-1 (]: Writing runtime sql for node "model.jaffle_shop.stg_customers"
[0m22:42:15.256958 [debug] [Thread-3 (]: Writing runtime sql for node "model.jaffle_shop.stg_payments"
[0m22:42:15.259107 [debug] [Thread-1 (]: Using snowflake connection "model.jaffle_shop.stg_customers"
[0m22:42:15.260317 [debug] [Thread-2 (]: Using snowflake connection "model.jaffle_shop.stg_orders"
[0m22:42:15.261035 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */
create or replace   view RAW.JAFFLE_SHOP.stg_customers
  
   as (
    -- noinspection SqlNoDataSourceInspectionForFile



select
    id as customer_id,
    first_name,
    last_name

from raw.jaffle_shop.raw_customers
  );
[0m22:42:15.261812 [debug] [Thread-2 (]: On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */
create or replace   view RAW.JAFFLE_SHOP.stg_orders
  
   as (
    

select
    id as order_id,
    user_id as customer_id,
    order_date,
    status

from raw.jaffle_shop.raw_orders
  );
[0m22:42:15.262919 [debug] [Thread-3 (]: Using snowflake connection "model.jaffle_shop.stg_payments"
[0m22:42:15.263522 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:42:15.264097 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m22:42:15.264659 [debug] [Thread-3 (]: On model.jaffle_shop.stg_payments: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_payments"} */
create or replace   view RAW.JAFFLE_SHOP.stg_payments
  
   as (
    

select
    id,
    order_id,
    payment_method,
    amount

from raw.jaffle_shop.raw_payments
  );
[0m22:42:15.268310 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m22:42:15.816215 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m22:42:15.858603 [debug] [Thread-1 (]: Timing info for model.jaffle_shop.stg_customers (execute): 22:42:15.247280 => 22:42:15.858245
[0m22:42:15.859290 [debug] [Thread-1 (]: On model.jaffle_shop.stg_customers: Close
[0m22:42:15.913484 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m22:42:15.919980 [debug] [Thread-2 (]: Timing info for model.jaffle_shop.stg_orders (execute): 22:42:15.199221 => 22:42:15.919450
[0m22:42:15.923060 [debug] [Thread-2 (]: On model.jaffle_shop.stg_orders: Close
[0m22:42:15.978756 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m22:42:15.985919 [debug] [Thread-3 (]: Timing info for model.jaffle_shop.stg_payments (execute): 22:42:15.252029 => 22:42:15.985381
[0m22:42:15.986986 [debug] [Thread-3 (]: On model.jaffle_shop.stg_payments: Close
[0m22:42:16.004996 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8cc72603-ed6b-4e1c-9720-14e1a08b4085', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ad20590>]}
[0m22:42:16.006650 [info ] [Thread-1 (]: 1 of 5 OK created sql view model JAFFLE_SHOP.stg_customers ..................... [[32mSUCCESS 1[0m in 0.84s]
[0m22:42:16.008704 [debug] [Thread-1 (]: Finished running node model.jaffle_shop.stg_customers
[0m22:42:16.063922 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8cc72603-ed6b-4e1c-9720-14e1a08b4085', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ab13d90>]}
[0m22:42:16.064899 [info ] [Thread-2 (]: 2 of 5 OK created sql view model JAFFLE_SHOP.stg_orders ........................ [[32mSUCCESS 1[0m in 0.90s]
[0m22:42:16.065806 [debug] [Thread-2 (]: Finished running node model.jaffle_shop.stg_orders
[0m22:42:16.066749 [debug] [Thread-4 (]: Began running node model.jaffle_shop.customers
[0m22:42:16.067505 [info ] [Thread-4 (]: 4 of 5 START sql view model JAFFLE_SHOP.customers .............................. [RUN]
[0m22:42:16.068616 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.jaffle_shop.customers'
[0m22:42:16.069192 [debug] [Thread-4 (]: Began compiling node model.jaffle_shop.customers
[0m22:42:16.075614 [debug] [Thread-4 (]: Writing injected SQL for node "model.jaffle_shop.customers"
[0m22:42:16.076901 [debug] [Thread-4 (]: Timing info for model.jaffle_shop.customers (compile): 22:42:16.069558 => 22:42:16.076519
[0m22:42:16.077493 [debug] [Thread-4 (]: Began executing node model.jaffle_shop.customers
[0m22:42:16.082200 [debug] [Thread-4 (]: Writing runtime sql for node "model.jaffle_shop.customers"
[0m22:42:16.084786 [debug] [Thread-4 (]: Using snowflake connection "model.jaffle_shop.customers"
[0m22:42:16.085541 [debug] [Thread-4 (]: On model.jaffle_shop.customers: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.customers"} */
create or replace   view RAW.JAFFLE_SHOP.customers
  
   as (
    


with customers as (

    select * from RAW.JAFFLE_SHOP.stg_customers

),

orders as (

    select * from RAW.JAFFLE_SHOP.stg_orders

),

customer_orders as (

    select
        customer_id,

        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders

    from orders

    group by 1

),

final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce(customer_orders.number_of_orders, 0) as number_of_orders

    from customers

    left join customer_orders using (customer_id)

)

select * from final
  );
[0m22:42:16.086338 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m22:42:16.127394 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8cc72603-ed6b-4e1c-9720-14e1a08b4085', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ad3cf50>]}
[0m22:42:16.128432 [info ] [Thread-3 (]: 3 of 5 OK created sql view model JAFFLE_SHOP.stg_payments ...................... [[32mSUCCESS 1[0m in 0.96s]
[0m22:42:16.129472 [debug] [Thread-3 (]: Finished running node model.jaffle_shop.stg_payments
[0m22:42:16.130559 [debug] [Thread-2 (]: Began running node model.jaffle_shop.int_orders__pivoted
[0m22:42:16.131354 [info ] [Thread-2 (]: 5 of 5 START sql view model JAFFLE_SHOP.int_orders__pivoted .................... [RUN]
[0m22:42:16.132471 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.jaffle_shop.stg_orders, now model.jaffle_shop.int_orders__pivoted)
[0m22:42:16.133235 [debug] [Thread-2 (]: Began compiling node model.jaffle_shop.int_orders__pivoted
[0m22:42:16.142479 [debug] [Thread-2 (]: Writing injected SQL for node "model.jaffle_shop.int_orders__pivoted"
[0m22:42:16.144228 [debug] [Thread-2 (]: Timing info for model.jaffle_shop.int_orders__pivoted (compile): 22:42:16.134111 => 22:42:16.143591
[0m22:42:16.145155 [debug] [Thread-2 (]: Began executing node model.jaffle_shop.int_orders__pivoted
[0m22:42:16.152083 [debug] [Thread-2 (]: Writing runtime sql for node "model.jaffle_shop.int_orders__pivoted"
[0m22:42:16.155895 [debug] [Thread-2 (]: Using snowflake connection "model.jaffle_shop.int_orders__pivoted"
[0m22:42:16.156734 [debug] [Thread-2 (]: On model.jaffle_shop.int_orders__pivoted: /* {"app": "dbt", "dbt_version": "1.7.8", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.int_orders__pivoted"} */
create or replace   view RAW.JAFFLE_SHOP.int_orders__pivoted
  
   as (
    



WITH payments AS (
    SELECT p.id AS id,
           p.order_id AS order_id,
           p.payment_method AS payment_method,
           p.amount AS amount,
           o.status AS status
    FROM RAW.JAFFLE_SHOP.stg_payments p
    JOIN RAW.JAFFLE_SHOP.stg_orders o
    ON p.order_id = o.order_id
),
pivoted AS (
    SELECT
        order_id,
        SUM(CASE WHEN payment_method = 'bank_transfer' THEN amount ELSE 0 END) AS bank_transfer_amount,
        SUM(CASE WHEN payment_method = 'coupon' THEN amount ELSE 0 END) AS coupon_amount,
        SUM(CASE WHEN payment_method = 'credit_card' THEN amount ELSE 0 END) AS credit_card_amount,
        SUM(CASE WHEN payment_method = 'gift_card' THEN amount ELSE 0 END) AS gift_card_amount
    FROM payments
    WHERE status = 'completed'
    GROUP BY 1
)

SELECT * FROM pivoted
  );
[0m22:42:16.157432 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:42:16.637717 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m22:42:16.645182 [debug] [Thread-4 (]: Timing info for model.jaffle_shop.customers (execute): 22:42:16.077853 => 22:42:16.644729
[0m22:42:16.646100 [debug] [Thread-4 (]: On model.jaffle_shop.customers: Close
[0m22:42:16.724708 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m22:42:16.731960 [debug] [Thread-2 (]: Timing info for model.jaffle_shop.int_orders__pivoted (execute): 22:42:16.145725 => 22:42:16.731501
[0m22:42:16.733415 [debug] [Thread-2 (]: On model.jaffle_shop.int_orders__pivoted: Close
[0m22:42:16.809578 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8cc72603-ed6b-4e1c-9720-14e1a08b4085', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10acfb750>]}
[0m22:42:16.811108 [info ] [Thread-4 (]: 4 of 5 OK created sql view model JAFFLE_SHOP.customers ......................... [[32mSUCCESS 1[0m in 0.74s]
[0m22:42:16.812533 [debug] [Thread-4 (]: Finished running node model.jaffle_shop.customers
[0m22:42:16.882536 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8cc72603-ed6b-4e1c-9720-14e1a08b4085', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ad342d0>]}
[0m22:42:16.883794 [info ] [Thread-2 (]: 5 of 5 OK created sql view model JAFFLE_SHOP.int_orders__pivoted ............... [[32mSUCCESS 1[0m in 0.75s]
[0m22:42:16.885413 [debug] [Thread-2 (]: Finished running node model.jaffle_shop.int_orders__pivoted
[0m22:42:16.889371 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:42:16.890216 [debug] [MainThread]: Connection 'model.jaffle_shop.stg_customers' was properly closed.
[0m22:42:16.891016 [debug] [MainThread]: Connection 'model.jaffle_shop.int_orders__pivoted' was properly closed.
[0m22:42:16.891753 [debug] [MainThread]: Connection 'model.jaffle_shop.stg_payments' was properly closed.
[0m22:42:16.892423 [debug] [MainThread]: Connection 'model.jaffle_shop.customers' was properly closed.
[0m22:42:16.893050 [info ] [MainThread]: 
[0m22:42:16.893632 [info ] [MainThread]: Finished running 5 view models in 0 hours 0 minutes and 3.45 seconds (3.45s).
[0m22:42:16.895591 [debug] [MainThread]: Command end result
[0m22:42:16.910336 [info ] [MainThread]: 
[0m22:42:16.911032 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:42:16.911565 [info ] [MainThread]: 
[0m22:42:16.912156 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m22:42:16.914035 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 4.7626257, "process_user_time": 4.798391, "process_kernel_time": 0.639125, "process_mem_max_rss": "138211328", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m22:42:16.914945 [debug] [MainThread]: Command `dbt run` succeeded at 22:42:16.914735 after 4.76 seconds
[0m22:42:16.915601 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109963650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109fdac90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105c8bd90>]}
[0m22:42:16.916200 [debug] [MainThread]: Flushing usage events
